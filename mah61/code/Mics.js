CImagesNum=function(t){this.Papa=t,this.Imgs=[],this.Widths=[],this.Heights=[],this.ActiveFlag=!1},CImagesNum.prototype.clear=function(){this.HideFlag=!1,this.ImgsNum=0;for(var t=0;t<this.Imgs.length;t++)null!=this.Imgs[t].Img&&(this.Imgs[t].Img.kill(),this.Imgs[t].Img=null)},CImagesNum.prototype.create=function(t,i,s,h,e,a,l,r,p,n,d,m){this.clear();for(var o=0;o<a.length;o++){var g=this.Papa.cache.getFrameData(e);this.Widths[o]=g.getFrameByName(a[o]).width,this.Heights[o]=g.getFrameByName(a[o]).height}this.FirstSymb=h,this.Lefts=p,this.Frames=a,this.Atlas=e,this.Align=r,this.Marg=d,this.ScaleX=m,this.ScaleY=m,this.Group=l,this.Order=0,this.Shifts=n,this.Group.alive=!0,this.Group.visible=!0,this.Group.scale.set(m),this.setNum(s),this.Drag(t,i),this.ActiveFlag=!0},CImagesNum.prototype.Revive=function(){this.setNum(this.Number)},CImagesNum.prototype.Hide=function(t){this.Group.visible=!t},CImagesNum.prototype.setTint=function(t){for(var i=0;i<this.SlotsNum;i++)this.Imgs[i].Img.tint=t},CImagesNum.prototype.addImgObj=function(t,i,s,h){return null==this.Imgs[h]&&(this.Imgs[h]={Num:0,Sx0:0,Sy0:0,Sx:0,Sy:0,ScaleX:1,ScaleY:1,Img:null,HideFlag:!1}),null==this.Imgs[h].Img?this.Imgs[h].Img=this.Papa.getZeroImg(0,0,this.Atlas,this.Frames[s],this.Group,this.Order):(this.Imgs[h].Img.x=0,this.Imgs[h].Img.y=0,this.Imgs[h].Img.frameName=this.Frames[s],this.Imgs[h].Img.revive()),this.Imgs[h].Img.x=t,this.Imgs[h].Img.y=i,this.Imgs[h].Num=s,this.Imgs[h].Sx0=t,this.Imgs[h].Sy0=i,this.Imgs[h].Sx=t,this.Imgs[h].Sy=i,this.Imgs[h].HideFlag=!1,this.Imgs[h]},CImagesNum.prototype.kill=function(){this.ActiveFlag&&(this.clear(),this.Group.alive=!1,this.ActiveFlag=!1)},CImagesNum.prototype.DragUpdate=function(){this.Drag(this.Xc,this.Yc)},CImagesNum.prototype.Drag=function(t,i){this.Xc=t,this.Yc=i,this.Group.x=this.Xc,this.Group.y=this.Yc},CImagesNum.prototype.setAlpha=function(t){this.Group.alpha=t},CImagesNum.prototype.setScale=function(t,i){this.ScaleX=t,this.ScaleY=i,this.Group.scale.set(this.ScaleX,this.ScaleY)},CImagesNum.prototype.setNum=function(t){this.Number=t;var i=1e6,s=7,h=t,e=0,a=!1,l=0,r=0,p=-1,n=0;this.FirstSymb>=0&&(e=this.FirstSymb,(d=this.addImgObj(l+n,0,e,r)).Img.anchor.set(0,.5),d.Img.alpha=1,l+=this.Widths[e]+this.Marg,d.HideFlag=!1,r++);for(;s>0;){var d;if(e=Math.floor(h/i),a)n=0,null!=this.Shifts&&p>=0&&(n=this.Shifts[p][e]),(d=this.addImgObj(l+n,0,e,r)).Img.anchor.set(0,.5),d.Img.alpha=1,l+=this.Widths[e]+this.Marg+n,d.HideFlag=!1,r++;else e>0&&(n=0,null!=this.Shifts&&p>=0&&(n=this.Shifts[p][e]),(d=this.addImgObj(l+n,0,e,r)).Img.anchor.set(0,.5),d.Img.alpha=1,l+=this.Widths[e]+this.Marg+n,a=!0,d.HideFlag=!1,r++);h-=e*i,i/=10,--s<=0&&0==r&&(n=0,null!=this.Shifts&&p>=0&&(n=this.Shifts[p][e]),(d=this.addImgObj(l+n,0,0,r)).Img.anchor.set(0,.5),d.Img.alpha=1,l+=this.Widths[e]+this.Marg+n,d.HideFlag=!1,r++),p=e}this.SlotsNum=r;for(var m=r;m<this.Imgs.length;m++)null!=this.Imgs[m].Img&&(this.Imgs[m].Img.visible=!1,this.Imgs[m].HideFlag=!0);switch(this.Align){case 0:for(m=0;m<this.SlotsNum;m++)this.Imgs[m].Sx0-=l/2,this.Imgs[m].Sy0=0;break;case 1:if(null!=this.Lefts)for(m=0;m<this.SlotsNum;m++)this.Imgs[m].Sx0-=this.Lefts[r-1];break;case 2:if(1==this.SlotsNum)for(m=0;m<this.SlotsNum;m++)this.Imgs[m].Sx0-=l/2;else if(null!=this.Lefts)for(m=0;m<this.SlotsNum;m++)this.Imgs[m].Sx0-=this.Lefts[r-1]}for(m=0;m<this.SlotsNum;m++)this.Imgs[m].Sx=this.Imgs[m].Sx0,this.Imgs[m].Sy=this.Imgs[m].Sy0,this.Imgs[m].Img.x=this.Imgs[m].Sx,this.Imgs[m].Img.y=this.Imgs[m].Sy;return this.DragUpdate(),l},CExplGlow=function(t,i){this.Papa=t,this.Threads=i,this.dT=1/Base.UPS,this.ActiveFlag=!1},CExplGlow.prototype.create=function(t,i,s,h,e,a,l,r,p,n){this.dT=Base.RealTimeInt,this.dT<.05&&(this.dT=.05),this.Angle=0,this.Alpha=l,this.AlphaSpeedAddFade=this.dT*this.Alpha/a,this.TimeLife=e,this.TimeCntr=0,this.Scale=s,this.ScaleDest=h,this.ScaleAdd=(this.ScaleDest-this.Scale)*this.dT/(e+a),this.X=t,this.Y=i,this.Img=this.Papa.getImg(t,i,r,p,n,0),this.Img.alpha=this.Alpha,this.Img.anchor.set(.5),this.Img.rotation=this.Angle,this.Img.scale.set(this.Scale),this.Threads.addThread(this,this.update),this.ActiveFlag=!0},CExplGlow.prototype.setAngle=function(t){this.Angle=t,this.Img.rotation=this.Angle},CExplGlow.prototype.setAnchor=function(t,i){this.Img.anchor.set(t,i)},CExplGlow.prototype.setScreenSplash=function(t,i,s,h,e,a,l,r,p,n){this.ScaleAdd=0,this.dT=Base.RealTimeInt,this.dT<.05&&(this.dT=.05),this.Alpha=l,this.AlphaSpeedAddFade=this.dT*this.Alpha/a,this.TimeLife=e,this.TimeCntr=0,this.X=t,this.Y=i,this.Img=this.Papa.getZeroImg(t,i,r,p,n,0),this.Img.alpha=this.Alpha,this.Img.anchor.set(.5),this.Img.width=s,this.Img.height=h,this.Threads.addThread(this,this.update),this.ActiveFlag=!0},CExplGlow.prototype.Kill=function(){this.ActiveFlag&&(this.Img.kill(),this.Threads.removeThread(this,this.update),this.ActiveFlag=!1)},CExplGlow.prototype.update=function(){if(0!=this.ScaleAdd&&(this.Scale+=this.ScaleAdd,this.Img.scale.set(this.Scale)),(this.TimeCntr+=this.dT)>this.TimeLife){if(this.Alpha-=this.AlphaSpeedAddFade,this.Alpha<0)return void this.Kill();this.Img.alpha=this.Alpha}},CDustParticle=function(t,i){this.Papa=t,this.Threads=i,this.dT=1/Base.UPS,this.ActiveFlag=!1},CDustParticle.prototype.create=function(t,i,s,h,e,a,l,r){this.dT=Base.RealTimeInt,this.dT<.05&&(this.dT=.05),this.Def=Base.Dusts[s],this.SpeedCoeffMin=this.Def.speedMin,this.ScaleDie=this.Def.scaleDie,this.Alpha=r,this.TimeLifeCntr=h,this.TimeFade=this.Def.timeFade,this.AlphaSpeedAddFade=1/this.TimeFade*this.dT,this.TimeCntr=0,this.TimeCoeff=0,this.SpeedCoeff=1,this.SpeedCoeffSpeed=1/(this.TimeFade+h),this.Duration=h,this.Scale=this.Def.scale0+this.Def.scaleRnd*Math.random(),this.ScaleAdd=this.dT*(1-this.ScaleDie)/this.TimeFade,this.X=t,this.Y=i,this.SpeedXAdd=e*this.dT,this.SpeedYAdd=a*this.dT,this.Img=this.Papa.getImg(t,i,this.Def.atlas,this.Def.img,l,0),this.Img.alpha=this.Alpha,this.Img.anchor.set(.5),this.Img.scale.set(this.Scale),this.Threads.addThread(this,this.update),this.ActiveFlag=!0},CDustParticle.prototype.Kill=function(){this.ActiveFlag&&(this.Img.kill(),this.Threads.removeThread(this,this.update),this.ActiveFlag=!1)},CDustParticle.prototype.update=function(){this.X+=this.SpeedXAdd*this.SpeedCoeff,this.Y+=this.SpeedYAdd*this.SpeedCoeff,this.Img.x=this.X,this.Img.y=this.Y,this.SpeedCoeff-=this.SpeedCoeffSpeed*Base.RealTimeInt,this.SpeedCoeff<0&&(this.SpeedCoeff=0),(this.TimeLifeCntr-=this.dT)<0&&(this.Scale-=this.ScaleAdd,this.Img.scale.set(this.Scale),this.Scale<this.ScaleDie&&this.Kill())},CExplParticle=function(t,i){this.Papa=t,this.Threads=i,this.dT=1/Base.UPS,this.ActiveFlag=!1},CExplParticle.prototype.create=function(t,i,s,h,e,a,l,r,p,n){this.RotateSpeed=p,this.Angle=r,this.dT=Base.RealTimeInt,this.dT<.05&&(this.dT=.05),this.Def=Base.Dusts[h],this.SpeedCoeffMin=this.Def.speedMin,this.ScaleDie=this.Def.scaleDie,this.Alpha=1,this.TimeLifeCntr=e,this.TimeFade=this.Def.timeFade,this.AlphaSpeedAddFade=1/this.TimeFade*this.dT,this.TimeCntr=0,this.TimeCoeff=0,this.SpeedCoeff=1,this.Duration=e+this.TimeFade,this.Scale=this.Def.scale0+this.Def.scaleRnd*Math.random(),this.ScaleAdd=this.dT*(1-this.ScaleDie)/this.TimeFade,this.X=t,this.Y=i,this.SpeedXAdd=a*this.dT,this.SpeedYAdd=l*this.dT,this.SpeedGravity=0;var d=s;null==s&&(d=this.Def.img),this.Img=this.Papa.getImg(t,i,this.Def.atlas,d,n,0),this.Img.alpha=this.Alpha,this.Img.anchor.set(.5),this.Img.rotation=r,this.Img.scale.set(this.Scale),this.Threads.addThread(this,this.update),this.ActiveFlag=!0},CExplParticle.prototype.setGravity=function(t){this.SpeedGravity=t*this.dT},CExplParticle.prototype.Kill=function(){this.ActiveFlag&&(this.Img.kill(),this.Threads.removeThread(this,this.update),this.ActiveFlag=!1)},CExplParticle.prototype.update=function(){this.X+=this.SpeedXAdd*this.SpeedCoeff,this.Y+=this.SpeedYAdd*this.SpeedCoeff,this.Y+=this.SpeedGravity,this.Img.x=this.X,this.Img.y=this.Y,0!=this.RotateSpeed&&(this.Angle+=this.RotateSpeed*Base.RealTimeInt,this.Img.rotation=this.Angle);var t=this.TimeCntr/this.Duration;t=t>1?1:t,this.SpeedCoeff=t*(2-t),this.SpeedCoeff<this.SpeedCoeffMin&&(this.SpeedCoeff=this.SpeedCoeffMin),(this.TimeLifeCntr-=this.dT)<0&&(this.Scale-=this.ScaleAdd,this.Img.scale.set(this.Scale),this.Scale<this.ScaleDie&&this.Kill())},CPopUp=function(t,i,s){this.Papa=t,this.Group=i,this.Threads=s,this.AllParams=[];var h={dist:50,life:1,rise:.1,stay:.75,fade:.25};this.AllParams.push(h),h={dist:50,life:1.5,rise:.2,stay:1,fade:.3},this.AllParams.push(h)},CPopUp.prototype.clear=function(){this.Alpha=0,this.Scale=1,this.Time=0,this.TimeCoeff=0,this.DistUp=0,this.DistMaxDest=0,this.DistMaxUpFlag=!1,this.FadeFlag=!1},CPopUp.prototype.create=function(t,i,s,h,e,a,l){this.clear(),this.Type=s,this.Func=a,this.FuncContex=l,this.Params=this.AllParams[this.Type],this.PauseTimeCntr=e,this.Y0=i,this.Xc=t,this.Yc=i,this.Img=this.Papa.getImg(0,0,"atlas",h,this.Group,0),this.Img.x=t,this.Img.y=this.Y0-this.DistUp,this.Img.alpha=this.Alpha,this.Img.rotation=0,this.Img.scale.set(this.Scale),this.Img.anchor.set(.5),this.TimeDuration=this.Params.life,this.DistMax=this.Params.dist,this.AlphaSpeed=1/this.Params.rise,this.updateAlpha=this.updateAlpha0,this.Threads.addThread(this,this.update),this.ActiveFlag=!0},CPopUp.prototype.setShortUp=function(t,i){this.DistMaxUpFlag?this.DistMaxDest+=t:(this.DistMaxDest=this.DistMax+t,this.DistMaxSpeed=(this.DistMaxDest-this.DistMax)/i,this.DistMaxUpFlag=!0)},CPopUp.prototype.kill=function(){this.ActiveFlag&&(this.Threads.removeThread(this,this.update),this.Img.kill(),this.ActiveFlag=!1)},CPopUp.prototype.updateAlpha0=function(){this.Alpha+=this.AlphaSpeed*Base.RealTimeInt,this.Alpha>=1&&(this.Alpha=1,this.StayTimeCntr=this.Params.stay,this.updateAlpha=this.updateAlpha1),this.Img.alpha=this.Alpha},CPopUp.prototype.updateAlpha1=function(){this.StayTimeCntr-=Base.RealTimeInt,this.StayTimeCntr<=0&&(this.updateAlpha=this.updateAlpha2,this.AlphaSpeed=1/this.Params.fade,this.FadeFlag=!0)},CPopUp.prototype.updateAlpha2=function(){this.Alpha-=this.AlphaSpeed*Base.RealTimeInt,this.Alpha<=0?(this.Alpha=0,this.kill(),null!=this.Func&&this.Func.call(this.FuncContex)):this.Img.alpha=this.Alpha},CPopUp.prototype.update=function(){this.PauseTimeCntr-=Base.RealTimeInt,this.PauseTimeCntr>0||(this.Time+=Base.RealTimeInt,this.TimeCoeff=this.Time/this.TimeDuration,this.TimeCoeff=this.TimeCoeff>1?1:this.TimeCoeff,this.TimeCoeff=this.TimeCoeff*(2-this.TimeCoeff),this.DistMaxUpFlag&&(this.DistMax+=this.DistMaxSpeed*Base.RealTimeInt,this.DistMax>=this.DistMaxDest&&(this.DistMax=this.DistMaxDest,this.DistMaxUpFlag=!1)),this.DistUp=this.DistMax*this.TimeCoeff,this.Yc=this.Y0-this.DistUp,this.Img.y=this.Yc,this.updateAlpha.call(this))},CImgGroup=function(t,i,s){Phaser.Group.call(this,t,null),this.Papa=i,this.x=0,this.y=0,this.game=t,this.Imgs=[],this.ImgsNum=0,this.Threads=s,this.ActiveFlag=!1},CImgGroup.prototype=Object.create(Phaser.Group.prototype),CImgGroup.prototype.constructor=CImgGroup,CImgGroup.prototype.clear=function(){this.ScalingFlag=!1,this.Scale=1,this.ImgsNum=0},CImgGroup.prototype.create=function(t,i,s,h,e){this.clear(),this.x=t,this.y=i,this.angle=h,this.rotation=h,this.Scale=e,this.scale.set(e),this.ActiveFlag=!0},CImgGroup.prototype.setAngle=function(t){this.angle=t,this.rotation=t,this.update()},CImgGroup.prototype.addImgObj=function(t,i,s,h,e,a,l){var r=this.addImg(t,i,s,h,e);r.anchor.set(.5),r.alpha=1;var p=this.ImgsNum;return null==this.Imgs[p]&&(this.Imgs[p]={Sx:0,Sy:0,Scale:a,Img:null}),this.Imgs[p].Img=r,this.Imgs[p].Sx=t,this.Imgs[p].Sy=i,this.Imgs[p].Scale=a,this.Imgs[p].Angle=l,this.Imgs[p].Img.scale.set(this.Imgs[p].Scale),this.Imgs[p].Img.rotation=this.Imgs[p].Angle,this.ImgsNum++,this.Imgs[p]},CImgGroup.prototype.setScale=function(t){this.Scale=t,this.scale.set(this.Scale)},CImgGroup.prototype.setScaling=function(t,i,s){this.ScaleDest=t,this.ScaleSpeed=(this.ScaleDest-this.Scale)/i,this.ScalingHideFlag=s,0==this.ScalingFlag&&this.Threads.addThread(this,this.scalingUpdate),this.ScalingFlag=!0},CImgGroup.prototype.scalingUpdate=function(){this.ScalingFlag&&(this.Scale+=this.ScaleSpeed*Backet.RealTimeInt,(this.Scale>this.ScaleDest&&this.ScaleSpeed>0||this.Scale<this.ScaleDest&&this.ScaleSpeed<0)&&(this.Scale=this.ScaleDest,this.ScalingHideFlag&&this.Hide(!0),this.ScalingFlag=!1,this.Threads.removeThread(this,this.scalingUpdate)),this.setScale(this.Scale))},CImgGroup.prototype.kill=function(){if(this.ActiveFlag){for(var t=0;t<this.children.length;t++)this.children[t].alive&&this.children[t].kill();this.ScalingFlag&&this.Threads.removeThread(this,this.scalingUpdate),this.ImgsNum=0,this.ActiveFlag=!0}},CImgGroup.prototype.Hide=function(t){if(this.Number.Hide(t),t)for(var i=0;i<this.children.length;i++)this.children[i].visible&&(this.children[i].visible=!1);else for(i=0;i<this.children.length;i++)this.children[i].alive&&(this.children[i].visible=!0)},CImgGroup.prototype.addImg=function(t,i,s,h){for(var e=null,a=0;a<this.children.length;a++)if(!1===this.children[a].alive&&this.children[a]instanceof Phaser.Image&&this.children[a].type==Phaser.IMAGE&&this.children[a].key===s){e=this.children[a];break}return null==e?(e=this.game.make.image(t,i,s,h),this.add(e)):(e.revive(),e.x=t,e.y=i,null!=h&&(e.frameName=h)),e.Order=0,e},CTextPopUp=function(t,i,s){this.Papa=t,this.Group=i,this.Threads=s,this.AllParams=[],this.AllParams.push({dist:40,rise:.1,stay:.25,fade:.25}),this.AllParams.push({dist:30,rise:.1,stay:1,fade:.3})},CTextPopUp.prototype.clear=function(){this.Alpha=0,this.Scale=1,this.Time=0,this.TimeCoeff=0,this.DistUp=0,this.DistMaxDest=0,this.DistMaxUpFlag=!1,this.FadeFlag=!1},CTextPopUp.prototype.init=function(t){this.Text=t,this.Text.visible=!1,this.Text.alive=!1},CTextPopUp.prototype.create=function(t,i,s,h,e,a){this.clear(),this.Type=s,this.Params=this.AllParams[this.Type],this.PauseTimeCntr=0,this.Y0=i,this.Xc=t,this.Yc=i,this.Text.x=t,this.Text.y=this.Y0-this.DistUp,this.Text.alpha=this.Alpha,this.Text.rotation=0,this.Scale=e,this.Text.scale.set(this.Scale),this.Text.anchor.set(.5),this.Text.visible=!0,this.Text.alive=!0,this.Text.setText(h),a>0&&this.setWidthMax(a),this.TimeDuration=this.Params.rise+this.Params.stay+this.Params.fade,this.DistMax=this.Params.dist,this.AlphaSpeed=1/this.Params.rise,this.updateAlpha=this.updateAlpha0,this.ActiveFlag||this.Threads.addThread(this,this.update),this.ActiveFlag=!0},CTextPopUp.prototype.setWidthMax=function(t){var i=this.Text.width;i>t&&(this.Scale=t/i),this.Text.scale.set(this.Scale)},CTextPopUp.prototype.setShortUp=function(t,i){this.DistMaxUpFlag?this.DistMaxDest+=t:(this.DistMaxDest=this.DistMax+t,this.DistMaxSpeed=(this.DistMaxDest-this.DistMax)/i,this.DistMaxUpFlag=!0)},CTextPopUp.prototype.kill=function(){this.ActiveFlag&&(this.Threads.removeThread(this,this.update),this.Text.visible=!1,this.Text.alive=!1,this.ActiveFlag=!1)},CTextPopUp.prototype.updateAlpha0=function(){this.Alpha+=this.AlphaSpeed*Base.RealTimeInt,this.Alpha>=1&&(this.Alpha=1,this.StayTimeCntr=this.Params.stay,this.updateAlpha=this.updateAlpha1),this.Text.alpha=this.Alpha},CTextPopUp.prototype.updateAlpha1=function(){this.StayTimeCntr-=Base.RealTimeInt,this.StayTimeCntr<=0&&(this.updateAlpha=this.updateAlpha2,this.AlphaSpeed=1/this.Params.fade,this.FadeFlag=!0)},CTextPopUp.prototype.updateAlpha2=function(){this.Alpha-=this.AlphaSpeed*Base.RealTimeInt,this.Alpha<=0?(this.Alpha=0,this.kill()):this.Text.alpha=this.Alpha},CTextPopUp.prototype.update=function(){this.PauseTimeCntr-=Base.RealTimeInt,this.PauseTimeCntr>0||(this.Time+=Base.RealTimeInt,this.TimeCoeff=this.Time/this.TimeDuration,this.TimeCoeff=this.TimeCoeff>1?1:this.TimeCoeff,this.TimeCoeff=this.TimeCoeff*(2-this.TimeCoeff),this.DistMaxUpFlag&&(this.DistMax+=this.DistMaxSpeed*Base.RealTimeInt,this.DistMax>=this.DistMaxDest&&(this.DistMax=this.DistMaxDest,this.DistMaxUpFlag=!1)),this.DistUp=this.DistMax*this.TimeCoeff,this.Yc=this.Y0-this.DistUp,this.Text.y=this.Yc,this.updateAlpha.call(this))},CPopNum=function(t,i,s){this.Papa=t,this.Group=i,this.Threads=s,this.AllParams=[];this.AllParams.push({dist:50,life:.6,rise:.1,stay:.5,fade:.25,marg:1}),this.Number=new CImagesNum(this.Papa),this.GroupNum=this.Papa.game.add.group(),this.Group.add(this.GroupNum)},CPopNum.prototype.clear=function(){this.Alpha=0,this.Scale=1,this.Time=0,this.TimeCoeff=0,this.DistUp=0,this.DistMaxDest=0,this.DistMaxUpFlag=!1,this.FadeFlag=!1,this.Number.clear(),this.Row=0,this.Col=0},CPopNum.prototype.create=function(t,i,s,h,e,a,l,r,p,n){this.clear(),this.Type=s,this.Func=p,this.FuncContex=n,this.Params=this.AllParams[this.Type],this.PauseTimeCntr=l,this.Y0=i,this.Xc=t,this.Yc=i,this.Number.create(t,i,h,10,"atlas",Base.WhiteNums,this.GroupNum,0,null,null,this.Params.marg,r),this.Number.setAlpha(e),this.Number.setTint(a),this.TimeDuration=this.Params.life,this.DistMax=this.Params.dist,this.AlphaMax=e,this.AlphaSpeed=this.AlphaMax/this.Params.rise,this.updateAlpha=this.updateAlpha0,this.Threads.addThread(this,this.update),this.ActiveFlag=!0},CPopNum.prototype.setNumber=function(t){this.Number.setNum(t)},CPopNum.prototype.setRowCol=function(t,i){this.Row=t,this.Col=i},CPopNum.prototype.setShortUp=function(t,i){this.DistMaxUpFlag?this.DistMaxDest+=t:(this.DistMaxDest=this.DistMax+t,this.DistMaxSpeed=(this.DistMaxDest-this.DistMax)/i,this.DistMaxUpFlag=!0)},CPopNum.prototype.kill=function(){this.ActiveFlag&&(this.Threads.removeThread(this,this.update),this.Number.kill(),this.ActiveFlag=!1)},CPopNum.prototype.updateAlpha0=function(){this.Alpha+=this.AlphaSpeed*Base.RealTimeInt,this.Alpha>=this.AlphaMax&&(this.Alpha=this.AlphaMax,this.StayTimeCntr=this.Params.stay,this.updateAlpha=this.updateAlpha1),this.Number.setAlpha(this.Alpha)},CPopNum.prototype.updateAlpha1=function(){this.StayTimeCntr-=Base.RealTimeInt,this.StayTimeCntr<=0&&(this.updateAlpha=this.updateAlpha2,this.AlphaSpeed=1/this.Params.fade,this.FadeFlag=!0)},CPopNum.prototype.updateAlpha2=function(){this.Alpha-=this.AlphaSpeed*Base.RealTimeInt,this.Alpha<=0?(this.Alpha=0,this.kill(),null!=this.Func&&this.Func.call(this.FuncContex)):this.Number.setAlpha(this.Alpha)},CPopNum.prototype.update=function(){this.PauseTimeCntr-=Base.RealTimeInt,this.PauseTimeCntr>0||(this.Time+=Base.RealTimeInt,this.TimeCoeff=this.Time/this.TimeDuration,this.TimeCoeff>1&&(this.TimeCoeff=1),this.TimeCoeff=--this.TimeCoeff*this.TimeCoeff*this.TimeCoeff+1,this.DistUp=this.DistMax*this.TimeCoeff,this.Yc=this.Y0+this.DistUp,this.Number.Drag(this.Xc,this.Yc),this.updateAlpha.call(this))},CFishAnimFX=function(t,i,s){this.Papa=t,this.Group=i,this.Threads=s,this.ActiveFlag=!1},CFishAnimFX.prototype.create=function(t,i,s,h,e,a,l){this.X0=t,this.Y0=i,this.Scale=1,this.Base=h,this.Xc=this.X0,this.Yc=this.Base.y+this.Y0,this.ImgStrs=Base.FXAnims[e].imgs,this.ShiftX=Base.FXAnims[e].sx,this.ShiftY=Base.FXAnims[e].sy,this.Func=a,this.FuncContex=l,this.Img=this.Papa.getZeroImg(this.Xc+this.ShiftX,this.Yc+this.ShiftY,"gfx",this.ImgStrs[0],this.Group,0),this.Img.x=this.Xc,this.Img.y=this.Yc,this.Img.scale.set(this.Scale),this.TimeCntr=0,this.Time=s,this.Threads.addThread(this,this.update),this.ActiveFlag=!0},CFishAnimFX.prototype.kill=function(){this.ActiveFlag&&(this.Img.kill(),this.Threads.removeThread(this,this.update),this.ActiveFlag=!1,null!=this.Func&&this.Func.call(this.FuncContex))},CFishAnimFX.prototype.update=function(){this.Xc=this.X0+this.ShiftX,this.Yc=this.Base.y+this.Y0+this.ShiftY,this.Img.x=this.Xc,this.Img.y=this.Yc,this.TimeCntr+=Base.RealTimeInt;var t=Math.floor(this.TimeCntr*this.ImgStrs.length/this.Time);t>=this.ImgStrs.length?this.kill():this.Img.frameName=this.ImgStrs[t]},CFrenzy=function(t,i,s){this.Papa=t,this.Group=i,this.Threads=s,this.ActiveFlag=!1,this.Lights=[],this.LightsNum=0,this.Lines=[],this.LinesNum=0,this.ActiveFlag=!1},CFrenzy.prototype.init=function(t,i,s,h,e){this.BgFreenzyImg=s,this.BgFreenzyImg.visible=!1,this.FreenzySliderBgImg=i,this.FreenzySliderBgImg.anchor.set(.5,.5),this.FreenzySliderBgImg.visible=!1,this.FreenzySliderImg=t,this.FreenzySliderImg.visible=!1,this.FreenzySliderImg.x=Base.Width/2-this.FreenzySliderImg.width/2,this.FreenzySliderImg.anchor.set(0,.5),this.FreenzySliderImg.cropRect=new Phaser.Rectangle(0,0,this.FreenzySliderImg.width,this.FreenzySliderImg.height),this.FreenzySliderWidth=this.FreenzySliderImg.width,this.FreenzyPanelImg=h,this.FreenzyText=e,this.FreenzyPanelImg.visible=!1,this.FreenzyText.visible=!1,this.Y_text=50+Base.LangParams[Base.LangIndex].y_frenzy,this.ActiveFlag=!1},CFrenzy.prototype.create=function(t){this.FreenzyTime=5,this.FreenzyTimeCntr=this.FreenzyTime,this.FreenzySliderBgImg.visible=!0,this.FreenzySliderImg.visible=!0,this.BgFreenzyImg.visible=!0,this.FreenzySliderBgImg.alpha=0,this.FreenzySliderImg.alpha=0,this.BgFreenzyImg.alpha=0,this.FreenzySliderImg.cropRect.width=this.FreenzySliderWidth,this.FreenzySliderImg.updateCrop(),this.Alpha=0,this.AlphaSpeed=2,this.Threads.addThread(this,this.updateFadeIn);this.LightsNum=0;for(var i=0;i<6;i++){null==this.Lights[this.LightsNum]&&(this.Lights[this.LightsNum]={img:null,frame:0});var s=this.Lights[this.LightsNum];this.LightsNum++,s.img=this.Papa.getZeroImg(t-295,180+90*i,"gfx","light_00.png",this.Group),s.img.alpha=0,s.rateCntr=1+.3*i,s.frame=0,s.alpha=-(.35*i+.25),null==this.Lights[this.LightsNum]&&(this.Lights[this.LightsNum]={img:null}),s=this.Lights[this.LightsNum],this.LightsNum++,s.img=this.Papa.getZeroImg(t+290,180+90*i,"gfx","light_00.png",this.Group),s.img.anchor.set(.5),s.img.alpha=0}for(this.Threads.addThread(this,this.updateLightsFadeIn),this.LinesNum=0,i=0;i<this.Papa.LinesXY.length;i++)null==this.Lines[this.LinesNum]&&(this.Lines[this.LinesNum]={img:null,alpha:0}),s=this.Lines[this.LinesNum],this.LinesNum++,s.img=this.Papa.getZeroImg(this.Papa.LinesXY[i].x-101,this.Papa.LinesXY[i].y-104,"gfx","lineGlow1.png",this.Group),s.img.anchor.set(0,0),s.img.alpha=0,s.alpha=0;for(i=0;i<this.Papa.LinesXY.length/2;i++)this.Lines[i].alpha=-.75*i,this.Lines[this.Papa.LinesXY.length-1-i].alpha=-.75*i;this.LinesFadeInTimeCntr=1,this.FreenzyPanelImg.visible=!0,this.FreenzyText.visible=!0,this.FreenzyPanelImg.y=0,this.FreenzyText.y=40,this.FreenzyText.anchor.set(.5,.5),this.FreenzyText.setText(sgLang.x3[Base.Lang]),this.FreenzyText.update(),this.FreenzyText.x>210&&this.FreenzyText.scale.set(.6),this.Y0_pad=0,this.Y_pad=0,this.DistPad=100,this.DistYoYo=20,this.DistTime=.5,this.TimeYoYo=.2,this.DistTimeCntr=0,this.PadYoYoCntr=0,this.PadMoveFlag=!0,this.Threads.addThread(this,this.updatePad),this.Threads.addThread(this,this.updateFreenzy),this.FadeFlag=!1,this.ActiveFlag=!0},CFrenzy.prototype.stop=function(){this.ActiveFlag&&(this.FadeFlag||this.FadeFreenzy())},CFrenzy.prototype.updateFreenzy=function(){this.FreenzyTimeCntr-=Base.RealTimeInt,this.FreenzyTimeCntr<=0?this.stop():this.setFreenzySlider(this.FreenzyTimeCntr/this.FreenzyTime)},CFrenzy.prototype.setPadOut=function(){this.Y0_pad=this.FreenzyPanelImg.y,this.DistPad=15,this.DistYoYo=120,this.DistTime=.25,this.TimeYoYo=.7,this.DistTimeCntr=0,this.PadYoYoCntr=0,this.Threads.addThread(this,this.updatePadOut)},CFrenzy.prototype.updatePadOut=function(){this.DistTimeCntr+=Base.RealTimeInt;var t=this.DistTimeCntr/this.DistTime;if((t*=2)<1?t*=.5*t:t=-.5*(--t*(t-2)-1),this.DistTimeCntr>=this.DistTime&&(t=1),this.Y_pad=this.Y0_pad+this.DistPad*t,this.FreenzyPanelImg.y=this.Y_pad,this.FreenzyText.y=this.Y_pad+this.Y_text,1==t){if(this.Y0_pad=this.Y_pad,0!=this.PadYoYoCntr)return void this.Threads.removeThread(this,this.updatePadOut);this.DistPad=-this.DistYoYo,this.DistTime=this.TimeYoYo,this.PadYoYoCntr++}},CFrenzy.prototype.updatePad=function(){this.DistTimeCntr+=Base.RealTimeInt;var t=this.DistTimeCntr/this.DistTime;(t*=2)<1?t*=.5*t:t=-.5*(--t*(t-2)-1),this.DistTimeCntr>=this.DistTime&&(t=1),this.Y_pad=this.Y0_pad+this.DistPad*t,this.FreenzyPanelImg.y=this.Y_pad,this.FreenzyText.y=this.Y_pad+this.Y_text,1==t&&(this.Y0_pad=this.Y_pad,0==this.PadYoYoCntr?(this.DistPad=-this.DistYoYo,this.DistTime=this.TimeYoYo):(this.DistPad=.8*-this.DistPad,this.TimeYoYo=.9*this.TimeYoYo,this.DistTime=this.TimeYoYo),this.PadYoYoCntr++,this.DistTimeCntr=0,Math.abs(this.DistPad)<3&&(this.PadMoveFlag=!1,this.Threads.removeThread(this,this.updatePad)))},CFrenzy.prototype.FadeFreenzy=function(){this.ActiveFlag&&(this.AlphaSpeed=-1.5,this.Threads.addThread(this,this.updateFadeOut),this.Threads.removeThread(this,this.updateFreenzy),this.Papa.Field.OffFreenzy(),this.setPadOut(),this.FadeFlag=!0)},CFrenzy.prototype.updateLightsFadeIn=function(){for(var t=0;t<this.LightsNum-1;t+=2)this.Lights[t].alpha+=3*Base.RealTimeInt,this.Lights[t].alpha>=0&&(this.Lights[t].alpha>=1&&(this.Lights[t].alpha=1,t+1==this.LightsNum-1&&this.Threads.removeThread(this,this.updateLightsFadeIn)),this.Lights[t].img.alpha=this.Lights[t].alpha,this.Lights[t+1].img.alpha=this.Lights[t].alpha)},CFrenzy.prototype.updateLines=function(){this.LinesFadeInTimeCntr-=Base.RealTimeInt;for(var t=0;t<this.LinesNum;t++)this.Lines[t].alpha+=2*Base.RealTimeInt,this.Lines[t].alpha>=0&&(this.Lines[t].alpha>=1?this.Lines[t].alpha=1:this.Lines[t].img.alpha=this.Lines[t].alpha);this.LinesFadeInTimeCntr<0&&this.Threads.removeThread(this,this.updateLines)},CFrenzy.prototype.updateLight=function(){for(var t=0;t<this.LightsNum-1;t+=2)this.Lights[t].rateCntr-=Base.RealTimeInt,this.Lights[t].rateCntr<=0&&(this.Lights[t].rateCntr=1/30,this.Lights[t].frame++,this.Lights[t].frame>=Base.Lights.length&&(this.Lights[t].frame=0),this.Lights[t].img.frameName=Base.Lights[this.Lights[t].frame],this.Lights[t+1].img.frameName=Base.Lights[this.Lights[t].frame])},CFrenzy.prototype.setFreenzySlider=function(t){this.FreenzySliderImg.cropRect.width=this.FreenzySliderWidth*t,this.FreenzySliderImg.updateCrop()},CFrenzy.prototype.updateFadeIn=function(){this.Alpha+=this.AlphaSpeed*Base.RealTimeInt,this.Alpha>=1&&(this.Alpha=1,this.Threads.removeThread(this,this.updateFadeIn),this.Threads.addThread(this,this.updateLight),this.Threads.addThread(this,this.updateLines)),this.FreenzySliderBgImg.alpha=this.Alpha,this.FreenzySliderImg.alpha=this.Alpha,this.BgFreenzyImg.alpha=this.Alpha},CFrenzy.prototype.updateFadeOut=function(){if(this.Alpha+=this.AlphaSpeed*Base.RealTimeInt,this.Alpha<=0)return this.Alpha=0,void this.kill();for(var t=0;t<this.LightsNum;t++)this.Lights[t].img.alpha=this.Alpha;for(t=0;t<this.LinesNum;t++)this.Lines[t].img.alpha=this.Alpha;this.FreenzySliderBgImg.alpha=this.Alpha,this.FreenzySliderImg.alpha=this.Alpha,this.BgFreenzyImg.alpha=this.Alpha},CFrenzy.prototype.kill=function(){if(this.ActiveFlag){this.PadMoveFlag&&this.Threads.removeThread(this,this.updatePad),this.Threads.removeThread(this,this.updatePadOut),this.Threads.removeThread(this,this.updateLightsFadeIn),this.Threads.removeThread(this,this.updateLines),this.Threads.removeThread(this,this.updateFadeIn),this.Threads.removeThread(this,this.updateFadeOut),this.Threads.removeThread(this,this.updateLight);for(var t=0;t<this.LightsNum;t++)this.Lights[t].img.kill(),this.Lights[t].img=null;for(t=0;t<this.LinesNum;t++)this.Lines[t].img.kill(),this.Lines[t].img=null;this.Papa.Field.OffFreenzy(),this.FreenzyPanelImg.visible=!1,this.FreenzyText.visible=!1,this.FreenzySliderBgImg.visible=!1,this.FreenzySliderImg.visible=!1,this.BgFreenzyImg.visible=!1,this.FadeFlag=!1,this.ActiveFlag=!1}},CCameraShake=function(t,i){this.Camera=t,this.Threads=i,this.ActiveFlag=!1},CCameraShake.prototype.create=function(t,i,s){this.Rad=t,this.Speed=i,this.TimeCntr=s,this.RadsFlag=!1,this.Rad instanceof Array&&(this.Rads=t,this.RadsIndex=0,this.RadsIndexNext=1,this.Rad=this.Rads[this.RadsIndex],this.Rads.length>1&&(this.RadsTime=this.TimeCntr/(this.Rads.length-1),this.RadsTimeCntr=0,this.RadsFlag=!0)),this.ActiveFlag?(this.Angle+=Math.PI/2+Math.PI*Math.random(),this.Angle>=2*Math.PI&&(this.Angle-=2*Math.PI)):(this.Angle=Math.random()*Math.PI,this.X=0,this.Y=0);var h=this.Rad/3+2*Math.random()*this.Rad/3;this.X_dest=h*Math.cos(this.Angle),this.Y_dest=h*Math.sin(this.Angle);var e=Math.sqrt((this.X_dest-this.X)*(this.X_dest-this.X)+(this.Y_dest-this.Y)*(this.Y_dest-this.Y));this.dX=this.X_dest-this.X,this.dY=this.Y_dest-this.Y,this.CoeffTime=e/this.Speed,this.CoeffTimeCntr=0,this.Coeff=this.CoeffTimeCntr/this.CoeffTime,this.ActiveFlag||this.Threads.addThread(this,this.update),this.FinishFlag=!1,this.ActiveFlag=!0},CCameraShake.prototype.kill=function(){this.ActiveFlag&&(this.X=0,this.Y=0,this.Camera._shake.x=this.X,this.Camera._shake.y=this.Y,this.Threads.removeThread(this,this.update),this.ActiveFlag=!1)},CCameraShake.prototype.update=function(){if(this.TimeCntr-=Base.RealTimeInt,this.CoeffTimeCntr+=Base.RealTimeInt,this.Coeff=this.CoeffTimeCntr/this.CoeffTime,this.X=this.X_dest-this.dX*(1-this.Coeff),this.Y=this.Y_dest-this.dY*(1-this.Coeff),this.Camera._shake.x=this.X,this.Camera._shake.y=this.Y,this.RadsFlag&&(this.RadsTimeCntr+=Base.RealTimeInt,this.RadsTimeCntr>=this.RadsTime&&(this.RadsIndex++,this.RadsIndexNext=this.RadsIndex+1,this.RadsIndex>=this.Rads.length&&(this.RadsIndex=0),this.RadsIndexNext>=this.Rads.length&&(this.RadsIndexNext=0),this.RadsTimeCntr=0)),this.Coeff>=1){if(this.TimeCntr<0){if(this.FinishFlag)return void this.kill();this.FinishFlag=!0}this.RadsFlag&&(this.Rad=this.Rads[this.RadsIndex]+this.RadsTimeCntr/this.RadsTime*(this.Rads[this.RadsIndexNext]-this.Rads[this.RadsIndex])),this.Angle+=Math.PI/2+Math.PI*Math.random(),this.Angle>=2*Math.PI&&(this.Angle-=2*Math.PI);var t=this.Rad/2+Math.random()*this.Rad/2;this.X_dest=t*Math.cos(this.Angle),this.Y_dest=t*Math.sin(this.Angle),this.FinishFlag&&(this.X_dest=0,this.Y_dest=0);var i=Math.sqrt((this.X_dest-this.X)*(this.X_dest-this.X)+(this.Y_dest-this.Y)*(this.Y_dest-this.Y));this.dX=this.X_dest-this.X,this.dY=this.Y_dest-this.Y,this.CoeffTime=i/this.Speed,this.CoeffTimeCntr=0}};