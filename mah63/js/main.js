/*
 Platform.js <https://mths.be/platform>
 Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>
 Copyright 2011-2013 John-David Dalton
 Available under MIT license <https://mths.be/mit>
*/
(function(){var b="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},n="undefined"!==typeof module&&module.exports,d=function(){for(var h,c=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),
"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],k=0,m=c.length,a={};k<m;k++)if((h=c[k])&&h[1]in b){for(k=0;k<h.length;k++)a[c[0][k]]=h[k];return a}return!1}(),f={change:d.fullscreenchange,error:d.fullscreenerror},l={request:function(h){return new Promise(function(c,k){var m=function(){this.off("change",
m);c()}.bind(this);this.on("change",m);h=h||b.documentElement;Promise.resolve(h[d.requestFullscreen]())["catch"](k)}.bind(this))},exit:function(){return new Promise(function(h,c){if(this.isFullscreen){var k=function(){this.off("change",k);h()}.bind(this);this.on("change",k);Promise.resolve(b[d.exitFullscreen]())["catch"](c)}else h()}.bind(this))},toggle:function(h){return this.isFullscreen?this.exit():this.request(h)},onchange:function(h){this.on("change",h)},onerror:function(h){this.on("error",h)},
on:function(h,c){var k=f[h];k&&b.addEventListener(k,c,!1)},off:function(h,c){var k=f[h];k&&b.removeEventListener(k,c,!1)},raw:d};d?(Object.defineProperties(l,{isFullscreen:{get:function(){return!!b[d.fullscreenElement]}},element:{enumerable:!0,get:function(){return b[d.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!b[d.fullscreenEnabled]}}}),n?module.exports=l:window.screenfull=l):n?module.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}})();
(function(){function b(r){r=String(r);return r.charAt(0).toUpperCase()+r.slice(1)}function n(r,C){var I=-1,z=r?r.length:0;if("number"==typeof z&&-1<z&&z<=u)for(;++I<z;)C(r[I],I,r);else f(r,C)}function d(r){r=String(r).replace(/^ +| +$/g,"");return/^(?:webOS|i(?:OS|P))/.test(r)?r:b(r)}function f(r,C){for(var I in r)w.call(r,I)&&C(r[I],I,r)}function l(r){return null==r?b(r):q.call(r).slice(8,-1)}function h(r,C){var I=null!=r?typeof r[C]:"number";return!/^(?:boolean|number|string|undefined)$/.test(I)&&
("object"==I?!!r[C]:!0)}function c(r){return String(r).replace(/([ -])(?!$)/g,"$1?")}function k(r,C){var I=null;n(r,function(z,y){I=C(I,z,y,r)});return I}function m(r){function C(M){return k(M,function(J,H){var O=H.pattern||c(H);!J&&(J=RegExp("\\b"+O+" *\\d+[.\\w_]*","i").exec(r)||RegExp("\\b"+O+" *\\w+-[\\w]*","i").exec(r)||RegExp("\\b"+O+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(r))&&((J=String(H.label&&!RegExp(O,"i").test(H.label)?H.label:J).split("/"))[1]&&!/[\d.]+/.test(J[0])&&(J[0]+=
" "+J[1]),H=H.label||H,J=d(J[0].replace(RegExp(O,"i"),H).replace(RegExp("; *(?:"+H+"[_-])?","i")," ").replace(RegExp("("+H+")[-_.]?(\\w)","i"),"$1 $2")));return J})}function I(M){return k(M,function(J,H){return J||(RegExp(H+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(r)||0)[1]||null})}var z=g,y=r&&"object"==typeof r&&"String"!=l(r);y&&(z=r,r=null);var K=z.navigator||{},D=K.userAgent||"";r||(r=D);var L=y?!!K.likeChrome:/\bChrome\b/.test(r)&&!/internal|\n/i.test(q.toString()),
T=y?"Object":"ScriptBridgingProxyObject",E=y?"Object":"Environment",N=y&&z.java?"JavaPackage":l(z.java),U=y?"Object":"RuntimeObject";E=(N=/\bJava/.test(N)&&z.java)&&l(z.environment)==E;var ca=N?"a":"\u03b1",da=N?"b":"\u03b2",Y=z.document||{},R=z.operamini||z.opera,V=t.test(V=y&&R?R["[[Class]]"]:l(R))?V:R=null,v,W=r;y=[];var X=null,S=r==D;D=S&&R&&"function"==typeof R.version&&R.version();var F=function(M){return k(M,function(J,H){return J||RegExp("\\b"+(H.pattern||c(H))+"\\b","i").exec(r)&&(H.label||
H)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),A=function(M){return k(M,function(J,H){return J||RegExp("\\b"+(H.pattern||c(H))+"\\b","i").exec(r)&&(H.label||H)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser",
"PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},
{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),G=C([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad",
"iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),P=function(M){return k(M,function(J,H,O){return J||(H[G]||H[/^[a-z]+(?: +[a-z]+\b)*/i.exec(G)]||RegExp("\\b"+c(O)+"(?:\\b|\\w*\\d)","i").exec(r))&&O})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},
"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),B=function(M){return k(M,function(J,H){var O=H.pattern||c(H);if(!J&&(J=RegExp("\\b"+O+"(?:/[\\d.]+|[ \\w.]*)","i").exec(r))){var Q=J,Z=H.label||H,aa={"10.0":"10","6.4":"10 Technical Preview",
"6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};O&&Z&&/^Win/i.test(Q)&&!/^Windows Phone /i.test(Q)&&(aa=aa[/[\d.]+$/.exec(Q)])&&(Q="Windows "+aa);Q=String(Q);O&&Z&&(Q=Q.replace(RegExp(O,"i"),Z));J=Q=d(Q.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/,
" $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return J})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac",
"Windows 98;","Windows "]);F&&(F=[F]);P&&!G&&(G=C([P]));if(v=/\bGoogle TV\b/.exec(G))G=v[0];/\bSimulator\b/i.test(r)&&(G=(G?G+" ":"")+"Simulator");"Opera Mini"==A&&/\bOPiOS\b/.test(r)&&y.push("running in Turbo/Uncompressed mode");"IE"==A&&/\blike iPhone OS\b/.test(r)?(v=m(r.replace(/like iPhone OS/,"")),P=v.manufacturer,G=v.product):/^iP/.test(G)?(A||(A="Safari"),B="iOS"+((v=/ OS ([\d_]+)/i.exec(r))?" "+v[1].replace(/_/g,"."):"")):"Konqueror"!=A||/buntu/i.test(B)?P&&"Google"!=P&&(/Chrome/.test(A)&&
!/\bMobile Safari\b/i.test(r)||/\bVita\b/.test(G))||/\bAndroid\b/.test(B)&&/^Chrome/.test(A)&&/\bVersion\//i.test(r)?(A="Android Browser",B=/\bAndroid\b/.test(B)?B:"Android"):"Silk"==A?(/\bMobi/i.test(r)||(B="Android",y.unshift("desktop mode")),/Accelerated *= *true/i.test(r)&&y.unshift("accelerated")):"PaleMoon"==A&&(v=/\bFirefox\/([\d.]+)\b/.exec(r))?y.push("identifying as Firefox "+v[1]):"Firefox"==A&&(v=/\b(Mobile|Tablet|TV)\b/i.exec(r))?(B||(B="Firefox OS"),G||(G=v[1])):!A||(v=!/\bMinefield\b/i.test(r)&&
/\b(?:Firefox|Safari)\b/.exec(A))?(A&&!G&&/[\/,]|^[^(]+?\)/.test(r.slice(r.indexOf(v+"/")+8))&&(A=null),(v=G||P||B)&&(G||P||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(B))&&(A=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(B)?B:v)+" Browser")):"Electron"==A&&(v=(/\bChrome\/([\d.]+)\b/.exec(r)||0)[1])&&y.push("Chromium "+v):B="Kubuntu";D||(D=I(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",c(A),"(?:Firefox|Minefield|NetFront)"]));
if(v="iCab"==F&&3<parseFloat(D)&&"WebKit"||/\bOpera\b/.test(A)&&(/\bOPR\b/.test(r)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(r)&&!/^(?:Trident|EdgeHTML)$/.test(F)&&"WebKit"||!F&&/\bMSIE\b/i.test(r)&&("Mac OS"==B?"Tasman":"Trident")||"WebKit"==F&&/\bPlayStation\b(?! Vita\b)/i.test(A)&&"NetFront")F=[v];"IE"==A&&(v=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(r)||0)[1])?(A+=" Mobile",B="Windows Phone "+(/\+$/.test(v)?v:v+".x"),y.unshift("desktop mode")):/\bWPDesktop\b/i.test(r)?(A="IE Mobile",B="Windows Phone 8.x",
y.unshift("desktop mode"),D||(D=(/\brv:([\d.]+)/.exec(r)||0)[1])):"IE"!=A&&"Trident"==F&&(v=/\brv:([\d.]+)/.exec(r))&&(A&&y.push("identifying as "+A+(D?" "+D:"")),A="IE",D=v[1]);if(S){if(h(z,"global"))if(N&&(v=N.lang.System,W=v.getProperty("os.arch"),B=B||v.getProperty("os.name")+" "+v.getProperty("os.version")),E){try{D=z.require("ringo/engine").version.join("."),A="RingoJS"}catch(M){(v=z.system)&&v.global.system==z.system&&(A="Narwhal",B||(B=v[0].os||null))}A||(A="Rhino")}else"object"==typeof z.process&&
!z.process.browser&&(v=z.process)&&("object"==typeof v.versions&&("string"==typeof v.versions.electron?(y.push("Node "+v.versions.node),A="Electron",D=v.versions.electron):"string"==typeof v.versions.nw&&(y.push("Chromium "+D,"Node "+v.versions.node),A="NW.js",D=v.versions.nw)),A||(A="Node.js",W=v.arch,B=v.platform,D=(D=/[\d.]+/.exec(v.version))?D[0]:null));else l(v=z.runtime)==T?(A="Adobe AIR",B=v.flash.system.Capabilities.os):l(v=z.phantom)==U?(A="PhantomJS",D=(v=v.version||null)&&v.major+"."+v.minor+
"."+v.patch):"number"==typeof Y.documentMode&&(v=/\bTrident\/(\d+)/i.exec(r))?(D=[D,Y.documentMode],(v=+v[1]+4)!=D[1]&&(y.push("IE "+D[1]+" mode"),F&&(F[1]=""),D[1]=v),D="IE"==A?String(D[1].toFixed(1)):D[0]):"number"==typeof Y.documentMode&&/^(?:Chrome|Firefox)\b/.test(A)&&(y.push("masking as "+A+" "+D),A="IE",D="11.0",F=["Trident"],B="Windows");B=B&&d(B)}D&&(v=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(D)||/(?:alpha|beta)(?: ?\d)?/i.exec(r+";"+(S&&K.appMinorVersion))||/\bMinefield\b/i.test(r)&&
"a")&&(X=/b/i.test(v)?"beta":"alpha",D=D.replace(RegExp(v+"\\+?$"),"")+("beta"==X?da:ca)+(/\d+\+?/.exec(v)||""));if("Fennec"==A||"Firefox"==A&&/\b(?:Android|Firefox OS)\b/.test(B))A="Firefox Mobile";else if("Maxthon"==A&&D)D=D.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(G))"Xbox 360"==G&&(B=null),"Xbox 360"==G&&/\bIEMobile\b/.test(r)&&y.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(A)&&(!A||G||/Browser|Mobi/.test(A))||"Windows CE"!=B&&!/Mobi/i.test(r))if("IE"==A&&S)try{null===
z.external&&y.unshift("platform preview")}catch(M){y.unshift("embedded")}else(/\bBlackBerry\b/.test(G)||/\bBB10\b/.test(r))&&(v=(RegExp(G.replace(/ +/g," *")+"/([.\\d]+)","i").exec(r)||0)[1]||D)?(v=[v,/BB10/.test(r)],B=(v[1]?(G=null,P="BlackBerry"):"Device Software")+" "+v[0],D=null):this!=f&&"Wii"!=G&&(S&&R||/Opera/.test(A)&&/\b(?:MSIE|Firefox)\b/i.test(r)||"Firefox"==A&&/\bOS X (?:\d+\.){2,}/.test(B)||"IE"==A&&(B&&!/^Win/.test(B)&&5.5<D||/\bWindows XP\b/.test(B)&&8<D||8==D&&!/\bTrident\b/.test(r)))&&
!t.test(v=m.call(f,r.replace(t,"")+";"))&&v.name&&(v="ing as "+v.name+((v=v.version)?" "+v:""),t.test(A)?(/\bIE\b/.test(v)&&"Mac OS"==B&&(B=null),v="identify"+v):(v="mask"+v,A=V?d(V.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(v)&&(B=null),S||(D=null)),F=["Presto"],y.push(v));else A+=" Mobile";if(v=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(r)||0)[1]){v=[parseFloat(v.replace(/\.(\d)$/,".0$1")),v];if("Safari"==A&&"+"==v[1].slice(-1))A="WebKit Nightly",X="alpha",D=v[1].slice(0,-1);else if(D==
v[1]||D==(v[2]=(/\bSafari\/([\d.]+\+?)/i.exec(r)||0)[1]))D=null;v[1]=(/\bChrome\/([\d.]+)/i.exec(r)||0)[1];537.36==v[0]&&537.36==v[2]&&28<=parseFloat(v[1])&&"WebKit"==F&&(F=["Blink"]);S&&(L||v[1])?(F&&(F[1]="like Chrome"),v=v[1]||(v=v[0],530>v?1:532>v?2:532.05>v?3:533>v?4:534.03>v?5:534.07>v?6:534.1>v?7:534.13>v?8:534.16>v?9:534.24>v?10:534.3>v?11:535.01>v?12:535.02>v?"13+":535.07>v?15:535.11>v?16:535.19>v?17:536.05>v?18:536.1>v?19:537.01>v?20:537.11>v?"21+":537.13>v?23:537.18>v?24:537.24>v?25:537.36>
v?26:"Blink"!=F?"27":"28")):(F&&(F[1]="like Safari"),v=(v=v[0],400>v?1:500>v?2:526>v?3:533>v?4:534>v?"4+":535>v?5:537>v?6:538>v?7:601>v?8:"8"));F&&(F[1]+=" "+(v+="number"==typeof v?".x":/[.+]/.test(v)?"":"+"));"Safari"==A&&(!D||45<parseInt(D))&&(D=v)}"Opera"==A&&(v=/\bzbov|zvav$/.exec(B))?(A+=" ",y.unshift("desktop mode"),"zvav"==v?(A+="Mini",D=null):A+="Mobile",B=B.replace(RegExp(" *"+v+"$"),"")):"Safari"==A&&/\bChrome\b/.exec(F&&F[1])&&(y.unshift("desktop mode"),A="Chrome Mobile",D=null,/\bOS X\b/.test(B)?
(P="Apple",B="iOS 4.3+"):B=null);D&&0==D.indexOf(v=/[\d.]+$/.exec(B))&&-1<r.indexOf("/"+v+"-")&&(B=String(B.replace(v,"")).replace(/^ +| +$/g,""));F&&!/\b(?:Avant|Nook)\b/.test(A)&&(/Browser|Lunascape|Maxthon/.test(A)||"Safari"!=A&&/^iOS/.test(B)&&/\bSafari\b/.test(F[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(A)&&F[1])&&(v=F[F.length-1])&&y.push(v);y.length&&(y=["("+y.join("; ")+")"]);P&&G&&0>G.indexOf(P)&&y.push("on "+P);G&&y.push((/^on /.test(y[y.length-
1])?"":"on ")+G);if(B){var ba=(v=/ ([\d.+]+)$/.exec(B))&&"/"==B.charAt(B.length-v[0].length-1);B={architecture:32,family:v&&!ba?B.replace(v[0],""):B,version:v?v[1]:null,toString:function(){var M=this.version;return this.family+(M&&!ba?" "+M:"")+(64==this.architecture?" 64-bit":"")}}}(v=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(W))&&!/\bi686\b/i.test(W)?(B&&(B.architecture=64,B.family=B.family.replace(RegExp(" *"+v),"")),A&&(/\bWOW64\b/i.test(r)||S&&/\w(?:86|32)$/.test(K.cpuClass||K.platform)&&!/\bWin64; x64\b/i.test(r))&&
y.unshift("32-bit")):B&&/^OS X/.test(B.family)&&"Chrome"==A&&39<=parseFloat(D)&&(B.architecture=64);r||(r=null);z={};z.description=r;z.layout=F&&F[0];z.manufacturer=P;z.name=A;z.prerelease=X;z.product=G;z.ua=r;z.version=A&&D;z.os=B||{architecture:null,family:null,version:null,toString:function(){return"null"}};z.parse=m;z.toString=function(){return this.description||""};z.version&&y.unshift(D);z.name&&y.unshift(A);B&&A&&(B!=String(B).split(" ")[0]||B!=A.split(" ")[0]&&!G)&&y.push(G?"("+B+")":"on "+
B);y.length&&(z.description=y.join(" "));return z}var a={"function":!0,object:!0},g=a[typeof window]&&window||this,e=a[typeof exports]&&exports;a=a[typeof module]&&module&&!module.nodeType&&module;var p=e&&a&&"object"==typeof global&&global;!p||p.global!==p&&p.window!==p&&p.self!==p||(g=p);var u=Math.pow(2,53)-1,t=/\bOpera/;p=Object.prototype;var w=p.hasOwnProperty,q=p.toString,x=m();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(g.platform=x,define(function(){return x})):e&&
a?f(x,function(r,C){e[C]=r}):g.platform=x}).call(this);
function buildIOSMeta(){for(var b=[{name:"viewport",content:"width=device-width, height=device-height, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"},{name:"apple-mobile-web-app-capable",content:"yes"},{name:"apple-mobile-web-app-status-bar-style",content:"black"}],n=0;n<b.length;n++){var d=document.createElement("meta");d.name=b[n].name;d.content=b[n].content;var f=window.document.head.querySelector('meta[name="'+d.name+'"]');f&&f.parentNode.removeChild(f);window.document.head.appendChild(d)}}
function hideIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","none");jQuery(".xxx-ios-fullscreen-scroll").css("display","none");jQuery(".xxx-game-iframe-full").removeClass("xxx-game-iframe-iphone-se")}function buildIOSFullscreenPanel(){jQuery("body").append('<div class="xxx-ios-fullscreen-message"><div class="xxx-ios-fullscreen-swipe"></div></div><div class="xxx-ios-fullscreen-scroll"></div>')}
function showIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","block");jQuery(".xxx-ios-fullscreen-scroll").css("display","block")}
function __iosResize(){window.scrollTo(0,0);if("iPhone"===platform.product)switch(window.devicePixelRatio){case 2:switch(window.innerWidth){case 568:320!==window.innerHeight&&jQuery(".xxx-game-iframe-full").addClass("xxx-game-iframe-iphone-se");break;case 667:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;default:hideIOSFullscreenPanel()}break;case 3:switch(window.innerWidth){case 736:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;
case 724:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;default:hideIOSFullscreenPanel()}break;default:hideIOSFullscreenPanel()}}function iosResize(){__iosResize();setTimeout(function(){__iosResize()},500)}$(document).ready(function(){platform&&"iPhone"===platform.product&&(buildIOSFullscreenPanel(),buildIOSMeta())});jQuery(window).resize(function(){platform&&"iPhone"===platform.product&&iosResize()});var s_iScaleFactor=1,s_iOffsetX,s_iOffsetY,s_bIsIphone=!1;
(function(b){(jQuery.browser=jQuery.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(b.substr(0,
4))})(navigator.userAgent||navigator.vendor||window.opera);$(window).resize(function(){sizeHandler()});function trace(b){console.log(b)}
function getSize(b){var n=b.toLowerCase(),d=window.document,f=d.documentElement;if(void 0===window["inner"+b])b=f["client"+b];else if(window["inner"+b]!=f["client"+b]){var l=d.createElement("body");l.id="vpw-test-b";l.style.cssText="overflow:scroll";var h=d.createElement("div");h.id="vpw-test-d";h.style.cssText="position:absolute;top:-1000px";h.innerHTML="<style>@media("+n+":"+f["client"+b]+"px){body#vpw-test-b div#vpw-test-d{"+n+":7px!important}}</style>";l.appendChild(h);f.insertBefore(l,d.head);
b=7==h["offset"+b]?f["client"+b]:window["inner"+b];f.removeChild(l)}else b=window["inner"+b];return b}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler();window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function isChrome(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}function isMobile(){return isIpad()?!0:jQuery.browser.mobile}
function isIpad(){var b=-1!==navigator.userAgent.toLowerCase().indexOf("ipad");return!b&&navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints?!0:b}function isIOS(){var b="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");if(-1!==navigator.userAgent.toLowerCase().indexOf("iphone"))return s_bIsIphone=!0;for(;b.length;)if(navigator.platform===b.pop())return s_bIsIphone=!0;return s_bIsIphone=!1}
function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}function getHeightOfIOSToolbars(){var b=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<b?b:0}
function sizeHandler(){window.scrollTo(0,1);if($("#canvas")){var b="safari"===platform.name.toLowerCase()?getIOSWindowHeight():getSize("Height");var n=getSize("Width");_checkOrientation(n,b);var d=Math.min(b/CANVAS_HEIGHT,n/CANVAS_WIDTH),f=Math.round(CANVAS_WIDTH*d);d=Math.round(CANVAS_HEIGHT*d);if(d<b){var l=b-d;d+=l;f+=CANVAS_WIDTH/CANVAS_HEIGHT*l}else f<n&&(l=n-f,f+=l,d+=CANVAS_HEIGHT/CANVAS_WIDTH*l);l=b/2-d/2;var h=n/2-f/2,c=CANVAS_WIDTH/f;if(h*c<-EDGEBOARD_X||l*c<-EDGEBOARD_Y)d=Math.min(b/(CANVAS_HEIGHT-
2*EDGEBOARD_Y),n/(CANVAS_WIDTH-2*EDGEBOARD_X)),f=Math.round(CANVAS_WIDTH*d),d=Math.round(CANVAS_HEIGHT*d),l=(b-d)/2,h=(n-f)/2,c=CANVAS_WIDTH/f;s_iOffsetX=-1*h*c;s_iOffsetY=-1*l*c;0<=l&&(s_iOffsetY=0);0<=h&&(s_iOffsetX=0);null!==s_oInterface&&s_oInterface.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oMenu&&s_oMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY);s_bIsIphone?(canvas=document.getElementById("canvas"),s_oStage.canvas.width=2*f,s_oStage.canvas.height=2*d,canvas.style.width=f+"px",canvas.style.height=
d+"px",s_iScaleFactor=2*Math.min(f/CANVAS_WIDTH,d/CANVAS_HEIGHT),s_oStage.scaleX=s_oStage.scaleY=s_iScaleFactor):s_bMobile||isChrome()?($("#canvas").css("width",f+"px"),$("#canvas").css("height",d+"px")):(s_oStage.canvas.width=f,s_oStage.canvas.height=d,s_iScaleFactor=Math.min(f/CANVAS_WIDTH,d/CANVAS_HEIGHT),s_oStage.scaleX=s_oStage.scaleY=s_iScaleFactor);0>l||(l=(b-d)/2);$("#canvas").css("top",l+"px");$("#canvas").css("left",h+"px");if(DEBUG_BOX2D){if(s_bMobile||isChrome())$("#debug").css("width",
f+"px"),$("#debug").css("height",d+"px");0>l?$("#debug").css("top",l+"px"):(l=(b-d)/2,$("#canvas").css("top",l+"px"));$("#debug").css("left",h+"px")}fullscreenHandler()}}
function _checkOrientation(b,n){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(b>n?"landscape"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),s_oMain.stopUpdate()):"portrait"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),
s_oMain.stopUpdate()))}function playSound(b,n,d){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[b].play(),s_aSounds[b].volume(n),s_aSounds[b].loop(d),s_aSounds[b]):null}function stopSound(b){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[b].stop()}function setVolume(b,n){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[b].volume(n)}function setMute(b,n){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[b].mute(n)}
function fadeSound(b,n,d,f){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[b].fade(n,d,f)}function soundPlaying(b){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)return s_aSounds[b].playing()}function createBitmap(b,n,d){var f=new createjs.Bitmap(b),l=new createjs.Shape;n&&d?l.graphics.beginFill("#fff").drawRect(0,0,n,d):l.graphics.beginFill("#ff0").drawRect(0,0,b.width,b.height);f.hitArea=l;return f}
function createSprite(b,n,d,f,l,h){b=null!==n?new createjs.Sprite(b,n):new createjs.Sprite(b);n=new createjs.Shape;n.graphics.beginFill("#000000").drawRect(-d,-f,l,h);b.hitArea=n;return b}function pad(b,n,d){b+="";return b.length>=n?b:Array(n-b.length+1).join(d||"0")+b}function linearFunction(b,n,d,f,l){return(b-n)*(l-f)/(d-n)+f}function randomFloatBetween(b,n,d){"undefined"===typeof d&&(d=2);return parseFloat(Math.min(b+Math.random()*(n-b),n).toFixed(d))}
function rotateVector2D(b,n){var d=n.getX()*Math.cos(b)+n.getY()*Math.sin(b),f=n.getX()*-Math.sin(b)+n.getY()*Math.cos(b);n.set(d,f)}function tweenVectorsOnX(b,n,d){return b+d*(n-b)}function shuffle(b){for(var n=b.length,d,f;0!==n;)f=Math.floor(Math.random()*n),--n,d=b[n],b[n]=b[f],b[f]=d;return b}function bubbleSort(b){do{var n=!1;for(var d=0;d<b.length-1;d++)b[d]>b[d+1]&&(n=b[d],b[d]=b[d+1],b[d+1]=n,n=!0)}while(n)}function compare(b,n){return b.index>n.index?-1:b.index<n.index?1:0}
function easeLinear(b,n,d,f){return d*b/f+n}function easeInQuad(b,n,d,f){return d*(b/=f)*b+n}function easeInSine(b,n,d,f){return-d*Math.cos(b/f*(Math.PI/2))+d+n}function easeInCubic(b,n,d,f){return d*(b/=f)*b*b+n}function getTrajectoryPoint(b,n){var d=new createjs.Point,f=(1-b)*(1-b),l=b*b;d.x=f*n.start.x+2*(1-b)*b*n.traj.x+l*n.end.x;d.y=f*n.start.y+2*(1-b)*b*n.traj.y+l*n.end.y;return d}
function formatTime(b){b/=1E3;var n=Math.floor(b/60);b=parseFloat(b-60*n).toFixed(1);var d="";d=10>n?d+("0"+n+":"):d+(n+":");return 10>b?d+("0"+b):d+b}function degreesToRadians(b){return b*Math.PI/180}function checkRectCollision(b,n){var d=getBounds(b,.9);var f=getBounds(n,.98);return calculateIntersection(d,f)}
function calculateIntersection(b,n){var d,f,l,h;var c=b.x+(d=b.width/2);var k=b.y+(f=b.height/2);var m=n.x+(l=n.width/2);var a=n.y+(h=n.height/2);c=Math.abs(c-m)-(d+l);k=Math.abs(k-a)-(f+h);return 0>c&&0>k?(c=Math.min(Math.min(b.width,n.width),-c),k=Math.min(Math.min(b.height,n.height),-k),{x:Math.max(b.x,n.x),y:Math.max(b.y,n.y),width:c,height:k,rect1:b,rect2:n}):null}
function getBounds(b,n){var d={x:Infinity,y:Infinity,width:0,height:0};if(b instanceof createjs.Container){d.x2=-Infinity;d.y2=-Infinity;var f=b.children,l=f.length,h;for(h=0;h<l;h++){var c=getBounds(f[h],1);c.x<d.x&&(d.x=c.x);c.y<d.y&&(d.y=c.y);c.x+c.width>d.x2&&(d.x2=c.x+c.width);c.y+c.height>d.y2&&(d.y2=c.y+c.height)}Infinity==d.x&&(d.x=0);Infinity==d.y&&(d.y=0);Infinity==d.x2&&(d.x2=0);Infinity==d.y2&&(d.y2=0);d.width=d.x2-d.x;d.height=d.y2-d.y;delete d.x2;delete d.y2}else{if(b instanceof createjs.Bitmap){l=
b.sourceRect||b.image;h=l.width*n;var k=l.height*n}else if(b instanceof createjs.Sprite)if(b.spriteSheet._frames&&b.spriteSheet._frames[b.currentFrame]&&b.spriteSheet._frames[b.currentFrame].image){l=b.spriteSheet.getFrame(b.currentFrame);h=l.rect.width;k=l.rect.height;f=l.regX;var m=l.regY}else d.x=b.x||0,d.y=b.y||0;else d.x=b.x||0,d.y=b.y||0;f=f||0;h=h||0;m=m||0;k=k||0;d.regX=f;d.regY=m;l=b.localToGlobal(0-f,0-m);c=b.localToGlobal(h-f,k-m);h=b.localToGlobal(h-f,0-m);f=b.localToGlobal(0-f,k-m);d.x=
Math.min(Math.min(Math.min(l.x,c.x),h.x),f.x);d.y=Math.min(Math.min(Math.min(l.y,c.y),h.y),f.y);d.width=Math.max(Math.max(Math.max(l.x,c.x),h.x),f.x)-d.x;d.height=Math.max(Math.max(Math.max(l.y,c.y),h.y),f.y)-d.y}return d}function NoClickDelay(b){this.element=b;window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(b){for(var n=b.length,d,f;0<n;)f=Math.floor(Math.random()*n),n--,d=b[n],b[n]=b[f],b[f]=d;return b}
NoClickDelay.prototype={handleEvent:function(b){switch(b.type){case "touchstart":this.onTouchStart(b);break;case "touchmove":this.onTouchMove(b);break;case "touchend":this.onTouchEnd(b)}},onTouchStart:function(b){b.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(b){this.moved=!0},onTouchEnd:function(b){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){b=document.elementFromPoint(b.changedTouches[0].clientX,b.changedTouches[0].clientY);3==b.nodeType&&(b=b.parentNode);var n=document.createEvent("MouseEvents");n.initEvent("click",!0,!0);b.dispatchEvent(n)}}};
(function(){function b(d){var f={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};d=d||window.event;d.type in f?document.body.className=f[d.type]:(document.body.className=this[n]?"hidden":"visible","hidden"===document.body.className?s_oMain.stopUpdate():s_oMain.startUpdate())}var n="hidden";n in document?document.addEventListener("visibilitychange",b):(n="mozHidden")in document?document.addEventListener("mozvisibilitychange",b):(n="webkitHidden")in
document?document.addEventListener("webkitvisibilitychange",b):(n="msHidden")in document?document.addEventListener("msvisibilitychange",b):"onfocusin"in document?document.onfocusin=document.onfocusout=b:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=b})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}
function getParamValue(b){for(var n=window.location.search.substring(1).split("&"),d=0;d<n.length;d++){var f=n[d].split("=");if(f[0]==b)return f[1]}}String.prototype.format=function(){for(var b=this,n=arguments.length;n--;)b=b.replace(new RegExp("\\{"+n+"\\}","gm"),arguments[n]);return b};function fullscreenHandler(){ENABLE_FULLSCREEN&&screenfull.isEnabled&&(s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut())}
if(screenfull.isEnabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut()});var s_szGameID="58a6922f7ccd465d89f2c00c4cf01b9a";window.GD_OPTIONS={gameId:s_szGameID,onEvent:function(b){switch(b.name){case "SDK_GAME_START":s_oMain&&s_oMain.startUpdate();break;case "SDK_GAME_PAUSE":s_oMain&&s_oMain.stopUpdate()}}};
(function(b,n,d){var f=b.getElementsByTagName(n)[0];b.getElementById(d)||(b=b.createElement(n),b.id=d,b.src="main.min.js",f.parentNode.insertBefore(b,f))})(document,"script","gamedistribution-jssdk");
function CSpriteLibrary(){var b={},n,d,f,l,h,c;this.init=function(k,m,a){n={};f=d=0;l=k;h=m;c=a};this.addSprite=function(k,m){if(!b.hasOwnProperty(k)){var a=new Image;b[k]=n[k]={szPath:m,oSprite:a,bLoaded:!1};d++}};this.getSprite=function(k){return b.hasOwnProperty(k)?b[k].oSprite:null};this._onSpritesLoaded=function(){d=0;h.call(c)};this._onSpriteLoaded=function(){l.call(c);++f===d&&this._onSpritesLoaded()};this.loadSprites=function(){for(var k in n)n[k].oSprite.oSpriteLibrary=this,n[k].oSprite.szKey=
k,n[k].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey);this.oSpriteLibrary._onSpriteLoaded(this.szKey)},n[k].oSprite.onerror=function(m){var a=m.currentTarget;setTimeout(function(){n[a.szKey].oSprite.src=n[a.szKey].szPath},500)},n[k].oSprite.src=n[k].szPath};this.setLoaded=function(k){b[k].bLoaded=!0};this.isLoaded=function(k){return b[k].bLoaded};this.getNumSprites=function(){return d}}
var CANVAS_WIDTH=768,CANVAS_HEIGHT=1280,CANVAS_WIDTH_HALF=CANVAS_WIDTH/2,CANVAS_HEIGHT_HALF=CANVAS_HEIGHT/2,EDGEBOARD_X=100,EDGEBOARD_Y=140,GAME_NAME="pinball",PRIMARY_FONT="walibi0615bold",SECONDARY_FONT="Digital",PRIMARY_FONT_COLOUR="#fff600",SOUNDTRACK_VOLUME_IN_GAME=1,FPS=60,FPS_TIME=1E3/FPS,DISABLE_SOUND_MOBILE=!1,STATE_LOADING=0,STATE_MENU=1,STATE_HELP=1,STATE_GAME=3,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,ON_INCREASE_JACKPOT=6,ON_INCREASE_SCORE=
7,CONTACT_BEGIN=0,CONTACT_END=1,CONTACT_PRESOLVE=2,CONTACT_POSTSOLVE=3,SETTINGS_HEIGHT=240,TODEGREE_PROPORTION=180/Math.PI,ZOOM_TABLE_SIZE={w:1,h:1},BALL_OUT_SAFE_LIMIT=40,DEBUG_BOX2D=!1,DEBUG_BOX2D_ALPHA=.2,WORLD_SCALE=100,GRAVITY=13.6,GENERAL_RESTITUTION=.33,GENERAL_FRICTION=.7,ZOOM=1,ZOOM_PER_WORLDSCALE=ZOOM*WORLD_SCALE,BALL_STARTPOS={x:1092,y:1770},BALL_RADIUS=28,LERP_SLOW={x:.01,y:.01},LERP_FOLLOW_BALL={x:.05,y:.15},NUM_BALL=3,SHIELD_ACTIVATION_THRESHOLD=3,EXTRABALL_JACKPOT_SCORE_ACTIVATION=
5E5,FLIPPER_STRENGTH=18,SPRING_MAX_STRENGTH=1,iY=1300,LETTERS_POSITION=[{x:300,y:iY},{x:360,y:iY},{x:440,y:iY},{x:530,y:iY},{x:630,y:iY},{x:720,y:iY},{x:810,y:iY}],MAX_MULTIPLIER=7,TIME_ROUTER_SCORE_DECREASE=2E4,SCORE_RATIO_TO_ADD_AT_JACKPOT=2,TIME_LAST_ACTIVE_JACKPOT=9E4,ENABLE_FULLSCREEN,ENABLE_CHECK_ORIENTATION;
function CPreloader(){var b,n,d,f,l,h,c,k,m,a;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.jpg");s_oSpriteLibrary.addSprite("but_start","./sprites/but_start.png");s_oSpriteLibrary.loadSprites();a=new createjs.Container;s_oStage.addChild(a)};this.unload=function(){a.removeAllChildren();m.unload()};this._onImagesLoaded=function(){};
this._onAllImagesLoaded=function(){this.attachSprites();s_oMain.preloaderReady()};this.attachSprites=function(){var g=new createjs.Shape;g.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);a.addChild(g);g=s_oSpriteLibrary.getSprite("200x200");c=createBitmap(g);c.regX=.5*g.width;c.regY=.5*g.height;c.x=CANVAS_WIDTH/2;c.y=CANVAS_HEIGHT/2-180;a.addChild(c);k=new createjs.Shape;k.graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(c.x-100,c.y-100,200,200,10);a.addChild(k);c.mask=k;
g=s_oSpriteLibrary.getSprite("progress_bar");f=createBitmap(g);f.x=CANVAS_WIDTH/2-g.width/2;f.y=CANVAS_HEIGHT/2+50;a.addChild(f);b=g.width;n=g.height;l=new createjs.Shape;l.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(f.x,f.y,1,n);a.addChild(l);f.mask=l;d=new createjs.Text("","30px "+PRIMARY_FONT,PRIMARY_FONT_COLOUR);d.x=CANVAS_WIDTH/2;d.y=CANVAS_HEIGHT/2+100;d.textBaseline="alphabetic";d.textAlign="center";a.addChild(d);g=s_oSpriteLibrary.getSprite("but_start");m=new CTextButton(CANVAS_WIDTH/
2,CANVAS_HEIGHT/2,g,TEXT_PRELOADER_CONTINUE,"Arial","#000","bold 50",a);m.addEventListener(ON_MOUSE_UP,this._onButStartRelease,this);m.setVisible(!1);h=new createjs.Shape;h.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);a.addChild(h);createjs.Tween.get(h).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(h);a.removeChild(h)})};this._onButStartRelease=function(){s_oMain._onRemovePreloader()};this.refreshLoader=function(g){d.text=g+"%";100===g&&(s_oMain._onRemovePreloader(),
d.visible=!1,f.visible=!1);l.graphics.clear();g=Math.floor(g*b/100);l.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(f.x,f.y,g,n)};this._init()}
function CMain(b){var n,d=0,f=0,l=STATE_LOADING,h,c;this.initContainer=function(){s_oCanvas=document.getElementById("canvas");s_oStage=new createjs.Stage(s_oCanvas);s_oStage.preventSelection=!1;createjs.Touch.enable(s_oStage);s_bMobile=isMobile();!1===s_bMobile&&(s_oStage.enableMouseOver(FPS),$("body").on("contextmenu","#canvas",function(m){return!1}));s_iPrevTime=(new Date).getTime();createjs.Ticker.addEventListener("tick",this._update);createjs.Ticker.framerate=FPS;navigator.userAgent.match(/Windows Phone/i)&&
(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=new CSpriteLibrary;h=new CPreloader;s_oLocalStorage=new CLocalStorage(GAME_NAME)};this.preloaderReady=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds();this._loadImages();n=!0};this.soundLoaded=function(){d++;h.refreshLoader(Math.floor(d/f*100))};this._initSounds=function(){Howler.mute(!s_bAudioActive);s_aSoundsInfo=[];s_aSoundsInfo.push({path:"./sounds/",filename:"soundtrack",loop:!0,volume:1,ingamename:"soundtrack"});s_aSoundsInfo.push({path:"./sounds/",
filename:"press_button",loop:!1,volume:1,ingamename:"click"});s_aSoundsInfo.push({path:"./sounds/",filename:"game_over",loop:!1,volume:1,ingamename:"game_over"});s_aSoundsInfo.push({path:"./sounds/",filename:"start_game",loop:!1,volume:1,ingamename:"start_game"});s_aSoundsInfo.push({path:"./sounds/",filename:"launch",loop:!1,volume:1,ingamename:"launch"});s_aSoundsInfo.push({path:"./sounds/",filename:"toggle",loop:!1,volume:1,ingamename:"toggle"});s_aSoundsInfo.push({path:"./sounds/",filename:"gate",
loop:!1,volume:1,ingamename:"gate"});s_aSoundsInfo.push({path:"./sounds/",filename:"bumper",loop:!1,volume:1,ingamename:"bumper"});s_aSoundsInfo.push({path:"./sounds/",filename:"jumper",loop:!1,volume:1,ingamename:"jumper"});s_aSoundsInfo.push({path:"./sounds/",filename:"pinball_button_on",loop:!1,volume:1,ingamename:"pinball_button_on"});s_aSoundsInfo.push({path:"./sounds/",filename:"pinball_button_off",loop:!1,volume:1,ingamename:"pinball_button_off"});s_aSoundsInfo.push({path:"./sounds/",filename:"in_hole",
loop:!1,volume:1,ingamename:"in_hole"});s_aSoundsInfo.push({path:"./sounds/",filename:"out_hole",loop:!1,volume:1,ingamename:"out_hole"});s_aSoundsInfo.push({path:"./sounds/",filename:"flipper",loop:!1,volume:1,ingamename:"flipper"});s_aSoundsInfo.push({path:"./sounds/",filename:"all_letters_complete",loop:!1,volume:1,ingamename:"all_letters_complete"});s_aSoundsInfo.push({path:"./sounds/",filename:"all_lights_on_1",loop:!1,volume:1,ingamename:"all_lights_on_1"});s_aSoundsInfo.push({path:"./sounds/",
filename:"all_lights_on_2",loop:!1,volume:1,ingamename:"all_lights_on_2"});s_aSoundsInfo.push({path:"./sounds/",filename:"letter",loop:!1,volume:1,ingamename:"letter"});s_aSoundsInfo.push({path:"./sounds/",filename:"bonus_win_1",loop:!1,volume:1,ingamename:"bonus_win_1"});s_aSoundsInfo.push({path:"./sounds/",filename:"bonus_win_2",loop:!1,volume:1,ingamename:"bonus_win_2"});s_aSoundsInfo.push({path:"./sounds/",filename:"ball_out",loop:!1,volume:1,ingamename:"ball_out"});f+=s_aSoundsInfo.length;s_aSounds=
[];for(var m=0;m<s_aSoundsInfo.length;m++)this.tryToLoadSound(s_aSoundsInfo[m],!1)};this.tryToLoadSound=function(m,a){setTimeout(function(){s_aSounds[m.ingamename]=new Howl({src:[m.path+m.filename+".mp3"],autoplay:!1,preload:!0,loop:m.loop,volume:m.volume,onload:s_oMain.soundLoaded,onloaderror:function(g,e){for(var p=0;p<s_aSoundsInfo.length;p++)if(g===s_aSounds[s_aSoundsInfo[p].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[p],!0);break}},onplayerror:function(g){for(var e=0;e<s_aSoundsInfo.length;e++)if(g===
s_aSounds[s_aSoundsInfo[e].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[e].ingamename].once("unlock",function(){s_aSounds[s_aSoundsInfo[e].ingamename].play();"soundtrack"===s_aSoundsInfo[e].ingamename&&null!==s_oGame&&setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME)});break}}})},a?200:0)};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png");s_oSpriteLibrary.addSprite("msg_box","./sprites/msg_box.png");
s_oSpriteLibrary.addSprite("credits_panel","./sprites/credits_panel.png");s_oSpriteLibrary.addSprite("ctl_logo","./sprites/ctl_logo.png");s_oSpriteLibrary.addSprite("but_credits","./sprites/but_credits.png");s_oSpriteLibrary.addSprite("but_yes","./sprites/but_yes.png");s_oSpriteLibrary.addSprite("but_no","./sprites/but_no.png");s_oSpriteLibrary.addSprite("score_panel","./sprites/score_panel.png");s_oSpriteLibrary.addSprite("keys","./sprites/keys.png");s_oSpriteLibrary.addSprite("but_restart","./sprites/but_restart.png");
s_oSpriteLibrary.addSprite("but_home","./sprites/but_home.png");s_oSpriteLibrary.addSprite("hand_anim","./sprites/hand_anim.png");s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg");s_oSpriteLibrary.addSprite("but_settings","./sprites/but_settings.png");s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png");s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png");s_oSpriteLibrary.addSprite("but_fullscreen","./sprites/but_fullscreen.png");s_oSpriteLibrary.addSprite("bestscore",
"./sprites/bestscore.png");s_oSpriteLibrary.addSprite("extra_ball","./sprites/extra_ball.png");s_oSpriteLibrary.addSprite("star","./sprites/star.png");s_oSpriteLibrary.addSprite("pinball_bg","./sprites/pinball_elements/pinball_bg.jpg");s_oSpriteLibrary.addSprite("multiplier_light","./sprites/pinball_elements/multiplier_light.png");s_oSpriteLibrary.addSprite("multiplier_toggle_light","./sprites/pinball_elements/multiplier_toggle_light.png");s_oSpriteLibrary.addSprite("bumper","./sprites/pinball_elements/bumper.png");
s_oSpriteLibrary.addSprite("bumper_button","./sprites/pinball_elements/bumper_button.png");s_oSpriteLibrary.addSprite("capsule_0","./sprites/pinball_elements/capsule_0.png");s_oSpriteLibrary.addSprite("capsule_1","./sprites/pinball_elements/capsule_1.png");s_oSpriteLibrary.addSprite("capsule_2","./sprites/pinball_elements/capsule_2.png");s_oSpriteLibrary.addSprite("capsule_3","./sprites/pinball_elements/capsule_3.png");for(var m=0;6>m;m++)s_oSpriteLibrary.addSprite("button_light_"+m,"./sprites/pinball_elements/button_light_"+
m+".png");s_oSpriteLibrary.addSprite("curve_light_button","./sprites/pinball_elements/curve_light_button.png");s_oSpriteLibrary.addSprite("light_indicator_0","./sprites/pinball_elements/light_indicator_0.png");s_oSpriteLibrary.addSprite("light_indicator_1","./sprites/pinball_elements/light_indicator_1.png");s_oSpriteLibrary.addSprite("light_indicator_2","./sprites/pinball_elements/light_indicator_2.png");for(m=0;7>m;m++)s_oSpriteLibrary.addSprite("router_light_"+m,"./sprites/pinball_elements/router_light_"+
m+".png");s_oSpriteLibrary.addSprite("curve_tunnel","./sprites/pinball_elements/curve_tunnel.png");s_oSpriteLibrary.addSprite("eye","./sprites/pinball_elements/eye.png");s_oSpriteLibrary.addSprite("arrow_light_0","./sprites/pinball_elements/arrow_light_0.png");s_oSpriteLibrary.addSprite("arrow_light_1","./sprites/pinball_elements/arrow_light_1.png");for(m=0;7>m;m++)s_oSpriteLibrary.addSprite("letter_"+m,"./sprites/pinball_elements/letter_"+m+".png");s_oSpriteLibrary.addSprite("logo","./sprites/pinball_elements/logo.png");
s_oSpriteLibrary.addSprite("jackpot","./sprites/pinball_elements/jackpot.png");s_oSpriteLibrary.addSprite("tunnel_start","./sprites/pinball_elements/tunnel_start.png");s_oSpriteLibrary.addSprite("arrow_start","./sprites/pinball_elements/arrow_start.png");s_oSpriteLibrary.addSprite("start_platform","./sprites/pinball_elements/start_platform.png");s_oSpriteLibrary.addSprite("spring","./sprites/pinball_elements/spring.png");s_oSpriteLibrary.addSprite("flipper_bumper","./sprites/pinball_elements/flipper_bumper.png");
s_oSpriteLibrary.addSprite("hole","./sprites/pinball_elements/hole.png");s_oSpriteLibrary.addSprite("shield","./sprites/pinball_elements/shield.png");s_oSpriteLibrary.addSprite("jumper","./sprites/pinball_elements/jumper.png");s_oSpriteLibrary.addSprite("safe_pin","./sprites/pinball_elements/safe_pin.png");s_oSpriteLibrary.addSprite("gate","./sprites/pinball_elements/gate.png");s_oSpriteLibrary.addSprite("ball","./sprites/pinball_elements/ball.png");s_oSpriteLibrary.addSprite("flipper","./sprites/pinball_elements/flipper.png");
f+=s_oSpriteLibrary.getNumSprites();s_oSpriteLibrary.loadSprites()};this._onImagesLoaded=function(){d++;h.refreshLoader(Math.floor(d/f*100))};this._onAllImagesLoaded=function(){};this._onRemovePreloader=function(){try{checkMoreGames(s_szGameID,"bottom-left",["arcade","multiplayer"],[],-1,"violet")}catch(m){}h.unload();s_oSoundtrack=playSound("soundtrack",1,!0);this.gotoMenu()};this.gotoMenu=function(){try{showMoreGames()}catch(m){}new CMenu;l=STATE_MENU};this.gotoGame=function(){c=new CGame(k);l=
STATE_GAME};this.gotoHelp=function(){new CHelp;l=STATE_HELP};this.stopUpdate=function(){n=!1;createjs.Ticker.paused=!0;$("#block_game").css("display","block");Howler.mute(!0)};this.startUpdate=function(){s_iPrevTime=(new Date).getTime();n=!0;createjs.Ticker.paused=!1;$("#block_game").css("display","none");s_bAudioActive&&Howler.mute(!1)};this._update=function(m){if(!1!==n){var a=(new Date).getTime();s_iTimeElaps=a-s_iPrevTime;s_iCntTime+=s_iTimeElaps;s_iCntFps++;s_iPrevTime=a;1E3<=s_iCntTime&&(s_iCurFps=
s_iCntFps,s_iCntTime-=1E3,s_iCntFps=0);l===STATE_GAME&&c.update();s_oStage.update(m)}};s_oMain=this;var k=b;ENABLE_FULLSCREEN=b.fullscreen;ENABLE_CHECK_ORIENTATION=b.check_orientation;s_bAudioActive=b.audio_enable_on_startup;this.initContainer()}var s_bMobile,s_bAudioActive=!1,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_bFullscreen=!1,s_aSounds=[],s_aSoundsInfo=[],s_oDrawLayer,s_oStage,s_oMain,s_oSpriteLibrary,s_oSoundtrack,s_oCanvas,s_oLocalStorage;
function CTextButton(b,n,d,f,l,h,c,k){var m,a,g,e,p,u,t;this._init=function(q,x,r,C,I,z,y){m=[];a=[];g=[];var K=createBitmap(r);p=new createjs.Text(C,y+"px "+I,z);p.textAlign="center";p.textBaseline="middle";p.getBounds();p.x=r.width/2;p.y=Math.floor(r.height/2);e=new createjs.Container;e.x=q;e.y=x;e.regX=r.width/2;e.regY=r.height/2;e.addChild(K,p);w.addChild(e);s_bMobile||(e.cursor="pointer");this._initListener()};this.unload=function(){e.off("mousedown",u);e.off("pressup",t);w.removeChild(e)};this.setVisible=
function(q){e.visible=q};this._initListener=function(){oParent=this;u=e.on("mousedown",this.buttonDown);t=e.on("pressup",this.buttonRelease)};this.addEventListener=function(q,x,r){a[q]=x;g[q]=r};this.buttonRelease=function(){e.scaleX=1;e.scaleY=1;playSound("click",1,!1);a[ON_MOUSE_UP]&&a[ON_MOUSE_UP].call(g[ON_MOUSE_UP],m[ON_MOUSE_UP])};this.buttonDown=function(){e.scaleX=.9;e.scaleY=.9;a[ON_MOUSE_DOWN]&&a[ON_MOUSE_DOWN].call(g[ON_MOUSE_DOWN],m[ON_MOUSE_DOWN])};this.addEventListenerWithParams=function(q,
x,r,C){a[q]=x;g[q]=r;m[q]=C};this.setTextPosition=function(q){p.y=q};this.setPosition=function(q,x){e.x=q;e.y=x};this.setX=function(q){e.x=q};this.setY=function(q){e.y=q};this.getButtonImage=function(){return e};this.getX=function(){return e.x};this.getY=function(){return e.y};var w=k;this._init(b,n,d,f,l,h,c);return this}
function CToggle(b,n,d,f,l){var h,c,k,m,a,g,e;this._init=function(p,u,t,w,q){a=[];g=[];var x=new createjs.SpriteSheet({images:[t],frames:{width:t.width/2,height:t.height,regX:t.width/2/2,regY:t.height/2},animations:{state_true:[0],state_false:[1]}});h=w;e=createSprite(x,"state_"+h,t.width/2/2,t.height/2,t.width/2,t.height);e.x=p;e.y=u;e.stop();q.addChild(e);this._initListener()};this.unload=function(){s_bMobile?e.off("mousedown",c):(e.off("mousedown",c),e.off("mouseover",m));e.off("pressup",k);l.removeChild(e)};
this._initListener=function(){s_bMobile?c=e.on("mousedown",this.buttonDown):(c=e.on("mousedown",this.buttonDown),m=e.on("mouseover",this.buttonOver));k=e.on("pressup",this.buttonRelease)};this.addEventListener=function(p,u,t){a[p]=u;g[p]=t};this.addText=function(){};this.setActive=function(p){h=p;e.gotoAndStop("state_"+h)};this.buttonRelease=function(){e.scaleX=1;e.scaleY=1;playSound("click",1,!1);h=!h;e.gotoAndStop("state_"+h);a[ON_MOUSE_UP]&&a[ON_MOUSE_UP].call(g[ON_MOUSE_UP],h)};this.buttonDown=
function(){e.scaleX=.9;e.scaleY=.9;a[ON_MOUSE_DOWN]&&a[ON_MOUSE_DOWN].call(g[ON_MOUSE_DOWN])};this.buttonOver=function(p){s_bMobile||(p.target.cursor="pointer")};this.setPosition=function(p,u){e.x=p;e.y=u};this.getButtonImage=function(){return e};this._init(b,n,d,f,l)}
function CGfxButton(b,n,d,f){var l,h,c,k,m,a,g,e=[],p;this._init=function(t,w,q,x){l=!1;h=1;a=[];g=[];p=createBitmap(q);p.x=t;p.y=w;p.scaleX=p.scaleY=h;p.regX=q.width/2;p.regY=q.height/2;x.addChild(p);this._initListener()};this.unload=function(){s_bMobile?p.off("mousedown",c):(p.off("mousedown",c),p.off("mouseover",m));p.off("pressup",k);f.removeChild(p)};this.setVisible=function(t){p.visible=t};this.setClickable=function(t){l=!t};this._initListener=function(){s_bMobile?c=p.on("mousedown",this.buttonDown):
(c=p.on("mousedown",this.buttonDown),m=p.on("mouseover",this.buttonOver));k=p.on("pressup",this.buttonRelease)};this.addEventListener=function(t,w,q){a[t]=w;g[t]=q};this.addEventListenerWithParams=function(t,w,q,x){a[t]=w;g[t]=q;e=x};this.buttonRelease=function(){l||(p.scaleX=h,p.scaleY=h,a[ON_MOUSE_UP]&&a[ON_MOUSE_UP].call(g[ON_MOUSE_UP],e))};this.buttonDown=function(){l||(p.scaleX=.9*h,p.scaleY=.9*h,playSound("click",1,!1),a[ON_MOUSE_DOWN]&&a[ON_MOUSE_DOWN].call(g[ON_MOUSE_DOWN],e))};this.buttonOver=
function(t){s_bMobile||l||(t.target.cursor="pointer")};this.pulseAnimation=function(){createjs.Tween.get(p).to({scaleX:1.1*h,scaleY:1.1*h},850,createjs.Ease.quadOut).to({scaleX:h,scaleY:h},650,createjs.Ease.quadIn).call(function(){u.pulseAnimation()})};this.trembleAnimation=function(){createjs.Tween.get(p).to({rotation:5},75,createjs.Ease.quadOut).to({rotation:-5},140,createjs.Ease.quadIn).to({rotation:0},75,createjs.Ease.quadIn).wait(750).call(function(){u.trebleAnimation()})};this.setPosition=function(t,
w){p.x=t;p.y=w};this.setX=function(t){p.x=t};this.setY=function(t){p.y=t};this.getButtonImage=function(){return p};this.getX=function(){return p.x};this.getY=function(){return p.y};var u=this;this._init(b,n,d,f);return this}
function CMenu(){var b,n,d,f,l,h,c,k,m,a,g,e,p,u,t=null,w=null;this._init=function(){c=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(c);var q=s_oSpriteLibrary.getSprite("but_play");k=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT-300,q,s_oStage);k.addEventListener(ON_MOUSE_UP,this._onButPlayRelease,this);q=s_oSpriteLibrary.getSprite("but_credits");l=q.width/2+10;h=q.height/2+10;g=new CGfxButton(l,h,q,s_oStage);g.addEventListener(ON_MOUSE_UP,this._onCreditsBut,this);if(!1===DISABLE_SOUND_MOBILE||
!1===s_bMobile)q=s_oSpriteLibrary.getSprite("audio_icon"),d=CANVAS_WIDTH-q.width/4-10,f=q.height/2+10,a=new CToggle(d,f,q,s_bAudioActive,s_oStage),a.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);var x=window.document;q=x.documentElement;t=q.requestFullscreen||q.mozRequestFullScreen||q.webkitRequestFullScreen||q.msRequestFullscreen;w=x.exitFullscreen||x.mozCancelFullScreen||x.webkitExitFullscreen||x.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(t=!1);t&&screenfull.isEnabled&&(q=s_oSpriteLibrary.getSprite("but_fullscreen"),
b=l+q.width/2+10,n=q.height/2+10,e=new CToggle(b,n,q,s_bFullscreen,s_oStage),e.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));q=s_oSpriteLibrary.getSprite("logo");p=new CLightIndicator(q,CANVAS_WIDTH_HALF,CANVAS_HEIGHT_HALF-100,s_oStage);u=[];for(x=0;7>x;x++)q=s_oSpriteLibrary.getSprite("letter_"+x),q=new CLightIndicator(q,LETTERS_POSITION[x].x+-170,LETTERS_POSITION[x].y+-600,s_oStage),u.push(q);this.animLogo();m=new createjs.Shape;m.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,
CANVAS_HEIGHT);s_oStage.addChild(m);createjs.Tween.get(m).to({alpha:0},1E3).call(function(){m.visible=!1});this.refreshButtonPos(s_iOffsetX,s_iOffsetY);s_oLocalStorage.isUsed()||new CMsgBox(TEXT_IOS_PRIVATE)};this.unload=function(){k.unload();k=null;m.visible=!1;g.unload();p.unload();for(var q=0;q<u.length;q++)u[q].unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)a.unload(),a=null;t&&screenfull.isEnabled&&e.unload();s_oStage.removeAllChildren();s_oMenu=c=null};this.refreshButtonPos=function(q,
x){g.setPosition(l+q,x+h);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||a.setPosition(d-q,x+f);t&&screenfull.isEnabled&&e.setPosition(b+q,n+x)};this.animLogo=function(){p.slowHighlight(2E3,0,function(){});for(var q=0;q<u.length;q++)u[q].slowHighlight(2E3,1500,s_oMenu.animLogo)};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onCreditsBut=function(){new CCreditsPanel};this.resetFullscreenBut=function(){t&&screenfull.isEnabled&&e.setActive(s_bFullscreen)};
this._onFullscreenRelease=function(){s_bFullscreen?w.call(window.document):t.call(window.document.documentElement);sizeHandler()};this._onButPlayRelease=function(){"undefined"!==typeof gdsdk&&"undefined"!==gdsdk.showAd&&gdsdk.showAd();try{hideMoreGames()}catch(q){}this.unload();$(s_oMain).trigger("start_session");s_oMain.gotoGame()};s_oMenu=this;this._init()}var s_oMenu=null;
function CGame(b){function n(E){E||(E=window.event);E.preventDefault();switch(E.keyCode){case 37:l=!0;c||(c=!0,p.shiftElementsToLeft(),playSound("flipper",1,!1));break;case 39:h=!0;c||(c=!0,p.shiftElementsToRight(),playSound("flipper",1,!1));break;case 40:c||(c=!0,s_oTable.loadSpring())}}function d(E){E||(E=window.event);E.preventDefault();c=!1;switch(E.keyCode){case 37:l=!1;break;case 39:h=!1;break;case 40:s_oTable.releaseSpring()}}var f,l,h,c,k,m,a,g,e=null,p,u,t,w,q,x,r,C,I,z,y,K,D,L,T;this._init=
function(){m=k=c=h=l=f=!1;a=NUM_BALL;T={x:LERP_SLOW.x,y:LERP_SLOW.y};new CPhysicsController;new CObjectBuilder;new CSCoreController;u=s_oObjectBuilder.addBall(BALL_RADIUS,BALL_STARTPOS.x,BALL_STARTPOS.y,.1,.7,0);z=new createjs.Container;z.scaleX=z.scaleY=ZOOM;s_oStage.addChild(z);y=new createjs.Container;z.addChild(y);K=new createjs.Container;z.addChild(K);q=new createjs.Shape;q.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(q);p=new CTable(y,K);
L={x:BALL_STARTPOS.x*ZOOM+CANVAS_WIDTH/2,y:BALL_STARTPOS.y*ZOOM+CANVAS_HEIGHT/2};var E=s_oSpriteLibrary.getSprite("ball");t=createBitmap(E);t.regX=E.width/2;t.regY=E.height/2;y.addChild(t);D=new CPausePanel(s_oStage);g=new CInterface;g.refreshScore(0);s_oScoreController.addEventListener(ON_INCREASE_JACKPOT,s_oTable.onJackpotIncreased);s_oScoreController.addEventListener(ON_INCREASE_SCORE,g.refreshScore);E=s_oSpriteLibrary.getSprite("flipper");C=createBitmap(E);C.x=726;C.y=1706;C.regX=E.width-14;C.regY=
28;y.addChild(C);E=s_oSpriteLibrary.getSprite("flipper");I=createBitmap(E);I.x=326;I.y=1706;I.regX=E.width-14;I.regY=28;I.scaleX=-1;y.addChild(I);p.activeShield();if(s_bMobile){E=s_oSpriteLibrary.getSprite("hand_anim");var N=E.width/5,U=E.height/2;E=new createjs.SpriteSheet({images:[E],frames:{width:N,height:U,regX:N/2,regY:U/2},animations:{start:[5,9,"stop"],stop:[9,9,"back",.02],back:[0,4,"start"]}});w=createSprite(E,"start",N/2,U/2,N,U);w.x=CANVAS_WIDTH_HALF;w.y=CANVAS_HEIGHT_HALF-200;w.visible=
!1;s_oStage.addChild(w)}new CHelpPanel;this.updateCamera()};this.moveBall=function(E){E={x:E.localX/WORLD_SCALE,y:E.localY/WORLD_SCALE};u.SetLinearVelocity({x:0,y:0});u.SetAngularVelocity(0);u.SetPosition(E);u.SetActive(!1)};this.releaseBall=function(){u.SetActive(!0)};this._onPressDown=function(E){f&&(E.localX>CANVAS_WIDTH_HALF?m&&(h=!0,p.shiftElementsToRight()):m&&(l=!0,p.shiftElementsToLeft()),playSound("flipper",1,!1),E.localY>SETTINGS_HEIGHT&&s_oTable.loadSpring())};this._onPressUp=function(E){if(f){w.visible=
!1;if(!1===h&&!0===l||!0===h&&!1===l)l=h=!1;E.localX>CANVAS_WIDTH_HALF?h=!1:l=!1;s_oTable.releaseSpring()}};this.resetBallPos=function(){var E={x:BALL_STARTPOS.x/WORLD_SCALE,y:BALL_STARTPOS.y/WORLD_SCALE};setTimeout(function(){u.SetLinearVelocity({x:0,y:0});u.SetAngularVelocity(0);u.SetPosition(E)},500)};this.ballInGame=function(E){m=E};this.restartGame=function(){$(s_oMain).trigger("show_interlevel_ad");s_oScoreController.resetScore();s_oTable.reset();s_oTable.unblockLaunch();s_oTable.activeShield();
f=!0;a=NUM_BALL;g.resetBallRemaining()};this.unload=function(){f=!1;g.unload();null!==e&&e.unload();s_bMobile?q.removeAllEventListeners():(document.onkeydown=null,document.onkeyup=null);createjs.Tween.removeAllTweens();s_oStage.removeAllChildren();s_oPhysicsController.unload()};this.setFlippers=function(E,N){r=E;x=N};this.setNewLaunch=function(){s_oGame.resetBallPos();p.activeShield();0===a&&(f=!1,s_oTable.blockLaunch(),s_oGame.gameOver())};this.setExtraBall=function(){k=!0;g.activeExtraBallAnim(a-
1)};this.isExtraBall=function(){return k};this.launchBall=function(E){u.SetActive(!0);u.ApplyImpulse({x:-.001+.002*Math.random(),y:-E},u.GetPosition());T=LERP_FOLLOW_BALL};this.onBallLaunched=function(){k?(g.disableExtraBallAnim(),k=!1):a--};this.onBallOut=function(){k?(g.disableExtraBallAnim(),k=!1,s_oTable.resetOnExtraBall()):(a--,0<a&&g.refreshBallRemaining(a-1),s_oTable.reset());s_oGame.ballInGame(!1);T=LERP_SLOW;s_oTable.unblockLaunch();s_oGame.setNewLaunch();playSound("ball_out",1,!1)};this.getBall=
function(){return u};this.getBallSprite=function(){return t};this.onExit=function(){$(s_oMain).trigger("end_session");s_oGame.unload();s_oMain.gotoMenu()};this._onExitHelp=function(){f=!0;s_bMobile&&(w.visible=!0);playSound("start_game",1,!1);$(s_oMain).trigger("start_level",1);s_bMobile?(q.on("mousedown",this._onPressDown),q.on("pressup",this._onPressUp)):(document.onkeydown=n,document.onkeyup=d)};this.gameOver=function(){e=CEndPanel(s_oSpriteLibrary.getSprite("msg_box"));e.show(s_oScoreController.getScore())};
this.onPause=function(){f=!1;D.show()};this.onResume=function(){f=!0;D.hide()};this.updateCamera=function(){var E=-u.GetPosition().x*ZOOM_PER_WORLDSCALE+CANVAS_WIDTH_HALF;var N=(-u.GetPosition().y*ZOOM_PER_WORLDSCALE+CANVAS_HEIGHT_HALF-L.y)*T.y;L.x+=(E-L.x)*T.x;L.y+=N;E=-(ZOOM_TABLE_SIZE.w-CANVAS_WIDTH+s_iOffsetX);L.x<E&&(L.x=E);L.x>s_iOffsetX&&(L.x=s_iOffsetX);E=-(ZOOM_TABLE_SIZE.h-CANVAS_HEIGHT+s_iOffsetY);L.y<E&&(L.y=E);L.y>s_iOffsetY&&(L.y=s_iOffsetY);z.x=L.x;z.y=L.y};this.update=function(){f&&
(l?x.SetMotorSpeed(FLIPPER_STRENGTH):x.SetMotorSpeed(-FLIPPER_STRENGTH),h?r.SetMotorSpeed(-FLIPPER_STRENGTH):r.SetMotorSpeed(FLIPPER_STRENGTH),this.updateCamera(),s_oPhysicsController.update(L),s_oTable.update(),t.x=u.GetPosition().x*WORLD_SCALE,t.y=u.GetPosition().y*WORLD_SCALE,C.rotation=r.GetBodyA().GetAngle()*TODEGREE_PROPORTION,I.rotation=x.GetBodyA().GetAngle()*TODEGREE_PROPORTION,u.GetPosition().y>BALL_OUT_SAFE_LIMIT&&(u.SetPosition({x:u.GetPosition().x,y:u.GetPosition().y-BALL_OUT_SAFE_LIMIT/
2}),s_oGame.onBallOut()))};s_oGame=this;this._init()}var s_oGame;
function CInterface(){var b,n,d,f,l,h,c,k,m,a,g,e,p,u,t,w,q,x,r,C=null,I=null;this._init=function(){var z,y=s_oSpriteLibrary.getSprite("but_exit");c=CANVAS_WIDTH-y.width/2-10;k=y.height/2+10;p=new CGfxButton(c,k,y,s_oStage);p.addEventListener(ON_MOUSE_UP,this._onExit,this);l=z=c-y.width-10;h=y.height/2+10;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)y=s_oSpriteLibrary.getSprite("audio_icon"),e=new CToggle(l,h,y,s_bAudioActive,s_oStage),e.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this),z=l-
y.width/2-10;y=window.document;var K=y.documentElement;C=K.requestFullscreen||K.mozRequestFullScreen||K.webkitRequestFullScreen||K.msRequestFullscreen;I=y.exitFullscreen||y.mozCancelFullScreen||y.webkitExitFullscreen||y.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(C=!1);C&&screenfull.isEnabled&&(y=s_oSpriteLibrary.getSprite("but_fullscreen"),d=z-10,f=y.height/2+10,u=new CToggle(d,f,y,s_bFullscreen,s_oStage),u.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));y=s_oSpriteLibrary.getSprite("but_settings");
r=new CGUIExpandible(c,k,y,s_oStage);r.addButton(p);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||r.addButton(e);C&&screenfull.isEnabled&&r.addButton(u);y=s_oSpriteLibrary.getSprite("score_panel");b=y.width/2+10;n=y.height/2+10;w=new createjs.Container;w.x=b;w.y=n;s_oStage.addChild(w);z=createBitmap(y);z.regX=y.width/2;z.regY=y.height/2;w.addChild(z);y=s_oSpriteLibrary.getSprite("star");z=createBitmap(y);z.x=-90;z.y=-16;z.regX=y.width/2;z.regY=y.height/2;z.scaleX=z.scaleY=.7;w.addChild(z);q=new createjs.Text(0,
" 28px "+PRIMARY_FONT,PRIMARY_FONT_COLOUR);q.x=z.x+28;q.y=z.y;q.textAlign="left";q.textBaseline="middle";q.lineWidth=200;w.addChild(q);y=s_oSpriteLibrary.getSprite("ball");m=z.x;a=z.y+38;g=y.width/2+4;t=[];for(z=0;z<NUM_BALL-1;z++)K=createBitmap(y),K.x=m+g*z,K.y=a,K.regX=y.width/2,K.regY=y.height/2,K.scaleX=K.scaleY=.5,w.addChild(K),t.push(K);y=s_oSpriteLibrary.getSprite("extra_ball");x=createBitmap(y);x.regX=y.width/2;x.regY=y.height/2;x.alpha=0;w.addChild(x);this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};
this.unload=function(){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)e.unload(),e=null;C&&screenfull.isEnabled&&u.unload();r.unload();s_oInterface=null};this.refreshButtonPos=function(z,y){r.refreshPos(z,y);w.x=b+z;w.y=n+y};this.refreshScore=function(z){q.text=z.toLocaleString()};this.refreshBallRemaining=function(z){t[z].visible=!1};this.resetBallRemaining=function(){for(var z=0;z<t.length;z++)t[z].visible=!0};this.activeExtraBallAnim=function(z){x.x=m+z*g;x.y=a;x.alpha=1;createjs.Tween.get(x,{loop:!0}).to({alpha:0},
500).to({alpha:1},500).wait(1E3)};this.disableExtraBallAnim=function(){createjs.Tween.removeTweens(x);x.alpha=0};this._onButHelpRelease=function(){_oHelpPanel=new CHelpPanel};this._onButRestartRelease=function(){s_oGame.restartGame();$(s_oMain).trigger("restart_level",1)};this.onExitFromHelp=function(){_oHelpPanel.unload()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onExit=function(){new CAreYouSurePanel(s_oGame.onExit)};this.resetFullscreenBut=
function(){C&&screenfull.isEnabled&&u.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?I.call(window.document):C.call(window.document.documentElement);sizeHandler()};s_oInterface=this;this._init();return this}var s_oInterface=null;
function CHelpPanel(){var b,n,d,f;this._init=function(){d=new createjs.Shape;d.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);d.alpha=1;d.on("mousedown",function(){l._onExitHelp()});s_oStage.addChild(d);(new createjs.Tween.get(d)).to({alpha:.7},500);f=new createjs.Container;f.on("mousedown",function(){l._onExitHelp()});s_oStage.addChild(f);var h=s_oSpriteLibrary.getSprite("msg_box"),c=createBitmap(h);c.regX=h.width/2;c.regY=h.height/2;f.addChild(c);f.x=CANVAS_WIDTH/2;f.y=CANVAS_HEIGHT+
h.height/2;b=f.y;(new createjs.Tween.get(f)).to({y:CANVAS_HEIGHT/2-40},500,createjs.Ease.cubicOut);if(s_bMobile){h=s_oSpriteLibrary.getSprite("flipper");c=createBitmap(h);c.x=250;c.y=-80;c.regX=h.width-7;c.regY=14;c.scaleX=.5;c.scaleY=.5;f.addChild(c);h=s_oSpriteLibrary.getSprite("flipper");var k=createBitmap(h);k.x=-250;k.y=-80;k.regX=h.width-7;k.regY=14;k.scaleX=-.5;k.scaleY=.5;f.addChild(k);createjs.Tween.get(k,{loop:!0}).to({rotation:-50},100,createjs.Ease.cubicIn).wait(500*Math.random()).to({rotation:0},
500,createjs.Ease.cubicIn);createjs.Tween.get(c,{loop:!0}).to({rotation:50},100,createjs.Ease.cubicIn).wait(500*Math.random()).to({rotation:0},500,createjs.Ease.cubicIn);h=300;c=70;new CTLText(f,-(h/2),-110-c/2,h,c,20,"center",PRIMARY_FONT_COLOUR,PRIMARY_FONT,1.3,2,2,TEXT_HELP1_MOBILE,!0,!0,!0,!1)}else c=80,new CTLText(f,-250,-110-c/2,300,c,20,"left",PRIMARY_FONT_COLOUR,PRIMARY_FONT,1.3,2,2,TEXT_HELP1,!0,!0,!0,!1),h=s_oSpriteLibrary.getSprite("keys"),c=createBitmap(h),c.x=130,c.y=-100,c.regX=h.width/
2,c.regY=h.height/2,f.addChild(c);h=400;c=80;new CTLText(f,-(h/2),50-c/2,h,c,20,"center",PRIMARY_FONT_COLOUR,PRIMARY_FONT,1.3,2,2,TEXT_HELP2,!0,!0,!0,!1);h=s_oSpriteLibrary.getSprite("star");c=createBitmap(h);c.regX=h.width/2;c.regY=h.height/2;c.y=120;f.addChild(c)};this.unload=function(){s_oStage.removeChild(d);s_oStage.removeChild(f);f.off("mousedown",function(){l._onExitHelp()});d.off("mousedown",function(){l._onExitHelp()})};this._onExitHelp=function(){n||(n=!0,(new createjs.Tween.get(d)).to({alpha:0},
500),(new createjs.Tween.get(f)).to({y:b},400,createjs.Ease.backIn).call(function(){l.unload();s_oGame._onExitHelp()}))};var l=this;this._init()}
function CCreditsPanel(){var b,n,d,f,l,h,c;this._init=function(){n=new createjs.Shape;n.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);n.alpha=0;s_oStage.addChild(n);createjs.Tween.get(n).to({alpha:.7},500);h=new createjs.Shape;h.graphics.beginFill("#0f0f0f").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);h.alpha=.01;c=h.on("click",function(){});s_oStage.addChild(h);d=new createjs.Container;s_oStage.addChild(d);var k=s_oSpriteLibrary.getSprite("msg_box"),m=createBitmap(k);m.regX=k.width/
2;m.regY=k.height/2;d.addChild(m);d.x=CANVAS_WIDTH/2;d.y=CANVAS_HEIGHT+k.height/2;b=d.y;createjs.Tween.get(d).to({y:CANVAS_HEIGHT/2},500,createjs.Ease.quartIn);k=400;m=60;new CTLText(d,-(k/2),-90-m/2,k,m,40,"center",PRIMARY_FONT_COLOUR,PRIMARY_FONT,1.3,2,2,TEXT_DEVELOPED,!0,!0,!0,!1);k=400;m=60;new CTLText(d,-(k/2),70-m/2,k,m,40,"center",PRIMARY_FONT_COLOUR,PRIMARY_FONT,1.3,2,2,"www.codethislab.com",!0,!0,!0,!1);new CTLText(d,-(k/2)-110,m/2+150,100,14,14,"left",PRIMARY_FONT_COLOUR,PRIMARY_FONT,1.3,
2,2,"v2",!0,!0,!0,!1);k=s_oSpriteLibrary.getSprite("ctl_logo");l=createBitmap(k);l.regX=k.width/2;l.regY=k.height/2;d.addChild(l);k=s_oSpriteLibrary.getSprite("but_exit");f=new CGfxButton(270,-138,k,d);f.addEventListener(ON_MOUSE_UP,this.unload,this)};this.unload=function(){h.off("click",c);f.setClickable(!1);createjs.Tween.get(n).to({alpha:0},500);createjs.Tween.get(d).to({y:b},400,createjs.Ease.backIn).call(function(){s_oStage.removeChild(n);s_oStage.removeChild(d);f.unload()})};this._init()}
function CAreYouSurePanel(b,n){var d,f,l,h,c,k;this._init=function(a,g){h=new createjs.Shape;h.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);h.alpha=0;k=h.on("mousedown",function(){});s_oStage.addChild(h);createjs.Tween.get(h).to({alpha:.7},500);c=new createjs.Container;s_oStage.addChild(c);var e=s_oSpriteLibrary.getSprite("credits_panel"),p=createBitmap(e);p.regX=e.width/2;p.regY=e.height/2;c.addChild(p);c.x=CANVAS_WIDTH/2;c.y=CANVAS_HEIGHT+e.height/2;d=c.y;createjs.Tween.get(c).to({y:CANVAS_HEIGHT/
2},500,createjs.Ease.quartIn);p=new createjs.Text(TEXT_ARE_SURE," 34px "+PRIMARY_FONT,"#000000");p.y=-e.height/2+120;p.textAlign="center";p.textBaseline="middle";p.lineWidth=400;p.outline=5;c.addChild(p);e=new createjs.Text(TEXT_ARE_SURE," 34px "+PRIMARY_FONT,PRIMARY_FONT_COLOUR);e.y=p.y;e.textAlign="center";e.textBaseline="middle";e.lineWidth=400;c.addChild(e);f=new CGfxButton(110,80,s_oSpriteLibrary.getSprite("but_yes"),c);f.addEventListener(ON_MOUSE_UP,this._onButYes,this);l=new CGfxButton(-110,
80,s_oSpriteLibrary.getSprite("but_no"),c);l.addEventListener(ON_MOUSE_UP,this._onButNo,this);l.pulseAnimation()};this._onButYes=function(){l.setClickable(!1);f.setClickable(!1);createjs.Tween.get(h).to({alpha:0},500);createjs.Tween.get(c).to({y:d},400,createjs.Ease.backIn).call(function(){m.unload();b&&b()})};this._onButNo=function(){l.setClickable(!1);f.setClickable(!1);createjs.Tween.get(h).to({alpha:0},500);createjs.Tween.get(c).to({y:d},400,createjs.Ease.backIn).call(function(){m.unload();n&&
n()})};this.unload=function(){l.unload();f.unload();s_oStage.removeChild(h);s_oStage.removeChild(c);h.off("mousedown",k)};var m=this;this._init(b,n)}
function CEndPanel(b){var n,d,f,l,h,c,k,m,a,g;this._init=function(e){k=new createjs.Shape;k.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);k.alpha=0;g=k.on("mousedown",function(){});s_oStage.addChild(k);createjs.Tween.get(k).to({alpha:.7},500);c=new createjs.Container;s_oStage.addChild(c);e=s_oSpriteLibrary.getSprite("msg_box");var p=createBitmap(e);p.regX=e.width/2;p.regY=e.height/2;c.addChild(p);c.x=CANVAS_WIDTH/2;c.y=CANVAS_HEIGHT+e.height/2;n=c.y;d=new createjs.Container;
d.y=-120;c.addChild(d);e=s_oSpriteLibrary.getSprite("bestscore");p=createBitmap(e);p.regY=e.height/2;d.addChild(p);f=new createjs.Text("0"," 38px "+PRIMARY_FONT,PRIMARY_FONT_COLOUR);f.x=p.x+e.width+4;f.y=p.y;f.textAlign="left";f.textBaseline="middle";f.lineWidth=200;d.addChild(f);l=new createjs.Container;l.y=-50;c.addChild(l);e=s_oSpriteLibrary.getSprite("star");p=createBitmap(e);p.regY=e.height/2;l.addChild(p);h=new createjs.Text("0"," 28px "+PRIMARY_FONT,PRIMARY_FONT_COLOUR);h.x=p.x+e.width+4;h.y=
p.y;h.textAlign="left";h.textBaseline="middle";h.lineWidth=200;l.addChild(h);a=new CGfxButton(110,80,s_oSpriteLibrary.getSprite("but_restart"),c);a.addEventListener(ON_MOUSE_UP,this._onRestart,this);a.pulseAnimation();m=new CGfxButton(-110,80,s_oSpriteLibrary.getSprite("but_home"),c);m.addEventListener(ON_MOUSE_UP,this._onExit,this)};this.unload=function(){k.off("mousedown",g);s_oStage.removeChild(c);s_oStage.removeChild(k)};this.show=function(e){playSound("game_over",1,!1);e>s_iTotalScore&&(s_iTotalScore=
e,s_oLocalStorage.saveData());f.text=s_iTotalScore.toLocaleString();d.regX=d.getBounds().width/2;h.text=e.toLocaleString();l.regX=l.getBounds().width/2;createjs.Tween.get(c).to({y:CANVAS_HEIGHT/2},500,createjs.Ease.quartIn);$(s_oMain).trigger("save_score",e,"DON'T FORGET TO SET THE MODE");$(s_oMain).trigger("end_level",1);var p="You collected <strong>"+e+" points</strong>!<br><br>Share your score with your friends!",u="My score is "+e+" points! Can you do better?";$(s_oMain).trigger("share_event",
e,"200x200.jpg","Congratulations!",p,u)};this._onRestart=function(){a.setClickable(!1);m.setClickable(!1);s_oGame.restartGame();createjs.Tween.get(k).to({alpha:0},500);createjs.Tween.get(c).to({y:n},400,createjs.Ease.backIn).call(function(){s_oStage.removeChild(k);s_oStage.removeChild(c)})};this._onExit=function(){$(s_oMain).trigger("show_interlevel_ad");s_oGame.onExit()};this._init(b);return this}
function CPhysicsController(){var b=Box2D.Common.Math.b2Vec2,n=Box2D.Dynamics.b2World,d=Box2D.Dynamics.b2DebugDraw,f,l,h=this,c,k,m;this.init=function(){f=new b(0,GRAVITY);l=new n(f,!0);c=[];k=[];if(DEBUG_BOX2D){var a=document.createElement("canvas");a.id="debug";a.width=s_oCanvas.width;a.height=s_oCanvas.height;a.style.position="fixed";document.body.appendChild(a);$("#debug").css("pointer-events","none");m=document.getElementById("debug").getContext("2d");a=new d;a.SetSprite(m);a.SetDrawScale(WORLD_SCALE*
ZOOM);a.SetFillAlpha(DEBUG_BOX2D_ALPHA);a.SetLineThickness(1);a.SetFlags(d.e_shapeBit);l.SetDebugDraw(a);sizeHandler()}this.createAContactListener()};this.createAContactListener=function(){var a=new Box2D.Dynamics.b2ContactListener;a.BeginContact=function(g){var e=g.GetFixtureA().GetUserData(),p=g.GetFixtureB().GetUserData();s_oPhysicsController.processContactEvent(CONTACT_BEGIN,e,g);s_oPhysicsController.processContactEvent(CONTACT_BEGIN,p,g)};a.EndContact=function(g){var e=g.GetFixtureA().GetUserData(),
p=g.GetFixtureB().GetUserData();s_oPhysicsController.processContactEvent(CONTACT_END,e,g);s_oPhysicsController.processContactEvent(CONTACT_END,p,g)};l.SetContactListener(a)};this.destroyBodyVector=function(a){l.DestroyBody(a)};this.destroyAllBodies=function(){for(var a=l.GetBodyList();a;){var g=a;a=a.GetNext();l.DestroyBody(g)}};this.destroyAllJoints=function(){for(var a=l.GetJointList();a;){var g=a;a=a.GetNext();l.DestroyJoint(g)}};this.destroyAllContacts=function(){for(var a=l.GetContactList();a;){var g=
a.GetNext();l.DestroyJoint(g)}};this.unload=function(){s_oPhysicsController.destroyAllJoints();s_oPhysicsController.destroyAllBodies();s_oPhysicsController.destroyAllContacts();DEBUG_BOX2D&&document.getElementById("debug").remove();l=s_oPhysicsController=null};this.processContactEvent=function(a,g,e){g&&g.contacttype===a&&g.callback(g.params,e)};this.startComputing=function(a){a.GetBody().SetActive(!0)};this.movePlayer=function(a,g,e){g={x:g/WORLD_SCALE,y:e/WORLD_SCALE};a.GetBody().SetPosition(g)};
this.applyImpulse=function(a){a.GetBody().ApplyImpulse({x:.8,y:1},a.GetBody().GetWorldCenter())};this.decreaseSpeedRotation=function(a){var g=.99*a.GetBody().GetAngularVelocity();a.GetBody().SetAngularVelocity(g)};this.getSpeedRotation=function(a){return a.GetBody().GetAngularVelocity()};this.moveObject=function(a,g,e){g={x:g/WORLD_SCALE,y:e/WORLD_SCALE};a.GetBody().SetPosition(g)};this.destroyBody=function(a){l.DestroyBody(a.GetBody())};this.getInstance=function(){null===h&&(h=new CPhysicsController);
return h};this.update=function(a){l.Step(1/FPS,8,8);DEBUG_BOX2D&&(m.save(),m.clearRect(0,0,s_oCanvas.width,s_oCanvas.height),m.translate(a.x,a.y),l.DrawDebugData(),m.restore());l.ClearForces();this._deactiveAllBodyInList();this._activeAllBodyInList()};this.getWorld=function(){return l};this.getElementPosition=function(a){var g=a.GetBody().GetPosition();return{x:g.x*WORLD_SCALE,y:g.y*WORLD_SCALE,angle:180*a.GetBody().GetAngle()/Math.PI}};this.getElementAngle=function(a){return 180*a.GetBody().GetAngle()/
Math.PI};this.enableBody=function(a,g){k.push({body:a,pos:g})};this.disableBody=function(a,g){c.push({body:a,pos:g})};this._deactiveAllBodyInList=function(){for(var a=0;a<c.length;a++)c[a].body.SetActive(!1),c[a].pos&&c[a].body.SetPosition({x:c[a].pos.x/WORLD_SCALE,y:c[a].pos.y/WORLD_SCALE});c=[]};this._activeAllBodyInList=function(){for(var a=0;a<k.length;a++)k[a].body.SetActive(!0),k[a].pos&&k[a].body.SetPosition({x:k[a].pos.x/WORLD_SCALE,y:k[a].pos.y/WORLD_SCALE});k=[]};this.init();s_oPhysicsController=
this}var s_oPhysicsController=null;
function CObjectBuilder(){var b=Box2D.Common.Math.b2Vec2,n=Box2D.Dynamics.b2BodyDef,d=Box2D.Dynamics.b2Body,f=Box2D.Dynamics.b2FixtureDef,l=Box2D.Collision.Shapes.b2PolygonShape,h=Box2D.Collision.Shapes.b2CircleShape,c=Box2D.Dynamics.Joints.b2RevoluteJointDef,k,m;this.init=function(){m=s_oPhysicsController.getInstance();k=m.getWorld()};this.addButton=function(a,g,e,p,u,t,w,q,x){var r=new f;r.density=t;r.friction=w;r.restitution=q;r.color=16777215;r.userData=x;t=new n;t.type=d.b2_staticBody;r.shape=
new l;r.shape.SetAsBox(a/2/WORLD_SCALE,g/2/WORLD_SCALE);t.position.Set(e/WORLD_SCALE,p/WORLD_SCALE);t.angle=u*Math.PI/180;a=k.CreateBody(t);a.CreateFixture(r);return a};this.addEdge=function(a,g,e,p,u,t){var w=new f;w.density=p;w.friction=u;w.restitution=t;p=new n;p.type=d.b2_staticBody;w.shape=new l;a=new b(a.x/WORLD_SCALE,a.y/WORLD_SCALE);g=new b(g.x/WORLD_SCALE,g.y/WORLD_SCALE);w.shape.SetAsEdge(a,g);p.angle=e*Math.PI/180;e=k.CreateBody(p);e.CreateFixture(w);return e};this.addPolygon=function(a,
g,e,p,u){var t=new f;t.density=e;t.friction=p;t.restitution=u;e=new n;e.type=d.b2_staticBody;t.shape=new l;p=[];for(u=0;u<a.length;u++){var w=new b;w.Set(a[u].x/WORLD_SCALE,a[u].y/WORLD_SCALE);p.push(w)}t.shape.SetAsArray(p,p.length);e.angle=g*Math.PI/180;k.CreateBody(e).CreateFixture(t)};this.addBall=function(a,g,e,p,u,t){var w=new f;w.density=p;w.friction=u;w.restitution=t;w.userData={id:"ball"};p=new n;p.type=d.b2_dynamicBody;w.shape=new h(a/WORLD_SCALE);p.allowSleep=!1;p.bullet=!0;p.position.x=
g/WORLD_SCALE;p.position.y=e/WORLD_SCALE;a=k.CreateBody(p);a.CreateFixture(w);return a};this.addCircle=function(a,g,e,p,u,t){var w=new f;w.density=p;w.friction=u;w.restitution=t;p=new n;p.type=d.b2_dynamicBody;w.shape=new h(a/WORLD_SCALE);p.position.x=g/WORLD_SCALE;p.position.y=e/WORLD_SCALE;return k.CreateBody(p).CreateFixture(w)};this.addStaticCircle=function(a,g,e,p,u,t,w){var q=new f;q.density=p;q.friction=u;q.restitution=t;q.userData=w;p=new n;p.type=d.b2_staticBody;q.shape=new h(a/WORLD_SCALE);
p.position.x=g/WORLD_SCALE;p.position.y=e/WORLD_SCALE;return k.CreateBody(p).CreateFixture(q)};this.addRevoluteRectangle=function(a,g,e,p,u,t,w,q){var x=new f;x.density=u;x.friction=t;x.restitution=w;u=new n;u.type=d.b2_dynamicBody;q&&(u.angularVelocity=3);x.shape=new l;x.shape.SetAsBox(a/WORLD_SCALE,g/WORLD_SCALE);u.position.Set(e/WORLD_SCALE,p/WORLD_SCALE);a=k.CreateBody(u);x=a.CreateFixture(x);g=new f;g.density=3;g.friction=1;g.restitution=.1;q=new n;q.type=d.b2_staticBody;g.shape=new h(10/WORLD_SCALE);
q.position.Set(e/WORLD_SCALE,p/WORLD_SCALE);e=k.CreateBody(q);p=e.CreateFixture(g);g=new c;g.Initialize(a,e,a.GetWorldCenter());k.CreateJoint(g);return{fixture1:x,fixture2:p}};this.addLeftFlipper=function(a,g,e,p,u,t){var w=new f;w.density=p;w.friction=u;w.restitution=t;var q=new n;q.type=d.b2_dynamicBody;w.shape=new l;for(var x=[],r=0;r<a.length;r++){var C=new b;C.Set(a[r].x/WORLD_SCALE*-1,a[r].y/WORLD_SCALE);x.push(C)}w.shape.SetAsArray(x,x.length);q.position.Set(g/WORLD_SCALE,(e+28)/WORLD_SCALE);
a=k.CreateBody(q);a.CreateFixture(w);w=new f;w.density=p;w.friction=u;w.restitution=t;p=new n;p.type=d.b2_staticBody;w.shape=new h(11/WORLD_SCALE);p.position.Set(g/WORLD_SCALE,e/WORLD_SCALE);g=k.CreateBody(p);g.CreateFixture(w);e=new c;p={x:g.GetWorldCenter().x,y:g.GetWorldCenter().y};e.Initialize(a,g,p);e.lowerAngle=5*Math.PI/180;e.upperAngle=50*Math.PI/180;e.enableLimit=!0;e.maxMotorTorque=1E3;e.enableMotor=!0;g=k.CreateJoint(e);g.EnableMotor(!0);return g};this.addRightFlipper=function(a,g,e,p,
u,t){var w=new f;w.density=p;w.friction=u;w.restitution=t;var q=new n;q.type=d.b2_dynamicBody;w.shape=new l;for(var x=[],r=0;r<a.length;r++){var C=new b;C.Set(a[r].x/WORLD_SCALE,a[r].y/WORLD_SCALE);x.push(C)}w.shape.SetAsArray(x,x.length);q.position.Set(g/WORLD_SCALE,(e+28)/WORLD_SCALE);a=k.CreateBody(q);a.CreateFixture(w);w=new f;w.density=p;w.friction=u;w.restitution=t;p=new n;p.type=d.b2_staticBody;w.shape=new h(11/WORLD_SCALE);p.position.Set(g/WORLD_SCALE,e/WORLD_SCALE);g=k.CreateBody(p);g.CreateFixture(w);
e=new c;p={x:g.GetWorldCenter().x,y:g.GetWorldCenter().y};e.Initialize(a,g,p);e.lowerAngle=-50*Math.PI/180;e.upperAngle=-5*Math.PI/180;e.enableLimit=!0;e.maxMotorTorque=1E3;e.enableMotor=!0;g=k.CreateJoint(e);g.EnableMotor(!0);return g};this.addRectangle=function(a,g,e,p,u,t,w,q){var x=new f;x.density=t;x.friction=w;x.restitution=q;t=new n;t.type=d.b2_staticBody;x.shape=new l;x.shape.SetAsBox(a/WORLD_SCALE,g/WORLD_SCALE);t.position.Set(e/WORLD_SCALE,p/WORLD_SCALE);t.angle=u*Math.PI/180;return k.CreateBody(t).CreateFixture(x)};
this.init();s_oObjectBuilder=this}var s_oObjectBuilder=null,EDGE_FRAME="edge_frame",TOP_CHANNELLERS="top_channellers",LEFT_ROUTER="left_router",BOT_CHANNELLERS="bot_channellers",FLIPPER_BUMPER="flipper_bumper",RIGHT_CHANNELLER="right_channeller",CIRCLE_BUMPER="circle_bumper",PLATFORM="platforms",CENTERSAFE="centersafe",FLIPPER="flipper";
function CTable(b,n){var d,f,l,h,c,k,m,a,g,e,p,u;this._init=function(t,w){var q=s_oSpriteLibrary.getSprite("pinball_bg");d=q.width;f=q.height;l=createBitmap(q);l.alpha=1;t.addChild(l);ZOOM_TABLE_SIZE={w:d*ZOOM,h:f*ZOOM};u=new CModuleStart(t,w);h=new CModuleMultiplier(t,w);c=new CModuleBumper(t,w);k=new CModuleHole(t,w);m=new CModuleRouter(t,w);a=new CModuleLetters(t,w);g=new CModuleJumper(t,w);e=new CModuleJackpot(t,w);p=new CModuleShield(t,w);this._buildTable();this._addCheckPoints()};this._buildTable=
function(){for(var t=TileMaps.levelsettings.layers,w=GENERAL_RESTITUTION,q=0;q<t.length;q++)if("objectgroup"===t[q].type){var x=t[q].objects;switch(t[q].name){case EDGE_FRAME:this._addShapes(x,0);break;case CENTERSAFE:var r=t[q].objects[0],C=this.getAdjustedPoints(0,0,[{x:r.x,y:r.y}]);s_oObjectBuilder.addStaticCircle(r.width/2,C[0].x+r.width/2,C[0].y+r.width/2,0,0,.75);C=createBitmap(s_oSpriteLibrary.getSprite("safe_pin"));C.x=r.x;C.y=r.y;b.addChild(C);break;case TOP_CHANNELLERS:for(r=0;r<x.length;r++)this._addPolygons(x[r],
3*w/2);break;case LEFT_ROUTER:this._addShapes(x,0);break;case BOT_CHANNELLERS:for(r=0;r<x.length;r++)x[r].ellipse?(C=this.getAdjustedPoints(0,0,[{x:x[r].x,y:x[r].y}]),s_oObjectBuilder.addStaticCircle(x[r].width/2,C[0].x+x[r].width/2,C[0].y+x[r].width/2,0,0,0)):this._addPolygons(x[r],w/2);break;case FLIPPER_BUMPER:c.buildFlipperBumper(x);break;case CIRCLE_BUMPER:c.buildCircularBumper(x);break;case RIGHT_CHANNELLER:for(r=0;r<x.length;r++)this._addPolygons(x[r],.7);break;case FLIPPER:x=t[q].objects,
C=x[0],C=this.getAdjustedPoints(0,0,C.polygon),r=s_oObjectBuilder.addRightFlipper(C,726,1706,1,0,w),x=t[q].objects,C=x[0],C=this.getAdjustedPoints(0,0,C.polygon),C=s_oObjectBuilder.addLeftFlipper(C.reverse(),326,1706,1,0,w),s_oGame.setFlippers(r,C)}}};this._addPolygons=function(t,w){var q=this.getAdjustedPoints(t.x,t.y,t.polygon);s_oObjectBuilder.addPolygon(q,0,1,GENERAL_FRICTION,w)};this._addShapes=function(t,w){for(var q=0;q<t.length;q++)for(var x=this.getAdjustedPoints(t[q].x,t[q].y,t[q].polyline),
r=0;r<x.length-1;r++)s_oObjectBuilder.addEdge({x:x[r].x,y:x[r].y},{x:x[r+1].x,y:x[r+1].y},0,1,GENERAL_FRICTION,w)};this._addCheckPoints=function(){var t=140,w=1460,q=s_oSpriteLibrary.getSprite("button_light_0");q=new CLightIndicator(q,t,w,b);q={contacttype:CONTACT_END,callback:this._onCheckPoint,params:q};s_oObjectBuilder.addButton(8,40,t,w,0,0,0,0,q).GetFixtureList().SetSensor(!0);t=936;w=1460;q=s_oSpriteLibrary.getSprite("button_light_0");q=new CLightIndicator(q,t,w,b);q={contacttype:CONTACT_END,
callback:this._onCheckPoint,params:q};s_oObjectBuilder.addButton(8,40,t,w,0,0,0,0,q).GetFixtureList().SetSensor(!0);t=56;w=1460;q=s_oSpriteLibrary.getSprite("button_light_1");q=new CLightIndicator(q,t,w,b);q={contacttype:CONTACT_END,callback:this._onCheckPoint,params:q};t=s_oObjectBuilder.addButton(8,40,t,w,0,0,0,0,q);t.GetFixtureList().SetSensor(!0);t=1016;w=1460;q=s_oSpriteLibrary.getSprite("button_light_1");q=new CLightIndicator(q,t,w,b);q={contacttype:CONTACT_END,callback:this._onCheckPoint,params:q};
s_oObjectBuilder.addButton(8,40,t,w,0,0,0,0,q).GetFixtureList().SetSensor(!0);q={contacttype:CONTACT_END,callback:s_oGame.onBallOut,params:"checkpoint"};t=s_oObjectBuilder.addButton(320,8,520,1900,0,0,0,0,q);t.GetFixtureList().SetSensor(!0)};this._onCheckPoint=function(t){playSound("toggle",1,!1);s_oScoreController.addButtonScore();t.flashing()};this.resetOnExtraBall=function(){e.reset()};this.reset=function(){s_oScoreController.resetJackpot();s_oScoreController.resetMultiplier();s_oScoreController.resetCircleBumperLevel();
h.reset();c.reset();m.reset();k.reset();a.reset();g.reset();e.reset();p.reset()};this.stopLogoAnim=function(){a.stopAnimLogo()};this.blockLaunch=function(){u.block()};this.unblockLaunch=function(){u.unBlock();u.startLighting();a.animLogo()};this.loadSpring=function(){u.loadSpring()};this.releaseSpring=function(){u.releaseSpring()};this.shiftElementsToRight=function(){h.shiftElementsToRight();g.shiftElementsToRight()};this.shiftElementsToLeft=function(){h.shiftElementsToLeft();g.shiftElementsToLeft()};
this.enableShieldBonus=function(){k.activeShieldLight()};this.activeShield=function(){p.enableShield()};this.enableExtraBallBonus=function(){k.activeExtraBallLight()};this.activeExtraBall=function(){s_oGame.setExtraBall()};this.enableJackpot=function(){e.enableJackpot()};this.onJackpotIncreased=function(t){e.setJackpotAmount(t)};this.getTableSize=function(){return{w:d,h:f}};this.getAdjustedPoints=function(t,w,q){for(var x=[],r=0;r<q.length;r++)x[r]={x:l.x+t+q[r].x,y:l.y+w+q[r].y};return x};this.update=
function(){e.update();m.update();a.update()};s_oTable=this;this._init(b,n)}var s_oTable;
(function(b,n){"undefined"===typeof onTileMapLoaded?("undefined"===typeof TileMaps&&(TileMaps={}),TileMaps[b]=n):onTileMapLoaded(b,n);"object"===typeof module&&module&&module.exports&&(module.exports=n)})("levelsettings",{height:1,infinite:!1,layers:[{data:[0],height:1,name:"Livello tile 1",opacity:1,type:"tilelayer",visible:!0,width:1,x:0,y:0},{image:"../sprites/pinball_reference(old).jpg",name:"Livello immagine 1",opacity:.5,type:"imagelayer",visible:!0,x:0,y:0},{draworder:"topdown",name:"edge_frame",
objects:[{height:0,id:32,name:"outer",polyline:[{x:0,y:0},{x:-.333334,y:-1260.334},{x:-4.33334,y:-1320.334},{x:-10.33334,y:-1369.666},{x:-20.3334,y:-1419.666},{x:-33.6666,y:-1459},{x:-50.3334,y:-1496.334},{x:-77.6666,y:-1549},{x:-115,y:-1594.334},{x:-153.6666,y:-1633.666},{x:-210.334,y:-1685},{x:-241.666,y:-1709.666},{x:-295,y:-1735},{x:-345,y:-1755.666},{x:-398.334,y:-1768.334},{x:-451,y:-1776.334},{x:-501,y:-1779},{x:-549,y:-1781},{x:-605,y:-1775},{x:-661,y:-1767},{x:-713,y:-1753},{x:-757,y:-1735},
{x:-811,y:-1711},{x:-857,y:-1683},{x:-899,y:-1651},{x:-949,y:-1607},{x:-989,y:-1563},{x:-1027,y:-1517},{x:-1055,y:-1465},{x:-1075,y:-1411},{x:-1089,y:-1349},{x:-1099,y:-1281},{x:-1098.334,y:-613},{x:-1025.668,y:-541},{x:-1025.666,y:-511.666},{x:-1102.334,y:-434.334},{x:-1103,y:-115},{x:-1093,y:-96.3334},{x:-1082.334,y:-87},{x:-786.334,y:51},{x:-786.334,y:96.3334}],rotation:0,type:"",visible:!0,width:0,x:1127,y:1805},{height:0,id:33,name:"inner",polyline:[{x:53.3334,y:0},{x:0,y:0},{x:-1.333334,y:-1218.666},
{x:-5.33334,y:-1308.666},{x:-24,y:-1405.334},{x:-58,y:-1486.666},{x:-84.6666,y:-1529.334},{x:-106.6666,y:-1552.666},{x:-164,y:-1606},{x:-188,y:-1602.666},{x:-200,y:-1592},{x:-198,y:-1515.334},{x:-188,y:-1503.334},{x:-124.6666,y:-1502.666},{x:-37,y:-1127.666},{x:-48.8334,y:-1090.334},{x:-106.9166,y:-942.25},{x:-110.8126,y:-931.48},{x:-113.7084,y:-921.708},{x:-116.5,y:-911.166},{x:-118.9166,y:-900.834},{x:-121.875,y:-889.916},{x:-123.8334,y:-879},{x:-126.2916,y:-867.25},{x:-128.25,y:-856},{x:-129.6666,
y:-842.5},{x:-128.6666,y:-584},{x:-123.3334,y:-568.666},{x:-11.33334,y:-452},{x:-11.33334,y:-157.3334},{x:-22,y:-121.3334},{x:-36.6666,y:-103.3334},{x:-360,y:46},{x:-359.334,y:95.3334}],rotation:0,type:"",visible:!0,width:0,x:1060,y:1805.334}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",name:"left_router",objects:[{height:0,id:50,name:"router_head",polyline:[{x:0,y:0},{x:50,y:14},{x:48,y:88}],rotation:0,type:"",visible:!0,width:0,x:290,y:198},{height:0,id:53,name:"router_tail",
polyline:[{x:181,y:0},{x:131,y:44},{x:91,y:88},{x:53,y:134},{x:25,y:186},{x:5,y:240},{x:0,y:291},{x:9,y:339},{x:34.6666,y:403.666},{x:43.3334,y:380.334},{x:51.3334,y:359},{x:62.6666,y:332.334},{x:78,y:302.334},{x:94,y:274.334},{x:116,y:244.334},{x:148.6666,y:201.666},{x:185.3334,y:156},{x:229.334,y:89.3334}],rotation:0,type:"",visible:!0,width:0,x:108,y:198},{height:0,id:95,name:"fork_right",polyline:[{x:33,y:-37},{x:32,y:-18},{x:31,y:2},{x:31,y:32},{x:31,y:56},{x:31,y:86},{x:31,y:111},{x:30,y:145},
{x:30,y:181},{x:31,y:211},{x:42,y:244},{x:63,y:274},{x:103,y:313},{x:123.6666,y:338.334},{x:144,y:368.666},{x:160.6668,y:394.666},{x:172.6668,y:423.666},{x:177.3334,y:449},{x:175.3334,y:473.334},{x:167.6666,y:506.666},{x:161.6668,y:474.334},{x:144.6666,y:437.334},{x:125,y:408.334},{x:102.6666,y:381.666},{x:84,y:362},{x:60,y:339},{x:37,y:317},{x:15,y:295},{x:-8,y:267},{x:-16,y:242},{x:-20,y:208},{x:-19,y:182},{x:-21,y:146},{x:-20,y:118},{x:-20,y:89},{x:-20,y:58},{x:-16,y:-39}],rotation:0,type:"",visible:!0,
width:0,x:419,y:337},{height:0,id:96,name:"fork_left",polyline:[{x:0,y:0},{x:-3,y:18},{x:-11,y:30},{x:-20,y:40},{x:-30,y:61},{x:-42,y:80},{x:-53,y:99},{x:-64,y:113},{x:-79,y:130},{x:-94,y:150},{x:-113,y:176},{x:-127,y:197},{x:-139,y:219},{x:-149,y:236},{x:-160,y:256},{x:-173,y:280},{x:-188,y:308},{x:-204.5,y:338.5},{x:-218,y:370.334},{x:-228.334,y:406.666},{x:-227.668,y:435},{x:-225,y:456.666},{x:-219.334,y:474.5},{x:-209.5,y:494.668},{x:-181,y:529},{x:-186,y:503},{x:-185,y:463.332},{x:-177,y:434.332},
{x:-167.3332,y:408.334},{x:-150.3334,y:372},{x:-129,y:334.666},{x:-111.2552,y:305.252},{x:-93,y:279},{x:-75,y:251},{x:-65,y:231},{x:-54,y:201},{x:-34,y:173},{x:-23,y:149},{x:-4,y:126},{x:11,y:110},{x:31,y:84},{x:37,y:71},{x:47,y:44},{x:48,y:20},{x:50,y:4}],rotation:0,type:"",visible:!0,width:0,x:401,y:313},{height:0,id:97,name:"curve_top",polyline:[{x:-8,y:-5},{x:10,y:-33},{x:23,y:-45},{x:35,y:-52},{x:45,y:-55},{x:60,y:-58},{x:74,y:-56},{x:86,y:-49},{x:97,y:-41},{x:106,y:-30},{x:115,y:-20},{x:125,
y:-6}],rotation:0,type:"",visible:!0,width:0,x:298,y:625},{height:0,id:100,name:"curve_bot",polyline:[{x:28,y:-60},{x:26,y:-83},{x:34,y:-108},{x:43,y:-130},{x:51,y:-148},{x:59,y:-165},{x:68,y:-177},{x:76,y:-183},{x:85,y:-186},{x:94,y:-188},{x:104.75,y:-186.25},{x:116,y:-181},{x:126,y:-173},{x:140,y:-158},{x:151,y:-146},{x:164,y:-134},{x:176,y:-119},{x:190,y:-102},{x:202,y:-87},{x:208.666,y:-78.3334},{x:212,y:-67},{x:208,y:-59},{x:191,y:-55},{x:38,y:-59}],rotation:0,type:"",visible:!0,width:0,x:269,
y:856}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",name:"Livello di oggetti 10",objects:[{height:1920,id:120,name:"",rotation:0,type:"",visible:!0,width:1152,x:0,y:0}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",name:"centersafe",objects:[{ellipse:!0,height:20,id:115,name:"center",rotation:0,type:"",visible:!0,width:20,x:520,y:1862}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",name:"top_channellers",objects:[{height:0,
id:56,name:"4",polygon:[{x:0,y:0},{x:10,y:-2},{x:20,y:0},{x:30,y:6},{x:36,y:16},{x:36,y:90},{x:32,y:98},{x:22,y:106},{x:2,y:106},{x:-6,y:102},{x:-14,y:90},{x:-14,y:18},{x:-8,y:8}],rotation:0,type:"",visible:!0,width:0,x:760,y:228},{height:0,id:57,name:"3",polygon:[{x:0,y:0},{x:10,y:-2},{x:20,y:0},{x:30,y:6},{x:36,y:16},{x:36,y:90},{x:32,y:98},{x:22,y:106},{x:2,y:106},{x:-6,y:102},{x:-14,y:90},{x:-14,y:18},{x:-8,y:8}],rotation:0,type:"",visible:!0,width:0,x:644,y:252},{height:0,id:58,name:"2",polygon:[{x:0,
y:0},{x:10,y:-2},{x:20,y:0},{x:30,y:6},{x:36,y:16},{x:36,y:90},{x:32,y:98},{x:22,y:106},{x:2,y:106},{x:-6,y:102},{x:-14,y:90},{x:-14,y:18},{x:-8,y:8}],rotation:0,type:"",visible:!0,width:0,x:528,y:252},{height:0,id:59,name:"1",polygon:[{x:0,y:0},{x:10,y:-2},{x:20,y:0},{x:25,y:3},{x:30,y:6},{x:36,y:16},{x:36,y:90},{x:32,y:98},{x:22,y:106},{x:2,y:106},{x:-6,y:102},{x:-14,y:90},{x:-14,y:18},{x:-8,y:8}],rotation:0,type:"",visible:!0,width:0,x:416,y:228}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},
{draworder:"topdown",name:"bot_channellers",objects:[{height:0,id:79,name:"vertical_right",polygon:[{x:-2,y:0},{x:8,y:0},{x:10,y:196},{x:6,y:202},{x:0,y:206},{x:-4,y:202},{x:-6,y:196},{x:-6,y:192}],rotation:0,type:"",visible:!0,width:0,x:978,y:1402},{height:0,id:80,name:"horizontal_right",polygon:[{x:0,y:0},{x:8,y:14},{x:-224,y:122},{x:-236,y:86}],rotation:0,type:"",visible:!0,width:0,x:972,y:1592},{height:0,id:83,name:"vertical_left",polygon:[{x:-2,y:0},{x:8,y:0},{x:10,y:196},{x:6,y:202},{x:0,y:206},
{x:-4,y:202},{x:-6,y:196},{x:-6,y:192}],rotation:0,type:"",visible:!0,width:0,x:92,y:1406},{height:0,id:84,name:"horizontal_left",polygon:[{x:0,y:0},{x:222,y:84},{x:204,y:120},{x:-4,y:20}],rotation:0,type:"",visible:!0,width:0,x:96,y:1592},{ellipse:!0,height:20,id:85,name:"head_left",rotation:0,type:"",visible:!0,width:20,x:86,y:1392},{ellipse:!0,height:20,id:87,name:"head_right",rotation:0,type:"",visible:!0,width:20,x:972,y:1386}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",
name:"flipper_bumper",objects:[{height:0,id:88,name:"right",polygon:[{x:2.41666,y:-9.91666},{x:0,y:200},{x:-96,y:236},{x:-126,y:216},{x:-42.1212,y:12.18184},{x:-36.6666,y:2},{x:-29.1818,y:-7.0227},{x:-21.5152,y:-14.8636},{x:-11.72726,y:-23.197},{x:2.14396,y:-29.7348}],rotation:0,type:"",visible:!0,width:0,x:904,y:1348},{height:0,id:89,name:"left",polygon:[{x:0,y:0},{x:90,y:210},{x:68,y:232},{x:-36,y:192},{x:-33.3334,y:-7.33334},{x:-32.7272,y:-34.0606},{x:-23.6666,y:-27.697},{x:-16.33332,y:-20.6666},
{x:-7.66666,y:-10}],rotation:0,type:"",visible:!0,width:0,x:210,y:1354}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",name:"right_channeller",objects:[{height:0,id:90,name:"channeller",polygon:[{x:69.909,y:-156.1666},{x:73.5758,y:-145.1666},{x:76.7424,y:-132.8334},{x:77.2424,y:-121.5},{x:-38,y:128.8334},{x:-44.6666,y:129.5},{x:-53.3334,y:128.8334},{x:-62.6666,y:124.1666},{x:-68.1818,y:115.1364},{x:-68.6666,y:105.5},{x:-67.2728,y:97.1364},{x:52.909,y:-155.1666},{x:62.409,y:-173.6666}],
rotation:0,type:"",visible:!0,width:0,x:924,y:691.334}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",name:"circle_bumper",objects:[{ellipse:!0,height:120,id:94,name:"3",rotation:0,type:"",visible:!0,width:120,x:739.334,y:422.666},{ellipse:!0,height:120,id:91,name:"2",rotation:0,type:"",visible:!0,width:120,x:678,y:608},{ellipse:!0,height:120,id:93,name:"1",rotation:0,type:"",visible:!0,width:120,x:517.334,y:467.334}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",
name:"flipper",objects:[{height:0,id:113,name:"right",polygon:[{x:0,y:0},{x:-144,y:55.3334},{x:-150.6666,y:53.3334},{x:-154.5,y:49.5834},{x:-156.6666,y:46},{x:-158.6666,y:41.3334},{x:-159.25,y:35.5},{x:-158.0834,y:30.6666},{x:-153.5,y:26.4166},{x:-20.5834,y:-44.5834},{x:-13.83334,y:-46.1666},{x:-8,y:-45.3334},{x:-2,y:-42.6666},{x:2,y:-39.3334},{x:5.33334,y:-32.6666},{x:8.83334,y:-24.5834},{x:9.33334,y:-14.66666},{x:6.66666,y:-6.66666}],rotation:0,type:"",visible:!0,width:0,x:735.334,y:1730},{height:0,
id:114,name:"left",polygon:[{x:0,y:9.1668},{x:-144,y:-46.1666},{x:-150.6666,y:-44.1666},{x:-154.5,y:-40.4166},{x:-156.6666,y:-36.8332},{x:-158.6666,y:-32.1666},{x:-159.25,y:-26.3332},{x:-158.0834,y:-21.4998},{x:-153.5,y:-17.2498},{x:-20.5834,y:53.7502},{x:-13.83334,y:55.3334},{x:-8,y:54.5002},{x:-2,y:51.8334},{x:2,y:48.5002},{x:5.33334,y:41.8334},{x:8.83334,y:33.7502},{x:9.33334,y:23.8334},{x:6.66666,y:15.83346}],rotation:180,type:"",visible:!0,width:0,x:315.584,y:1735.666}],opacity:1,type:"objectgroup",
visible:!0,x:0,y:0}],nextobjectid:122,orientation:"orthogonal",renderorder:"right-down",tiledversion:"2018.03.21",tileheight:960,tilesets:[],tilewidth:576,type:"map",version:1.2,width:1});
function CButtonSystem(){var b,n,d,f,l,h,c,k;this._init=function(){b=!0;d=n=!1;l=[];f=[];h=[]};this.setAutoReset=function(a){b=a};this.setReturn=function(a){n=a};this.restart=function(){d=!1;for(var a=0;a<f.length;a++)f[a]=!1,l[a].SetActive(!0),h[a].flashing()};this.reset=function(){d=!1;for(var a=0;a<f.length;a++)f[a]=!1,l[a].SetActive(!0),h[a].slowOff(500,100*(f.length-a-1))};this.addButton=function(a,g,e,p,u,t,w,q,x){l.push(s_oObjectBuilder.addButton(a,g,e,p,u,0,1,.8,{contacttype:CONTACT_BEGIN,
callback:this._buttonHit,params:l.length}));f.push(!1);a=new CLightIndicator(t,e+w,p+q,x);a.rotate(u);h.push(a)};this.flipButtonX=function(){for(var a=0;a<l.length;a++)h[a].flipX()};this.setResititution=function(a){for(var g=0;g<l.length;g++)l[g].GetFixtureList().SetRestitution(a)};this._buttonHit=function(a){f[a]?playSound("pinball_button_off",1,!1):playSound("pinball_button_on",1,!1);f[a]=!0;var g=l[a];n&&s_oPhysicsController.disableBody(g);h[a].lit(!0);k&&k();m.checkTriggerEvent()};this.addSingleButtonListener=
function(a){k=a};this.addAllButtonHitListener=function(a){c=a};this.checkTriggerEvent=function(){for(var a=0;a<f.length;a++)if(!f[a]||d)return;d=!0;if(b){d=!1;for(a=0;a<f.length;a++)h[a].flashing(),f[a]=!1;setTimeout(function(){for(var g=0;g<f.length;g++)l[g].SetActive(!0)},500)}playSound("all_lights_on_1",1,!1);c&&c()};var m=this;this._init()}
function CToggleSystem(){var b,n,d,f,l;this._init=function(){n=[];b=[];d=[]};this.restart=function(){for(var c=0;c<b.length;c++)b[c]=!1,d[c].flashing()};this.reset=function(){for(var c=0;c<b.length;c++)b[c]=!1,d[c].slowOff(500,100*(b.length-c-1))};this.addButton=function(c,k,m,a,g,e,p,u,t,w){n.push(s_oObjectBuilder.addButton(c,k,m,a,g,0,1,1,{contacttype:CONTACT_BEGIN,callback:this._buttonHit,params:n.length}));n[n.length-1].GetFixtureList().SetSensor(!0);b.push(!1);c=new CLightIndicator(e,m+p,a+u,
t);c.addText(w,0,0,40,"#000000");d.push(c)};this._buttonHit=function(c){b[c]=!0;playSound("toggle",1,!1);d[c].lit(b[c]);l&&l(c);h.checkTriggerEvent()};this.addSingleButtonListener=function(c){l=c};this.addAllButtonHitListener=function(c){f=c};this.shiftRight=function(){var c=b.pop();b.unshift(c);for(c=0;c<d.length;c++)d[c].lit(b[c])};this.shiftLeft=function(){var c=b.shift();b.push(c);for(c=0;c<d.length;c++)d[c].lit(b[c])};this.checkTriggerEvent=function(){for(var c=0;c<b.length;c++)if(!b[c])return;
h.restart();playSound("all_lights_on_2",1,!1);f&&f()};var h=this;this._init()}
function CHoleSystem(b,n,d){var f,l,h;this._init=function(k,m,a){l=s_oObjectBuilder.addStaticCircle(1,k,m,0,0,0,{contacttype:CONTACT_BEGIN,callback:this._holeHit,params:"hole_enabled"});l.GetBody().GetFixtureList().SetSensor(!0)};this.addHoleEventListener=function(k){f=k};this.setLaunchImpulse=function(k,m){h={x:k,y:m}};this._disableHole=function(){l.SetUserData({contacttype:CONTACT_BEGIN,callback:c._wakeUpHole,params:"hole_disabled"})};this._wakeUpHole=function(){l.SetUserData({contacttype:CONTACT_END,
callback:c._enableHole,params:"hole_wake"})};this._enableHole=function(){l.SetUserData({contacttype:CONTACT_BEGIN,callback:c._holeHit,params:"hole_enabled"})};this._releaseBall=function(k){k.SetActive(!0);h&&(c._enableHole(),k.ApplyImpulse(h,k.GetPosition()))};this._centerBallInHole=function(k){c._disableHole();k.SetLinearVelocity({x:0,y:0});k.SetAngularVelocity(0);s_oPhysicsController.disableBody(k,{x:b,y:n});playSound("in_hole",1,!1);setTimeout(function(){playSound("out_hole",1,!1);c._releaseBall(k)},
d)};this._getBall=function(k){var m=k.GetFixtureA().GetUserData(),a=k.GetFixtureB().GetUserData(),g;m.id&&"ball"===m.id&&(g=k.GetFixtureA().GetBody());a.id&&"ball"===a.id&&(g=k.GetFixtureB().GetBody());return g};this._holeHit=function(k,m){var a=c._getBall(m);c._centerBallInHole(a);f&&f()};this.getHole=function(){return l.GetBody()};var c=this;this._init(b,n,d)}var GATE_LISTENER_STATE_CLOSED=0,GATE_LISTENER_STATE_OPEN=1;
function CGateSystem(b,n){var d,f,l,h;this._init=function(k,m){f=d=null};this.addGate=function(k,m,a){h=s_oObjectBuilder.addButton(k,m,b,n,a,0,1,.4)};this.addSprite=function(k,m,a,g,e){k=createBitmap(k);k.x=b;k.y=n;k.regX=e;k.regY=g;k.rotation=a;m.addChild(k)};this.addOpener=function(k,m,a,g,e){s_oObjectBuilder.addStaticCircle(a,b+k,n+m,0,0,0,{contacttype:CONTACT_BEGIN,callback:this._openGate,params:{openingid:g,gateid:e}}).GetBody().GetFixtureList().SetSensor(!0)};this.addCloser=function(k,m,a,g,
e){s_oObjectBuilder.addStaticCircle(a,b+k,n+m,0,0,0,{contacttype:CONTACT_BEGIN,callback:this._closeGate,params:{openingid:g,gateid:e}}).GetBody().GetFixtureList().SetSensor(!0)};this.addPassingGateListener=function(k){l=k};this.setRestitution=function(k){h.GetFixtureList().SetRestitution(k)};this._openGate=function(k){d=k.openingid;null===f&&(f=k.gateid);f!==k.gateid&&c._gatePassedCorrectly();s_oPhysicsController.disableBody(h)};this._closeGate=function(k){d===k.openingid&&c._gatePassedCorrectly();
f=d=null;h.SetActive(!0)};this._gatePassedCorrectly=function(){l&&l(f);playSound("gate",1,!1);f=d=null};var c=this;this._init(b,n)}var SINGLE_BUTTON_SCORE=50,CIRCLE_BUMPER_SCORE=[10,20,50,100,200,500,1E3],GATE_SCORE=100,ROUTER_GATE_SCORE=[50,100,200,500,1E3,2E3,5E3],MULTIPLIER_TOGGLE_SCORE=100,HOLE_BONUS_SCORE=[1E3,5E3,1E4,5E4,1E5,5E5,1E6],HOLE_STANDARD_SCORE=500,SINGLE_LETTERS_LIT_SCORE=5E4,ALL_LETTERS_LIT_SCORE=5E6,JUMPER_SCORE=500,ALL_JUMPER_BUTTONS_SCORE=5E3;
function CSCoreController(){var b,n,d,f,l,h,c,k;this._init=function(){b=[];n=[];d=0;f=1;c=h=l=0;k=-1};this._increaseJackpot=function(m){l+=Math.floor(m*SCORE_RATIO_TO_ADD_AT_JACKPOT);b[ON_INCREASE_JACKPOT]&&b[ON_INCREASE_JACKPOT].call(n[ON_INCREASE_JACKPOT],l)};this._addScore=function(m){d+=m;s_oScoreController._increaseJackpot(m);b[ON_INCREASE_SCORE]&&b[ON_INCREASE_SCORE].call(n[ON_INCREASE_SCORE],d)};this.resetScore=function(){d=0;s_oScoreController._addScore(0)};this.getScore=function(){return d};
this.addEventListener=function(m,a,g){b[m]=a;n[m]=g};this.resetCircleBumperLevel=function(){h=0};this.resetJackpot=function(){l=0;b[ON_INCREASE_JACKPOT]&&b[ON_INCREASE_JACKPOT].call(n[ON_INCREASE_JACKPOT],l)};this.resetMultiplier=function(){f=1};this.getJackpotAmount=function(){return l};this.addButtonScore=function(){s_oScoreController._addScore(SINGLE_BUTTON_SCORE*f)};this.increaseCircleBumperLevel=function(){h++;h===CIRCLE_BUMPER_SCORE.length&&(h=CIRCLE_BUMPER_SCORE.length-1)};this.getBumperValue=
function(){return CIRCLE_BUMPER_SCORE[h]};this.addCircleBumperScore=function(){s_oScoreController._addScore(CIRCLE_BUMPER_SCORE[h]*f)};this.addGateScore=function(){s_oScoreController._addScore(GATE_SCORE*f)};this.addRouterScore=function(){s_oScoreController._addScore(ROUTER_GATE_SCORE[c]*f)};this.increaseRouterLevel=function(){c++;c===ROUTER_GATE_SCORE.length&&(c=ROUTER_GATE_SCORE.length-1)};this.decreaseRouterLevel=function(){c--;0>c&&(c=0)};this.getCurRouterLevel=function(){return c};this.resetRouterLevel=
function(){c=0};this.addMultiplierToggleScore=function(){s_oScoreController._addScore(MULTIPLIER_TOGGLE_SCORE*f)};this.addTotalMultiplierToggleScore=function(){s_oScoreController._addScore(10*MULTIPLIER_TOGGLE_SCORE*f)};this.increaseMultiplier=function(){f++;f>=MAX_MULTIPLIER&&(f=MAX_MULTIPLIER)};this.getCurMultiplier=function(){return f};this.addTotalHoleButtonScore=function(){s_oScoreController._addScore(10*SINGLE_BUTTON_SCORE*f)};this.addStandardHoleScore=function(){s_oScoreController._addScore(HOLE_STANDARD_SCORE*
f)};this.addHoleScoreBonus=function(){s_oScoreController._addScore(HOLE_BONUS_SCORE[k]*f)};this.increaseHoleBonusLevel=function(){k++};this.decreaseHoleBonusLevel=function(){k--};this.resetHoleBonusLevel=function(){k=-1};this.getCurHoleBonusLevel=function(){return k};this.addSingleLettersScore=function(){s_oScoreController._addScore(SINGLE_LETTERS_LIT_SCORE*f)};this.addAllLettersScore=function(){s_oScoreController._addScore(ALL_LETTERS_LIT_SCORE*f)};this.addAllJumperButtonsScore=function(){s_oScoreController._addScore(ALL_JUMPER_BUTTONS_SCORE*
f)};this.addJumperScore=function(){s_oScoreController._addScore(JUMPER_SCORE*f)};this.addJackpotScore=function(){s_oScoreController._addScore(l)};s_oScoreController=this;this._init()}var s_oScoreController;
function CLightIndicator(b,n,d,f){var l,h,c,k;this._init=function(m,a,g,e){l=new createjs.Container;l.x=a;l.y=g;e.addChild(l);a=new createjs.SpriteSheet({images:[m],frames:{width:m.width/2,height:m.height,regX:m.width/2/2,regY:m.height/2},animations:{state_true:[0],state_false:[1]}});c=createSprite(a,"state_false",m.width/2/2,m.height/2,m.width/2,m.height);l.addChild(c);h=createSprite(a,"state_true",m.width/2/2,m.height/2,m.width/2,m.height);h.alpha=0;l.addChild(h)};this.unload=function(){createjs.Tween.removeTweens(h);
f.removeChild(h)};this.lit=function(m){createjs.Tween.removeTweens(h);h.alpha=m?1:0};this.slowOn=function(m,a){createjs.Tween.get(h,{override:!0}).wait(a).to({alpha:1},m)};this.highlight=function(m){h.alpha=0;createjs.Tween.get(h,{override:!0,loop:!0}).to({alpha:1},m/3).wait(m/3).to({alpha:0},m/3)};this.slowHighlight=function(m,a,g){h.alpha=0;createjs.Tween.get(h,{override:!0}).wait(a).to({alpha:1},m/3).wait(m/3).to({alpha:0},m/3).call(function(){g()})};this.slowOff=function(m,a){createjs.Tween.get(h,
{override:!0}).wait(a).to({alpha:0},m)};this.flashing=function(){createjs.Tween.get(h,{override:!0}).to({alpha:0},100).to({alpha:1},100).to({alpha:0},100).to({alpha:1},100).to({alpha:0},100).to({alpha:1},100).to({alpha:0},100)};this.addPreciseText=function(m,a,g,e,p,u,t){k=(new CTLText(l,a-u/2,g-t/2,u,t,e,"center",p,PRIMARY_FONT,1.3,2,2,m,!0,!0,!0,!1)).getText()};this.addText=function(m,a,g,e,p){k=new createjs.Text(m,e+"px "+PRIMARY_FONT,p);k.x=a;k.y=g;k.textAlign="center";k.textBaseline="middle";
k.lineWidth=200;l.addChild(k);k.cache(-l.getBounds().width/2,-l.getBounds().height/2,l.getBounds().width,l.getBounds().height)};this.setText=function(m){k.text=m;k.updateCache()};this.textRotate=function(m){k.rotation=m};this.rotate=function(m){l.rotation=m};this.scale=function(m){l.scaleX=l.scaleY=m};this.flipX=function(){l.scaleX=-1};this._init(b,n,d,f)}
function CModuleMultiplier(b,n){var d,f,l;this._init=function(c,k){this._addCapsule();this._addToggle();this._addMultiplierIndicator()};this._addCapsule=function(){d=[];var c=s_oSpriteLibrary.getSprite("capsule_0");c=new CLightIndicator(c,428,286,n);d.push(c);c=s_oSpriteLibrary.getSprite("capsule_1");c=new CLightIndicator(c,540,312,n);d.push(c);c=s_oSpriteLibrary.getSprite("capsule_2");c=new CLightIndicator(c,656,312,n);d.push(c);c=s_oSpriteLibrary.getSprite("capsule_3");c=new CLightIndicator(c,770,
286,n);d.push(c)};this._addToggle=function(){var c=s_oSpriteLibrary.getSprite("multiplier_toggle_light");l=new CToggleSystem;l.addButton(4,8,380,280,0,c,0,-80,b,TEXT_MULTI[0]);l.addButton(4,8,490,304,0,c,0,-80,b,TEXT_MULTI[1]);l.addButton(4,8,600,320,0,c,0,-80,b,TEXT_MULTI[2]);l.addButton(4,8,710,304,0,c,0,-80,b,TEXT_MULTI[3]);l.addButton(4,8,820,280,0,c,0,-80,b,TEXT_MULTI[4]);l.addAllButtonHitListener(this._onAllLightOn);l.addSingleButtonListener(this._onToggle)};this._onToggle=function(c){s_oScoreController.addMultiplierToggleScore();
h._radialAnim(c)};this._onAllLightOn=function(){s_oScoreController.increaseMultiplier();s_oScoreController.addTotalMultiplierToggleScore();for(var c=s_oScoreController.getCurMultiplier(),k=2;k<=MAX_MULTIPLIER;k++)f[k].lit(!1);f[c].lit(!0)};this._addMultiplierIndicator=function(){f=[];var c=new createjs.Container;c.x=526;c.y=1680;b.addChild(c);var k=Math.floor((MAX_MULTIPLIER-1)/2),m=2,a=new createjs.Container;a.x=-440;c.addChild(a);for(var g=0;g<k;g++){var e=s_oSpriteLibrary.getSprite("multiplier_light");
e=new CLightIndicator(e,112*g,54*g,a);e.addText("x"+m,0,0,50,"#8416ff");e.rotate(25);f[m]=e;m++}a=new createjs.Container;a.x=430;c.addChild(a);for(g=0;g<k;g++)e=s_oSpriteLibrary.getSprite("multiplier_light"),e=new CLightIndicator(e,112*-g,54*g,a),e.addText("x"+m,0,0,50,"#8416ff"),e.rotate(-25),f[m]=e,m++;m===MAX_MULTIPLIER&&(e=s_oSpriteLibrary.getSprite("multiplier_light"),e=new CLightIndicator(e,0,160,c),e.addText("x"+m,0,0,50,"#8416ff"),f[m]=e)};this._radialAnim=function(c){for(var k=0,m=c;m<d.length;m++)d[m].slowHighlight(500,
150*k,function(){}),k++;if(0<c)for(k=0,m=c-1;0<=m;m--)d[m].slowHighlight(500,150*k,function(){}),k++};this.reset=function(){l.reset();f.forEach(function(c){c.lit(!1)})};this.shiftElementsToRight=function(){l.shiftRight()};this.shiftElementsToLeft=function(){l.shiftLeft()};var h=this;this._init(b,n)}
function CModuleBumper(b,n){var d,f,l,h,c,k;this._init=function(m,a){this._addLinearBumper();this._addCircularBumperSystemButton()};this.buildFlipperBumper=function(m){for(var a=0;a<m.length;a++){var g=m[a];g=s_oTable.getAdjustedPoints(g.x,g.y,g.polygon);s_oObjectBuilder.addPolygon(g,0,1,.7,.3)}a=s_oSpriteLibrary.getSprite("flipper_bumper");m={images:[a],frames:{width:a.width/2,height:a.height,regX:a.width/2/2,regY:a.height/2},animations:{state_true:[0],state_false:[1]}};m=new createjs.SpriteSheet(m);
c=createSprite(m,"state_false",a.width/2/2,a.height/2,a.width/2,a.height);c.x=840;c.y=1460;b.addChild(c);k=createSprite(m,"state_false",a.width/2/2,a.height/2,a.width/2,a.height);k.x=240;k.y=1460;k.scaleX=-1;b.addChild(k)};this._addLinearBumper=function(){var m={contacttype:CONTACT_BEGIN,callback:this._leftFlipperBumperCollision,params:"bumper"};m=s_oObjectBuilder.addButton(220,12,252,1460,66.7,0,0,0,m);m.GetFixtureList().SetSensor(!0);m={contacttype:CONTACT_BEGIN,callback:this._rightFlipperBumperCollision,
params:"bumper"};m=s_oObjectBuilder.addButton(220,12,824,1460,-69,0,0,0,m);m.GetFixtureList().SetSensor(!0)};this._leftFlipperBumperCollision=function(m,a){var g=new Box2D.Common.Math.b2Vec2(-.4,.5),e=a.GetFixtureA().GetUserData(),p=a.GetFixtureB().GetUserData(),u;e.id&&"ball"===e.id&&(u=a.GetFixtureA().GetBody());p.id&&"ball"===p.id&&(u=a.GetFixtureB().GetBody());u.SetLinearVelocity({x:0,y:0});u.SetAngularVelocity(0);g.Multiply(20*-u.GetMass());u.ApplyImpulse(g,u.GetPosition());k.gotoAndStop("state_true");
setTimeout(function(){k.gotoAndStop("state_false")},100);playSound("bumper",1,!1);s_oScoreController.addButtonScore()};this._rightFlipperBumperCollision=function(m,a){var g=new Box2D.Common.Math.b2Vec2(.4,.5),e=a.GetFixtureA().GetUserData(),p=a.GetFixtureB().GetUserData(),u;e.id&&"ball"===e.id&&(u=a.GetFixtureA().GetBody());p.id&&"ball"===p.id&&(u=a.GetFixtureB().GetBody());u.SetLinearVelocity({x:0,y:0});u.SetAngularVelocity(0);g.Multiply(20*-u.GetMass());u.ApplyImpulse(g,u.GetPosition());c.gotoAndStop("state_true");
setTimeout(function(){c.gotoAndStop("state_false")},100);playSound("bumper",1,!1);s_oScoreController.addButtonScore()};this.buildCircularBumper=function(m){l=new createjs.Text(s_oScoreController.getBumperValue(),"40px "+PRIMARY_FONT,"#c6c6c6");l.x=694;l.y=570;l.rotation=-25;l.textAlign="center";l.textBaseline="middle";l.lineWidth=200;l.outline=3;b.addChild(l);f=new createjs.Text(s_oScoreController.getBumperValue(),"40px "+PRIMARY_FONT,"#88028b");f.x=694;f.y=570;f.rotation=-25;f.textAlign="center";
f.textBaseline="middle";f.lineWidth=200;b.addChild(f);d=[];for(var a=0;a<m.length;a++){var g=m[a],e=s_oTable.getAdjustedPoints(0,0,[{x:g.x,y:g.y}]);this._addCircularBumper(g.width/2,e[0].x+g.width/2,e[0].y+g.width/2,a)}};this._addCircularBumper=function(m,a,g,e){s_oObjectBuilder.addStaticCircle(m,a,g,0,0,0,{contacttype:CONTACT_BEGIN,callback:this._circularBumperCollision,params:e});d[e]=new createjs.Container;d[e].x=a;d[e].y=g;n.addChild(d[e]);g=s_oSpriteLibrary.getSprite("bumper");m=g.width/7;a=
g.height/2;g=new createjs.SpriteSheet({images:[g],frames:{width:m,height:a,regX:m/2,regY:a/2},animations:{idle:[0],hit:[0,13,"idle"]}});m=createSprite(g,"hit",m/2,a/2,m,a);d[e].addChild(m)};this._circularBumperCollision=function(m,a){d[m].scaleX=.9;d[m].scaleY=.9;d[m].children[0].gotoAndPlay("hit");createjs.Tween.get(d[m],{override:!0}).to({scaleX:1,scaleY:1},.1);var g=new Box2D.Collision.b2WorldManifold;a.GetWorldManifold(g);g=g.m_normal;var e=a.GetFixtureA().GetUserData(),p=a.GetFixtureB().GetUserData(),
u;e.id&&"ball"===e.id&&(u=a.GetFixtureA().GetBody());p.id&&"ball"===p.id&&(u=a.GetFixtureB().GetBody());u.SetLinearVelocity({x:0,y:0});u.SetAngularVelocity(0);g.Multiply(14*-u.GetMass());u.ApplyImpulse(g,u.GetPosition());playSound("bumper",1,!1);s_oScoreController.addCircleBumperScore()};this._addCircularBumperSystemButton=function(){h=new CButtonSystem;for(var m=s_oSpriteLibrary.getSprite("bumper_button"),a=0;3>a;a++)h.addButton(8,60,930+18*a,340+70*a,-13,m,0,0,b);h.setReturn(!0);h.addAllButtonHitListener(this._onBumperLevelUp);
h.addSingleButtonListener(s_oScoreController.addButtonScore)};this._onBumperLevelUp=function(){s_oScoreController.increaseCircleBumperLevel();f.text=s_oScoreController.getBumperValue();l.text=s_oScoreController.getBumperValue();for(var m=f.getBounds().width,a=40;80<=m;)a--,f.font=" "+a+"px "+PRIMARY_FONT,l.font=" "+a+"px "+PRIMARY_FONT,m=f.getBounds().width};this.reset=function(){h.reset();f.font=" 40px "+PRIMARY_FONT;f.text=s_oScoreController.getBumperValue();l.font=" 40px "+PRIMARY_FONT;l.text=
s_oScoreController.getBumperValue()};this._init(b,n)}
function CModuleHole(b,n){var d,f,l,h,c,k,m;this._init=function(g,e){l=f=d=!1;this._addHole();this._addRightSystemButton();this._addLabels()};this._addHole=function(){var g=new CHoleSystem(988,680,1E3);g.addHoleEventListener(this._onHole);g.setLaunchImpulse(0,.8);g=s_oSpriteLibrary.getSprite("hole");g=createBitmap(g);g.x=932;g.y=600;n.addChild(g)};this._addRightSystemButton=function(){m=new CButtonSystem;for(var g=2,e=0;4>e;e++){var p=s_oSpriteLibrary.getSprite("button_light_"+g);m.addButton(8,56,
924,980+68*e,0,p,-52,0,b);p=s_oSpriteLibrary.getSprite("bumper_button");new CLightIndicator(p,918,980+68*e,b);g++}m.addAllButtonHitListener(this._onAllButtonActive);m.addSingleButtonListener(s_oScoreController.addButtonScore)};this._onAllButtonActive=function(){s_oScoreController.addTotalHoleButtonScore();if(!d){d=!0;s_oScoreController.increaseHoleBonusLevel();var g=s_oScoreController.getCurHoleBonusLevel();h[g].highlight(2E3)}};this._onHole=function(){m.reset();if(d){d=!1;s_oScoreController.addHoleScoreBonus();
var g=s_oScoreController.getCurHoleBonusLevel();h[g].lit(!0);g===HOLE_BONUS_SCORE.length-1&&a.reset()}else s_oScoreController.addStandardHoleScore();l&&(playSound("bonus_win_1",1,!1),a._activeExtraBall());f&&(playSound("bonus_win_1",1,!1),a._activeShield())};this._activeShield=function(){a.disableShieldLight();s_oTable.activeShield()};this._activeExtraBall=function(){a.disableExtraBallLight();s_oTable.activeExtraBall()};this._addLabels=function(){h=[];var g=0,e=s_oSpriteLibrary.getSprite("light_indicator_0");
e=new CLightIndicator(e,1008,880,b);e.addText(TEXT_HOLE_VALUE[g],0,0,46,"#f68eff");e.textRotate(-20);e.scale(.68);g++;h.push(e);e=s_oSpriteLibrary.getSprite("light_indicator_0");e=new CLightIndicator(e,1008,940,b);e.addText(TEXT_HOLE_VALUE[g],0,0,46,"#f68eff");e.textRotate(-20);e.scale(.68);g++;h.push(e);e=s_oSpriteLibrary.getSprite("light_indicator_0");e=new CLightIndicator(e,1008,1E3,b);e.addText(TEXT_HOLE_VALUE[g],0,0,36,"#f68eff");e.textRotate(-20);e.scale(.68);g++;h.push(e);e=s_oSpriteLibrary.getSprite("light_indicator_0");
e=new CLightIndicator(e,1008,1060,b);e.addText(TEXT_HOLE_VALUE[g],0,0,34,"#f68eff");e.textRotate(-20);e.scale(.68);g++;h.push(e);e=s_oSpriteLibrary.getSprite("light_indicator_0");e=new CLightIndicator(e,1008,1120,b);e.addText(TEXT_HOLE_VALUE[g],0,0,26,"#f68eff");e.textRotate(-20);e.scale(.68);g++;h.push(e);e=s_oSpriteLibrary.getSprite("light_indicator_0");e=new CLightIndicator(e,1008,1180,b);e.addText(TEXT_HOLE_VALUE[g],0,0,26,"#f68eff");e.textRotate(-20);e.scale(.68);g++;h.push(e);e=s_oSpriteLibrary.getSprite("light_indicator_2");
e=new CLightIndicator(e,1008,1240,b);e.addText(TEXT_HOLE_VALUE[g],0,0,50,"#ff4040");e.textRotate(-20);e.scale(.68);h.push(e);g=new createjs.Container;g.x=928;g.y=820;b.addChild(g);e=s_oSpriteLibrary.getSprite("light_indicator_1");c=new CLightIndicator(e,0,0,g);c.addPreciseText(TEXT_SHIELD,0,0,20,"#000000",90,70);c.scale(.7);c.rotate(25);e=s_oSpriteLibrary.getSprite("light_indicator_2");k=new CLightIndicator(e,-28,60,g);k.addPreciseText(TEXT_EXTRABALL,0,-2,20,"#000000",90,70);k.scale(.7);k.rotate(25)};
this.reset=function(){d=!1;s_oScoreController.resetHoleBonusLevel();for(var g=0;g<h.length;g++)h[g].slowOff(500,100*(h.length-g-1));m.reset();this.disableShieldLight();this.disableExtraBallLight()};this.disableShieldLight=function(){f=!1;c.lit(!1)};this.disableExtraBallLight=function(){l=!1;k.lit(!1)};this.activeShieldLight=function(){f=!0;c.highlight(2E3)};this.activeExtraBallLight=function(){l=!0;k.highlight(2E3)};var a=this;this._init(b,n)}
function CModuleRouter(b,n){var d,f;this._init=function(h,c){d=0;this._addRouterGate();this._addLabels();var k=s_oScoreController.getCurRouterLevel();f[k].highlight(2E3);this._setIntervalTime()};this._setIntervalTime=function(){d=TIME_ROUTER_SCORE_DECREASE};this._addRouterGate=function(){var h=new CGateSystem(256,176);h.addGate(60,8,45);var c=s_oSpriteLibrary.getSprite("gate");h.addSprite(c,n,25,c.height/8,c.width/2+16);h.addOpener(-40,40,12,!0);h.addCloser(56,-32,12,!0);h.addCloser(-148,176,12,!1);
h.addPassingGateListener(this._routerPassed)};this._routerPassed=function(){var h=s_oScoreController.getCurRouterLevel();f[h].lit(!0);s_oScoreController.addRouterScore();s_oScoreController.increaseRouterLevel();h=s_oScoreController.getCurRouterLevel();f[h].highlight(2E3);l._setIntervalTime()};this._addLabels=function(){f=[];var h=0,c=s_oSpriteLibrary.getSprite("router_light_0");c=new CLightIndicator(c,72,624,b);c.addText(TEXT_ROUTER_VALUE[h],0,0,26,"#f947ce");h++;f.push(c);c=s_oSpriteLibrary.getSprite("router_light_1");
c=new CLightIndicator(c,72,556,b);c.addText(TEXT_ROUTER_VALUE[h],0,0,20,"#55bdf5");h++;f.push(c);c=s_oSpriteLibrary.getSprite("router_light_2");c=new CLightIndicator(c,72,488,b);c.addText(TEXT_ROUTER_VALUE[h],0,0,18,"#73ec34");h++;f.push(c);c=s_oSpriteLibrary.getSprite("router_light_3");c=new CLightIndicator(c,80,420,b);c.addText(TEXT_ROUTER_VALUE[h],0,0,18,"#f2a937");h++;f.push(c);c=s_oSpriteLibrary.getSprite("router_light_4");c=new CLightIndicator(c,104,360,b);c.addText(TEXT_ROUTER_VALUE[h],0,0,
26,"#f22935");h++;f.push(c);c=s_oSpriteLibrary.getSprite("router_light_5");c=new CLightIndicator(c,140,300,b);c.addText(TEXT_ROUTER_VALUE[h],0,0,26,"#f3dc47");h++;f.push(c);c=s_oSpriteLibrary.getSprite("router_light_6");c=new CLightIndicator(c,188,240,b);c.addText(TEXT_ROUTER_VALUE[h],0,0,26,"#9e2bf2");f.push(c)};this._levelDecreased=function(){var h=s_oScoreController.getCurRouterLevel();0<h&&(f[h].lit(!1),s_oScoreController.decreaseRouterLevel(),h=s_oScoreController.getCurRouterLevel(),f[h].highlight(2E3))};
this.reset=function(){s_oScoreController.resetRouterLevel();for(var h=0;h<f.length;h++)f[h].slowOff(500,100*(f.length-h-1));h=s_oScoreController.getCurRouterLevel();f[h].highlight(2E3)};this.update=function(){d-=s_iTimeElaps;0>d&&(l._setIntervalTime(),l._levelDecreased())};var l=this;this._init(b,n)}var CURVE_FROM_RIGHT=0,CURVE_FROM_LEFT=1;
function CModuleLetters(b,n){var d,f,l,h,c=0,k,m,a,g,e,p,u,t;this._init=function(q,x){h=l=f=d=!1;this._addSprite();this._addCurveGate();this._addCurveSystemButton();this._addArrows();this._addLetters();this._addLogo()};this._addSprite=function(){var q=new createjs.Container;q.x=382;q.y=560;n.addChild(q);var x=s_oSpriteLibrary.getSprite("curve_tunnel"),r=createBitmap(x);r.regX=x.width/2;r.regY=x.height/2;q.addChild(r);r=new createjs.Container;r.x=-16;r.y=-52;q.addChild(r);x=s_oSpriteLibrary.getSprite("eye");
g=createBitmap(x);g.regX=x.width/2;g.regY=x.height/2;r.addChild(g)};this._addCurveSystemButton=function(){u=new CButtonSystem;u.setAutoReset(!1);for(var q=s_oSpriteLibrary.getSprite("curve_light_button"),x=0;3>x;x++)u.addButton(40,8,324+60*x,806,0,q,0,20,b);u.addAllButtonHitListener(this._onAllButtonPress);u.addSingleButtonListener(s_oScoreController.addButtonScore);u.setResititution(.33)};this._onAllButtonPress=function(){d||l?d&&!l?(l=!0,e.highlight(500)):!d&&l&&(d=!0,p.highlight(500)):.5>Math.random()?
(d=!0,p.highlight(500)):(l=!0,e.highlight(500))};this._allLettersAreLit=function(){for(var q=0;q<m.length;q++)if(!m[q])return!1;return!0};this._onAllLettersLit=function(){playSound("all_letters_complete",1,!1);s_oScoreController.addAllLettersScore();w.hardReset();s_oTable.enableShieldBonus();s_oTable.enableExtraBallBonus()};this._addCurveGate=function(){var q=new CGateSystem(368,620);q.addGate(60,8,90);q.addOpener(40,32,12,0,CURVE_FROM_RIGHT);q.addOpener(-52,32,12,0,CURVE_FROM_LEFT);q.addCloser(-116,
176,12,1);q.addCloser(152,176,12,1);q.addPassingGateListener(this._curvePassed)};this._curvePassed=function(q){s_oScoreController.addGateScore();q===CURVE_FROM_RIGHT&&d&&!f?(trace("CURVE FROM RIGHT"),f=!0,p.lit(!0),u.restart(),w._tryToFlashARandomLetter()):q===CURVE_FROM_LEFT&&l&&!h&&(trace("CURVE FROM LEFT"),h=!0,e.lit(!0),u.restart(),w._tryToFlashARandomLetter());f&&h&&(trace("LETTER LIT"),w.restart(),k[c].lit(!0),m[c]=!0,a[c]=!0,playSound("letter",1,!1),s_oScoreController.addSingleLettersScore(),
w._allLettersAreLit()&&w._onAllLettersLit())};this._tryToFlashARandomLetter=function(){if(!f&&h||f&&!h){trace("FLASHING A RANDOM LETTER");do c=Math.floor(Math.random()*k.length);while(m[c]);k[c].highlight(1E3);m[c]=!1}};this._addArrows=function(){var q=s_oSpriteLibrary.getSprite("arrow_light_0");e=new CLightIndicator(q,272,880,b);e.rotate(-20);q=s_oSpriteLibrary.getSprite("arrow_light_0");p=new CLightIndicator(q,520,860,b);p.rotate(0)};this._addLetters=function(){k=[];m=[];a=[];for(var q=0;7>q;q++){var x=
s_oSpriteLibrary.getSprite("letter_"+q);x=new CLightIndicator(x,LETTERS_POSITION[q].x,LETTERS_POSITION[q].y,b);k.push(x);m[q]=!1;a[q]=!1}m=[];a=[];for(q=0;q<k.length;q++)m[q]=!1,a[q]=!1};this._addLogo=function(){var q=s_oSpriteLibrary.getSprite("logo");t=new CLightIndicator(q,540,1140,b);this.animLogo()};this.animLogo=function(){t.slowHighlight(2E3,1E3,w.animLogo)};this.stopAnimLogo=function(){t.slowOff(1E3,0)};this.restart=function(){h=l=f=d=!1;p.flashing();e.flashing();u.restart()};this.reset=function(){w.restart();
p.slowOff();e.slowOff();u.reset();for(var q=0;q<k.length;q++)m[q]=!1,a[q]?k[q].lit(!0):k[q].lit(!1)};this.hardReset=function(){this.restart();for(var q=0;q<k.length;q++)m[q]=!1,a[q]=!1,k[q].flashing(),t.flashing()};this.update=function(){g.x=s_oGame.getBallSprite().x-g.parent.parent.x;g.y=s_oGame.getBallSprite().y-g.parent.parent.y;var q=Math.atan2(g.y,g.x);Math.pow(g.x,2)+Math.pow(g.y,2)>Math.pow(14,2)&&(g.x=14*Math.cos(q),g.y=14*Math.sin(q))};var w=this;this._init(b,n)}
var STATE_START=0,STATE_JUMPER=1,STATE_SHIELD=2,STATE_EXTRABALL=3,STATE_DIRECTIONAL_JUMPER=4,DIRECTION_UP=0,DIRECTION_MID=1,DIRECTION_RIGHT=2;
function CModuleJumper(b,n){var d,f,l,h,c,k;this._init=function(a,g){d=STATE_START;f=DIRECTION_UP;this._addJumper();this._addJumperButtons();this._addArrows()};this._addJumper=function(){var a={contacttype:CONTACT_BEGIN,callback:this._onJumper,params:"bumper"};h=s_oObjectBuilder.addButton(100,12,68,1220,45,0,0,0,a);h.GetFixtureList().SetSensor(!0);s_oPhysicsController.disableBody(h);a=s_oSpriteLibrary.getSprite("jumper");var g=new createjs.SpriteSheet({images:[a],frames:{width:a.width/2,height:a.height,
regX:a.width/2/2,regY:a.height/2},animations:{state_true:[0],state_false:[1]}});c=createSprite(g,"state_false",a.width/2/2,a.height/2,a.width/2,a.height);c.x=68;c.y=1220;c.rotation=45;c.visible=!1;b.addChild(c);a={contacttype:CONTACT_BEGIN,callback:function(){},params:"bumper"};s_oObjectBuilder.addButton(60,8,188,800,60,0,0,1,a).GetFixtureList().SetSensor(!0)};this._onJumper=function(a,g){s_oScoreController.addJumperScore();var e=g.GetFixtureA().GetUserData(),p=g.GetFixtureB().GetUserData(),u;e.id&&
"ball"===e.id&&(u=g.GetFixtureA().GetBody());p.id&&"ball"===p.id&&(u=g.GetFixtureB().GetBody());d>=STATE_DIRECTIONAL_JUMPER?m._jumperModeDirectional(u):m._jumperModeWeak(u);c.gotoAndStop("state_true");setTimeout(function(){c.gotoAndStop("state_false")},100);playSound("jumper",1,!1)};this._jumperModeWeak=function(a){var g=new Box2D.Common.Math.b2Vec2(a.GetPosition().x*WORLD_SCALE,a.GetPosition().y*WORLD_SCALE),e=new Box2D.Common.Math.b2Vec2(960*Math.random(),960);g.Subtract(e);g.Normalize();g=new Box2D.Common.Math.b2Vec2(g.x,
g.y);e=6+2*Math.random();a.SetLinearVelocity({x:0,y:0});a.SetAngularVelocity(0);g.Multiply(-a.GetMass()*e);a.ApplyImpulse(g,a.GetPosition())};this._jumperModeDirectional=function(a){var g=new Box2D.Common.Math.b2Vec2(a.GetPosition().x*WORLD_SCALE,a.GetPosition().y*WORLD_SCALE),e=m._getDirection();g.Subtract(e);g.Normalize();g=new Box2D.Common.Math.b2Vec2(g.x,g.y);a.SetLinearVelocity({x:0,y:0});a.SetAngularVelocity(0);g.Multiply(32*-a.GetMass());a.ApplyImpulse(g,a.GetPosition())};this._getDirection=
function(){switch(f){case DIRECTION_UP:var a=new Box2D.Common.Math.b2Vec2(78,640);break;case DIRECTION_MID:a=new Box2D.Common.Math.b2Vec2(740,640);break;case DIRECTION_RIGHT:a=new Box2D.Common.Math.b2Vec2(1408,600)}return a};this._addJumperButtons=function(){k=new CButtonSystem;for(var a=s_oSpriteLibrary.getSprite("bumper_button"),g=0;5>g;g++)k.addButton(8,56,38,860+68*g,0,a,0,0,b);k.addAllButtonHitListener(this._onAllButtonActive);k.addSingleButtonListener(s_oScoreController.addButtonScore);k.flipButtonX()};
this._onAllButtonActive=function(){s_oScoreController.addAllJumperButtonsScore();m.changeState()};this._addArrows=function(){l=[];var a=s_oSpriteLibrary.getSprite("arrow_light_1");a=new CLightIndicator(a,88,1060,b);a.rotate(-5);l.push(a);a=s_oSpriteLibrary.getSprite("arrow_light_1");a=new CLightIndicator(a,180,1100,b);a.rotate(40);l.push(a);a=s_oSpriteLibrary.getSprite("arrow_light_1");a=new CLightIndicator(a,240,1160,b);a.rotate(55);l.push(a)};this.reset=function(){k.reset();d=STATE_START;f=DIRECTION_UP;
for(var a=0;a<l.length;a++)l[a].slowOff(1E3,0);s_oPhysicsController.disableBody(h);c.visible=!1};this.shiftElementsToRight=function(){if(!(d<STATE_DIRECTIONAL_JUMPER)){f++;f===l.length&&(f=0);for(var a=0;a<l.length;a++)l[a].lit(!1);l[f].lit(!0)}};this.shiftElementsToLeft=function(){if(!(d<STATE_DIRECTIONAL_JUMPER)){f--;0>f&&(f=l.length-1);for(var a=0;a<l.length;a++)l[a].lit(!1);l[f].lit(!0)}};this.changeState=function(){s_oTable.enableJackpot();d++;switch(d){case STATE_START:break;case STATE_JUMPER:h.SetActive(!0);
c.visible=!0;break;case STATE_SHIELD:s_oTable.enableShieldBonus();break;case STATE_EXTRABALL:s_oTable.enableExtraBallBonus();break;case STATE_DIRECTIONAL_JUMPER:l[f].lit(!0);break;default:0===d%SHIELD_ACTIVATION_THRESHOLD&&s_oTable.enableShieldBonus()}};var m=this;this._init(b,n)}
function CModuleJackpot(b,n){var d,f,l,h;this._init=function(k,m){d=!1;f=0;this._addGate();this._addActiveIndicator();this._addJackpotAmountIndicator()};this._addGate=function(){var k=new CGateSystem(172,620);k.addGate(60,8,35);var m=s_oSpriteLibrary.getSprite("gate");k.addSprite(m,n,5,80,m.width/2-6);k.setRestitution(0);k.addOpener(24,-60,12,!0);k.addCloser(-40,56,12,!0);k.addPassingGateListener(this._onJackpot)};this._onJackpot=function(){s_oScoreController.addGateScore();d&&(playSound("bonus_win_2",
1,!1),s_oScoreController.addJackpotScore(),s_oScoreController.getJackpotAmount()>=EXTRABALL_JACKPOT_SCORE_ACTIVATION&&s_oTable.enableExtraBallBonus(),s_oScoreController.resetJackpot(),d=!1,l.flashing())};this._addActiveIndicator=function(){var k=s_oSpriteLibrary.getSprite("jackpot");l=new CLightIndicator(k,190,360,b)};this._addJackpotAmountIndicator=function(){h=new createjs.Text((0).toLocaleString(),"28px "+SECONDARY_FONT,"#ff56b0");h.x=220;h.y=388;h.textAlign="center";h.textBaseline="middle";h.lineWidth=
200;h.rotation=-55;b.addChild(h);h.cache(-110,-20,220,40)};this.reset=function(){c.disableJackpot()};this.enableJackpot=function(){d=!0;l.highlight(1E3);f=TIME_LAST_ACTIVE_JACKPOT};this.disableJackpot=function(){d=!1;l.slowOff(1E3,0)};this.setJackpotAmount=function(k){h.text=k.toLocaleString();h.updateCache()};this.update=function(){d&&(f-=s_iTimeElaps,0>f&&c.disableJackpot())};var c=this;this._init(b,n)}
function CModuleShield(b,n){var d,f,l,h;this._init=function(c,k){this._addRightShield();this._addLeftShield()};this._addRightShield=function(){f=new CHoleSystem(1016,1580,1E3);f.addHoleEventListener(this._onRightShieldUsed);f.setLaunchImpulse(0,-(.3+.2*Math.random()));s_oPhysicsController.disableBody(f.getHole());var c=s_oSpriteLibrary.getSprite("shield");h=new CLightIndicator(c,1016,1580,b);h.lit(!0)};this._addLeftShield=function(){d=new CHoleSystem(54,1580,1E3);d.addHoleEventListener(this._onLeftShieldUsed);
d.setLaunchImpulse(0,-(.3+.2*Math.random()));var c=s_oSpriteLibrary.getSprite("shield");l=new CLightIndicator(c,54,1580,b);l.lit(!0)};this._onRightShieldUsed=function(){s_oPhysicsController.disableBody(f.getHole());h.slowOff(1E3,500)};this._onLeftShieldUsed=function(){s_oPhysicsController.disableBody(d.getHole());l.slowOff(1E3,500)};this.reset=function(){s_oPhysicsController.disableBody(f.getHole());s_oPhysicsController.disableBody(d.getHole());h.lit(!1);l.lit(!1)};this.enableShield=function(){s_oPhysicsController.enableBody(f.getHole());
s_oPhysicsController.enableBody(d.getHole());h.slowOn(500,0);l.slowOn(500,0)};this._init(b,n)}
function CModuleStart(b,n){var d,f,l,h,c,k,m,a;this._init=function(e,p){l=!0;h=!1;d=1976;f=1876;c=1E3;this._addTunnelSprites();this._addStartGate();this._addLaunchPlatform();this._addLauncher()};this._addTunnelSprites=function(){var e=s_oSpriteLibrary.getSprite("tunnel_start"),p=createBitmap(e);p.x=880;p.y=140;n.addChild(p);k=0;m=[];e=s_oSpriteLibrary.getSprite("arrow_start");e=new CLightIndicator(e,994,252,b);e.rotate(-35);m.unshift(e);e=s_oSpriteLibrary.getSprite("arrow_start");e=new CLightIndicator(e,
1044,332,b);e.rotate(-25);m.unshift(e);e=s_oSpriteLibrary.getSprite("arrow_start");e=new CLightIndicator(e,1074,422,b);e.rotate(-10);m.unshift(e);e=s_oSpriteLibrary.getSprite("arrow_start");e=new CLightIndicator(e,1088,522,b);e.rotate(-5);m.unshift(e);for(p=0;11>p;p++)e=s_oSpriteLibrary.getSprite("arrow_start"),e=new CLightIndicator(e,1090,632+100*p,b),m.unshift(e);this.startLighting()};this.startLighting=function(){for(var e=k=0;e<m.length;e++)m[e].slowHighlight(1E3,100*e,this.endLighting)};this.endLighting=
function(){k++;k>=m.length&&g.startLighting()};this.stopAnimLighting=function(){for(var e=0;e<m.length;e++)m[e].slowOff(1E3,0)};this._addStartGate=function(){var e=new CGateSystem(924,176);e.addGate(60,8,-45);var p=s_oSpriteLibrary.getSprite("gate");e.addSprite(p,n,-68,p.height/3,p.width/2+6);e.addOpener(60,60,12,0);e.addCloser(-56,-32,12,0);e.addCloser(132,176,12,1);e.addPassingGateListener(this._onStartGatePassed)};this._onStartGatePassed=function(){s_oGame.ballInGame(!0);s_oScoreController.addGateScore();
h=!0;s_oTable.stopLogoAnim();g.stopAnimLighting()};this._addLaunchPlatform=function(){var e={contacttype:CONTACT_BEGIN,callback:this._onPlatform,params:"platform"};s_oObjectBuilder.addButton(60,4,1092,1800,0,0,.33,.33,e);e={contacttype:CONTACT_BEGIN,callback:this._onAir,params:"platform"};s_oObjectBuilder.addButton(60,4,1092,1732,0,0,.33,.33,e).GetFixtureList().SetSensor(!0)};this._onPlatform=function(){l=!0};this._onAir=function(){l=!1};this._addLauncher=function(){var e=s_oSpriteLibrary.getSprite("spring");
a=createBitmap(e);a.regY=e.height;a.x=1069;a.y=1876;n.addChild(a);e=s_oSpriteLibrary.getSprite("start_platform");var p=createBitmap(e);p.regX=e.width;p.regY=e.height;p.x=s_oTable.getTableSize().w;p.y=s_oTable.getTableSize().h;n.addChild(p)};this.block=function(){h=!0};this.unBlock=function(){h=!1};this.loadSpring=function(){h||createjs.Tween.get(a,{override:!0}).to({y:d},c)};this.releaseSpring=function(){if(!h){createjs.Tween.get(a,{override:!0}).to({y:f},300,createjs.Ease.elasticOut);var e=linearFunction(a.y,
f,d,0,SPRING_MAX_STRENGTH);l&&(playSound("launch",1,!1),s_oGame.launchBall(e))}};var g=this;this._init(b,n)}
function CGUIExpandible(b,n,d,f){var l,h,c,k,m,a,g,e;this._init=function(u,t,w,q){k=[];a=new createjs.Container;a.x=u;a.y=t;q.addChild(a);g=new createjs.Container;a.addChild(g);e=new createjs.Container;a.addChild(e);c=!1;m=new CGfxButton(0,0,w,e);m.addEventListener(ON_MOUSE_UP,this._onMenu,this);h=l=120};this.unload=function(){m.unload();f.removeChild(a)};this.refreshPos=function(u,t){a.x=b-u;a.y=n+t};this.addButton=function(u){u=u.getButtonImage();u.x=0;u.y=0;u.visible=0;g.addChildAt(u,0);k.push(u)};
this._onMenu=function(){(c=!c)?(p._expand(),s_oGame.onPause()):(p._collapse(),s_oGame.onResume())};this._expand=function(){for(var u=0;u<k.length;u++)k[u].visible=!0,createjs.Tween.get(k[u],{override:!0}).wait(300*u/2).to({y:l+u*h},300,createjs.Ease.cubicOut)};this._collapse=function(){for(var u=0;u<k.length;u++){var t=k[k.length-1-u];createjs.Tween.get(t,{override:!0}).wait(300*u/2).to({y:0},300,createjs.Ease.cubicOut).call(function(w){w.visible=!1},[t])}};var p=this;this._init(b,n,d,f)}
function CPausePanel(b){var n,d;this._init=function(f){n=new createjs.Shape;n.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);n.alpha=0;n.on("mousedown",function(){});f.addChild(n);d=new createjs.Container;f.addChild(d);d.x=CANVAS_WIDTH/2;d.y=CANVAS_HEIGHT/2;f=new createjs.Text(TEXT_PAUSE," 54px "+PRIMARY_FONT,PRIMARY_FONT_COLOUR);f.y=0;f.textAlign="center";f.textBaseline="middle";f.lineWidth=400;d.addChild(f);n.alpha=0;d.alpha=0};this.show=function(){createjs.Tween.get(n).to({alpha:.7},
500);createjs.Tween.get(d).to({alpha:1},500)};this.hide=function(){createjs.Tween.get(n).to({alpha:0},500);createjs.Tween.get(d).to({alpha:0},500)};this._init(b)}var LOCALSTORAGE_TOTALSCORE="totalscore",s_iTotalScore=0;
function CLocalStorage(b){var n=!0;this._init=function(d){try{var f=window.localStorage.getItem(d);this.resetData();null!==f&&void 0!==f&&this.loadData()}catch(l){this.resetData()}};this.isDirty=function(){return 0<s_iTotalScore?!0:!1};this.isUsed=function(){try{window.localStorage.setItem("ls_available","ok")}catch(d){n=!1}return n};this.resetData=function(){s_iTotalScore=0};this.deleteData=function(){window.localStorage.removeItem(b)};this.saveData=function(){var d={};d[LOCALSTORAGE_TOTALSCORE]=
s_iTotalScore;window.localStorage.setItem(b,JSON.stringify(d))};this.loadData=function(){var d=JSON.parse(window.localStorage.getItem(b))[LOCALSTORAGE_TOTALSCORE];s_iTotalScore=parseInt(d)};this._init(b)}
function CMsgBox(b,n){var d,f,l,h,c,k,m;this._init=function(g,e){c=new createjs.Shape;c.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);c.alpha=0;m=c.on("mousedown",function(){});s_oStage.addChild(c);(new createjs.Tween.get(c)).to({alpha:.7},500);k=new createjs.Container;s_oStage.addChild(k);var p=s_oSpriteLibrary.getSprite("msg_box"),u=createBitmap(p);u.regX=p.width/2;u.regY=p.height/2;k.addChild(u);k.x=CANVAS_WIDTH/2;k.y=CANVAS_HEIGHT+p.height/2;d=k.y;(new createjs.Tween.get(k)).to({y:CANVAS_HEIGHT/
2-40},500,createjs.Ease.quartIn);f=new createjs.Text(g," 20px "+PRIMARY_FONT,"#000000");f.y=-p.height/2+60;f.textAlign="center";f.textBaseline="middle";f.lineWidth=550;f.outline=5;k.addChild(f);l=new createjs.Text(g," 20px "+PRIMARY_FONT,"#ffffff");l.y=f.y;l.textAlign="center";l.textBaseline="middle";l.lineWidth=550;k.addChild(l);h=new CGfxButton(0,80,s_oSpriteLibrary.getSprite("but_yes"),k);h.addEventListener(ON_MOUSE_UP,this._onButYes,this);h.pulseAnimation()};this._onButYes=function(){h.setClickable(!1);
(new createjs.Tween.get(c)).to({alpha:0},500);(new createjs.Tween.get(k)).to({y:d},400,createjs.Ease.backIn).call(function(){a.unload();n&&n()})};this.changeMessage=function(g){f.text=g;l.text=g};this.unload=function(){h.unload();s_oStage.removeChild(c);s_oStage.removeChild(k);c.off("mousedown",m)};var a=this;this._init(b,n)}
CTLText.prototype={constructor:CTLText,__autofit:function(){if(this._bFitText){for(var b=this._iFontSize;(this._oText.getBounds().height>this._iHeight-2*this._iPaddingV||this._oText.getBounds().width>this._iWidth-2*this._iPaddingH)&&!(b--,this._oText.font=b+"px "+this._szFont,this._oText.lineHeight=Math.round(b*this._fLineHeightFactor),this.__updateY(),this.__verticalAlign(),8>b););this._iFontSize=b}},__verticalAlign:function(){if(this._bVerticalAlign){var b=this._oText.getBounds().height;this._oText.y-=
(b-this._iHeight)/2+this._iPaddingV}},__updateY:function(){this._oText.y=this._y+this._iPaddingV;switch(this._oText.textBaseline){case "middle":this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize)}},__createText:function(b){this._bDebug&&(this._oDebugShape=new createjs.Shape,this._oDebugShape.graphics.beginFill("rgba(255,0,0,0.5)").drawRect(this._x,this._y,this._iWidth,this._iHeight),this._oContainer.addChild(this._oDebugShape));this._oText=new createjs.Text(b,
this._iFontSize+"px "+this._szFont,this._szColor);this._oText.textBaseline="middle";this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this._oText.textAlign=this._szAlign;this._oText.lineWidth=this._bMultiline?this._iWidth-2*this._iPaddingH:null;switch(this._szAlign){case "center":this._oText.x=this._x+this._iWidth/2;break;case "left":this._oText.x=this._x+this._iPaddingH;break;case "right":this._oText.x=this._x+this._iWidth-this._iPaddingH}this._oContainer.addChild(this._oText);
this.refreshText(b)},setVerticalAlign:function(b){this._bVerticalAlign=b},setOutline:function(b){null!==this._oText&&(this._oText.outline=b)},setShadow:function(b,n,d,f){null!==this._oText&&(this._oText.shadow=new createjs.Shadow(b,n,d,f))},setColor:function(b){this._oText.color=b},setAlpha:function(b){this._oText.alpha=b},setY:function(b){this._y=this._oText.y=b},removeTweens:function(){createjs.Tween.removeTweens(this._oText)},getText:function(){return this._oText},getY:function(){return this._y},
getFontSize:function(){return this._iFontSize},refreshText:function(b){""===b&&(b=" ");null===this._oText&&this.__createText(b);this._oText.text=b;this._oText.font=this._iFontSize+"px "+this._szFont;this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this.__autofit();this.__updateY();this.__verticalAlign()}};
function CTLText(b,n,d,f,l,h,c,k,m,a,g,e,p,u,t,w,q){this._oContainer=b;this._x=n;this._y=d;this._iWidth=f;this._iHeight=l;this._bMultiline=w;this._iFontSize=h;this._szAlign=c;this._szColor=k;this._szFont=m;this._iPaddingH=g;this._iPaddingV=e;this._bVerticalAlign=t;this._bFitText=u;this._bDebug=q;this._oDebugShape=null;this._fLineHeightFactor=a;this._oText=null;p&&this.__createText(p)};