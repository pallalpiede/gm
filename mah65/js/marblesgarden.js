!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Game",[],e):"object"==typeof exports?exports.Game=e():t.Game=e()}(self,(function(){return function(){var t={6852:function(t,e,n){t.exports=function(){"use strict";function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function e(t){return"function"==typeof t}var i=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,r=void 0,s=void 0,a=function(t,e){T[o]=t,T[o+1]=e,2===(o+=2)&&(s?s(E):S())};function l(t){s=t}function h(t){a=t}var u="undefined"!=typeof window?window:void 0,c=u||{},p=c.MutationObserver||c.WebKitMutationObserver,_="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){return function(){return process.nextTick(E)}}function y(){return void 0!==r?function(){r(E)}:v()}function m(){var t=0,e=new p(E),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function g(){var t=new MessageChannel;return t.port1.onmessage=E,function(){return t.port2.postMessage(0)}}function v(){var t=setTimeout;return function(){return t(E,1)}}var T=new Array(1e3);function E(){for(var t=0;t<o;t+=2)(0,T[t])(T[t+1]),T[t]=void 0,T[t+1]=void 0;o=0}function b(){try{var t=Function("return this")().require("vertx");return r=t.runOnLoop||t.runOnContext,y()}catch(t){return v()}}var S=void 0;function P(t,e){var n=this,i=new this.constructor(w);void 0===i[O]&&J(i);var o=n._state;if(o){var r=arguments[o-1];a((function(){return Y(o,i,r,n._result)}))}else W(n,i,t,e);return i}function A(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(w);return U(n,t),n}S=_?d():p?m():f?g():void 0===u?b():v();var O=Math.random().toString(36).substring(2);function w(){}var L=void 0,C=1,I=2,x={error:null};function D(){return new TypeError("You cannot resolve a promise with itself")}function R(){return new TypeError("A promises callback cannot return that same promise.")}function M(t){try{return t.then}catch(t){return x.error=t,x}}function B(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}function N(t,e,n){a((function(t){var i=!1,o=B(n,e,(function(n){i||(i=!0,e!==n?U(t,n):j(t,n))}),(function(e){i||(i=!0,H(t,e))}),"Settle: "+(t._label||" unknown promise"));!i&&o&&(i=!0,H(t,o))}),t)}function F(t,e){e._state===C?j(t,e._result):e._state===I?H(t,e._result):W(e,void 0,(function(e){return U(t,e)}),(function(e){return H(t,e)}))}function k(t,n,i){n.constructor===t.constructor&&i===P&&n.constructor.resolve===A?F(t,n):i===x?(H(t,x.error),x.error=null):void 0===i?j(t,n):e(i)?N(t,n,i):j(t,n)}function U(e,n){e===n?H(e,D()):t(n)?k(e,n,M(n)):j(e,n)}function G(t){t._onerror&&t._onerror(t._result),X(t)}function j(t,e){t._state===L&&(t._result=e,t._state=C,0!==t._subscribers.length&&a(X,t))}function H(t,e){t._state===L&&(t._state=I,t._result=e,a(G,t))}function W(t,e,n,i){var o=t._subscribers,r=o.length;t._onerror=null,o[r]=e,o[r+C]=n,o[r+I]=i,0===r&&t._state&&a(X,t)}function X(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i=void 0,o=void 0,r=t._result,s=0;s<e.length;s+=3)i=e[s],o=e[s+n],i?Y(n,i,o,r):o(r);t._subscribers.length=0}}function V(t,e){try{return t(e)}catch(t){return x.error=t,x}}function Y(t,n,i,o){var r=e(i),s=void 0,a=void 0,l=void 0,h=void 0;if(r){if((s=V(i,o))===x?(h=!0,a=s.error,s.error=null):l=!0,n===s)return void H(n,R())}else s=o,l=!0;n._state!==L||(r&&l?U(n,s):h?H(n,a):t===C?j(n,s):t===I&&H(n,s))}function z(t,e){try{e((function(e){U(t,e)}),(function(e){H(t,e)}))}catch(e){H(t,e)}}var K=0;function q(){return K++}function J(t){t[O]=K++,t._state=void 0,t._result=void 0,t._subscribers=[]}function Z(){return new Error("Array Methods must be provided an Array")}var Q=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(w),this.promise[O]||J(this.promise),i(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?j(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&j(this.promise,this._result))):H(this.promise,Z())}return t.prototype._enumerate=function(t){for(var e=0;this._state===L&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===A){var o=M(t);if(o===P&&t._state!==L)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===ot){var r=new n(w);k(r,t,o),this._willSettleAt(r,e)}else this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(i(t),e)},t.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===L&&(this._remaining--,t===I?H(i,n):this._result[e]=n),0===this._remaining&&j(i,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;W(t,void 0,(function(t){return n._settledAt(C,e,t)}),(function(t){return n._settledAt(I,e,t)}))},t}();function $(t){return new Q(this,t).promise}function tt(t){var e=this;return i(t)?new e((function(n,i){for(var o=t.length,r=0;r<o;r++)e.resolve(t[r]).then(n,i)})):new e((function(t,e){return e(new TypeError("You must pass an array to race."))}))}function et(t){var e=new this(w);return H(e,t),e}function nt(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function it(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var ot=function(){function t(e){this[O]=q(),this._result=this._state=void 0,this._subscribers=[],w!==e&&("function"!=typeof e&&nt(),this instanceof t?z(this,e):it())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var e=this,n=e.constructor;return e.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))}))},t}();function rt(){var t=void 0;if(void 0!==n.g)t=n.g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var i=null;try{i=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===i&&!e.cast)return}t.Promise=ot}return ot.prototype.then=P,ot.all=$,ot.race=tt,ot.resolve=A,ot.reject=et,ot._setScheduler=l,ot._setAsap=h,ot._asap=a,ot.polyfill=rt,ot.Promise=ot,ot.polyfill(),ot}()},2178:function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{l(i.next(t))}catch(t){r(t)}}function a(t){try{l(i.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((i=i.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.wkbGameStart=e.App=void 0;var r=n(8553),s=n(5409),a=n(8564),l=n(6819),h=n(4060),u=n(7417),c=n(9498),p=n(2902),_=n(7306),f=n(4983),d=n(6674),y=n(5357),m=n(9221),g=n(240),v=n(2014),T=function(){function t(){}return Object.defineProperty(t,"sponsorID",{get:function(){return t._sponsor},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sponsor",{get:function(){return _.Utils.api},enumerable:!1,configurable:!0}),Object.defineProperty(t,"game",{get:function(){return t._game},enumerable:!1,configurable:!0}),Object.defineProperty(t,"isLandscape",{get:function(){return t._isLandscape},set:function(e){t._isLandscape=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"settings",{get:function(){return t._settings},set:function(e){t._settings=e},enumerable:!1,configurable:!0}),t.launch=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return i(this,void 0,void 0,(function(){var n;return o(this,(function(i){switch(i.label){case 0:return null!=t._game?[2]:(n=v.getSponsorFeatures(t._sponsor),[4,t.loadConfigs(n)]);case 1:if(i.sent(),!0,t._sponsor===r.eSponsorID.NONE)new s.SponsorNone(n);else if(t._sponsor===r.eSponsorID.ORANGE_FR||t._sponsor===r.eSponsorID.TATAKI)new a.SponsorGTM(n,window.sbcPublisherId,window.sbcProductKey);else if(t._sponsor===r.eSponsorID.YANDEX)new p.SponsorYandex(n,{fullscreen:!0,orientation:{value:"portrait",lock:!0}});else if(t._sponsor===r.eSponsorID.WANTED5GAMES)new l.SponsorWanted5Games(n,-1);else if(t._sponsor===r.eSponsorID.GAMEDISTRIBUTION)new h.SponsorGameDistribution(n,"26d4d51848cf42d8b335581e59b4b083",t.onSponsorInitialized);else if(t._sponsor===r.eSponsorID.WKB){if(!(!d.Host.isLocal()&&void 0!==e[0]||d.Host.isLocal()&&void 0===e[0]))return[2];new u.SponsorWKB(n,e[0],y.Config.USE_GMO_STORAGE)}else{if(t._sponsor!==r.eSponsorID.COOLMATHGAMES)return[2];new c.SponsorCoolmathGames(n)}return t._game=new m.Game,_.Utils.api.game=t._game,[2]}}))}))},t.onSponsorInitialized=function(){_.Utils.isFeatureOn("showPreRollAd")&&t.sponsor.showAd()},t.loadConfigs=function(t){return i(this,void 0,void 0,(function(){var e,n;return o(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,f.ObjectUtils.loadJson("assets/config.json")];case 1:return e=i.sent(),f.ObjectUtils.loadValuesIntoObject(e,y.Config),[3,3];case 2:throw i.sent();case 3:if(!t.hasConfig)return[3,7];i.label=4;case 4:return i.trys.push([4,6,,7]),[4,f.ObjectUtils.loadJson("assets/sponsor/"+t.name+".json")];case 5:return n=i.sent(),f.ObjectUtils.loadValuesIntoObject(n,y.Config),[3,7];case 6:return i.sent(),[3,7];case 7:return[2]}}))}))},t._sponsor=r.eSponsorID.GAMEDISTRIBUTION,t._game=null,t._isLandscape=!0,t._settings=new g.Settings(y.Config.SAVE_KEY),t}();function E(t,e,n,i,o,r){return T.launch({callbackStart:e,callbackShowAd:n,callbackSendScore:i,callbackError:o,callbackStartLog:r}),e()}e.App=T,e.wkbGameStart=E,window.wkbGameStart=E,window.onload=function(){T.launch()}},5357:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Config=void 0;var n=function(){function t(){}return t.GAME_WIDTH=1280,t.GAME_HEIGHT=800,t.SAVE_KEY="marblesgarden_save",t.checkLanguage=!0,t.checkLanguageEveryTime=!0,t.supportedLanguages=["en"],t.TakeScreenshots=!1,t.ENABLE_PORTRAIT=!0,t.DO_NOT_HANDLE_ORIENTATION=!1,t.FORCE_TOUCH_TO_START=!0,t.SHOW_LANGUAGES=!0,t.SHOW_CREDITS=!0,t.PLAY_ON_FIRST_RUN=!0,t.SCORE_SYSTEM=!1,t.SCORE_SYSTEM_PARTICLES=!1,t.WAVE_FLOWERS=!0,t.SEND_TOTAL_SCORE=!1,t.SEND_SCORE_WHEN_LOST=!1,t.DEBUG_NO_SCALE=!1,t.DEBUG_CANNON_QUEUE=!1,t.DEBUG_UNLOCK_ALL_LEVELS=!1,t.DEBUG_UNLOCK_ALL_POWERUPS=!1,t.DEBUG_ENABLE_CHEATS=!1,t.DEBUG_STARS=0,t.DEBUG_CHAIN_POWERUPS_MASK=0,t.DEBUG_ELEMENT_POWERUPS_MASK=0,t.DEBUG_LEVEL_NAMES=!1,t.DEBUG_TUTORIAL_EVERY_TIME=!1,t.DEBUG_LOAD_INDIVIDUAL_LEVEL_FILES=!1,t.DEBUG_EMULATE_MOBILE=!1,t.DEBUG_BALLS=-1,t.DEBUG_PROFILE_IDX=0,t.DEBUG_USE_PROFILES=!1,t.DEBUG_PROFILES=[{balls:-1,powerups:null},{balls:3,powerups:{0:{level:1},1:{level:1},2:{level:1},3:{level:0},4:{level:0},5:{level:0},6:{level:1},7:{level:0},8:{level:0},9:{level:0},10:{level:1},11:{level:0},12:{level:0},13:{level:0}}},{balls:4,powerups:{0:{level:2},1:{level:2},2:{level:2},3:{level:2},4:{level:0},5:{level:0},6:{level:2},7:{level:2},8:{level:0},9:{level:0},10:{level:2},11:{level:0},12:{level:2},13:{level:0}}},{balls:5,powerups:{0:{level:3},1:{level:2},2:{level:3},3:{level:3},4:{level:3},5:{level:0},6:{level:2},7:{level:3},8:{level:0},9:{level:2},10:{level:2},11:{level:2},12:{level:2},13:{level:0}}},{balls:6,powerups:{0:{level:3},1:{level:3},2:{level:3},3:{level:3},4:{level:3},5:{level:2},6:{level:3},7:{level:3},8:{level:3},9:{level:3},10:{level:3},11:{level:2},12:{level:2},13:{level:0}}}],t.LEVEL_MAX=60,t.ATLAS_COMMON="UI",t.ATLAS_SPRITES="Game",t.ATLAS_OBJECTS_BOTTOM="UI",t.ATLAS_GAME="Game",t.ATLAS_UI="UI",t.ATLAS_FONT="UI",t.ATLAS_LEVELS="Levels",t.ATLAS_POWERUPS="UI",t.ATLAS_HUD="Game",t.ATLAS_EFFECTS="Game",t.ATLAS_LOGO="UI",t.ATLAS_GAMEOVER="UI",t.IMAGE_TRAJECTORY="Trajectory",t.FONT="Font",t.FONT_STARS="StarsNum",t.FONT_LEVELS="LevelsNum",t.FONT_SCORE_GAME="ScoreGame",t.FONT_SCORE_LEVELS="ScoreLevels",t.FONT_SCORE_MENU_SIZE=36,t.FONT_SCORE_GAME_SIZE=36,t.FONT_SCORE_WIN_SIZE=36,t.FONT_SCORE_LEVELS_SIZE=20,t.FONT_DIALOG_TITLE="Font",t.FONT_DIALOG_TITLE_SIZE=30,t.FONT_DIALOG_TEXT="Font",t.FONT_DIALOG_TEXT_SIZE=27,t.FONT_TUTORIAL_TEXT="Font",t.FONT_TUTORIAL_TEXT_SIZE=30,t.FONT_POWERUPS_TEXT="Font",t.FONT_POWERUPS_TEXT_SIZE=25,t.FONT_POWERUPS_TEXT_SIZE_JA=30,t.FONT_POWERUPS_PANEL_TEXT="Font",t.FONT_POWERUPS_PANEL_TEXT_SIZE=22,t.FONT_POWERUPS_STARS_TEXT="StarsNum",t.FONT_POWERUPS_STARS_TEXT_SIZE=90,t.TEXTURES={bg:{path:"assets/images/bg",images:["bd1.jpg","bg1.jpg","bg2.jpg","bg3.jpg","bg5.jpg","bm1.jpg","bp1.jpg","bs1.jpg","bs2.jpg","bw1.jpg","bl1.png"]},path:{path:"assets/images/path",images:["pt1.png","pt2.png","pt3.png","pt4.png","pt5.png","pt6.png","pt8.png","pt9.png"]}},t.BG_WIDTH=2048,t.BG_HEIGHT=1024,t.BRIDGES_MAX=4,t.BRIDGE_MAX_WIDTH=512,t.BRIDGE_MAX_HEIGHT=512,t.MATCH_MIN=3,t.COMBO_TIME=3e3,t.COMBO_MATCHES_FOR_RAINBOW=5,t.CURVE_STEP=10,t.CHAIN_BONUS_GENERATE_TIMES=[0,300,300,350,350,350,300,300],t.CHAIN_BONUS_GENERATE_TIME_VARIANCE=.15,t.CHAIN_BONUS_DURATION=5e3,t.CHAIN_BONUS_BLINK_START_TIME=t.CHAIN_BONUS_DURATION-1400,t.CHAIN_BONUS_BLINK_PERIOD=200,t.CHAIN_BONUS_APPEAR_DURATION=250,t.STARDUST_LEVEL_LIMIT=2,t.STARDUST_DURATION=8e3,t.STARDUST_WAITING_MIN=25e3,t.STARDUST_WAITING_MAX=t.STARDUST_WAITING_MIN+1e4,t.LAUNCHED_BALL_SPEED=1200,t.CONSECUTIVE_TYPES_MAX=3,t.CHAIN_SPEED=68,t.CHAIN_SHRINK_SPEED=150,t.CHAIN_SLOW_COEF=.5,t.CHAIN_FREEZE_COEF=0,t.CHAIN_SPEED_NEW_WAVE_COEF=8,t.CHAIN_MULTI_COEF=.9,t.CHAIN_NEW_WAVE_DIST_FAST_RIDE=.35,t.CHAIN_NEW_WAVE_CANCEL_FAST_RIDE=.5,t.LEVELS_DIFFICULTY={},t.SCORE_FOR_BALL=100,t.ELEMENT_LIMIT=20,t.ELEMENT_LIMIT_FAST_FILL=1.2,t.HOLE_ROOTS_CHECK_DISTANCE=500,t.HOLE_ROOTS_FULL_DISTANCE=150,t.COMBO_NUMS_SCALE=1,t.COMPLETED_STAR_OFFSET_X=0,t.COMPLETED_STAR_OFFSET_Y=0,t.LIMITS_OFFSET_FROM_LEFT=0,t.LIMITS_OFFSET_FROM_TOP=0,t.LIMITS_DISPLAY_VERTICAL=!1,t.STARDUST_OFFSET_FROM_CENTER=0,t.PORTRAIT_BOTTOM_BUTTONS_OFFSET=0,t}();e.Config=n},3860:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CurvePath=void 0;var i=n(713),o=function(){function t(t,e){this._path=null,this._pathLength=-1,this._pathStep=0,this._hlpPoint={x:0,y:0,angle:0,layer:0,shadowLayer:0,tunnelId:-1,tunnelStartDist:0,tunnelStartPt:{x:0,y:0},tunnelEndDist:0,tunnelEndPt:{x:0,y:0}},this._pathPosition={idx:0,frac:0},this._l=new Phaser.Line,this._c=new Phaser.Circle,this._path=[],this._pathStep=e,this.turnPathIntoPoints(t),this._pathLength=(this._path.length-1)*this._pathStep}return Object.defineProperty(t.prototype,"pathLength",{get:function(){return this._pathLength},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pathPointsCount",{get:function(){return this._path.length},enumerable:!1,configurable:!0}),t.prototype.render=function(t){for(var e=0;e<this._path.length;e++){var n=0===this._path[e].layer?"RGBA(0,255,0,1)":"RGBA(255,0,0,1)";this._c.setTo(this._path[e].x,this._path[e].y,4),t.debug.geom(this._c,n,!0)}for(e=0;e<this._path.length;e++){var i=this.getPathPointAt(e);t.debug.text(""+this._path[e].tunnelId,i.x+640,i.y+400,"RGBA(0,255,255,1)","8px monospace")}},t.prototype.turnPathIntoPoints=function(t){for(var e=this._path,n=t.x.length,i=0;i<n;i++){var o={x:t.x[i],y:t.y[i],angle:t.angle[i],layer:t.layer[i],shadowLayer:t.shadowLayer[i],tunnelId:t.tunnelId[i]-1};if(o.tunnelId>=0){var r=t.tunnelData[t.tunnelRef[i]-1];o.tunnelStartDist=r.sd,o.tunnelStartPt={x:r.sp.x,y:r.sp.y},o.tunnelEndDist=r.ed,o.tunnelEndPt={x:r.ep.x,y:r.ep.y}}e.push(o)}},t.prototype.getPathPointAt=function(t){return t<0||this._path.length,this._path[t]},t.prototype.getPointAtDistance=function(t,e){void 0===e&&(e=this._hlpPoint);var n=this.getPathPosition(t),o=this._path[n.idx],r=this._path[n.idx+1],s=n.frac;return e.x=o.x+(r.x-o.x)*s,e.y=o.y+(r.y-o.y)*s,e.angle=i.MathHelp.angleLinear(o.angle,r.angle,s),e.layer=s<.5?o.layer:r.layer,e.shadowLayer=s<.5?o.shadowLayer:r.shadowLayer,e},t.prototype.getDirectionAtDistance=function(t,e){void 0===e&&(e=this._hlpPoint);var n=this.getPathPosition(t),i=this._path[n.idx],o=this._path[n.idx+1];return e.x=o.x-i.x,e.y=o.y-i.y,e},t.prototype.getTunnelId=function(t){var e=this.getPathPosition(t);return e.frac<.5?this._path[e.idx].tunnelId:this._path[e.idx+1].tunnelId},t.prototype.getTunnelInfo=function(t,e){void 0===e&&(e=this._hlpPoint);var n=this.getPathPosition(t),i=n.frac<.5?this._path[n.idx]:this._path[n.idx+1];return e.tunnelId=i.tunnelId,i.tunnelId>=0&&(e.tunnelStartDist=i.tunnelStartDist,e.tunnelStartPt=i.tunnelStartPt,e.tunnelEndDist=i.tunnelEndDist,e.tunnelEndPt=i.tunnelEndPt),e},t.prototype.getPointAtExtendedDistance=function(t,e){if(void 0===e&&(e=this._hlpPoint),t>=0&&t<=this._pathLength)return this.getPointAtDistance(t,e);var n,i;t<0?(n=this._path[1],i=this._path[0]):(n=this._path[this._path.length-2],i=this._path[this._path.length-1]);var o=Phaser.Math.distance(n.x,n.y,i.x,i.y);0===o&&(o=1);var r=t<0?-t:t-this._pathLength;return e.x=(i.x-n.x)/o*r+i.x,e.y=(i.y-n.y)/o*r+i.y,e.angle=i.angle,e.layer=i.layer,e.shadowLayer=i.shadowLayer,e},t.prototype.getPathPosition=function(t){var e=this._pathPosition,n=(t=Phaser.Math.clamp(t,0,this._pathLength))/this._pathStep,i=Math.floor(n),o=n-i;return i>=this._path.length-1&&(i=this._path.length-2,o=1),e.idx=i,e.frac=o,e},t}();e.CurvePath=o},1391:function(t,e,n){"use strict";var i,o;Object.defineProperty(e,"__esModule",{value:!0}),e.Defs=void 0;var r=n(5357),s=n(9071),a=function(){function t(){}return t.COLOR_BG=729624,t.COLOR_BG_LIGHT=1658167,t.TEXT_COLORS=[16777215,16711680,65280,255,16105730],t.COLOR_POWERUPS_PANEL_TITLE=16105730,t.COLOR_DIALOG_BG=1191458,t.COLOR_DIALOG_TITLE=16105730,t.COLOR_DIALOG_TEXT=16777215,t.COLOR_DIALOG_TEXT_YELLOW=16105730,t.COLOR_DIALOG_CREDITS_HEADING=16777215,t.ELEMENT_TINT_BLUE=4614885,t.ELEMENT_TINT_RED=16125454,t.ELEMENT_TINT_GREEN=5240362,t.ELEMENT_TINT_YELLOW=16315189,t.ELEMENT_TINT_CYAN=3845542,t.ELEMENT_TINT_PURPLE=13641718,t.BALL_TINT_BLUE=3302399,t.BALL_TINT_RED=16655908,t.BALL_TINT_GREEN=4517180,t.BALL_TINT_YELLOW=16766271,t.BALL_TINT_CYAN=8126452,t.BALL_TINT_PURPLE=16735742,t.COLOR_BALLISTICS_VALID=11711231,t.COLOR_BALLISTICS_INVALID=16744576,t.OBJ_ID_CANNON="cannon",t.OBJ_ID_HOLE="eh1",t.OBJ_ID_WATER="ef1",t.OBJ_ID_DUST="ef2",t.WAVE_SCALE={g01:{moveScale:.5,movement:!0,rotationScale:1,rotation:!1},g02:{moveScale:.5,movement:!0,rotationScale:1,rotation:!1},g03:{moveScale:.5,movement:!0,rotationScale:1,rotation:!1},g04:{moveScale:.5,movement:!0,rotationScale:1,rotation:!1},g05:{moveScale:.5,movement:!0,rotationScale:1,rotation:!1},g06:{moveScale:.5,movement:!0,rotationScale:1,rotation:!1},g07:{moveScale:.5,movement:!0,rotationScale:1,rotation:!1},g17:{moveScale:.5,movement:!0,rotationScale:1,rotation:!1},g19:{moveScale:1,movement:!0,rotationScale:1,rotation:!1},g21:{moveScale:.5,movement:!0,rotationScale:1,rotation:!0},g22:{moveScale:.5,movement:!1,rotationScale:1,rotation:!0},g23:{moveScale:.5,movement:!0,rotationScale:1,rotation:!0},g24:{moveScale:.5,movement:!1,rotationScale:1,rotation:!0},g27:{moveScale:.5,movement:!1,rotationScale:1,rotation:!0},g28:{moveScale:.5,movement:!1,rotationScale:1,rotation:!0},g29:{moveScale:.5,movement:!1,rotationScale:1,rotation:!0},g31:{moveScale:1,movement:!1,rotationScale:1,rotation:!1},g32:{moveScale:1,movement:!1,rotationScale:1,rotation:!1}},t.FRAME_BG_UI="menuBg",t.FRAME_CONGRATS="congrats",t.FRAME_SCORE_PTC="scorePtc_000",t.FRAME_MENU_BG_LIGHT="bgLight",t.FRAME_LANG_SHADOW="langShadow",t.FRAME_LANG_SELECTED="langSelected",t.TREES_DIALOG=[["sh1",121.3,44.7,1.4,1.4,4,1,16777215],["sh1",-242.2,56.8,1.49,1.49,33,1,16777215],["sh1",238.5,54.9,1.34,1.34,33,1,16777215],["g28",245.8,.1,.71,.71,44.5,1,16777215],["sh1",-93.7,27.7,1.4,1.4,4,1,16777215],["sh1",-9.8,40.2,1.1,1.1,33,1,16777215],["g24",119.2,9.1,.73,.73,5.5,1,16777215],["g29",-137,-3],["g23",-24.5,.8,.72,.72,12.25,1,16777215],["g28",-247.3,4.4,.72,.72,-30.75,1,16777215]],t.TREES_TOP_LEFT=[["sh1",-593,-135,2.06,2.06,0,1,16777215],["sh1",-219,-348,1.86,1.86,0,1,16777215],["g28",-241,-399,1.01,1.01,-.75,1,16777215],["sh1",-543,-294,2.7,2.7,0,1,16777215],["g28",-461,-328,1.01,1.01,103.75,1,16777215],["sh1",-367,-267,1.53,1.53,0,1,16777215],["g24",-379,-313,1.01,1.01,140.75,1,16777215],["g28",-626,-141,1,1,139,1,16777215],["g28",-572,-198,1,1,-12.25,1,16777215],["sh1",-622,-284,1.66,1.66,0,1,16777215],["g23",-592,-355,1,1,144.75,1,16777215],["sh1",-633,-392,4.5,3.53,0,.4,16777215]],t.TREES_TOP_RIGHT=[["sh1",201,-353,1.86,1.86,-148,1,16777215],["sh1",502,-258,2.7,2.7,0,1,16777215],["g28",229.1,-400.4,1,1,10.5,1,16777215],["g28",479.1,-268.4,1,1,-96.75,1,16777215],["g28",593.9,-320,1,1,-111.5,1,16777215],["sh1",579,-147,1.04,1.04,-148,1,16777215],["g29",590,-151.6,1.01,1.01,164,1,16777215],["g28",409.1,-375.4,1,1,-9.5,1,16777215],["sh1",574,-337,1.04,1.04,-148,.8,16777215],["g29",574.9,-338,1,1,-111.5,1,16777215],["sh1",634,-394,4.5,3.52,0,.4,16777215],["sh1",360,-279,1.22,1.22,-148,1,16777215],["g27",299.1,-305.4,1,1,-78.5,1,16777215],["g27",385.1,-318.4,1.02,1.02,92.25,1,16777215],["g27",363.1,-246.4,1,1,-167.25,1,16777215]],t.TREES_BOTTOM_LEFT=[["sh1",-318,445,2.7,2.7,0,1,16777215],["sh1",-586,255,2.7,2.7,0,1,16777215],["g28",-283.2,413.7,1,1,-173.25,1,16777215],["g28",-457.2,314.7,1,1,25.24,1,16777215],["sh1",-432,398,1.18,1.18,0,1,16777215],["g23",-607.1,208.5,1,1,-134.5,1,16777215],["g29",-411.2,357.3,1,1,22,1,16777215],["sh1",-605,378,1.59,1.59,0,1,16777215],["g24",-581.2,357.3,1,1,66.5,1,16777215],["sh1",-634,394,4.5,3.53,0,.4,16777215]],t.TREES_BOTTOM_RIGHT=[["sh1",365,409,2.7,2.7,0,1,16777215],["sh1",625,208,2.7,2.7,0,1,16777215],["g23",283.3,400.7,.93,.93,164.25,1,16777215],["g28",429.3,316.7,1.01,1.01,32.5,1,16777215],["g24",624.7,139,1,1,-100.76,1,16777215],["g28",559.7,233,1,1,-18.76,1,16777215],["sh1",639,310,1.44,1.44,0,1,16777215],["g23",617.6,337.9,1,1,-37.25,1,16777215],["sh1",633,393,4.5,3.53,0,.4,16777215]],t.TREES_MENU_POSITIONS=[{x:-690,y:-455},{x:690,y:-455},{x:-690,y:450},{x:690,y:450}],t.TREES_LEVELS_POSITIONS=[{x:-750,y:-467},{x:750,y:-467},{x:-800,y:558},{x:810,y:565}],t.TREES_POWERUPS_POSITIONS=[{x:-750,y:-467},{x:750,y:-467},{x:-800,y:558},{x:810,y:565}],t.TREES_OUT_POSITIONS=[{x:-840,y:-600},{x:840,y:-600},{x:-840,y:600},{x:840,y:600}],t.TREES_MENU_POSITIONS_PORTRAIT=[{x:-555,y:-690},{x:555,y:-690},{x:-555,y:690},{x:555,y:690}],t.TREES_LEVELS_POSITIONS_PORTRAIT=[{x:-580,y:-725},{x:580,y:-725},{x:-625,y:770},{x:635,y:780}],t.TREES_POWERUPS_POSITIONS_PORTRAIT=[{x:-580,y:-725},{x:580,y:-725},{x:-625,y:770},{x:635,y:780}],t.TREES_OUT_POSITIONS_PORTRAIT=[{x:-690,y:-840},{x:690,y:-840},{x:-690,y:840},{x:690,y:840}],t.FRAMES_FORCE_TOUCH=["touch00","touch01","touch02","touch03","touch04","touch00","touch00","touch00","touch00","touch00","touch00","touch00","touch00"],t.FRAME_LEVEL_CLOSED="levelClosed",t.FRAME_LEVEL_STAR="levelStar",t.FRAME_LEVEL_STAR_EMPTY="levelStarEmpty",t.FRAME_LEVEL_FRAME="levelFrame",t.FRAME_LEVEL_SCORE_BG="scoreBg",t.FRAMES_POWERUPS_STARS=["pwStars0","pwStars1","pwStars2","pwStars3"],t.FRAME_HUD_LIMITS_BG_LEFT="limitBgLeft",t.FRAME_HUD_LIMITS_BG_MIDDLE="limitBgMiddle",t.FRAME_HUD_LIMITS_BG_RIGHT="limitBgRight",t.FRAME_HUD_LIMITS_BAR_BG="limitBarBg",t.FRAME_HUD_LIMITS_BAR_BG_LEFT="limitBarBgLeft",t.FRAMES_HUD_STARDUST=["hudStar0","hudStar1","hudStar2","hudStar3","hudStar4","hudStar5"],t.FRAMES_HUD_QUEUE_BG="queueBg",t.FRAMES_HUD_QUEUE_ICON="queueCannon",t.FRAME_TRAJECTORY="trajectory",t.FRAME_TRAJECTORY_IMPACT="trajectoryImpact",t.FRAME_BUTTON_SHADOW_BALL="buttonShadow",t.FRAME_BUTTON_SHADOW_POWERUP="buttonShadowPowerup",t.FRAMES_MOTOR_PUSH=["golem00","golem01","golem02","golem03","golem04","golem05","golem06","golem07","golem08","golem09","golem10","golem11","golem12","golem13","golem14","golem15","golem16","golem17","golem18","golem19","golem20","golem21","golem22","golem23","golem24","golem25","golem26","golem27","golem28","golem29","golem30","golem31","golem32","golem33","golem34","golem35","golem36","golem37","golem38","golem39"],t.FRAMES_MOTOR_WALK=["golemWalk00","golemWalk01","golemWalk02","golemWalk03","golemWalk04","golemWalk05","golemWalk06","golemWalk07","golemWalk08","golemWalk09","golemWalk10","golemWalk11","golemWalk12","golemWalk13","golemWalk14","golemWalk15","golemWalk16","golemWalk17","golemWalk18","golemWalk19","golemWalk20","golemWalk21","golemWalk22","golemWalk23","golemWalk24","golemWalk25","golemWalk26","golemWalk27","golemWalk28","golemWalk29","golemWalk30","golemWalk31","golemWalk32","golemWalk33","golemWalk34"],t.FRAME_MOTOR_PUSH_SHADOW="motorPushShadow",t.FRAME_MOTOR_WALK_SHADOW="motorWalkShadow",t.FRAME_TRAIL="trail",t.FRAMES_BALL_BREAK_FOG=["ballSmoke00","ballSmoke01","ballSmoke02","ballSmoke03","ballSmoke04","ballSmoke05","ballSmoke06","ballSmoke07","ballSmoke08","ballSmoke09","ballSmoke10","ballSmoke11","ballSmoke12","ballSmoke13","ballSmoke14","ballSmoke15"],t.FRAMES_BALL_BREAK_RING=["ballRing0","ballRing1","ballRing2","ballRing3","ballRing4","ballRing5","ballRing6","ballRing7","ballRing8"],t.FRAMES_HOLE_ROOTS=["roots0000","roots0001","roots0002","roots0003","roots0004","roots0005","roots0006"],t.FRAMES_STARDUST_SHOW=["starDustShow7","starDustShow6","starDustShow5","starDustShow4","starDustShow3","starDustShow2","starDustShow1","starDustShow0"],t.FRAMES_STARDUST_IDLE=["starDust0","starDust1","starDust2","starDust3","starDust4","starDust5"],t.FRAMES_STARDUST_HIDE=["starDustShow0","starDustShow1","starDustShow2","starDustShow3","starDustShow4","starDustShow5","starDustShow6","starDustShow7"],t.FRAMES_BOLT=[["bolt48_0","bolt48_1","bolt48_2"],["bolt96_0","bolt96_1","bolt96_2"],["bolt192_0","bolt192_1","bolt192_2"],["bolt384_0","bolt384_1","bolt384_2"]],t.FRAMES_BOLT_SPOTS=["boltSpot00","boltSpot01","boltSpot02"],t.FRAMES_EXPLOSION=["explosion00","explosion01","explosion02","explosion03","explosion04","explosion05","explosion06","explosion07","explosion08","explosion09","explosion10","explosion11","explosion12","explosion13","explosion14"],t.FRAMES_ELEMENT_BLUE_SPLAT_SHORT=["splatSmall00","splatSmall01","splatSmall02","splatSmall03","splatSmall04","splatSmall05","splatSmall06","splatSmall07","splatSmall08","splatSmall09","splatSmall10","splatSmall11"],t.FRAMES_ELEMENT_BLUE_SPLAT_LONG=["splatBig00","splatBig01","splatBig02","splatBig03","splatBig04","splatBig05","splatBig06","splatBig07","splatBig08","splatBig09","splatBig10","splatBig11"],t.FRAMES_ELEMENT_RED_LADYBUG=["ladybug0","ladybug1","ladybug2","ladybug3","ladybug4","ladybug5"],t.FRAME_ELEMENT_RED_LADYBUG_SHADOW="ladybugShadow",t.FRAME_ELEMENT_RED_LADYBUG_BOMB="ladybugBomb",t.FRAME_ELEMENT_RED_LADYBUG_BOMB_SHADOW="ladybugBombShadow",t.FRAMES_ELEMENT_RED_LADYBUG_BOMB_PTC=["ladybugBombPtc0","ladybugBombPtc1","ladybugBombPtc2","ladybugBombPtc3","ladybugBombPtc4","ladybugBombPtc5","ladybugBombPtc6","ladybugBombPtc7","ladybugBombPtc8"],t.FRAMES_WATER_REFLECTION_PTC=["water56","water57","water58","water59","water60","water61","water62","water63","water64","water65","water66","water67","water68","water69","water70","water71","water72","water73","water74","water75","water76","water77","water78","water79","water80","water81","water82","water83","water84","water85","water86","water87","water88","water89","water90","water91","water92","water93","water94","water95","water96"],t.FRAME_ELEMENT_GREEN_ARROW="greenArrow",t.FRAME_ELEMENT_GREEN_ARROW_TRAIL="greenArrowTrail",t.FRAME_ELEMENT_YELLOW_FLAME_HEAD="flameHead",t.FRAMES_BALL_ELEMENT_BLUE=["ballElementBlue00","ballElementBlue01","ballElementBlue02","ballElementBlue03","ballElementBlue04","ballElementBlue05","ballElementBlue06","ballElementBlue07","ballElementBlue08","ballElementBlue09","ballElementBlue10","ballElementBlue11","ballElementBlue12","ballElementBlue13","ballElementBlue14","ballElementBlue15","ballElementBlue16","ballElementBlue17","ballElementBlue18","ballElementBlue19"],t.FRAMES_BALL_ELEMENT_RED=["ballElementRed0","ballElementRed1","ballElementRed2","ballElementRed3","ballElementRed4","ballElementRed5"],t.FRAMES_BALL_ELEMENT_GREEN=["ballElementGreen0","ballElementGreen1","ballElementGreen2","ballElementGreen3","ballElementGreen4","ballElementGreen5"],t.FRAMES_BALL_ELEMENT_YELLOW=["ballElementYellow0","ballElementYellow1","ballElementYellow2","ballElementYellow3","ballElementYellow4","ballElementYellow5","ballElementYellow6","ballElementYellow7","ballElementYellow8","ballElementYellow9"],t.FRAMES_BALL_ELEMENT_CYAN=["ballElementCyan0","ballElementCyan1","ballElementCyan2","ballElementCyan3"],t.FRAMES_BALL_ELEMENT_PURPLE=["ballElementPurple0","ballElementPurple1","ballElementPurple2","ballElementPurple3","ballElementPurple4","ballElementPurple5"],t.FRAMES_BALL_RAINBOW=["ballRainbow0","ballRainbow1","ballRainbow2","ballRainbow3","ballRainbow4","ballRainbow5"],t.FRAMES_BALL_BOMB=["ballBomb0","ballBomb1","ballBomb2","ballBomb3"],t.FRAMES_BALL_CHAIN_STEEL=["ballSteel0","ballSteel1","ballSteel2","ballSteel3","ballSteel4","ballSteel5","ballSteel6"],t.FRAMES_ELEMENT_CYAN_SPARKS1=["boltPtc0","boltPtc1","boltPtc2"],t.FRAMES_ELEMENT_CYAN_SPARKS2=["boltPtc1","boltPtc2","boltPtc0"],t.FRAMES_ELEMENT_PURPLE_STAGBUG=["stagBug0","stagBug1","stagBug2","stagBug3","stagBug4","stagBug5"],t.FRAMES_SEAL=["blocker00","blocker01","blocker02","blocker03","blocker04","blocker05","blocker06","blocker07","blocker08","blocker09","blocker10","blocker11","blocker12","blocker13","blocker14","blocker15","blocker16","blocker17","blocker18","blocker19"],t.FRAMES_TUTORIAL_BG="blockWhite",t.FRAMES_TUTORIAL_RECT="tutorialRect",t.FRAMES_TUTORIAL_CIRCLE="tutorialCircle",t.FRAMES_TUTORIAL_TARGET="tutorialTarget",t.FRAMES_TUTORIAL_TEXT_BG="blockWhite",t.FRAMES_TRANSITION_EFFECT_BG="blockBlack",t.ANIM_LADYBUG="ladybug",t.TASK_SPRITES_ANIMS=[{name:t.ANIM_LADYBUG,frameRate:30,loop:!0,killOnComplete:!1,atlasKey:r.Config.ATLAS_GAME,frames:t.FRAMES_ELEMENT_RED_LADYBUG}],t.ANIM_STAR=null,t.ANIM_POP_BG=null,t.ANIM_POP=null,t.ANIM_LEVEL_GATE=null,t.ANIM_GAME_OVER=null,t.ANIM_TITLE=null,t.EMPTY_TEXT="",t.SCORE_TEXT="ÂÄÅ ",t.ELEMENTS=[{key:0,frame:"ballBlue",shineFrame:"ballBlueShine",tint:t.ELEMENT_TINT_BLUE},{key:1,frame:"ballRed",shineFrame:"ballRedShine",tint:t.ELEMENT_TINT_RED},{key:2,frame:"ballGreen",shineFrame:"ballGreenShine",tint:t.ELEMENT_TINT_GREEN},{key:3,frame:"ballYellow",shineFrame:"ballYellowShine",tint:t.ELEMENT_TINT_YELLOW},{key:4,frame:"ballCyan",shineFrame:"ballCyanShine",tint:t.ELEMENT_TINT_CYAN},{key:5,frame:"ballPurple",shineFrame:"ballPurpleShine",tint:t.ELEMENT_TINT_PURPLE}],t.BALL_MOTOR=t.ELEMENTS.length,t.BALL_SPECIAL=256,t.BALL_SPECIAL_MASK=t.BALL_SPECIAL-1,t.BALL_ELEMENT_BLUE=t.BALL_SPECIAL+0,t.BALL_ELEMENT_RED=t.BALL_SPECIAL+1,t.BALL_ELEMENT_GREEN=t.BALL_SPECIAL+2,t.BALL_ELEMENT_YELLOW=t.BALL_SPECIAL+3,t.BALL_ELEMENT_CYAN=t.BALL_SPECIAL+4,t.BALL_ELEMENT_PURPLE=t.BALL_SPECIAL+5,t.BALL_CHAIN_BOMB=t.BALL_SPECIAL+10,t.BALL_CHAIN_STEEL=t.BALL_SPECIAL+11,t.BALL_REWARD_RAINBOW=t.BALL_SPECIAL+13,t.ELEMENT_POWERUP_IDS=[0,1,2,3,4,5],t.CHAIN_POWERUP_IDS=[6,7,8,10,9,11,12],t.POWERUPS=((i={})[0]={shopFrame:"pwElementBlue",shopFrameSelected:"pwElementBlueSelected",availableFrom:0,levels:[{textID:"TXT_PW_BLUE_0",values:[0]},{textID:"TXT_PW_BLUE_1",values:[4]},{textID:"TXT_PW_BLUE_2",values:[6]},{textID:"TXT_PW_BLUE_3",values:[8]}],tutorialFlag:s.TutorialFlag.None,chainFrame:null,tint:t.ELEMENT_TINT_BLUE,limitFrame:"limitIconBlue",limitBarFrame:"limitBarBlue",queueFrame:"queueBlue",ballFrame:"ballElementBlue00",shineFrame:"ballElementShine"},i[1]={shopFrame:"pwElementRed",shopFrameSelected:"pwElementRedSelected",availableFrom:0,levels:[{textID:"TXT_PW_RED_0",values:[0]},{textID:"TXT_PW_RED_1",values:[400]},{textID:"TXT_PW_RED_2",values:[375]},{textID:"TXT_PW_RED_3",values:[350]}],tutorialFlag:s.TutorialFlag.None,chainFrame:null,tint:t.ELEMENT_TINT_RED,limitFrame:"limitIconRed",limitBarFrame:"limitBarRed",queueFrame:"queueRed",ballFrame:"ballElementRed0",shineFrame:"ballElementShine"},i[2]={shopFrame:"pwElementGreen",shopFrameSelected:"pwElementGreenSelected",availableFrom:0,levels:[{textID:"TXT_PW_GREEN_0",values:[0]},{textID:"TXT_PW_GREEN_1",values:[3]},{textID:"TXT_PW_GREEN_2",values:[5]},{textID:"TXT_PW_GREEN_3",values:[7]}],tutorialFlag:s.TutorialFlag.None,chainFrame:null,tint:t.ELEMENT_TINT_GREEN,limitFrame:"limitIconGreen",limitBarFrame:"limitBarGreen",queueFrame:"queueGreen",ballFrame:"ballElementGreen0",shineFrame:"ballShine"},i[3]={shopFrame:"pwElementYellow",shopFrameSelected:"pwElementYellowSelected",availableFrom:5,levels:[{textID:"TXT_PW_YELLOW_0",values:[0,0]},{textID:"TXT_PW_YELLOW_1",values:[1,3]},{textID:"TXT_PW_YELLOW_2",values:[2,3]},{textID:"TXT_PW_YELLOW_3",values:[3,3]}],tutorialFlag:s.TutorialFlag.PwYellow,chainFrame:null,tint:t.ELEMENT_TINT_YELLOW,limitFrame:"limitIconYellow",limitBarFrame:"limitBarYellow",queueFrame:"queueYellow",ballFrame:"ballElementYellow0",shineFrame:"ballShine"},i[4]={shopFrame:"pwElementCyan",shopFrameSelected:"pwElementCyanSelected",availableFrom:20,levels:[{textID:"TXT_PW_CYAN_0",values:[0]},{textID:"TXT_PW_CYAN_1",values:[5]},{textID:"TXT_PW_CYAN_2",values:[6]},{textID:"TXT_PW_CYAN_3",values:[7]}],tutorialFlag:s.TutorialFlag.PwCyan,chainFrame:null,tint:t.ELEMENT_TINT_CYAN,limitFrame:"limitIconCyan",limitBarFrame:"limitBarCyan",queueFrame:"queueCyan",ballFrame:"ballElementCyan0",shineFrame:"ballElementShine"},i[5]={shopFrame:"pwElementPurple",shopFrameSelected:"pwElementPurpleSelected",availableFrom:45,levels:[{textID:"TXT_PW_PURPLE_0",values:[0]},{textID:"TXT_PW_PURPLE_1",values:[5]},{textID:"TXT_PW_PURPLE_2",values:[7]},{textID:"TXT_PW_PURPLE_3",values:[9]}],tutorialFlag:s.TutorialFlag.PwPurple,chainFrame:null,tint:t.ELEMENT_TINT_PURPLE,limitFrame:"limitIconPurple",limitBarFrame:"limitBarPurple",queueFrame:"queuePurple",ballFrame:"ballElementPurple0",shineFrame:"ballElementShine"},i[6]={shopFrame:"pwChainSlow",shopFrameSelected:"pwChainSlowSelected",availableFrom:0,levels:[{textID:"TXT_PW_SLOW_0",values:[0]},{textID:"TXT_PW_SLOW_1",values:[4]},{textID:"TXT_PW_SLOW_2",values:[5]},{textID:"TXT_PW_SLOW_3",values:[6]}],tutorialFlag:s.TutorialFlag.None,chainFrame:"bonusSlow",tint:16777215,limitFrame:null,limitBarFrame:null,queueFrame:null,ballFrame:null,shineFrame:null},i[7]={shopFrame:"pwChainFreeze",shopFrameSelected:"pwChainFreezeSelected",availableFrom:8,levels:[{textID:"TXT_PW_FREEZE_0",values:[0]},{textID:"TXT_PW_FREEZE_1",values:[3]},{textID:"TXT_PW_FREEZE_2",values:[4]},{textID:"TXT_PW_FREEZE_3",values:[5]}],tutorialFlag:s.TutorialFlag.PwFreeze,chainFrame:"bonusFreeze",tint:16777215,limitFrame:null,limitBarFrame:null,queueFrame:null,ballFrame:null,shineFrame:null},i[8]={shopFrame:"pwChainBack",shopFrameSelected:"pwChainBackSelected",availableFrom:39,levels:[{textID:"TXT_PW_BACK_0",values:[1]},{textID:"TXT_PW_BACK_1",values:[-6]},{textID:"TXT_PW_BACK_2",values:[-6.5]},{textID:"TXT_PW_BACK_3",values:[-7]}],tutorialFlag:s.TutorialFlag.PwBack,chainFrame:"bonusBack",tint:16777215,limitFrame:null,limitBarFrame:null,queueFrame:null,ballFrame:null,shineFrame:null},i[10]={shopFrame:"pwChainBomb",shopFrameSelected:"pwChainBombSelected",availableFrom:3,levels:[{textID:"TXT_PW_BOMB_0",values:[0]},{textID:"TXT_PW_BOMB_1",values:[96]},{textID:"TXT_PW_BOMB_2",values:[121]},{textID:"TXT_PW_BOMB_3",values:[146]}],tutorialFlag:s.TutorialFlag.PwBomb,chainFrame:"bonusBomb",tint:4210752,limitFrame:null,limitBarFrame:null,queueFrame:"queueBomb",ballFrame:"ballBomb0",shineFrame:"ballShine"},i[9]={shopFrame:"pwChainScore",shopFrameSelected:"pwChainScoreSelected",availableFrom:23,levels:[{textID:"TXT_PW_SCORE_0",values:[0]},{textID:"TXT_PW_SCORE_1",values:[5]},{textID:"TXT_PW_SCORE_2",values:[7]},{textID:"TXT_PW_SCORE_3",values:[9]}],tutorialFlag:s.TutorialFlag.PwScore,chainFrame:"bonusScore",tint:16777215,limitFrame:null,limitBarFrame:null,queueFrame:null,ballFrame:null,shineFrame:null},i[11]={shopFrame:"pwChainSteel",shopFrameSelected:"pwChainSteelSelected",availableFrom:30,levels:[{textID:"TXT_PW_STEEL_0",values:[0]},{textID:"TXT_PW_STEEL_1",values:[1]},{textID:"TXT_PW_STEEL_2",values:[2]},{textID:"TXT_PW_STEEL_3",values:[3]}],tutorialFlag:s.TutorialFlag.PwSteel,chainFrame:"bonusSteel",tint:16777215,limitFrame:null,limitBarFrame:null,queueFrame:"queueSteel",ballFrame:"ballSteel0",shineFrame:"ballShine"},i[12]={shopFrame:"pwChainThrow",shopFrameSelected:"pwChainThrowSelected",availableFrom:15,levels:[{textID:"TXT_PW_THROW_0",values:[0]},{textID:"TXT_PW_THROW_1",values:[3]},{textID:"TXT_PW_THROW_2",values:[4]},{textID:"TXT_PW_THROW_3",values:[5]}],tutorialFlag:s.TutorialFlag.PwThrow,chainFrame:"bonusBalistic",tint:16777215,limitFrame:null,limitBarFrame:null,queueFrame:null,ballFrame:null,shineFrame:null},i[13]={shopFrame:null,shopFrameSelected:null,availableFrom:0,levels:null,tutorialFlag:s.TutorialFlag.None,chainFrame:null,tint:16777215,limitFrame:null,limitBarFrame:null,queueFrame:"queueRainbow",ballFrame:"ballRainbow0",shineFrame:"ballElementShine"},i),t.PANEL_ELEMENTS={titleID:"TXT_ELEMENTS_PANEL",titleOffsetY:-77,starsPanelOffsetY:42,items:[{key:0,x:-430,y:0},{key:1,x:-258,y:0},{key:2,x:-86,y:0},{key:3,x:86,y:0},{key:4,x:258,y:0},{key:5,x:430,y:0}]},t.PANEL_CHAIN={titleID:"TXT_CHAIN_PANEL",titleOffsetY:-79,starsPanelOffsetY:47,items:[{key:6,x:-516,y:0},{key:10,x:-344,y:0},{key:7,x:-172,y:0},{key:12,x:0,y:0},{key:9,x:172,y:0},{key:11,x:344,y:0},{key:8,x:516,y:0}]},t.PANEL_ELEMENTS_PORTRAIT={titleID:"TXT_ELEMENTS_PANEL",titleOffsetY:-171,starsPanelOffsetY:42,items:[{key:0,x:-172,y:-94},{key:1,x:0,y:-94},{key:2,x:172,y:-94},{key:3,x:-172,y:94},{key:4,x:0,y:94},{key:5,x:172,y:94}]},t.PANEL_CHAIN_PORTRAIT={titleID:"TXT_CHAIN_PANEL",titleOffsetY:-173,starsPanelOffsetY:47,items:[{key:6,x:-172,y:-94},{key:10,x:0,y:-94},{key:7,x:172,y:-94},{key:12,x:-258,y:94},{key:9,x:-94,y:94},{key:11,x:94,y:94},{key:8,x:258,y:94}]},t.SFX_BACK={key:"back",volume:1},t.SFX_BALL_CONNECT={key:"ballConnect",volume:1},t.SFX_BALL_MATCH=[{key:"ballMatch1",volume:.8},{key:"ballMatch2",volume:.8},{key:"ballMatch3",volume:.8},{key:"ballMatch4",volume:.8},{key:"ballMatch5",volume:.8}],t.SFX_BALL_SHOT={key:"ballShot",volume:.8},t.SFX_BALL_SWITCH={key:"ballSwitch",volume:.6},t.SFX_BOMB_GET={key:"bombGet",volume:1},t.SFX_BUG_CRIP={key:"bugCrip",volume:1},t.SFX_BUG_DEATH={key:"bugDeath",volume:1},t.SFX_BUG_SHOW={key:"bugShow",volume:1},t.SFX_CLICK={key:"click",volume:1},t.SFX_END_EXPLOSION={key:"endExplosion",volume:1},t.SFX_END_WHOOSH={key:"endWhoosh",volume:1},t.SFX_EXPLOSION={key:"explosion",volume:1},t.SFX_FIRE_BURN={key:"fireBurn",volume:1},t.SFX_FIRE_IMPACT={key:"fireImpact",volume:1},t.SFX_FIRE_LAUNCH={key:"fireLaunch",volume:1},t.SFX_FREEZE={key:"freeze",volume:1},t.SFX_GATE_LOCK={key:"gateLock",volume:1},t.SFX_GATE_OPEN={key:"gateOpen",volume:1},t.SFX_GLASS={key:"glass",volume:1},t.SFX_GUN_IMPACT={key:"gunImpact",volume:.6},t.SFX_GUN_SERVO={key:"gunServo",volume:1},t.SFX_GUN_SHOT={key:"gunShot",volume:1},t.SFX_LB_BOMB={key:"lbBomb",volume:.5},t.SFX_LB_BOMB_IMPACT={key:"lbBombImpact",volume:.5},t.SFX_LB_SHOW={key:"lbShow",volume:1},t.SFX_LGHT_CHAIN={key:"lghtChain",volume:1},t.SFX_LGHT_IMPACT={key:"lghtImpact",volume:1},t.SFX_LIMIT_FULL={key:"limitFull",volume:1},t.SFX_LOSE={key:"lose",volume:1},t.SFX_MOTOR_DEATH={key:"motorDeath",volume:1},t.SFX_PATH_REVEAL={key:"pathReveal",volume:1},t.SFX_PATH_SEAL={key:"pathSeal",volume:1},t.SFX_PWR_UPGRADE={key:"pwrUpgrade",volume:1},t.SFX_RAINBOW_GET={key:"rainbowGet",volume:1},t.SFX_RAINBOW_MATCH={key:"rainbowMatch",volume:1},t.SFX_RECOLOR={key:"recolor",volume:1},t.SFX_SCORE={key:"score",volume:1},t.SFX_SLOW={key:"slow",volume:1},t.SFX_STAR={key:"star",volume:1},t.SFX_STARDUST_HUD={key:"stardustHUD",volume:1},t.SFX_STARDUST_PICK={key:"stardustPick",volume:1},t.SFX_STARDUST_SHOW={key:"stardustShow",volume:1},t.SFX_STEEL_GET={key:"steelGet",volume:1},t.SFX_STEEL_HIT=[{key:"steelHit1",volume:1},{key:"steelHit2",volume:1},{key:"steelHit3",volume:1}],t.SFX_STEEL_WALL={key:"steelWall",volume:.5},t.SFX_SUMMON_FOG={key:"summonFog",volume:1},t.SFX_SUMMON_SPARKLES={key:"summonSparkles",volume:.4},t.SFX_THROW={key:"throw",volume:1},t.SFX_THROW_GET={key:"throwGet",volume:1},t.SFX_THROW_IMPACT={key:"throwImpact",volume:1},t.SFX_TOOL_DROP1={key:"toolDrop1",volume:1},t.SFX_TOOL_DROP2={key:"toolDrop2",volume:1},t.SFX_WHEEL_DROP={key:"wheelDrop",volume:1},t.SFX_WHEEL_SHAKE={key:"wheelShake",volume:1},t.SFX_WIN={key:"win",volume:1},t.POWERID_TO_SFX_KEY=((o={})[6]=t.SFX_SLOW,o[7]=t.SFX_FREEZE,o[8]=t.SFX_BACK,o[9]=t.SFX_SCORE,o[10]=t.SFX_BOMB_GET,o[11]=t.SFX_STEEL_GET,o[12]=t.SFX_THROW_GET,o[13]=t.SFX_RAINBOW_GET,o),t.MUSIC_MENU_KEY="Menu",t.MUSIC_VOLUME={Menu:.8,Game1:.7,Game2:.7,Game3:.8},t.LEVEL_KEYS=["Jup_level01","Jup_level15","Jup_level11","Jup_level05","Jup_level18","Jup_level04","Jup_level19","Jup_level09","Jup_level28","Jup_level45","Jup_level43","Jup_level42","Tom_04","Jup_level35","Tom_03","Jup_level30","Tom_15","Tom_12","Jup_level20","Tom_18","Jup_level07","Jup_level03","Jup_level06","Jup_level02","Jup_level08","Tom_02","Jup_level12","Jup_level14","Tom_05","Jup_level25","Jup_level22","Tom_20","Jup_level31","Jup_level38","Jup_level27","Tom_14","Tom_06","Tom_07","Jup_level21","Tom_10","Tom_13","Tom_16","Jup_level10","Tom_23","Tom_24","Jup_level13","Jup_level17","Jup_level23","Tom_01","Jup_level33","Jup_level36","Jup_level41","Jup_level44","Jup_level24","Tom_08","Tom_11","Tom_19","Tom_22","Tom_21","Tom_17"],t.DLG_ID_MENU="Menu",t.DLG_ID_REPLAY="Repaly",t.DLG_ID_CONTINUE="Continue",t.DLG_ID_NEXT="Next",t.DLG_ID_SOUND="Sound",t.DLG_ID_MUSIC="Music",t}();e.Defs=a},7751:function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.ParticleDefs=void 0;var o=n(5357),r=n(3776),s=n(7748),a=n(1391),l=function(){function t(){}return t.ANIMS=[{name:"explosion",frameRate:20,loop:!1,killOnComplete:!0,atlasKey:o.Config.ATLAS_EFFECTS,frames:a.Defs.FRAMES_EXPLOSION},{name:"sparks1",frameRate:12,loop:!0,killOnComplete:!1,atlasKey:o.Config.ATLAS_EFFECTS,frames:a.Defs.FRAMES_ELEMENT_CYAN_SPARKS1},{name:"sparks2",frameRate:14,loop:!0,killOnComplete:!1,atlasKey:o.Config.ATLAS_EFFECTS,frames:a.Defs.FRAMES_ELEMENT_CYAN_SPARKS2},{name:"splatShort",frameRate:14,loop:!1,killOnComplete:!1,atlasKey:o.Config.ATLAS_EFFECTS,frames:a.Defs.FRAMES_ELEMENT_BLUE_SPLAT_SHORT},{name:"splatLong",frameRate:20,loop:!1,killOnComplete:!0,atlasKey:o.Config.ATLAS_EFFECTS,frames:a.Defs.FRAMES_ELEMENT_BLUE_SPLAT_LONG},{name:"ballFog",frameRate:20,loop:!1,killOnComplete:!0,atlasKey:o.Config.ATLAS_EFFECTS,frames:a.Defs.FRAMES_BALL_BREAK_FOG},{name:"ballRing",frameRate:24,loop:!1,killOnComplete:!0,atlasKey:o.Config.ATLAS_EFFECTS,frames:a.Defs.FRAMES_BALL_BREAK_RING},{name:"ladybugBombPtc",frameRate:24,loop:!1,killOnComplete:!0,atlasKey:o.Config.ATLAS_EFFECTS,frames:a.Defs.FRAMES_ELEMENT_RED_LADYBUG_BOMB_PTC},{name:"waterReflection",frameRate:15,loop:!1,killOnComplete:!0,atlasKey:o.Config.ATLAS_EFFECTS,frames:a.Defs.FRAMES_WATER_REFLECTION_PTC}],t.CURVE_COMBO={type:s.CurveType.HERMITE,keys:[{x:0,y:0,slope:{in:6.60726,out:6.60726}},{x:.2,y:1,slope:{in:.19754,out:.19754}},{x:.4,y:.5,slope:{in:-2.89369,out:3.56274}},{x:.6,y:1,slope:{in:6e-5,out:6e-5}},{x:.8,y:1,slope:{in:.00203,out:.00203}},{x:1,y:0,slope:{in:-5.6497,out:-5.6497}}]},t.PARAMS=((i={})[0]={area:new Phaser.Circle(0,0,200),edge:!0,edgeOutside:50,minLifetime:.4,maxLifetime:.4,minScale:.8,maxScale:1.2,rotateIntoVelocity:!0,minSpeedX:50,maxSpeedX:100,friction:-5,directionType:2,blendMode:PIXI.blendModes.ADD,minAlpha:0,maxAlpha:0,alphaChange:2,alphaChangeType:r.ParameterChangeType.TO_VALUE,tint:16759398,frames:["smallBeam"]},i[1]={minLifetime:1.5,maxLifetime:1.5,minScale:1.1,maxScale:1.1,scaleChange:{type:2,keys:[{x:0,y:0,c1:1,c2:1.0429719747457158},{x:.24012468827930175,y:.972817879794624,c1:.9901300073483699,c2:.8681869626775711},{x:.3139789415350513,y:.8954696466324373,c1:.9696158110983325,c2:.8346512483633665},{x:.3996453311166528,y:.8828178797946244,c1:.9015317597787212,c2:.9573285592300994},{x:.47852590745358825,y:.8795081589134973,c1:.7861611111848674,c2:.965876524127916},{x:.5602660016625104,y:.8695709919393496,c1:.8634258641520559,c2:1.033964517699706},{x:.6641729010806318,y:.8271902424175696,c1:.9046374494401639,c2:.9186597093168803},{x:1,y:12}]},scaleChangeType:r.ParameterChangeType.CURVE,blendMode:PIXI.blendModes.ADD,minAlpha:3,maxAlpha:3,alphaChangeType:r.ParameterChangeType.TO_VALUE,tint:16759398,frames:["endSphere"]},i[2]={minLifetime:.4,maxLifetime:.4,minDelay:1.1,maxDelay:1.1,scaleChange:7,scaleChangeType:r.ParameterChangeType.TO_VALUE,minAngle:-30,maxAngle:30,blendMode:PIXI.blendModes.ADD,minAlpha:1.5,maxAlpha:1.5,alphaChangeType:r.ParameterChangeType.TO_VALUE,tint:16759398,frames:["endDisc"],orient:!0},i[3]={area:new Phaser.Circle(0,0,40),edgeOutside:50,minLifetime:.4,maxLifetime:.6,minDelay:1.1,maxDelay:1.1,minScale:1.5,maxScale:2.5,rotateIntoVelocity:!0,minSpeedX:800,maxSpeedX:2400,friction:8,directionType:2,blendMode:PIXI.blendModes.ADD,minAlpha:2,maxAlpha:2,alphaChangeType:r.ParameterChangeType.TO_VALUE,tint:16759398,frames:["smallBeam"]},i[4]={area:new Phaser.Circle(0,0,60),edge:!0,edgeInside:20,minLifetime:.3,maxLifetime:.7,minScale:.5,scaleChange:.5,scaleChangeType:r.ParameterChangeType.TO_VALUE,maxAngle:360,minSpeedX:50,maxSpeedX:200,directionType:1,minAlpha:2,maxAlpha:2,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["starPtc"]},i[5]={area:new Phaser.Ellipse(-100,-15,200,30),edge:!0,edgeInside:15,minLifetime:.6,maxLifetime:.8,minScale:.5,scaleChangeType:r.ParameterChangeType.TO_VALUE,minSpeedX:75,maxSpeedX:250,directionType:1,minAlpha:4,maxAlpha:4,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["starDustPtc"]},i[6]={minLifetime:.9,maxLifetime:.9,minSpeedY:-20,maxSpeedY:-20,minAlpha:3,maxAlpha:3,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["scorePtc_000"],orient:!0},i[7]={area:new Phaser.Circle(0,0,20),minLifetime:.4,maxLifetime:.6,minScale:.4,maxScale:.6,scaleChange:2,scaleChangeType:r.ParameterChangeType.TO_PERCENT,maxAngle:360,minSpeedX:50,maxSpeedX:100,friction:5,directionType:1,minAlpha:.5,maxAlpha:.5,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["dustPtc"]},i[8]={minLifetime:1,maxLifetime:1,scaleChange:t.CURVE_COMBO,scaleChangeType:r.ParameterChangeType.CURVE,orient:!0},i[9]={parent:8,frames:"combo2x"},i[10]={parent:8,frames:"combo3x"},i[11]={parent:8,frames:"combo4x"},i[12]={area:new Phaser.Circle(0,0,40),edge:!0,minScale:.1,maxScale:.3,scaleChange:3,scaleChangeType:r.ParameterChangeType.TO_VALUE,maxSpeedX:20,directionType:1,blendMode:PIXI.blendModes.ADD,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["fireGlow"]},i[13]={frames:"explosion",minDelay:0,maxDelay:.3,minAngle:0,maxAngle:360,blendMode:PIXI.blendModes.NORMAL},i[14]={parent:13,minScale:1.875,maxScale:3.125,area:new Phaser.Circle(0,0,1.1*a.Defs.POWERUPS[10].levels[1].values[0])},i[15]={parent:13,minScale:2.5,maxScale:3.75,area:new Phaser.Circle(0,0,1.1*a.Defs.POWERUPS[10].levels[2].values[0])},i[16]={parent:13,minScale:3.125,maxScale:4.375,area:new Phaser.Circle(0,0,1.1*a.Defs.POWERUPS[10].levels[3].values[0])},i[17]={minLifetime:.3,maxLifetime:.3,minScale:2.5,maxScale:2.5,scaleChange:4.25,minAlpha:.7,maxAlpha:.7,scaleChangeType:r.ParameterChangeType.TO_PERCENT,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["flame"],blendMode:Phaser.blendModes.ADD},i[18]={minLifetime:.35,maxLifetime:.35,minScale:1.1,maxScale:1.1,blendMode:PIXI.blendModes.ADD,minAlpha:2,maxAlpha:2,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["steelCenter"]},i[19]={minLifetime:.35,maxLifetime:.35,minScale:1.2,maxScale:1.2,scaleChange:.25,scaleChangeType:r.ParameterChangeType.IN_TIME,blendMode:PIXI.blendModes.ADD,minAlpha:2,maxAlpha:2,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["steelCircle"]},i[20]={minLifetime:.2,maxLifetime:.25,minScale:.7,maxScale:1.4,scaleChange:.5,scaleChangeType:r.ParameterChangeType.IN_TIME,maxAngle:360,blendMode:PIXI.blendModes.ADD,minAlpha:1,maxAlpha:1,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["steelRay"]},i[21]={area:new Phaser.Circle(0,0,20),minLifetime:.4,maxLifetime:.45,minScale:.4,maxScale:.8,rotateIntoVelocity:!0,minSpeedX:50,maxSpeedX:250,friction:4,directionType:1,blendMode:PIXI.blendModes.ADD,minAlpha:1,maxAlpha:1.5,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["steelSpike"]},i[22]={minLifetime:.5,maxLifetime:.5,minScale:.5,maxScale:.5,scaleChange:{type:2,keys:[{x:0,y:.5,c1:1.0555723346421018,c2:.9694956206584111},{x:1,y:1}]},scaleChangeType:r.ParameterChangeType.CURVE,maxAngle:360,minAlpha:1.5,maxAlpha:1.5,alphaChange:-3,alphaChangeType:r.ParameterChangeType.IN_TIME,frames:["ballShards"]},i[23]={area:new Phaser.Point,minLifetime:.5,maxLifetime:.5,minScale:.5,maxAngle:360,minSpeedX:700,maxSpeedX:1e3,friction:14,directionType:1,minAngularSpeed:-1e3,maxAngularSpeed:1e3,angularDrag:9,minAlpha:2,maxAlpha:2,alphaChange:-4,alphaChangeType:r.ParameterChangeType.IN_TIME,frames:["ballShard1","ballShard2"]},i[24]={area:new Phaser.Circle(0,0,20),minLifetime:.5,maxLifetime:.5,minScale:.3,maxScale:.7,maxAngle:360,minSpeedX:200,maxSpeedX:1e3,minSpeedY:-300,maxSpeedY:300,friction:8,minAngularSpeed:-1e3,maxAngularSpeed:1e3,angularDrag:5,minAlpha:3,maxAlpha:3,alphaChange:-6,alphaChangeType:r.ParameterChangeType.IN_TIME,frames:["ballShard1","ballShard2"]},i[25]={area:new Phaser.Circle(0,0,40),minLifetime:.25,maxLifetime:.5,scaleChange:1.2,scaleChangeType:r.ParameterChangeType.TO_VALUE,maxAngle:360,rotateIntoVelocity:!0,minSpeedX:500,maxSpeedX:700,friction:12,directionType:1,blendMode:PIXI.blendModes.ADD,minAlpha:1.4,maxAlpha:1.7,alphaChangeType:r.ParameterChangeType.TO_VALUE,tint:[8388608,8421376,32768,32896,128,8388736],frames:["smallBeam"]},i[26]={minLifetime:.5,maxLifetime:.5,minScale:.2,maxScale:.2,scaleChange:3.5,scaleChangeType:r.ParameterChangeType.TO_VALUE,maxAngle:360,blendMode:PIXI.blendModes.ADD,minAlpha:2,maxAlpha:2,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["rainbowPtc"]},i[27]={minLifetime:1.2,maxLifetime:1.2,scaleChange:{type:2,keys:[{x:0,y:1,c1:1,c2:1},{x:.64,y:1,c1:1,c2:1},{x:1,y:.45}]},scaleChangeType:r.ParameterChangeType.CURVE,blendMode:PIXI.blendModes.ADD,alphaChange:{type:2,keys:[{x:0,y:1,c1:1,c2:1},{x:.59,y:1,c1:1,c2:1},{x:1,y:0}]},alphaChangeType:r.ParameterChangeType.CURVE,tint:16711935,frames:["golemDieCircle"],orient:!0},i[28]={area:new Phaser.Circle(0,0,80),minScale:1.5,maxScale:1.5,scaleChangeType:r.ParameterChangeType.TO_VALUE,maxAngle:360,maxSpeedX:75,directionType:1,blendMode:PIXI.blendModes.ADD,minAlpha:.6,maxAlpha:.6,alphaChangeType:r.ParameterChangeType.TO_VALUE,tint:11534549,frames:["whiteSmoke"],orient:!0},i[29]={area:new Phaser.Ellipse(-30,-25,60,50),edge:!0,minLifetime:.4,maxLifetime:.4,minScale:.75,minAngle:90,maxAngle:90,minSpeedY:-150,maxSpeedY:-200,friction:-2,blendMode:PIXI.blendModes.ADD,minAlpha:2,maxAlpha:2,alphaChangeType:r.ParameterChangeType.TO_VALUE,tint:14046443,frames:["smallBeam"],orient:!0},i[30]={minLifetime:.9,maxLifetime:.9,scaleChange:2,scaleChangeType:r.ParameterChangeType.TO_VALUE,minSpeedX:-5,maxSpeedX:5,minSpeedY:-150,maxSpeedY:-146,blendMode:PIXI.blendModes.ADD,minAlpha:.5,maxAlpha:.5,alphaChange:{type:2,keys:[{x:0,y:.5,c1:.5,c2:.5},{x:1,y:0}]},alphaChangeType:r.ParameterChangeType.CURVE,tint:14687231,frames:["golemDieGhost"],orient:!0},i[31]={area:new Phaser.Circle(0,0,40),edge:!0,edgeInside:5,minLifetime:.2,maxLifetime:.3,minScale:.3,maxScale:1.5,scaleChange:1,scaleChangeType:r.ParameterChangeType.TO_VALUE,maxAngle:360,minSpeedX:250,maxSpeedX:500,directionType:1,minAlpha:1,maxAlpha:1,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["starDustPtc"]},i[32]={area:new Phaser.Circle(0,0,10),minLifetime:.5,maxLifetime:.5,minScale:1,maxScale:2,scaleChange:0,scaleChangeType:r.ParameterChangeType.TO_VALUE,minAlpha:.25,maxAlpha:.25,alphaChange:{type:2,keys:[{x:0,y:1,c1:1,c2:1},{x:.48,y:1,c1:1,c2:.78},{x:1,y:0}]},alphaChangeType:r.ParameterChangeType.CURVE,tint:16768850,frames:["whiteSmoke"]},i[33]={frames:"onLimit",minScale:.9,maxScale:1.2,scaleChange:1.5,scaleChangeType:r.ParameterChangeType.IN_TIME,minAngle:0,maxAngle:360,minAngularSpeed:-90,maxAngularSpeed:90,blendMode:PIXI.blendModes.ADD,alphaChange:-1,alphaChangeType:r.ParameterChangeType.IN_TIME},i[34]={parent:33,tint:a.Defs.ELEMENT_TINT_BLUE},i[35]={parent:33,tint:a.Defs.ELEMENT_TINT_RED},i[36]={parent:33,tint:a.Defs.ELEMENT_TINT_GREEN},i[37]={parent:33,tint:a.Defs.ELEMENT_TINT_YELLOW},i[38]={parent:33,tint:a.Defs.ELEMENT_TINT_CYAN},i[39]={parent:33,tint:a.Defs.ELEMENT_TINT_PURPLE},i[40]={frames:"onLimitDrop",gravity:50,minLifetime:1,maxLifetime:1,minSpeedY:50,maxSpeedY:50,blendMode:PIXI.blendModes.NORMAL,alphaChange:-1.25,alphaChangeType:r.ParameterChangeType.IN_TIME,area:new Phaser.Line(-20,10,20,10)},i[41]={parent:40,tint:a.Defs.ELEMENT_TINT_BLUE},i[42]={parent:40,tint:a.Defs.ELEMENT_TINT_RED},i[43]={parent:40,tint:a.Defs.ELEMENT_TINT_GREEN},i[44]={parent:40,tint:a.Defs.ELEMENT_TINT_YELLOW},i[45]={parent:40,tint:a.Defs.ELEMENT_TINT_CYAN},i[46]={parent:40,tint:a.Defs.ELEMENT_TINT_PURPLE},i[47]={area:new Phaser.Ellipse(-144,-25,288,50),minScale:.75,scaleChange:2.5,scaleChangeType:r.ParameterChangeType.TO_PERCENT,minSpeedX:20,maxSpeedX:50,directionType:1,minAlpha:3,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["plusSign"]},i[48]={area:new Phaser.Circle(0,0,80),maxDelay:.1,minScale:.4,maxAngle:360,minSpeedX:100,maxSpeedX:200,friction:16,directionType:1,minAlpha:5,maxAlpha:5,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["splatShort"]},i[49]={parent:48,tint:a.Defs.BALL_TINT_BLUE},i[50]={parent:48,tint:a.Defs.BALL_TINT_RED},i[51]={parent:48,tint:a.Defs.BALL_TINT_GREEN},i[52]={parent:48,tint:a.Defs.BALL_TINT_YELLOW},i[53]={parent:48,tint:a.Defs.BALL_TINT_CYAN},i[54]={parent:48,tint:a.Defs.BALL_TINT_PURPLE},i[55]={frames:["splatLong"],minScale:1.5,maxScale:1.5},i[56]={parent:55,tint:a.Defs.BALL_TINT_BLUE},i[57]={parent:55,tint:a.Defs.BALL_TINT_RED},i[58]={parent:55,tint:a.Defs.BALL_TINT_GREEN},i[59]={parent:55,tint:a.Defs.BALL_TINT_YELLOW},i[60]={parent:55,tint:a.Defs.BALL_TINT_CYAN},i[61]={parent:55,tint:a.Defs.BALL_TINT_PURPLE},i[62]={area:new Phaser.Point,minLifetime:2,maxLifetime:2,maxScale:1.5,scaleChange:.5,scaleChangeType:r.ParameterChangeType.IN_TIME,maxAngle:360,minSpeedX:25,maxSpeedX:40,directionType:1,minAlpha:.5,maxAlpha:.5,alphaChange:0,alphaChangeType:r.ParameterChangeType.TO_VALUE,tint:16728128,frames:["whiteSmoke"]},i[63]={area:new Phaser.Circle(0,0,40),minLifetime:.75,maxLifetime:.75,minScale:.5,maxScale:.9,scaleChange:{type:2,keys:[{x:0,y:0,c1:.85,c2:.96},{x:.16,y:.99,c1:.96,c2:.086},{x:1,y:0}]},scaleChangeType:r.ParameterChangeType.CURVE,minAlpha:.75,tint:16761024,blendMode:Phaser.blendModes.ADD,frames:["sparklePtc","sparkleDotPtc"]},i[64]={area:new Phaser.Circle(0,0,10),minLifetime:.5,maxLifetime:.5,minScale:1,maxScale:2,scaleChange:0,scaleChangeType:r.ParameterChangeType.TO_VALUE,minAlpha:.35,maxAlpha:.35,alphaChange:{type:2,keys:[{x:0,y:1,c1:1,c2:1},{x:.48,y:1,c1:1,c2:.78},{x:1,y:0}]},alphaChangeType:r.ParameterChangeType.CURVE,tint:16728128,frames:["whiteSmoke"]},i[65]={frames:["ladybugBombPtc"]},i[66]={area:new Phaser.Point,minLifetime:.5,maxLifetime:.75,minScale:.2,maxScale:.5,scaleChange:1,scaleChangeType:r.ParameterChangeType.TO_VALUE,maxAngle:360,rotateIntoVelocity:!0,minSpeedX:900,maxSpeedX:350,friction:15,directionType:1,maxAlpha:2.5,alphaChange:-7,alphaChangeType:r.ParameterChangeType.IN_TIME,frames:["elementGreenSpark"]},i[67]={minLifetime:.3,maxLifetime:.3,scaleChange:{type:2,keys:[{x:0,y:0,c1:5.84,c2:3},{x:1,y:0}]},scaleChangeType:r.ParameterChangeType.CURVE,minAlpha:2,maxAlpha:2,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["elementGreenSparkCenter"]},i[68]={minLifetime:.075,maxLifetime:.075,minScale:3,maxScale:3,blendMode:PIXI.blendModes.ADD,frames:["fireGlow"]},i[69]={area:new Phaser.Circle(0,0,20),minLifetime:.35,maxLifetime:.35,minScale:3,maxScale:3,scaleChange:1,scaleChangeType:r.ParameterChangeType.TO_VALUE,maxAngle:360,minAlpha:1,maxAlpha:1,alphaChange:0,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["flame"]},i[70]={area:new Phaser.Circle(0,0,60),minLifetime:.4,maxLifetime:.4,maxDelay:.2,minScale:1.5,maxScale:2,scaleChange:2,scaleChangeType:r.ParameterChangeType.TO_PERCENT,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["flame"]},i[71]={minLifetime:.3,maxLifetime:.3,minScale:2.5,maxScale:2.5,scaleChange:4,minAlpha:1.25,maxAlpha:1.25,scaleChangeType:r.ParameterChangeType.TO_PERCENT,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["flame"],blendMode:Phaser.blendModes.ADD},i[72]={minLifetime:.25,maxLifetime:.35,minScale:1.6,maxScale:1.6,frames:["flameHead"]},i[73]={area:new Phaser.Circle(0,0,10),minLifetime:.3,maxLifetime:.5,minScale:2,maxScale:2.5,minAlpha:0,maxAlpha:0,alphaChange:2,alphaChangeType:r.ParameterChangeType.IN_TIME,blendMode:Phaser.blendModes.ADD,frames:["cyanGlow"]},i[74]={area:new Phaser.Circle(0,0,50),edge:!0,minLifetime:.5,maxLifetime:.7,maxDelay:.3,minScale:.8,maxScale:1.2,maxAngle:360,minSpeedX:-10,maxSpeedX:10,minSpeedY:-10,maxSpeedY:10,directionType:1,minAlpha:5,maxAlpha:5,alphaChange:-12,alphaChangeType:r.ParameterChangeType.IN_TIME,frames:["sparks1","sparks2"]},i[75]={area:new Phaser.Point,minLifetime:2,maxLifetime:2,maxScale:1.5,scaleChange:.5,scaleChangeType:r.ParameterChangeType.IN_TIME,maxAngle:360,minSpeedX:25,maxSpeedX:40,directionType:1,minAlpha:.5,maxAlpha:.5,alphaChange:0,alphaChangeType:r.ParameterChangeType.TO_VALUE,tint:16711935,frames:["whiteSmoke"]},i[76]={area:new Phaser.Circle(0,0,40),minLifetime:.75,maxLifetime:.75,minScale:.5,maxScale:.9,scaleChange:{type:2,keys:[{x:0,y:0,c1:.85,c2:.96},{x:.16,y:.99,c1:.96,c2:.086},{x:1,y:0}]},scaleChangeType:r.ParameterChangeType.CURVE,minAlpha:.75,tint:16777215,blendMode:Phaser.blendModes.ADD,frames:["sparklePtc","sparkleDotPtc"]},i[77]={area:new Phaser.Circle(0,0,10),minLifetime:.5,maxLifetime:.5,minScale:1,maxScale:2,scaleChange:0,scaleChangeType:r.ParameterChangeType.TO_VALUE,minAlpha:.35,maxAlpha:.35,alphaChange:{type:2,keys:[{x:0,y:1,c1:1,c2:1},{x:.48,y:1,c1:1,c2:.78},{x:1,y:0}]},alphaChangeType:r.ParameterChangeType.CURVE,tint:16711935,frames:["whiteSmoke"]},i[78]={area:new Phaser.Circle(0,0,20),minLifetime:.5,maxLifetime:.5,maxScale:.9,maxAngle:360,minSpeedX:-250,maxSpeedX:800,minSpeedY:-500,maxSpeedY:500,friction:12,minAngularSpeed:-300,maxAngularSpeed:300,angularDrag:6,minAlpha:3,maxAlpha:3,alphaChange:-6,alphaChangeType:r.ParameterChangeType.IN_TIME,rotateIntoVelocity:!0},i[79]={parent:78,frames:["shardBlue1","shardBlue2","shardBlue3","shardBlue4"]},i[80]={parent:78,frames:["shardRed1","shardRed2","shardRed3","shardRed4"]},i[81]={parent:78,frames:["shardGreen1","shardGreen2","shardGreen3","shardGreen4"]},i[82]={parent:78,frames:["shardYellow1","shardYellow2","shardYellow3","shardYellow4"]},i[83]={parent:78,frames:["shardCyan1","shardCyan2","shardCyan3","shardCyan4"]},i[84]={parent:78,frames:["shardMagenta1","shardMagenta2","shardMagenta3","shardMagenta4"]},i[85]={area:new Phaser.Point,minLifetime:.5,maxLifetime:.5,scaleChange:2,scaleChangeType:r.ParameterChangeType.IN_TIME,maxAngle:360,minSpeedX:25,maxSpeedX:40,directionType:1,minAlpha:.4,maxAlpha:.4,alphaChange:0,alphaChangeType:r.ParameterChangeType.TO_VALUE,frames:["whiteSmoke"]},i[86]={parent:85,tint:a.Defs.BALL_TINT_BLUE},i[87]={parent:85,tint:a.Defs.BALL_TINT_RED},i[88]={parent:85,tint:a.Defs.BALL_TINT_GREEN},i[89]={parent:85,tint:a.Defs.BALL_TINT_YELLOW},i[90]={parent:85,tint:a.Defs.BALL_TINT_CYAN},i[91]={parent:85,tint:a.Defs.BALL_TINT_PURPLE},i[92]={frames:["ballFog"],minScale:2,maxScale:2,minAngle:0,maxAngle:360},i[93]={parent:92,tint:a.Defs.BALL_TINT_BLUE},i[94]={parent:92,tint:a.Defs.BALL_TINT_RED},i[95]={parent:92,tint:a.Defs.BALL_TINT_GREEN},i[96]={parent:92,tint:a.Defs.BALL_TINT_YELLOW},i[97]={parent:92,tint:a.Defs.BALL_TINT_CYAN},i[98]={parent:92,tint:a.Defs.BALL_TINT_PURPLE},i[99]={frames:["ballRing"],minScale:2,maxScale:2,blendMode:Phaser.blendModes.ADD},i[100]={minLifetime:.5,maxLifetime:.5,blendMode:PIXI.blendModes.ADD,minAlpha:2,maxAlpha:2,alphaChangeType:r.ParameterChangeType.TO_VALUE,scaleChangeType:r.ParameterChangeType.TO_VALUE,scaleChange:2.5,frames:["revealPathPtc"]},i[101]={},i[102]={area:new Phaser.Circle(0,0,30),edge:!0,edgeInside:15,minScale:.5,maxScale:.8,scaleChange:{type:2,keys:[{x:0,y:0,c1:.95,c2:.95},{x:1,y:1}]},scaleChangeType:r.ParameterChangeType.CURVE,maxAngle:360,minSpeedX:40,maxSpeedX:80,friction:1,directionType:1,minAlpha:.6,maxAlpha:.8,alphaChangeType:r.ParameterChangeType.TO_VALUE,tint:7162657,frames:["dustPtc"]},i[103]={minLifetime:3.2,maxLifetime:3.2,tint:4942684,frames:["waterReflection"],blendMode:PIXI.blendModes.ADD,minAngle:0,maxAngle:360,minAlpha:.4,maxAlpha:.65,minScale:4,maxScale:6},i[104]={minLifetime:3,maxLifetime:4,minScale:1,maxScale:1.4,scaleChange:{type:2,keys:[{x:0,y:1,c1:1.19,c2:1.43},{x:1,y:1.4}]},scaleChangeType:r.ParameterChangeType.CURVE,maxAngle:360,minSpeedX:35,maxSpeedX:80,minSpeedY:-25,maxSpeedY:25,friction:.4,minAngularSpeed:-20,maxAngularSpeed:20,minAlpha:.5,maxAlpha:.5,alphaChange:{type:2,keys:[{x:0,y:0,c1:.49,c2:.46},{x:.5,y:.47,c1:.48,c2:.28},{x:1,y:0}]},alphaChangeType:r.ParameterChangeType.CURVE,frames:["dustPtc"]},i),t.PTC_COMBO=[null,null,9,10,11],t.PTC_BOMB_EXPLOSION=[14,15,16],t.PTC_BOMB_EXPLOSION_COUNT=[10,17,26],t.PTC_LIMIT_DROP=[41,42,43,44,45,46],t.PTC_LIMIT_REACHED=[34,35,36,37,38,39],t.PTC_ELEMENT_BLUE_SPLAT_SHORT=[49,50,51,52,53,54],t.PTC_ELEMENT_BLUE_SPLAT_LONG=[56,57,58,59,60,61],t.PTC_BALL_BREAK_EXPLOSION=[79,80,81,82,83,84],t.PTC_BALL_BREAK_DUST=[86,87,88,89,90,91],t.PTC_BALL_BREAK_FOG=[93,94,95,96,97,98],t}();e.ParticleDefs=l},4455:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ShakeDefs=void 0;var i=n(7748),o=function(){function t(){}return t.BOMB_SHAKE={strengthX:20,strengthY:20,strengthAngle:1,octaves:[{frequency:12,amplitude:1}],envelopeCurve:{type:i.CurveType.HERMITE,keys:[{x:0,y:0,slope:{in:18.05179,out:18.05179}},{x:.07547,y:1,slope:{in:8.75326,out:-.07508}},{x:.50809,y:1,slope:{in:-.03913,out:-2.5359}},{x:1,y:0,slope:{in:-.67214,out:-.67214}}]}},t.CANNON_SHAKE={strengthPos:3,strengthAngle:0,frequency:30,bounces:2,randomness:.75},t.FIRE_FEEDBACK={strengthPos:4,strengthAngle:0,frequency:20,bounces:1,randomness:0},t.SEAL_SHAKE={strengthPos:3,strengthAngle:0,frequency:15,bounces:21,randomness:.75},t}();e.ShakeDefs=o},3100:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TutorialDefs=void 0;var i=n(903),o=n(1391),r=function(){function t(){}return t.TEXTBOX_GAME={showBg:!1,tint:0,alpha:1,maxWidth:600},t.TEXTBOX_GAME_TRANSP={showBg:!0,tint:0,alpha:.7,maxWidth:500},t.GAME_TINT=0,t.GAME_ALPHA=.85,t.GAME_0={bg:{size:[{width:130,height:130}],frame:o.Defs.FRAMES_TUTORIAL_CIRCLE,tint:16777215,alpha:0,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_GAME_TRANSP,textId:"TXT_TUTORIAL_GAME_0",textPlacement:i.TutorialTextPlacement.Below,handleOrientation:!0},t.GAME_1={bg:{size:[{width:130,height:130}],frame:o.Defs.FRAMES_TUTORIAL_CIRCLE,tint:16777215,alpha:0,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_GAME_TRANSP,textId:"TXT_TUTORIAL_GAME_1",textPlacement:i.TutorialTextPlacement.Below,handleOrientation:!0},t.GAME_2={bg:{size:[{width:130,height:130}],frame:o.Defs.FRAMES_TUTORIAL_CIRCLE,tint:16777215,alpha:0,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_GAME_TRANSP,textId:"TXT_TUTORIAL_GAME_2",textPlacement:i.TutorialTextPlacement.Below,handleOrientation:!0},t.GAME_3={bg:{size:[{width:130,height:130}],frame:o.Defs.FRAMES_TUTORIAL_CIRCLE,tint:16777215,alpha:0,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_GAME_TRANSP,textId:"TXT_TUTORIAL_GAME_3",textPlacement:i.TutorialTextPlacement.Below,handleOrientation:!0},t.MOTOR={bg:{size:[{width:130,height:130}],frame:o.Defs.FRAMES_TUTORIAL_CIRCLE,tint:t.GAME_TINT,alpha:t.GAME_ALPHA,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_GAME,textId:"TXT_TUTORIAL_MOTOR",handleOrientation:!0},t.DESTORY={bg:{size:[{width:100,height:100}],frame:o.Defs.FRAMES_TUTORIAL_CIRCLE,tint:t.GAME_TINT,alpha:t.GAME_ALPHA,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_GAME,textId:"TXT_TUTORIAL_DESTROY"},t.STARDUST_0={bg:{size:[{width:120,height:120}],frame:o.Defs.FRAMES_TUTORIAL_CIRCLE,tint:t.GAME_TINT,alpha:t.GAME_ALPHA,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_GAME,textId:"TXT_TUTORIAL_STARDUST_0",handleOrientation:!0},t.STARDUST_1={bg:{size:[{width:90,height:90}],frame:o.Defs.FRAMES_TUTORIAL_CIRCLE,tint:t.GAME_TINT,alpha:t.GAME_ALPHA,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_GAME,textId:"TXT_TUTORIAL_STARDUST_1"},t.RAINBOW={bg:{size:[{width:130,height:130}],frame:o.Defs.FRAMES_TUTORIAL_CIRCLE,tint:t.GAME_TINT,alpha:t.GAME_ALPHA,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_GAME,textId:"TXT_TUTORIAL_RAINBOW",handleOrientation:!0},t.CHARGE={bg:{size:[{width:130,height:130}],frame:o.Defs.FRAMES_TUTORIAL_CIRCLE,tint:t.GAME_TINT,alpha:t.GAME_ALPHA,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_GAME,textId:"TXT_TUTORIAL_CHARGE"},t.TEXTBOX_POWERUP_1={showBg:!1,tint:o.Defs.COLOR_DIALOG_BG,alpha:1,maxWidth:760},t.POWERUP_TINT=0,t.POWERUP_ALPHA=.9,t.TEXTBOX_Y=275,t.TEXTBOX_Y_PORTRAIT=475,t.POWERUP_0={bg:{size:[{width:1400,height:540},{width:770,height:1e3}],frame:o.Defs.FRAMES_TUTORIAL_RECT,tint:t.POWERUP_TINT,alpha:t.POWERUP_ALPHA,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_POWERUP_1,fixedPosition:[{x:0,y:t.TEXTBOX_Y},{x:0,y:t.TEXTBOX_Y_PORTRAIT}],textId:"TXT_TUTORIAL_POWERUP_0"},t.POWERUP_1={bg:{size:[{width:300,height:120}],frame:o.Defs.FRAMES_TUTORIAL_RECT,tint:t.POWERUP_TINT,alpha:t.POWERUP_ALPHA,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_POWERUP_1,fixedPosition:[{x:0,y:t.TEXTBOX_Y},{x:0,y:t.TEXTBOX_Y_PORTRAIT}],textId:"TXT_TUTORIAL_POWERUP_1"},t.POWERUP_2={bg:{size:[{width:1200,height:260},{width:600,height:480}],frame:o.Defs.FRAMES_TUTORIAL_RECT,tint:t.POWERUP_TINT,alpha:t.POWERUP_ALPHA,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_POWERUP_1,fixedPosition:[{x:0,y:t.TEXTBOX_Y},{x:0,y:t.TEXTBOX_Y_PORTRAIT}],textId:"TXT_TUTORIAL_POWERUP_2"},t.POWERUP_3={bg:{size:[{width:1200,height:260},{width:600,height:480}],frame:o.Defs.FRAMES_TUTORIAL_RECT,tint:t.POWERUP_TINT,alpha:t.POWERUP_ALPHA,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_POWERUP_1,fixedPosition:[{x:0,y:t.TEXTBOX_Y},{x:0,y:t.TEXTBOX_Y_PORTRAIT}],textId:"TXT_TUTORIAL_POWERUP_3"},t.POWERUP_4={bg:{size:[{width:1400,height:260},{width:770,height:480}],frame:o.Defs.FRAMES_TUTORIAL_RECT,tint:t.POWERUP_TINT,alpha:t.POWERUP_ALPHA,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_POWERUP_1,fixedPosition:[{x:0,y:t.TEXTBOX_Y},{x:0,y:t.TEXTBOX_Y_PORTRAIT}],textId:"TXT_TUTORIAL_POWERUP_4"},t.NEW_POWERUP={bg:{size:[{width:260,height:260}],frame:o.Defs.FRAMES_TUTORIAL_CIRCLE,tint:t.POWERUP_TINT,alpha:t.POWERUP_ALPHA,tintFrame:!0,alphaFrame:!0},textbox:t.TEXTBOX_POWERUP_1,fixedPosition:[{x:0,y:t.TEXTBOX_Y},{x:0,y:t.TEXTBOX_Y_PORTRAIT}],textId:"TXT_TUTORIAL_NEW_POWERUP"},t}();e.TutorialDefs=r},9221:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;var r=n(2592),s=n(5357),a=n(9782),l=n(5733),h=n(5020),u=n(2267),c=n(9510),p=n(447),_=n(9952),f=function(t){function e(){var n=this,i=Phaser.AUTO,o=s.Config.TakeScreenshots;return n=t.call(this,{width:10,height:10,renderer:i,parent:"sbc_game_content",transparent:!1,antialias:!0,physicsConfig:null,preserveDrawingBuffer:o,mouseWheel:!0})||this,e.game=n,n.polyfills(),s.Config.TakeScreenshots&&r.FileUtils.initScreenshotTaker(n,"marblesgarden","S",!1,!0,!1),n.state.add("Boot",a.Boot),n.state.add("Preloader",_.Preloader),n.state.add("Menu",u.Menu),n.state.add("Levels",h.Levels),n.state.add("Powerups",p.Powerups),n.state.add("Play",c.Play),n.state.add("Congrats",l.Congrats),n.state.start("Boot"),n}return o(e,t),e.prototype.polyfills=function(){Math.sign||(Math.sign=Phaser.Math.sign),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(t,e){var n=e>0?0|e:0;return this.substring(n,n+t.length)===t}})},e}(Phaser.Game);e.Game=f},1875:function(t,e){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapDataFixed=void 0;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.copyTransform=function(t,e,n){if(void 0===e&&(e=null),void 0===n&&(n=!1),!t.hasOwnProperty("worldTransform")||!t.worldVisible||0===t.worldAlpha)return this;var i=t.worldTransform;if(this._pos.set(t.texture.crop.x,t.texture.crop.y),this._size.set(t.texture.crop.width,t.texture.crop.height),0===i.a||0===i.d||0===this._size.x||0===this._size.y)return this;t.texture instanceof Phaser.RenderTexture?this._image=t.texture.getCanvas():this._image=t.texture.baseTexture.source;var o=t.position.x,r=t.position.y;16777215!==t.tint&&(t.cachedTint!==t.tint&&(t.cachedTint=t.tint,t.tintedTexture=PIXI.CanvasTinter.getTintedTexture(t,t.tint)),this._image=t.tintedTexture,this._pos.set(0)),n&&(o|=0,r|=0),this._alpha.current=t.alpha;var s=this.context;return this._alpha.prev=s.globalAlpha,s.save(),s.globalAlpha=this._alpha.current,e&&(this.op=e),s[this.smoothProperty]=t.texture.baseTexture.scaleMode===PIXI.scaleModes.LINEAR,s.setTransform(i.a,i.b,i.c,i.d,o,r),s.drawImage(this._image,this._pos.x,this._pos.y,this._size.x,this._size.y,-this._size.x*t.anchor.x,-this._size.y*t.anchor.y,this._size.x,this._size.y),s.restore(),s.globalAlpha=this._alpha.prev,this.dirty=!0,this},e}(Phaser.BitmapData);e.BitmapDataFixed=o},1955:function(t,e){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.TileRope=void 0;var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._canvasPattern=null,e._l=new Phaser.Line,e}return i(e,t),e.prototype.render=function(t){if(this.points&&!(this.points.length<3))for(var e="RGBA(0,0,0,0.1)",n=(this.vertices,0);n<this.points.length-1;n++){var i=2*n,o=this.vertices,r=2*this.indices[i],s=2*this.indices[i+1],a=2*this.indices[i+2];this._l.setTo(o[r],o[r+1],o[s],o[s+1]),t.debug.geom(this._l,e,!0),this._l.setTo(o[s],o[s+1],o[a],o[a+1]),t.debug.geom(this._l,e,!0),this._l.setTo(o[a],o[a+1],o[r],o[r+1]),t.debug.geom(this._l,e,!0),r=2*this.indices[i+1],s=2*this.indices[i+2],a=2*this.indices[i+3],this._l.setTo(o[r],o[r+1],o[s],o[s+1]),t.debug.geom(this._l,e,!0),this._l.setTo(o[s],o[s+1],o[a],o[a+1]),t.debug.geom(this._l,e,!0),this._l.setTo(o[a],o[a+1],o[r],o[r+1]),t.debug.geom(this._l,e,!0)}},e.prototype.setPoints=function(t){this.points=t,this.vertices=new Float32Array(4*t.length),this.uvs=new Float32Array(4*t.length),this.colors=new Float32Array(2*t.length),this.indices=new Uint16Array(2*t.length),this.refresh(),this.dirty=!0},e.prototype.setTexture=function(e){t.prototype.setTexture.call(this,e),this.checktexturePOT(),this.setPadding(),this._canvasPattern&&(this._canvasPattern=null)},e.prototype.checktexturePOT=function(){var t=this.texture,e=Phaser.Math.isPowerOfTwo(t.width,t.height);t.baseTexture._powerOf2=e},e.prototype.setPadding=function(){this.game.renderer.type===Phaser.CANVAS&&(this.canvasPadding=1)},e.prototype.createCanvasPattern=function(t){var e=t.baseTexture,n=new PIXI.CanvasBuffer(t.frame.width,t.frame.height);n.context.drawImage(e.source,-t.frame.x,-t.frame.y),this._canvasPattern=n.context.createPattern(n.canvas,"repeat"),n.destroy()},e.prototype.refresh=function(){var t=this.points;if(!(t.length<1))for(var e=this.uvs,n=this.indices,i=this.colors,o=t.length,r=this.texture.width,s=0,a=t[0],l=0,h=0;h<o;h++){l+=Phaser.Point.distance(a,t[h])/r,e[s=4*h]=l,e[s+1]=0,e[s+2]=l,e[s+3]=1,i[s=2*h]=1,i[s+1]=1,n[s=2*h]=s,n[s+1]=s+1,a=t[h]}},e.prototype.updateTransform=function(){var t=this.points;if(!(t.length<1)){for(var e,n,i,o,r,s=t[0],a={x:0,y:0},l=this.vertices,h=t.length,u=this.texture.height/2,c=0;c<h;c++){n=t[c],i=4*c,e=c<h-1?t[c+1]:n,a.y=-(e.x-s.x),a.x=e.y-s.y,o=Math.sqrt(a.x*a.x+a.y*a.y),r=u,a.x/=o,a.y/=o,a.x*=r,a.y*=r;var p=n.x+a.x,_=n.y+a.y,f=n.x-a.x,d=n.y-a.y;if(c>0){var y=l[i-4],m=l[i-3],g=l[i-2],v=l[i-1],T=g-y,E=v-m,b=p-y,S=_-m,P=Phaser.Math.sign(T*S-E*b);P>0&&(p=y,_=m),b=f-y,S=d-m,(P=Phaser.Math.sign(T*S-E*b))>0&&(f=g,d=v)}l[i]=p,l[i+1]=_,l[i+2]=f,l[i+3]=d,s=n}PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)}},e.prototype._renderCanvasDrawTriangle=function(t,e,n,i,o,r){this._canvasPattern||this.createCanvasPattern(this.texture);var s=this.texture.width,a=this.texture.height,l=e[i],h=e[o],u=e[r],c=e[i+1],p=e[o+1],_=e[r+1],f=n[i]*s,d=n[o]*s,y=n[r]*s,m=n[i+1]*a,g=n[o+1]*a,v=n[r+1]*a;if(this.canvasPadding>0){var T=this.canvasPadding/this.worldTransform.a,E=this.canvasPadding/this.worldTransform.d,b=(l+h+u)/3,S=(c+p+_)/3,P=l-b,A=c-S,O=Math.sqrt(P*P+A*A);l=b+P/O*(O+T),c=S+A/O*(O+E),A=p-S,h=b+(P=h-b)/(O=Math.sqrt(P*P+A*A))*(O+T),p=S+A/O*(O+E),A=_-S,u=b+(P=u-b)/(O=Math.sqrt(P*P+A*A))*(O+T),_=S+A/O*(O+E)}t.save(),t.beginPath(),t.moveTo(l,c),t.lineTo(h,p),t.lineTo(u,_),t.closePath(),t.clip();var w=f*g+m*y+d*v-g*y-m*d-f*v,L=l*g+m*u+h*v-g*u-m*h-l*v,C=f*h+l*y+d*u-h*y-l*d-f*u,I=f*g*u+m*h*y+l*d*v-l*g*y-m*d*u-f*h*v,x=c*g+m*_+p*v-g*_-m*p-c*v,D=f*p+c*y+d*_-p*y-c*d-f*_,R=f*g*_+m*p*y+c*d*v-c*g*y-m*d*_-f*p*v;t.transform(L/w,x/w,C/w,D/w,I/w,R/w),t.fillStyle=this._canvasPattern,t.fill(),t.restore()},e}(Phaser.Rope);e.TileRope=o},6501:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TrajectoryRope=void 0;var r=n(2178),s=n(5357),a=function(t){function e(e,n){var i=t.call(this,e,0,0,s.Config.IMAGE_TRAJECTORY,0,n)||this;return i._valid=!1,i.setValid(!0),i}return o(e,t),e.prototype.updateTransform=function(){PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)},e.prototype.updatePoints=function(t,e){var n,i,o,s,a=this.texture.height/4,l=this.vertices,h=this.points.length,u=e?-1:1,c=t.getAtRatio(e?1:0),p=c.height;r.App.isLandscape?(o=c.position.x,s=c.position.y+p):(o=c.position.x+p,s=c.position.y);for(var _=0,f=e?h-1:0;_<h;_++,f+=u){n=4*_;var d=t.getAtRatio((f+u)/(h-1)),y=d.height,m=void 0,g=void 0;r.App.isLandscape?(m=d.position.x,g=d.position.y+y):(m=d.position.x+y,g=d.position.y);var v=-(m-o),T=g-s;T/=i=Math.sqrt(T*T+v*v),v/=i;var E=a*(.3+.7*Math.abs(p)/100);T*=E,v*=E,l[n]=o+T,l[n+1]=s+v,l[n+2]=o-T,l[n+3]=s-v,p=y,o=m,s=g}},e.prototype.setValid=function(t){if(t!==this._valid){for(var e=this.uvs,n=t?0:.5,i=t?.5:1,o=0;o<this.points.length;o++){var r=4*o;e[r+1]=n,e[r+3]=i}this._valid=t,this.dirty=!0}},e}(Phaser.Rope);e.TrajectoryRope=a},4418:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BridgeStructure=void 0;var n=function(){function t(t,e,n){this._idx=0,this._position=null,this._idx=t,this._position=new Phaser.Point(e,n)}return Object.defineProperty(t.prototype,"idx",{get:function(){return this._idx},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),t}();e.BridgeStructure=n},6680:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decode=void 0,e.decode=function(t,e){var n=t.length>3,i=8===t.length;return e.key=t[0],e.x=t[1],e.y=t[2],e.sx=n?t[3]:1,e.sy=n?t[4]:1,e.angle=n?t[5]:0,e.alpha=n?t[6]:1,e.tint=i?t[7]:16777215,e}},286:function(t,e,n){"use strict";var i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.LevelStructure=void 0;var o=n(2178),r=n(5357),s=n(1875),a=n(1955),l=n(3944),h=n(8142),u=n(5772),c=n(6359),p=n(6912),_=n(3824),f=n(4418),d=n(6680),y=function(){function t(e){this._game=null,this._id=-1,this._listener=null,this._levelName=null,this._bgRT=null,this._tmpBmd=null,this._tmpBmdSprite=null,this._tmpRope=null,this._tmpSpr=null,this._bridgesBmd=null,this._bridgesCount=0,this._bridgeStructures=null,this._physics=null,this._pointsPool=null,this._tmpLevelItem={key:"",x:0,y:0,sx:0,sy:0,angle:0,alpha:1,tint:16777215},this._game=e,this._bgRT=new Phaser.RenderTexture(e,r.Config.BG_WIDTH,r.Config.BG_HEIGHT),this._tmpBmd=new s.BitmapDataFixed(e,e.rnd.uuid(),r.Config.BG_WIDTH,r.Config.BG_HEIGHT),this._tmpBmdSprite=new Phaser.Sprite(e,0,0),this._tmpRope=new a.TileRope(e,0,0,null),this._tmpSpr=new Phaser.Sprite(e,0,0);var n=Math.ceil(r.Config.BRIDGES_MAX/2);this._bridgesBmd=new s.BitmapDataFixed(e,e.rnd.uuid(),2*r.Config.BRIDGE_MAX_WIDTH,r.Config.BRIDGE_MAX_HEIGHT*n),e.cache.addSpriteSheet("Bridges","",this._bridgesBmd.canvas,r.Config.BRIDGE_MAX_WIDTH,r.Config.BRIDGE_MAX_HEIGHT,r.Config.BRIDGES_MAX),this._pointsPool=new _.Pool(Phaser.Point,t.POOL_POINTS_MAX,(function(){return new Phaser.Point})),this._pointsPool.canGrow=!0,this._physics=new c.Physics(e)}return Object.defineProperty(t.prototype,"levelName",{get:function(){return this._levelName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundTexture",{get:function(){return this._bgRT},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"physics",{get:function(){return this._physics},enumerable:!1,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return null===t._instance&&(t._instance=new t(o.App.game)),t._instance},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){null!==this._tmpBmd&&(this._tmpBmd.destroy(),this._tmpBmd=null),null!==this._bridgesBmd&&(this._bridgesBmd.destroy(),this._bridgesBmd=null)},t.prototype.loadLevel=function(t,e,n){var o,r,s,a;this.clear(),this._listener=n,this._levelName=e.name,this._listener.onWavesDef(e.waves);try{for(var l=i(e.bottom),h=l.next();!h.done;h=l.next()){var u=h.value;this.processLayer(u,!0)}}catch(t){o={error:t}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(o)throw o.error}}try{for(var c=i(e.top),p=c.next();!p.done;p=c.next()){u=p.value;this.processLayer(u,!1)}}catch(t){s={error:t}}finally{try{p&&!p.done&&(a=c.return)&&a.call(c)}finally{if(s)throw s.error}}this._listener.onStardust(e.stardust),this._id=t},t.prototype.clear=function(){this._bgRT.clear(),this._bridgesCount=0,this._bridgeStructures=[],this._physics.clear()},t.prototype.processLayer=function(t,e){switch(t.type){case"bg":if(!e)throw new Error("Bg layer with name '"+t.name+"' can't be top layer.");this.processBgLayer(t);break;case"path":if(!e)throw new Error("Path layer with name '"+t.name+"' can't be top layer.");this.processPathLayer(t);break;case"strokes":if(!e)throw new Error("Strokes layer with name '"+t.name+"' can't be top layer.");this.processStrokesLayer(t);break;case"objects":this.processObjectsLayer(t,e);break;case"bridge":if(!e)throw new Error("Bridges layer with name '"+t.name+"' can't be top layer.");this.processBridgeLayer(t);break;case"physics":this.processPhysicsLayer(t);break;default:throw new Error("Unknown layer type "+t.type)}},t.prototype.processBgLayer=function(t){var e=this._tmpBmd,n=this._tmpBmdSprite;p.BitmapDataUtils.tilesIntoBmd(e,t.textureKey),e.dirty=!0,e.render(),n.alpha=1,n.anchor.set(0),n.loadTexture(e),this._bgRT.renderXY(n,0,0)},t.prototype.processPathLayer=function(t){if(this._game.renderType===Phaser.CANVAS){var e=this._game.renderer.renderSession;0!==e.currentBlendMode&&(e.currentBlendMode=Phaser.blendModes.NORMAL,e.context.globalCompositeOperation=PIXI.blendModesCanvas[e.currentBlendMode])}for(var n=[],i=0;i<t.points.x.length;i++){var o=this._pointsPool.spawn();o.set(t.points.x[i],t.points.y[i]),n.push(o)}t.onlyData||(this._tmpRope.loadTexture(t.textureKey),this._tmpRope.setPoints(n),this._bgRT.renderXY(this._tmpRope,r.Config.BG_WIDTH/2,r.Config.BG_HEIGHT/2));for(i=n.length-1;i>=0;i--)this._pointsPool.despawn(n[i]);t.decor||this._listener.onPath(t.points)},t.prototype.processStrokesLayer=function(t){var e,n,o=this._tmpBmd;o.clear();try{for(var r=i(t.strokes),s=r.next();!s.done;s=r.next()){var a=s.value,l=d.decode(a,this._tmpLevelItem);this.drawLevelItemIntoBmd(l,o)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}t.transp?o.blendSourceIn():o.blendSourceAtop(),p.BitmapDataUtils.tilesIntoBmd(o,t.textureKey,t.transp),o.dirty=!0,o.render(),o.blendReset();var h=this._tmpBmdSprite;h.anchor.set(0),h.loadTexture(o),h.alpha=t.alpha,h.blendMode=t.add?Phaser.blendModes.ADD:Phaser.blendModes.NORMAL,this._bgRT.renderXY(h,0,0)},t.prototype.processObjectsLayer=function(t,e){var n,o,r,s;if(e){var a=this._tmpBmd;a.clear();try{for(var l=i(t.objects),h=l.next();!h.done;h=l.next()){var u=h.value,c=d.decode(u,this._tmpLevelItem);this._listener.shallBakeObject(c)&&this.drawLevelItemIntoBmd(c,a),this._listener.onObject(c,!1,e)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}a.dirty=!0,a.render();var p=this._tmpBmdSprite;p.anchor.set(0),p.loadTexture(a),p.alpha=e?t.alpha:1,p.blendMode=t.add?Phaser.blendModes.ADD:Phaser.blendModes.NORMAL,this._bgRT.renderXY(p,0,0)}else try{for(var _=i(t.objects),f=_.next();!f.done;f=_.next()){u=f.value,c=d.decode(u,this._tmpLevelItem);this._listener.onObject(c,t.add,e)}}catch(t){r={error:t}}finally{try{f&&!f.done&&(s=_.return)&&s.call(_)}finally{if(r)throw r.error}}},t.prototype.drawLevelItemIntoBmd=function(t,e){var n=this._tmpSpr;n.anchor.set(.5);var i=this._game.cache.getFrameByName(r.Config.ATLAS_SPRITES,t.key)?r.Config.ATLAS_SPRITES:r.Config.ATLAS_OBJECTS_BOTTOM;n.loadTexture(i),n.frameName=t.key,n.position.set(t.x+r.Config.BG_WIDTH/2,t.y+r.Config.BG_HEIGHT/2),n.scale.set(t.sx,t.sy),n.angle=t.angle,n.alpha=t.alpha,n.tint=t.tint,n.updateTransform(this._game.world),e.copyTransform(n)},t.prototype.processBridgeLayer=function(t){var e,n,o=this._bridgesCount++,s=this._bridgesBmd,a=o%2*512,l=512*(o>>1);s.blendReset(),s.clear(a,l,512,512),this._tmpBmd.clear();var h=t.bounds,u=h.x,c=h.y,p=this._tmpSpr;p.anchor.set(.5),p.alpha=1,p.tint=16777215,p.loadTexture(r.Config.ATLAS_SPRITES);try{for(var _=i(t.objects),y=_.next();!y.done;y=_.next()){var m=y.value,g=d.decode(m,this._tmpLevelItem);p.frameName=g.key,p.scale.set(g.sx,g.sy),p.angle=g.angle,p.alpha=g.alpha;var v=g.x,T=g.y;g.key.startsWith("m")?(p.position.set(v-u,T-c),p.updateTransform(),this._tmpBmd.copyTransform(p),this._tmpBmd.dirty=!0,this._tmpBmd.render(),this._tmpBmd.blendSourceAtop(),this._tmpBmd.copy(this._bgRT,u+r.Config.BG_WIDTH/2,c+r.Config.BG_HEIGHT/2,h.width,h.height,0,0),this._tmpBmd.dirty=!0,this._tmpBmd.render(),s.draw(this._tmpBmd,a,l),s.dirty=!0,s.render(),this._tmpBmd.blendReset(),this._tmpBmd.clear()):(p.position.set(v-u+a,T-c+l),p.updateTransform(),s.copyTransform(p))}}catch(t){e={error:t}}finally{try{y&&!y.done&&(n=_.return)&&n.call(_)}finally{if(e)throw e.error}}this._game.cache.getFrameData("Bridges").getFrame(o).resize(h.width,h.height);var E=new f.BridgeStructure(o,h.x,h.y);this._bridgeStructures.push(E);var b=this._listener.onBridge(E);this._game.renderType===Phaser.WEBGL&&this._game.renderer.updateTexture(b.texture.baseTexture)},t.prototype.processPhysicsLayer=function(t){var e,n;try{for(var o=i(t.shapes),r=o.next();!r.done;r=o.next()){var s=r.value,a=null;switch(s.type){case"circle":a=new l.ColliderCircle(s.data,s.tunnel);break;case"rectangle":a=new u.ColliderRect(s.data,s.tunnel);break;case"polygon":a=new h.ColliderPoly(s.data,s.tunnel);break;default:throw new Error("Unknown type of collider '"+s.type+"'")}this._physics.addCollider(a)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},t.POOL_POINTS_MAX=256,t._instance=null,t}();e.LevelStructure=y},9771:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Collider=e.ColliderType=void 0,function(t){t[t.Circle=0]="Circle",t[t.Rect=1]="Rect",t[t.Poly=2]="Poly"}(e.ColliderType||(e.ColliderType={}));var n=function(){function t(t){this._boundingRect=null,this._isTunnel=!1,this._id=-1,this._isTunnel=t}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"boundingRect",{get:function(){return this._boundingRect},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isTunnel",{get:function(){return this._isTunnel},enumerable:!1,configurable:!0}),t.prototype.debugBoundingRect=function(e,n,i,o){if(this._boundingRect){var r=new Phaser.Line,s=t.DEBUG_BOUNDS;n&&i&&(o?this.broadCollision(n-o,i-o,2*o,2*o)&&(s=t.DEBUG_BOUNDS_HIT):this.broadCollision(n,i,0,0)&&(s=t.DEBUG_BOUNDS_HIT));var a=this._boundingRect.x,l=this._boundingRect.y,h=this._boundingRect.x+this._boundingRect.width,u=this._boundingRect.y+this._boundingRect.height;r.setTo(a,l,h,l),e.geom(r,s),r.setTo(h,l,h,u),e.geom(r,s),r.setTo(h,u,a,u),e.geom(r,s),r.setTo(a,u,a,l),e.geom(r,s)}},t.prototype.getDebugShapeColor=function(e,n,i){if(e&&n)if(i){if(this.circleIntersection(e,n,i))return t.DEBUG_SHAPE_HIT}else if(this.pointIntersection(e,n))return t.DEBUG_SHAPE_HIT;return t.DEBUG_SHAPE},t.prototype.circleLineSegmentIntersection=function(t,e,n,i,o){var r=o*o,s=n-t.x,a=i-t.y;if(s*s+a*a<=r)return!0;var l=n-e.x,h=i-e.y;if(l*l+h*h<=r)return!0;var u=e.x-t.x,c=e.y-t.y,p=u*u+c*c;if(p<Number.EPSILON)return!1;var _=s*u+a*c;if(_<0||_>p)return!1;var f=_/p,d=t.x+f*u-n,y=t.y+f*c-i;return d*d+y*y<=r},t.prototype.broadCollision=function(t,e,n,i){var o=this._boundingRect;return!(t>o.x+o.width||t+n<o.x||e>o.y+o.height||e+i<o.y)},t.DEBUG_BOUNDS="#00FF0080",t.DEBUG_BOUNDS_HIT="#FF000080",t.DEBUG_SHAPE="#00FF00FF",t.DEBUG_SHAPE_HIT="#FF0000FF",t}();e.Collider=n},3944:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.ColliderCircle=void 0;var r=function(t){function e(e,n){var i=t.call(this,n)||this;return i._c=new Phaser.Point,i._r=0,i._c.set(e.x,e.y),i._r=e.radius,i._boundingRect=new Phaser.Rectangle(e.x-e.radius,e.y-e.radius,2*e.radius,2*e.radius),i}return o(e,t),e.prototype.debugShape=function(t,e,n,i){var o=new Phaser.Circle(this._c.x,this._c.y,2*this._r),r=this.getDebugShapeColor(e,n,i);t.geom(o,r,!1)},e.prototype.pointIntersection=function(t,e){return this.circleIntersection(t,e,0)},e.prototype.circleIntersection=function(t,e,n){if(!this.broadCollision(t-n,e-n,2*n,2*n))return!1;var i=this._c.x-t,o=this._c.y-e,r=this._r+n;return i*i+o*o<=r*r},e}(n(9771).Collider);e.ColliderCircle=r},8142:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.ColliderPoly=void 0;var r=function(t){function e(e,n){var i=t.call(this,n)||this;i._points=[];for(var o=Number.MAX_VALUE,r=-Number.MAX_VALUE,s=Number.MAX_VALUE,a=-Number.MAX_VALUE,l=0;l<e.points.length;l+=2){var h=new Phaser.Point(e.points[l],e.points[l+1]);o=Math.min(o,h.x),r=Math.max(r,h.x),s=Math.min(s,h.y),a=Math.max(a,h.y),i._points.push(h)}return i._boundingRect=new Phaser.Rectangle(o,s,r-o,a-s),i}return o(e,t),e.prototype.debugShape=function(t,e,n,i){for(var o=new Phaser.Line,r=this.getDebugShapeColor(e,n,i),s=0,a=this._points.length-1;s<this._points.length;a=s++){var l=this._points[a],h=this._points[s];o.setTo(l.x,l.y,h.x,h.y),t.geom(o,r)}},e.prototype.pointIntersection=function(t,e){if(!this.broadCollision(t,e,0,0))return!1;for(var n=!1,i=0,o=this._points.length-1;i<this._points.length;o=i++){var r=this._points[o].x,s=this._points[o].y,a=this._points[i].x,l=this._points[i].y;s>e!=l>e&&t<(a-r)*(e-s)/(l-s)+r&&(n=!n)}return n},e.prototype.circleIntersection=function(t,e,n){if(!this.broadCollision(t-n,e-n,2*n,2*n))return!1;if(this.pointIntersection(t,e))return!0;for(var i=0,o=this._points.length-1;i<this._points.length;o=i++){var r=this._points[o],s=this._points[i];if(this.circleLineSegmentIntersection(r,s,t,e,n))return!0}return!1},e}(n(9771).Collider);e.ColliderPoly=r},5772:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.ColliderRect=void 0;var r=function(t){function e(e,n){var i=t.call(this,n)||this;i._points=[];var o=e.x,r=e.y,s=e.width,a=e.height,l=new Phaser.Point(o-s/2,r-a/2),h=new Phaser.Point(o-s/2,r+a/2),u=new Phaser.Point(o+s/2,r+a/2),c=new Phaser.Point(o+s/2,r-a/2),p=e.angle;l.rotate(o,r,p,!0),h.rotate(o,r,p,!0),u.rotate(o,r,p,!0),c.rotate(o,r,p,!0),i._points.push(l,h,u,c);var _=Math.min(l.x,h.x,u.x,c.x),f=Math.max(l.x,h.x,u.x,c.x),d=Math.min(l.y,h.y,u.y,c.y),y=Math.max(l.y,h.y,u.y,c.y);return i._boundingRect=new Phaser.Rectangle(_,d,f-_,y-d),i}return o(e,t),e.prototype.debugShape=function(t,e,n,i){for(var o=new Phaser.Line,r=this.getDebugShapeColor(e,n,i),s=0,a=this._points.length-1;s<this._points.length;a=s++){var l=this._points[a],h=this._points[s];o.setTo(l.x,l.y,h.x,h.y),t.geom(o,r)}},e.prototype.pointIntersection=function(t,e){if(!this.broadCollision(t,e,0,0))return!1;var n=this._points[0],i=t-n.x,o=e-n.y,r=this._points[3],s=r.x-n.x,a=r.y-n.y,l=i*s+o*a;if(l<0||l>s*s+a*a)return!1;var h=this._points[1];return!((l=i*(s=h.x-n.x)+o*(a=h.y-n.y))<0||l>s*s+a*a)},e.prototype.circleIntersection=function(t,e,n){if(!this.broadCollision(t-n,e-n,2*n,2*n))return!1;if(this.pointIntersection(t,e))return!0;for(var i=0,o=this._points.length-1;i<this._points.length;o=i++){var r=this._points[o],s=this._points[i];if(this.circleLineSegmentIntersection(r,s,t,e,n))return!0}return!1},e}(n(9771).Collider);e.ColliderRect=r},6359:function(t,e,n){"use strict";var i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.Physics=void 0;var o=n(8337),r=function(){function t(t){this._game=null,this._walls=null,this._tunnels=null,this._game=t}return t.prototype.debug=function(t,e,n){var o,r,s,a,l=this._game.debug;try{for(var h=i(this._walls),u=h.next();!u.done;u=h.next()){(_=u.value).debugBoundingRect(l,t,e,n),_.debugShape(l,t,e,n)}}catch(t){o={error:t}}finally{try{u&&!u.done&&(r=h.return)&&r.call(h)}finally{if(o)throw o.error}}try{for(var c=i(this._tunnels),p=c.next();!p.done;p=c.next()){var _;(_=p.value).debugBoundingRect(l,t,e,n),_.debugShape(l,t,e,n)}}catch(t){s={error:t}}finally{try{p&&!p.done&&(a=c.return)&&a.call(c)}finally{if(s)throw s.error}}if(t&&e){var f="#8080FFFF",d=new Phaser.Line;if(d.setTo(t-10,e,t+10,e),l.geom(d,f),d.setTo(t,e-10,t,e+10),l.geom(d,f),n){var y=new Phaser.Circle(t,e,2*n);l.geom(y,f,!1)}}},t.prototype.clear=function(){this._walls=[],this._tunnels=[]},t.prototype.addCollider=function(t){t.isTunnel?(t.id=this._tunnels.length,this._tunnels.push(t)):this._walls.push(t)},t.prototype.addTunnelsIntoSpatialGrid=function(t){this.addIntoSpatialGrid(this._tunnels,t)},t.prototype.addWallsIntoSpatialGrid=function(t){this.addIntoSpatialGrid(this._walls,t)},t.prototype.addIntoSpatialGrid=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=i.boundingRect,s=new o.SpatialCollider(i);e.addStatic(s,r.x,r.y,r.width,r.height)}},t.prototype.checkBallWallCollision=function(t,e,n,i){return this.checkBallCollidersArrayCollision(this._walls,t,e,n,i)},t.prototype.checkBallTunnelCollision=function(t,e,n,i){return this.checkBallCollidersArrayCollision(this._tunnels,t,e,n,i)},t.prototype.checkBallCollidersArrayCollision=function(t,e,n,o,r){var s,a;try{for(var l=i(t),h=l.next();!h.done;h=l.next()){var u=h.value;if(u.circleIntersection(e,n,o))return null!==r&&r(u),!0}}catch(t){s={error:t}}finally{try{h&&!h.done&&(a=l.return)&&a.call(l)}finally{if(s)throw s.error}}return!1},t}();e.Physics=r},8337:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpatialCollider=void 0;var i=n(6e3),o=function(){function t(t){this.spatialTestID=-1,this._spatialObject=t}return Object.defineProperty(t.prototype,"spatialType",{get:function(){return i.SpatialType.Collider},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spatialObject",{get:function(){return this._spatialObject},enumerable:!1,configurable:!0}),t.prototype.collidedWithCircle=function(t,e,n){return this._spatialObject.circleIntersection(t,e,n)},t}();e.SpatialCollider=o},712:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ball=e.BallInterpolation=e.BallRemoveReason=void 0;var i,o,r=n(5357),s=n(1391),a=n(7751),l=n(6e3),h=n(7857),u=n(713),c=n(7389);!function(t){t[t.None=0]="None",t[t.Match=1]="Match",t[t.PathEnd=2]="PathEnd",t[t.Broken=3]="Broken",t[t.WallCrash=4]="WallCrash",t[t.OutOfScreen=5]="OutOfScreen",t[t.Consumed=6]="Consumed"}(i=e.BallRemoveReason||(e.BallRemoveReason={})),function(t){t[t.None=0]="None",t[t.Position=1]="Position",t[t.Distance=2]="Distance",t[t.DistanceToPrev=3]="DistanceToPrev"}(o=e.BallInterpolation||(e.BallInterpolation={}));var p=function(){function t(t){this.tmp=0,this._game=null,this._path=null,this._chain=null,this._waveID=0,this.spatialTestID=-1,this._collisionDist=0,this._type=-1,this._ballLayer=0,this._shadowLayer=0,this._hasBonus=!1,this._position=new Phaser.Point,this._ball=null,this._shadow=null,this._shine=null,this._pathDistance=0,this._targetPathDistance=0,this._connected=!1,this._motorContact=!1,this._removeReason=i.None,this._scoreIdx=0,this._interpolationType=o.None,this._interpolationTimeMax=0,this._interpolationTimeCurrent=0,this._interpolationStartAngle=0,this._interpolationStartDistance=0,this._interpolationStartPosition=new Phaser.Point,this._interpolationStartFrameIdx=0,this._speed=0,this._listeners=null,this._refs=[],this._spawnTime=0,this._game=t,this.createIndices(t),this.createVisuals(t),this._listeners=new h.UnorderedArray}return Object.defineProperty(t.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ballSprite",{get:function(){return this._ball},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shadowSprite",{get:function(){return this._shadow},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pathDistance",{get:function(){return this._pathDistance},set:function(t){this._pathDistance=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetPathDistance",{get:function(){return this._targetPathDistance},set:function(t){this._targetPathDistance=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connected",{get:function(){return this._connected},set:function(t){this._connected=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"motorContact",{get:function(){return this._motorContact},set:function(t){this._motorContact=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"removeReason",{get:function(){return this._removeReason},set:function(t){this._removeReason=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scoreIdx",{get:function(){return this._scoreIdx},set:function(t){this._scoreIdx=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"interpolationType",{get:function(){return this._interpolationType},set:function(t){this._interpolationType=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speed",{get:function(){return this._speed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBasicType",{get:function(){return this._type>=0&&this._type<s.Defs.ELEMENTS.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMotor",{get:function(){return this._type===s.Defs.BALL_MOTOR},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ballLayer",{get:function(){return this._ballLayer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"chain",{get:function(){return this._chain},set:function(t){this._chain=t,this._path=t?t.path:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"waveID",{get:function(){return this._waveID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasBonus",{get:function(){return this._hasBonus},set:function(t){this._hasBonus=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ballGroup",{get:function(){return this._ball.parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spatialType",{get:function(){return l.SpatialType.Ball},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spatialObject",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"collisionDist",{get:function(){return this._collisionDist},enumerable:!1,configurable:!0}),t.calculateBallMetrics=function(e){if(-1===t.RADIUS){var n=s.Defs.ELEMENTS[0].frame+"_000",i=e.cache.getFrameByName(r.Config.ATLAS_GAME,n).width;t.DIAMETER=i,t.RADIUS=i/2,t.CIRCUMFERENCE=2*Math.PI*t.RADIUS,t.INV_MODIFIED_CIRC=t.FRAMES_REPEATS/t.CIRCUMFERENCE}},t.prototype.createIndices=function(e){if(0===t.SPRITE_INDICES.length){for(var n=0;n<s.Defs.ELEMENTS.length;n++){var i=e.cache.getFrameByName(r.Config.ATLAS_GAME,s.Defs.ELEMENTS[n].frame+"_000"),o=i?i.index:0;t.SPRITE_INDICES.push(o)}t.MOTOR_PUSH_INDICES=e.cache.getFrameByName(r.Config.ATLAS_GAME,s.Defs.FRAMES_MOTOR_PUSH[0]).index,t.MOTOR_WALK_INDICES=e.cache.getFrameByName(r.Config.ATLAS_GAME,s.Defs.FRAMES_MOTOR_WALK[0]).index}},t.prototype.createVisuals=function(t){this._ball=new Phaser.Sprite(t,0,0,r.Config.ATLAS_GAME),this._ball.anchor.set(.5),this._shine=new Phaser.Sprite(t,0,0,r.Config.ATLAS_GAME),this._shine.anchor.set(.5),this._shadow=new Phaser.Sprite(t,0,0,r.Config.ATLAS_GAME),this._shadow.anchor.set(.5),this._ball.addChild(this._shine)},t.prototype.setVisible=function(t){this._ball.visible=t,this._shadow.visible=t,this._shadow.visible=t},t.prototype.changeType=function(t){this._type=t,this.initVisuals(),this.isMotor&&(this._waveID=this._chain.waveID)},t.prototype.init=function(t,e){this.reset(),this.chain=e,this.changeType(t)},t.prototype.reset=function(){this._pathDistance=0,this._targetPathDistance=0,this._connected=this._motorContact=!1,this._removeReason=i.None,this._scoreIdx=0,this._hasBonus=!1,this._spawnTime=this._game.time.time,this._interpolationType=o.None,this._chain=null,this._waveID=-1,this.setAngle(0),this._shadow.angle=0,this._ballLayer=this._shadowLayer=-1},t.prototype.removeFromParent=function(){this.removeSpriteFromParent(this._ball),this.removeSpriteFromParent(this._shadow)},t.prototype.removeSpriteFromParent=function(t){var e=t.parent;e&&e.remove(t)},t.prototype.initVisuals=function(){var e=this._type;if(this._ball.visible=!0,this.isBasicType)this._ball.frame=t.SPRITE_INDICES[e],this._shine.frameName=s.Defs.ELEMENTS[e].shineFrame,this._shadow.frameName=t.SHADOW_FRAME,this._shine.visible=this._shadow.visible=!0;else if(this.isMotor)this._ball.frame=t.MOTOR_PUSH_INDICES,this._shine.visible=!1,this._shadow.frameName=s.Defs.FRAME_MOTOR_PUSH_SHADOW;else{var n=e&s.Defs.BALL_SPECIAL_MASK,i=s.Defs.POWERUPS[n];switch(this._ball.frameName=i.ballFrame,this._shine.frameName=i.shineFrame,this._shadow.frameName=t.SHADOW_FRAME,this._shadow.visible=this._shine.visible=!0,e){case s.Defs.BALL_ELEMENT_GREEN:case s.Defs.BALL_CHAIN_STEEL:case s.Defs.BALL_CHAIN_BOMB:this._shadow.visible=this._shine.visible=!1;break;case s.Defs.BALL_ELEMENT_YELLOW:this._shadow.visible=this._shine.visible=!1,(o=c.Emitters.instance.spawn(0,this._ball,12))&&(this._refs[0]=o,o.emitAt(0,0),o.flow(50,2));break;case s.Defs.BALL_ELEMENT_CYAN:var o;(o=c.Emitters.instance.spawn(0,this._ball,73))&&(this._refs[0]=o,o.emitAt(0,0),o.flow(100,1))}}},t.prototype.setFrameAccordingDistance=function(e){if(this.isBasicType)this._ball.frame=t.SPRITE_INDICES[this.type]+this.getFrameOffset(e);else if(this.isMotor){this._motorContact?(this._ball.frame=t.MOTOR_PUSH_INDICES+Math.floor(Math.max(0,e)/1.2)%s.Defs.FRAMES_MOTOR_PUSH.length,this._shadow.frameName=s.Defs.FRAME_MOTOR_PUSH_SHADOW):(this._ball.frame=t.MOTOR_WALK_INDICES+Math.floor(Math.max(0,e)/2)%s.Defs.FRAMES_MOTOR_WALK.length,this._shadow.frameName=s.Defs.FRAME_MOTOR_WALK_SHADOW);var n=this._ball.position;this._shadow.position.set(n.x+3,n.y+3),this._shadow.angle=this._ball.angle}},t.prototype.getFrameOffset=function(e){var n=t.FRAMES_COUNT,i=1e4-Math.max(0,e);return i*=t.INV_MODIFIED_CIRC,i-=Math.floor(i),Math.floor(i*n)},t.prototype.setPosition=function(t,e){this._position.set(t,e),this._ball.position.set(t,e),this._shadow.position.set(t,e),this._listeners.isEmpty||this.notifyMoved()},t.prototype.setAngle=function(t){this._ball.angle=t,this._shine.angle=-t},t.prototype.setShineAngle=function(t){this._shine.angle=t},t.prototype.resetShineAngle=function(){this._shine.angle=-this._ball.angle},t.prototype.setPositionAlongPath=function(t){var e=this._path.getPointAtDistance(t);this.setPosition(e.x,e.y),this.setAngle(e.angle),this.setBallLayer(e.layer),this.setShadowLayer(e.shadowLayer)},t.prototype.getTunnelId=function(){return this._path.getTunnelId(this._pathDistance)},t.prototype.getTunnelInfo=function(t){return this._path.getTunnelInfo(this._pathDistance,t)},t.prototype.setBallLayer=function(t){t!==this._ballLayer&&(this._ballLayer=t,this._chain.addBallToLayer(this,t))},t.prototype.setShadowLayer=function(t){t!==this._shadowLayer&&(this._shadowLayer=t,this._chain.addShadowToLayer(this,t))},t.prototype.moveBy=function(t,e){this.setPosition(this._position.x+t,this._position.y+e)},t.prototype.moveToTarget=function(t){var e=!1,n=this._pathDistance;switch(this._interpolationType){case o.None:this._pathDistance=this._targetPathDistance;break;case o.Distance:this.interpolatePathDistance();break;case o.DistanceToPrev:e=this.interpolatePathDistance();break;case o.Position:e=this.interpolatePosition()}return this._speed=t>1e-4?Math.min(650,(this._pathDistance-n)/t):0,this._interpolationType!==o.Position&&this.setPositionAlongPath(this._pathDistance),this.setFrameAccordingDistance(this._pathDistance),e},t.prototype.setPositionInterpolation=function(e,n,i){void 0===e&&(e=t.INTERPOLATION_TIME_INSERT),void 0===n&&(n=Phaser.Easing.Quadratic.Out),void 0===i&&(i=this.position),this._interpolationType=o.Position,this._interpolationTimeCurrent=0,this._interpolationTimeMax=e,this._interpolationStartPosition.copyFrom(i),this._interpolationStartAngle=this._ball.angle,this._interpolationFunction=n,this._interpolationStartFrameIdx=this._ball.frame-t.SPRITE_INDICES[this.type]},t.prototype.interpolatePosition=function(){this._interpolationTimeCurrent=Math.min(this._interpolationTimeCurrent+this._game.time.delta,this._interpolationTimeMax);var e=this._interpolationFunction(this._interpolationTimeCurrent/this._interpolationTimeMax),n=this._path.getPointAtDistance(this._targetPathDistance);if(this.setPosition(Phaser.Math.linear(this._interpolationStartPosition.x,n.x,e),Phaser.Math.linear(this._interpolationStartPosition.y,n.y,e)),this._ball.angle=u.MathHelp.angleLinear(this._interpolationStartAngle,n.angle,e),this.resetShineAngle(),this.isBasicType){var i=this.getFrameOffset(this._targetPathDistance);this._ball.frame=t.SPRITE_INDICES[this.type]+Math.round(Phaser.Math.linear(this._interpolationStartFrameIdx,i,e))}return this.setBallLayer(n.layer),this.setShadowLayer(n.shadowLayer),this._pathDistance=this._targetPathDistance,this._interpolationTimeCurrent===this._interpolationTimeMax&&(this._interpolationType=o.None,!0)},t.prototype.setPathDistanceToPrevInterpolation=function(t,e,n){this.setPathDistanceInterpolation(t,e,n),this._interpolationType=o.DistanceToPrev},t.prototype.setPathDistanceInterpolation=function(e,n,i){void 0===e&&(e=t.INTERPOLATION_TIME_INSERT),void 0===n&&(n=Phaser.Easing.Quadratic.Out),void 0===i&&(i=this._pathDistance),this._interpolationType=o.Distance,this._interpolationTimeCurrent=0,this._interpolationTimeMax=e,this._interpolationStartDistance=i,this._interpolationFunction=n,this._interpolationStartAngle=this._ball.angle},t.prototype.interpolatePathDistance=function(){this._interpolationTimeCurrent=Math.min(this._interpolationTimeCurrent+this._game.time.delta,this._interpolationTimeMax);var t=this._interpolationFunction(this._interpolationTimeCurrent/this._interpolationTimeMax);return this._pathDistance=Phaser.Math.linear(this._interpolationStartDistance,this._targetPathDistance,t),this._interpolationTimeCurrent===this._interpolationTimeMax&&(this._pathDistance=this._targetPathDistance,this._interpolationType=o.None,!0)},t.prototype.collidedWithCircle=function(e,n,i){if(this.isMotor)return!1;var o=i+t.RADIUS,r=this._position;if(e<r.x-o||e>r.x+o||n<r.y-o||n>r.y+o)return!1;var s=r.x-e,a=r.y-n,l=s*s+a*a;return l<=o*o&&(this._collisionDist=l,!0)},t.prototype.onCannonLaunch=function(){this.resetShineAngle(),this.shadowSprite.visible=!0},t.prototype.destroyWithReason=function(t){this.removeReason=t,this.chain&&(this.chain.forceRemove=!0)},t.prototype.onDestroy=function(t){this.isBasicType?this._removeReason!==i.Match&&this._removeReason!==i.Broken||this.onDestroyBasic(t):this.onDestroySpecials(t),this.notifyDestroyed()},t.prototype.onDestroyBasic=function(t){var e=a.ParticleDefs.PTC_BALL_BREAK_FOG,n=0===this._ballLayer?t.bottomBalls:t.topBalls,i=c.Emitters.instance.oneTime(1,n.effectsUnder,e[this._type]);i.emitAt(this.position.x,this.position.y),i.explode(1),(i=c.Emitters.instance.oneTime(1,n.effectsOver,99)).emitAt(this.position.x,this.position.y),i.explode(1)},t.prototype.onDestroySpecials=function(t){switch(this.type){case s.Defs.BALL_ELEMENT_YELLOW:case s.Defs.BALL_ELEMENT_CYAN:if(this._refs[0])this._refs[0].stop(),this._refs[0]=null;break;case s.Defs.BALL_REWARD_RAINBOW:this._removeReason!==i.Match&&this._removeReason!==i.Broken||this._path&&this.getTunnelId()<0&&t.emitOnRainbow(this)}},t.prototype.addListener=function(t){this._listeners.add(t)},t.prototype.removeListener=function(t){this._listeners.remove(t)},t.prototype.removeAllListeners=function(){this._listeners.clear()},t.prototype.notifyMoved=function(){var t=this,e=this._position;this._listeners.iterate((function(n){n.onBallMoved(t,e)}))},t.prototype.notifyDestroyed=function(){var t=this;this._listeners.iterate((function(e){e.onBallDestroyed(t)})),this.removeAllListeners()},t.prototype.updateLaunched=function(t){switch(this._type){case s.Defs.BALL_ELEMENT_BLUE:this.animateBallFrame(s.Defs.FRAMES_BALL_ELEMENT_BLUE,100);break;case s.Defs.BALL_ELEMENT_RED:this.animateBallFrame(s.Defs.FRAMES_BALL_ELEMENT_RED,50);break;case s.Defs.BALL_CHAIN_BOMB:this.setAngle((this._ball.angle+720*t)%360);break;case s.Defs.BALL_ELEMENT_CYAN:this.animateBallFrame(s.Defs.FRAMES_BALL_ELEMENT_CYAN);break;case s.Defs.BALL_ELEMENT_PURPLE:this.animateBallFrame(s.Defs.FRAMES_BALL_ELEMENT_PURPLE);break;case s.Defs.BALL_CHAIN_BOMB:this.animateBallFrame(s.Defs.FRAMES_BALL_BOMB,100);break;case s.Defs.BALL_REWARD_RAINBOW:this.animateBallFrame(s.Defs.FRAMES_BALL_RAINBOW,50)}},t.prototype.updateBallOnCannon=function(t,e,n){switch(this._type){case s.Defs.BALL_ELEMENT_BLUE:this.animateBallFrame(s.Defs.FRAMES_BALL_ELEMENT_BLUE,100);break;case s.Defs.BALL_ELEMENT_RED:this.animateBallFrame(s.Defs.FRAMES_BALL_ELEMENT_RED,50);break;case s.Defs.BALL_ELEMENT_GREEN:this.animateBallFrame(s.Defs.FRAMES_BALL_ELEMENT_GREEN,e.blocked&&n?20:100);break;case s.Defs.BALL_ELEMENT_YELLOW:this.animateBallFrame(s.Defs.FRAMES_BALL_ELEMENT_YELLOW);break;case s.Defs.BALL_ELEMENT_CYAN:this.animateBallFrame(s.Defs.FRAMES_BALL_ELEMENT_CYAN);break;case s.Defs.BALL_ELEMENT_PURPLE:this.animateBallFrame(s.Defs.FRAMES_BALL_ELEMENT_PURPLE);break;case s.Defs.BALL_CHAIN_BOMB:this.animateBallFrame(s.Defs.FRAMES_BALL_BOMB,100);break;case s.Defs.BALL_CHAIN_STEEL:this.animateBallFrame(s.Defs.FRAMES_BALL_CHAIN_STEEL,50),this._ball.angle=-e.angle,this._shine.angle=0;break;case s.Defs.BALL_REWARD_RAINBOW:this.animateBallFrame(s.Defs.FRAMES_BALL_RAINBOW,50)}},t.prototype.animateBallFrame=function(t,e){void 0===e&&(e=100);var n=this._game.time.time-this._spawnTime,i=Math.floor(n/e);i%=t.length,this._ball.frameName=t[i]},t.FRAMES_COUNT=100,t.FRAMES_REPEATS=2,t.SHADOW_FRAME="ballShadow",t.SPRITE_INDICES=[],t.MOTOR_PUSH_INDICES=-1,t.MOTOR_WALK_INDICES=-1,t.RADIUS=-1,t.DIAMETER=-1,t.CIRCUMFERENCE=-1,t.INV_MODIFIED_CIRC=-1,t.INTERPOLATION_TIME_INSERT=100,t}();e.Ball=p},1850:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BallStats=void 0;var n=function(){function t(){this._game=null,this._stats=[0,0,0,0,0,0],this._total=0}return Object.defineProperty(t.prototype,"countTotal",{get:function(){return this._total},enumerable:!1,configurable:!0}),t.prototype.clear=function(){var t=this._stats;t[0]=t[1]=t[2]=t[3]=t[4]=t[5]=0,this._total=0},t.prototype.inRange=function(t){return t>=0&&t<this._stats.length},t.prototype.count=function(t){return this._stats[t]},t.prototype.add=function(t){this.inRange(t)&&(++this._stats[t],++this._total)},t.prototype.remove=function(t){this.inRange(t)&&(--this._stats[t],--this._total)},t.prototype.switch=function(t,e){this.remove(t),this.add(e)},t.prototype.getBallsInStats=function(t,e,n){for(var i=0,o=0;o<e;o++){var r=this._stats[o];t[o]=r>0?n:0,i+=r}return i>0},t.prototype.toString=function(){for(var t="",e=0;e<this._stats.length;e++)t+="#"+e+": "+this._stats[e]+(e<this._stats.length-1?", ":"");return t+=" ... total = "+this._total},t}();e.BallStats=n},4979:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ballistics=void 0;var i=n(713),o=function(){function t(){this._start=new Phaser.Point,this._end=new Phaser.Point,this._dist=0,this._gravity=0,this._time=0,this._v=0,this._finished=!1,this._result={position:new Phaser.Point,height:0}}return Object.defineProperty(t.prototype,"finished",{get:function(){return this._finished},enumerable:!1,configurable:!0}),t.prototype.render=function(t){if(0!==this._dist){var e=new Phaser.Line;e.setTo(this._start.x,this._start.y,this._end.x,this._end.y),t.debug.geom(e,"RGBA(255,255,0, 0.5)");for(var n=this._start.x,i=this._start.y,o=1;o<=32;o++){var r=this.getAtRatio(o/32),s=r.position.y+r.height;e.setTo(n,i,r.position.x,s),t.debug.geom(e,"RGB(255,255,0)"),n=r.position.x,i=s}}},t.prototype.copy=function(t){t.init(this._start,this._end)},t.prototype.init=function(e,n){this._finished=!1,this._current=0,this._start.copyFrom(e),this._end.copyFrom(n),this._dist=Phaser.Point.distance(e,n),this._gravity=t.GRAVITY,this._time=Phaser.Math.mapLinear(this._dist,0,350,.3,1),this._time=Phaser.Math.clamp(this._time,.3,1),this._v=-.5*this._gravity*this._time},t.prototype.step=function(t){this._current+=t,this._current>=this._time&&(this._finished=!0),this._current=Phaser.Math.clamp(this._current,0,this._time)},t.prototype.getAtCurrent=function(){return this.getAtTime(this._current)},t.prototype.getAtTime=function(t){var e=t/this._time;return i.MathHelp.pointLinear(this._start,this._end,e,this._result.position),this._result.height=this._v*t+.5*this._gravity*t*t,this._result},t.prototype.getAtRatio=function(t){var e=this.ratioToTime(t);return this.getAtTime(e)},t.prototype.ratioToTime=function(t){return this._time*t},t.GRAVITY=1300,t}();e.Ballistics=o},1532:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.BallisticsTrajectory=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(6501),h=n(6e3),u=n(7892),c=n(712),p=n(4979),_=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i._level=null,i._impact=null,i._trajectory=null,i._validTarget=!1,i._level=n,i._curve=new p.Ballistics,i._impact=i.createImpact(),i._trajectory=i.createTrajectory(),i.visible=!1,i}return o(e,t),Object.defineProperty(e.prototype,"curve",{get:function(){return this._curve},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"validTarget",{get:function(){return this._validTarget},enumerable:!1,configurable:!0}),e.prototype.createImpact=function(){var t=this.game.add.sprite(0,0,s.Config.ATLAS_GAME,a.Defs.FRAME_TRAJECTORY_IMPACT,this);return t.anchor.set(.5),t},e.prototype.createTrajectory=function(){for(var t=[],n=0;n<e.TRAJECTORY_POINTS;n++)t.push(new Phaser.Point);var i=new l.TrajectoryRope(this.game,t);return this.add(i),i},e.prototype.setPositions=function(t,e){this._curve.init(t,e);var n=r.App.isLandscape?e.y<t.y:e.x<t.x;this._trajectory.updatePoints(this._curve,n),this._validTarget=!this.checkCollision(e),this._trajectory.setValid(this._validTarget);var i=this._curve.getAtRatio(1);this._impact.position.copyFrom(i.position),this._impact.tint=this._validTarget?a.Defs.COLOR_BALLISTICS_VALID:a.Defs.COLOR_BALLISTICS_INVALID,this._impact.angle=r.App.isLandscape?0:-90},e.prototype.checkCollision=function(t){var e=this._level.spatial,n=c.Ball.RADIUS,i=n<<1,o=!1;return e.testUnique(t.x,t.y,i,i,u.SpatialTestType.Static,(function(e){if(e.spatialType===h.SpatialType.Collider){var i=e.spatialObject;i.isTunnel||(o=i.circleIntersection(t.x,t.y,n))}return o}),.5,.5),o},e.TRAJECTORY_POINTS=32,e}(Phaser.Group);e.BallisticsTrajectory=_},4214:function(t,e){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.BallsGroup=void 0;var o=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i._balls=null,i._shadows=null,i._effectsUnder=null,i._effectsOver=null,i._shadows=new Phaser.Group(e,i),i._balls=new Phaser.Group(e,i),i._effectsUnder=new Phaser.Group(e,i),i._effectsOver=new Phaser.Group(e,i),i}return i(e,t),Object.defineProperty(e.prototype,"effectsUnder",{get:function(){return this._effectsUnder},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"effectsOver",{get:function(){return this._effectsOver},enumerable:!1,configurable:!0}),e.prototype.addBallAndShadow=function(t){this._balls.add(t.ballSprite),this._shadows.add(t.shadowSprite)},e.prototype.addBall=function(t){this._balls.add(t.ballSprite)},e.prototype.addShadow=function(t){this._shadows.add(t.shadowSprite)},e}(Phaser.Group);e.BallsGroup=o},1101:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Bonus=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(712),h=function(t){function e(e,n,i){var o=t.call(this,e,n)||this;return o._manager=null,o._ball=null,o._timeCurrent=0,o._timeMax=0,o._manager=i,o._icon=e.add.sprite(0,0,s.Config.ATLAS_GAME,0,o),o._icon.anchor.set(.5),o.visible=!1,o}return o(e,t),Object.defineProperty(e.prototype,"ball",{get:function(){return this._ball},set:function(t){this._ball=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isActive",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bonusType",{get:function(){return this._bonusType},enumerable:!1,configurable:!0}),e.prototype.setType=function(t){this._bonusType=t,this._timeCurrent=0,this._timeMax=s.Config.CHAIN_BONUS_DURATION;var e=a.Defs.POWERUPS[t];this._icon.frameName=e.chainFrame,this._icon.visible=!0,this._icon.alpha=0,this._icon.angle=r.App.isLandscape?0:-90},e.prototype.attach=function(t){this._ball=t,this._ball.hasBonus=!0,t.addListener(this),t.ballGroup.add(this),this.position.copyFrom(t.position),this.visible=!0},e.prototype.dettach=function(){this._ball.hasBonus=!1,this._ball.removeListener(this),this._ball=null,this.parent.remove(this),this.visible=!1},e.prototype.updateBonus=function(t){if(this.updateTime(t))return!1;if(this._timeCurrent<s.Config.CHAIN_BONUS_APPEAR_DURATION){var e=this._timeCurrent/s.Config.CHAIN_BONUS_APPEAR_DURATION;this._icon.alpha=.5+.5*e,this._icon.scale.set(1+.5*(1-e)),this._icon.angle=-30*(1-e)+(r.App.isLandscape?0:-90)}return this._timeCurrent>s.Config.CHAIN_BONUS_BLINK_START_TIME&&(this._icon.visible=(1&Math.floor(this._timeCurrent/s.Config.CHAIN_BONUS_BLINK_PERIOD))>0),!0},e.prototype.updateTime=function(t){return this._timeCurrent+=t,this._timeCurrent>=this._timeMax},e.prototype.onBallMoved=function(t,e){this.position.set(e.x,e.y),this.parent!==this._ball.ballGroup&&this._ball.ballGroup.add(this)},e.prototype.onBallDestroyed=function(t){this.isActive&&t.removeReason!==l.BallRemoveReason.PathEnd&&this._manager.activateBonus(this,t),this._manager.destroy(this)},e}(Phaser.Group);e.Bonus=h},5384:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BonusManager=void 0;var i=n(2178),o=n(5357),r=n(1391),s=n(6037),a=n(1101),l=function(){function t(e,n){this.onBonus=new Phaser.Signal,this._game=null,this._listener=null,this._pool=null,this._available=[],this._ballTime=0,this._game=e,this._listener=n;var i=this;this._pool=new s.UnorderedArrayPool(a.Bonus,t.MAX_BONUSES,(function(){return new a.Bonus(e,null,i)})),this.getAvailable(),this._ballTime=this.calcNextTime()}return t.prototype.getAvailable=function(){for(var t=i.App.settings.data.powerups,e=0;e<r.Defs.CHAIN_POWERUP_IDS.length;e++){var n=r.Defs.CHAIN_POWERUP_IDS[e];(t[n].level>0||(o.Config.DEBUG_CHAIN_POWERUPS_MASK&1<<e)>0)&&this._available.push(n)}},t.prototype.create=function(t){var e=this._pool.spawn();return null!==e&&e.setType(t),e},t.prototype.destroy=function(t){t.dettach(),this._pool.despawn(t)},t.prototype.activateBonus=function(t,e){this._listener.onBonusActivated(t,e)},t.prototype.update=function(){this.updateUsed(),this._available.length>0&&this.generate()},t.prototype.handleOrientationChange=function(){this._pool.iterate((function(t){t.icon.angle=i.App.isLandscape?0:-90}))},t.prototype.updateUsed=function(){var t=this,e=this._game.time.delta;this._pool.iterate((function(n){n.updateBonus(e)||t.destroy(n)}))},t.prototype.generate=function(){if(!(this.updateTime()>0)){this._ballTime=this.calcNextTime();var t=this._listener.getRandomBall();if(null!==t){var e=this._available[this._game.rnd.integerInRange(0,this._available.length-1)],n=this.create(e);null!==n&&(n.attach(t),this.onBonus.dispatch(n))}}},t.prototype.calcNextTime=function(){var t=o.Config.CHAIN_BONUS_GENERATE_TIMES[this._available.length];return t*=1+this._game.rnd.realInRange(0,o.Config.CHAIN_BONUS_GENERATE_TIME_VARIANCE)},t.prototype.updateTime=function(){var t=this._game.time.delta/1e3*this._listener.getBallsCount();return this._ballTime-=t,this._ballTime},t.MAX_BONUSES=8,t}();e.BonusManager=l},6124:function(t,e){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Bridge=void 0;var o=function(t){function e(e,n){var i=t.call(this,e,n.position.x,n.position.y,"Bridges",n.idx)||this;return i._structure=null,i._structure=n,i}return i(e,t),e}(Phaser.Sprite);e.Bridge=o},113:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.BridgesGroup=void 0;var r=n(6124),s=function(t){function e(e,n){return t.call(this,e,n)||this}return o(e,t),e.prototype.addBridge=function(t){var e=new r.Bridge(this.game,t);return this.add(e),e},e}(Phaser.Group);e.BridgesGroup=s},8762:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Cannon=void 0;var r=n(5357),s=n(1391),a=n(6944),l=n(6020),h=function(t){function e(n,i){var o=t.call(this,n,i)||this;return o._level=null,o._cannonBottom=null,o._cannonTop=null,o._currentBall=null,o._nextBall=null,o._currentBallHolder=null,o._nextBallHolder=null,o._launchPoint=new Phaser.Point,o._reloadInProgress=!1,o._reloadTime=0,o._swapInProgress=!1,o._swapTime=0,o._blocked=!1,o._queue=null,o._level=i,o._cannonBottom=n.add.sprite(0,0,r.Config.ATLAS_GAME,e.CANNON_FRAME_BOTTOM,o),o._cannonBottom.anchor.set(.5),o._nextBallHolder=new Phaser.Group(n,o),o._currentBallHolder=new Phaser.Group(n,o),o.resetHolders(),o._cannonTop=n.add.sprite(0,0,r.Config.ATLAS_GAME,e.CANNON_FRAME_TOP,o),o._cannonTop.anchor.set(.5),o._queue=new a.PriorityQueue,o.init(),o}return o(e,t),Object.defineProperty(e.prototype,"cannonRadius",{get:function(){return this._cannonBottom.height/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blocked",{get:function(){return this._blocked},set:function(t){this._blocked=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ready",{get:function(){return!this._swapInProgress&&!this._reloadInProgress},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canThrow",{get:function(){if(!this.ready)return!1;if(null===this._currentBall)return!1;var t=this._currentBall.type;return t!==s.Defs.BALL_ELEMENT_GREEN&&t!==s.Defs.BALL_ELEMENT_YELLOW},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.setCurrentBall(this.generateBall()),this.setNextBall(this.generateBall())},e.prototype.resetHolders=function(){this._currentBallHolder.position.copyFrom(e.CURRENT_HOLDER_OFFSET),this._currentBallHolder.scale.set(e.CURRENT_HOLDER_SCALE),this._nextBallHolder.position.copyFrom(e.NEXT_HOLDER_OFFSET),this._nextBallHolder.scale.set(e.NEXT_HOLDER_SCALE)},e.prototype.getLaunchPoint=function(){return this._launchPoint.copyFrom(e.CURRENT_HOLDER_OFFSET),this._launchPoint.add(this.x,this.y),this._launchPoint.rotate(this.x,this.y,this.angle,!0),this._launchPoint},e.prototype.generateBall=function(){var t=this.getNextBallType();if(-1===t)return null;var e=this._level.getNewBall();return e.init(t,null),e.setPosition(0,0),e.setAngle(0),e.isBasicType||this.setBallSpecials(e),e.shadowSprite.visible=!1,e.setShineAngle(-this.angle),e},e.prototype.setBallSpecials=function(t){if(t.type===s.Defs.BALL_CHAIN_BOMB){var e=this.game.rnd.integerInRange(15,45);t.setAngle(e*this.game.rnd.sign())}},e.prototype.getNextBallType=function(){if(this._queue.isEmpty)return this._level.getLimitedRandomBallType(!1);var t=this._queue.dequeue();return this._level.HUD.updateCannonQueue(this._queue),t},e.prototype.setCurrentBall=function(t){this._currentBall=t,null!==t&&this._currentBallHolder.add(t.ballSprite)},e.prototype.setNextBall=function(t){this._nextBall=t,null!==t&&this._nextBallHolder.add(t.ballSprite)},e.prototype.limitTypes=function(){this.checkBallType(this._currentBall),this.checkBallType(this._nextBall)},e.prototype.checkBallType=function(t){if(null!==t&&t.isBasicType&&!this._level.ballTypeInStats(t.type)){var e=this._level.getLimitedRandomBallType(!0);-1!==e&&t.changeType(e)}},e.prototype.reload=function(){null===this._currentBall&&null!==this._nextBall&&(this.setCurrentBall(this._nextBall),this.setNextBall(this.generateBall()),this._currentBallHolder.x=e.NEXT_HOLDER_OFFSET.x,this._currentBallHolder.scale.set(e.NEXT_HOLDER_SCALE),this._nextBallHolder.scale.set(e.NEXT_HOLDER_RELOAD_SCALE),this._reloadInProgress=!0,this._reloadTime=0)},e.prototype.swapBalls=function(){if(this.ready&&!this._blocked&&null!==this._currentBall&&null!==this._nextBall){var t=this._currentBall;this.setCurrentBall(this._nextBall),this.setNextBall(t),this._currentBallHolder.x=e.NEXT_HOLDER_OFFSET.x,this._currentBallHolder.scale.set(e.NEXT_HOLDER_SCALE),this._nextBallHolder.x=e.CURRENT_HOLDER_OFFSET.x,this._nextBallHolder.scale.set(e.CURRENT_HOLDER_SCALE),this._swapInProgress=!0,this._swapTime=0,l.AudioUtils.playAudioRecord(s.Defs.SFX_BALL_SWITCH)}},e.prototype.launchBall=function(){if(!this.ready||this._blocked)return null;var t=this._currentBall;if(null===t)return null;if(t.type===s.Defs.BALL_CHAIN_BOMB)t.setAngle((this.angle+t.ballSprite.angle)%360);else if(t.type===s.Defs.BALL_CHAIN_STEEL)t.setAngle(0);else{if(t.type===s.Defs.BALL_ELEMENT_GREEN)return this._blocked=!0,t;t.setAngle(this.angle)}var e=this.getLaunchPoint();return t.setPosition(e.x,e.y),this.removeCurrentBall(),t},e.prototype.removeCurrentBall=function(){var t=this._currentBall;return null!==t&&(this._currentBallHolder.remove(t.ballSprite),this._currentBall=null),t},e.prototype.aimAt=function(t){if(!this._blocked){var e=this._cannonBottom.height/4;Phaser.Math.distanceSq(t.x,t.y,this.x,this.y)>=e*e&&(this.angle=Phaser.Math.radToDeg(Phaser.Math.angleBetweenPoints(this.position,t)))}},e.prototype.updateCannon=function(t){this.setShineAngles(-this.angle),this.reload(),this._reloadInProgress&&this.animateReload(),this._swapInProgress&&this.animateSwap(),this.updateBalls(t)},e.prototype.updateBalls=function(t){null===this._currentBall||this._currentBall.isBasicType||this._currentBall.updateBallOnCannon(t,this,!0),null===this._nextBall||this._nextBall.isBasicType||this._nextBall.updateBallOnCannon(t,this,!1)},e.prototype.setShineAngles=function(t){null!==this._currentBall&&this._currentBall.setShineAngle(t),null!==this._nextBall&&this._nextBall.setShineAngle(t)},e.prototype.animateReload=function(){this._reloadTime+=this.game.time.delta;var t=Phaser.Math.clamp(this._reloadTime/e.RELOAD_DURATION,0,1);this._currentBallHolder.x=Phaser.Math.linear(e.NEXT_HOLDER_OFFSET.x,e.CURRENT_HOLDER_OFFSET.x,t),this._currentBallHolder.scale.set(Phaser.Math.linear(e.NEXT_HOLDER_SCALE,e.CURRENT_HOLDER_SCALE,t));var n=Math.max(2*t-1,0);this._nextBallHolder.scale.set(Phaser.Math.linear(e.NEXT_HOLDER_RELOAD_SCALE,e.NEXT_HOLDER_SCALE,n)),1===t&&(this.resetHolders(),this._reloadInProgress=!1)},e.prototype.animateSwap=function(){this._swapTime+=this.game.time.delta;var t=Phaser.Math.clamp(this._swapTime/e.SWAP_DURATION,0,1);this._currentBallHolder.x=Phaser.Math.linear(e.NEXT_HOLDER_OFFSET.x,e.CURRENT_HOLDER_OFFSET.x,t),this._currentBallHolder.scale.set(this.getSwapCurveAt(t)),this._nextBallHolder.x=Phaser.Math.linear(e.CURRENT_HOLDER_OFFSET.x,e.NEXT_HOLDER_OFFSET.x,t),this._nextBallHolder.scale.set(Phaser.Math.linear(e.CURRENT_HOLDER_SCALE,e.NEXT_HOLDER_SCALE,t)),1===t&&(this.resetHolders(),this._swapInProgress=!1)},e.prototype.getSwapCurveAt=function(t){return-1.678946638*t*t+2.198946638*t+e.NEXT_HOLDER_SCALE},e.prototype.enqueueBall=function(t){this._queue.enqueue(t),this._level.HUD.updateCannonQueue(this._queue)},e.CANNON_FRAME_BOTTOM="cannon_bottom",e.CANNON_FRAME_TOP="cannon_top",e.CURRENT_HOLDER_OFFSET=new Phaser.Point(50,0),e.NEXT_HOLDER_OFFSET=new Phaser.Point(-45,0),e.CURRENT_HOLDER_SCALE=1,e.NEXT_HOLDER_SCALE=.48,e.NEXT_HOLDER_RELOAD_SCALE=0,e.RELOAD_DURATION=200,e.SWAP_DURATION=200,e}(Phaser.Group);e.Cannon=h},1424:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Chain=void 0;var i=n(5357),o=n(1391),r=n(7215),s=n(712),a=n(8716),l=n(7389),h=n(7113),u=function(){function t(t,e,n){this.onWaveSpawned=new Phaser.Signal,this.onWaveDestroyed=new Phaser.Signal,this._game=null,this._level=null,this._path=null,this._speedManager=null,this._sealDistance=-1e5,this._balls=[],this._ballsCount=0,this._checkMatchIndices=[],this._checkMatchIndicesCount=0,this._forceRemove=!1,this._waveID=0,this._wavesFinished=!1,this._waveBallsTotal=0,this._waveBallsToSpawn=0,this._hlpPt1=new Phaser.Point,this._hlpPt2=new Phaser.Point,this._l=new Phaser.Line,this._c=new Phaser.Circle,this._game=t,this._level=e,this._path=n,this._speedManager=new h.SpeedManager(this,e)}return Object.defineProperty(t.prototype,"path",{get:function(){return this._path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"balls",{get:function(){return this._balls},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ballsCount",{get:function(){return this._ballsCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"waveID",{get:function(){return this._waveID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speedManager",{get:function(){return this._speedManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"forceRemove",{set:function(t){this._forceRemove=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ballsInCurrentWaveSpawned",{get:function(){return this._waveBallsTotal-this._waveBallsToSpawn},enumerable:!1,configurable:!0}),t.prototype.render=function(){for(var t="RGBA(0,0,255,1)",e=0;e<this._ballsCount;e++){var n=this._balls[e],i=n.position;if(n.connected){this._c.setTo(i.x,i.y,10),this._game.debug.geom(this._c,t,!0);var o=this._balls[e+1].position;this._l.setTo(i.x,i.y,o.x,o.y),this._game.debug.geom(this._l,t)}}},t.prototype.nextWave=function(t,e,n){i.Config.DEBUG_USE_PROFILES&&i.Config.DEBUG_PROFILE_IDX>0&&(e=1e4),this._waveID=t,this._waveBallsTotal=e,this._waveBallsToSpawn=e;var o=-1;this._ballsCount>0&&(o=this._balls[this._ballsCount-1].pathDistance),this._speedManager.handleNewWave(o,e),this._wavesFinished=n},t.prototype.setSealed=function(t){this._sealDistance=t+100},t.prototype.getChainIdx=function(t){for(var e=this._balls,n=this._ballsCount-1;n>=0;n--)if(e[n]===t)return n;return-1},t.prototype.resolveCollision=function(t,e){var n=this.getChainIdx(e);this._hlpPt2.set(t.position.x-e.position.x,t.position.y-e.position.y);var i=this._hlpPt2.dot(this.getBallDirection(e)),o=this._balls,r=this.insert(t,n,i<0);t.setPositionInterpolation();var l=r-1;if(l>=0){var h=o[l];h.connected&&h.setPathDistanceInterpolation()}var u=r+1;if(0!==a.Level.BALL_SHIFT_BACKWARD&&u<this._ballsCount&&t.targetPathDistance-o[u].targetPathDistance<s.Ball.DIAMETER){for(;u<this._ballsCount&&o[u].connected;)++u;u<this._ballsCount&&(o[u].targetPathDistance-=a.Level.BALL_SHIFT_BACKWARD,o[u].setPathDistanceInterpolation())}},t.prototype.insert=function(t,e,n){for(var i=n?e+1:e,o=this._ballsCount-1;o>=i;o--)this._balls[o+1]=this._balls[o];return++this._ballsCount,this._balls[i]=t,t.chain=this,n?(t.targetPathDistance=this._balls[i-1].targetPathDistance-a.Level.BALL_SHIFT_FORWARD,t.pathDistance=t.targetPathDistance):(t.connected=!0,t.targetPathDistance=this._balls[i+1].targetPathDistance+a.Level.BALL_SHIFT_FORWARD,t.pathDistance=t.targetPathDistance),i},t.prototype.getBallDirection=function(t,e){void 0===e&&(e=this._hlpPt1);var n=this._path.getDirectionAtDistance(t.pathDistance);return e.set(n.x,n.y),e},t.prototype.updateChain=function(t){if(this._speedManager.update(t),this.moveBalls(t),this._waveBallsToSpawn>0){var e=this.spawnNewBall();e&&this._level.onBallAdded(e)}this.addIntoSpatial(),this._forceRemove&&(this.removeBalls(),this._forceRemove=!1,this._speedManager.backRunning&&this.shrinkBalls()),this.checkPathEnd()&&this._level.gameLost(this._balls[0])},t.prototype.addIntoSpatial=function(){for(var t=this._level.spatial,e=0;e<this._ballsCount;e++){var n=this._balls[e],i=n.position;t.add(n,i.x,i.y,48,48,.5,.5)}},t.prototype.checkPathEnd=function(){return this._ballsCount>0&&this._balls[0].pathDistance>=this._path.pathLength},t.prototype.moveBalls=function(t){0!==this._ballsCount&&(this._checkMatchIndicesCount=0,this.doMoveBalls(t),this._checkMatchIndicesCount>0&&this.checkMatch())},t.prototype.doMoveBalls=function(t){for(var e=0,n=this._ballsCount-1;n>=0;n--){var i=this._balls[n],a=n===this._ballsCount-1;if(i.isMotor||a){if(i.isMotor&&!a){var l=i.motorContact?1.25*s.Ball.DIAMETER:s.Ball.DIAMETER;if(i.pathDistance-this._balls[n+1].pathDistance<l){this.killMotor(i);continue}}if(((e=this._speedManager.getDistance(a&&this.ballsInCurrentWaveSpawned>0))>0||this._balls[0].pathDistance>0&&i.pathDistance>this._sealDistance)&&(i.targetPathDistance+=e),i.isMotor&&(i.motorContact=n>0&&this._balls[n-1].connected,0===n||this._balls[n-1].isMotor)){this.killMotor(i);continue}i.moveToTarget(t)&&(this._checkMatchIndices[this._checkMatchIndicesCount++]=n)}else{var h=this._balls[n+1];if(i.pathDistance-h.pathDistance<=s.Ball.DIAMETER&&(i.connected||(i.connected=!0,i.interpolationType===s.BallInterpolation.DistanceToPrev&&(i.interpolationType=s.BallInterpolation.None,this._checkMatchIndices[this._checkMatchIndicesCount++]=n))),i.connected?i.targetPathDistance=h.pathDistance+s.Ball.DIAMETER:i.interpolationType===s.BallInterpolation.DistanceToPrev&&(h.type===i.type||this._speedManager.backRunning?i.targetPathDistance=h.pathDistance+s.Ball.DIAMETER:(i.targetPathDistance=i.pathDistance,i.interpolationType=s.BallInterpolation.None)),!i.connected&&i.interpolationType===s.BallInterpolation.None&&0!==i.speed){var u=Phaser.Math.linear(i.speed,0,4*t);i.targetPathDistance=i.pathDistance+u*t}var c=i.interpolationType;i.moveToTarget(t)&&(c===s.BallInterpolation.DistanceToPrev?(i.connected=!0,r.AudioUtils.playAudioRecord(o.Defs.SFX_BALL_CONNECT),h.type===i.type&&(this._checkMatchIndices[this._checkMatchIndicesCount++]=n)):c===s.BallInterpolation.Position&&(this.attractBalls(n,i),this._checkMatchIndices[this._checkMatchIndicesCount++]=n))}}},t.prototype.killMotor=function(t){if(t.destroyWithReason(s.BallRemoveReason.Consumed),t.getTunnelId()<0){var e=t.position.x,n=t.position.y,i=0===t.ballLayer?this._level.bottomBalls:this._level.topBalls,a=l.Emitters.instance.oneTime(0,i,27);a.emitAt(e,n);for(var h=0;h<1;h++){var u=a.emitParticle();u&&i.sendToBack(u.visual)}var c=this._level.effectsLayerTop;(a=l.Emitters.instance.oneTime(0,c,28)).emitAt(e,n),a.explode(25),(a=l.Emitters.instance.spawn(0,c,29)).emitAt(e,n),a.flow(50,5,50),a.despawnDelay=500,(a=l.Emitters.instance.oneTime(0,c,30)).emitAt(e,n),a.explode(5)}r.AudioUtils.playAudioRecord(o.Defs.SFX_MOTOR_DEATH),this.onWaveDestroyed.dispatch(t.waveID),this._wavesFinished&&1===this._ballsCount&&this._balls[0]===t&&0===this._waveBallsToSpawn&&this._level.waveCompleted(this,t.pathDistance)},t.prototype.attractBalls=function(t,e){if(e.isBasicType){var n=this._balls,i=t+1<this._ballsCount?n[t+1]:null;if(!i||!this.attractToNext(e,i)){var o=t-1>=0?n[t-1]:null;o&&this.attractToNext(o,e)}}},t.prototype.attractToNext=function(t,e){if(!t.isBasicType)return!1;if(!t.connected&&t.type===e.type){t.targetPathDistance=e.targetPathDistance+s.Ball.DIAMETER;var n=Math.max(0,t.pathDistance-e.pathDistance)/s.Ball.DIAMETER*i.Config.CHAIN_SHRINK_SPEED;return t.setPathDistanceToPrevInterpolation(n,Phaser.Easing.Quadratic.In),!0}return!1},t.prototype.checkMatch=function(){for(var t=this._checkMatchIndicesCount-1;t>=0;t--){var e=this._checkMatchIndices[t];this.checkMatchRainbow(e)?this._forceRemove=!0:this.checkMatchStandard(e)&&(this._forceRemove=!0)}},t.prototype.checkMatchRainbow=function(t){var e=this._balls;if(e[t].type!==o.Defs.BALL_REWARD_RAINBOW)return!1;e[t].removeReason=s.BallRemoveReason.Match,e[t].scoreIdx=1;for(var n=-1,i=t;--i>=0&&e[i].connected&&!e[i].isMotor&&(-1===n||e[i].type===n);)e[i].removeReason=s.BallRemoveReason.Match,e[i].scoreIdx=t-i+1,n=e[i].type;for(n=-1,i=t;e[i].connected&&++i<this._ballsCount&&!e[i].isMotor&&(-1===n||e[i].type===n);)e[i].removeReason=s.BallRemoveReason.Match,e[i].scoreIdx=i-t+1,n=e[i].type;return!0},t.prototype.checkMatchStandard=function(t){var e=this._balls,n=0,o=0,r=null;do{n=t,r=e[t]}while(--t>=0&&e[t].connected&&e[t].removeReason===s.BallRemoveReason.None&&r.type===e[t].type);t=n;do{++o,r=e[t]}while(r.connected&&++t<this._ballsCount&&e[t].removeReason===s.BallRemoveReason.None&&r.type===e[t].type);if(o>=i.Config.MATCH_MIN){for(var a=n;a<n+o;a++)e[a].removeReason=s.BallRemoveReason.Match,e[a].scoreIdx=a-n;var l=e[n].position,h=e[a-1].position;return this._level.onMatchDetected((l.x+h.x)/2,(l.y+h.y)/2),!0}return!1},t.prototype.removeBalls=function(){for(var t=this._balls,e=this._ballsCount,n=this._level,i=0,o=0;o<e;o++){var r=t[o];r.removeReason===s.BallRemoveReason.None?(i<o&&(t[o]=null,t[i]=r,i>0&&!t[i-1].connected&&this.attractToNext(t[i-1],r)),++i):(n.destroyBall(r),t[o]=null,i>0&&(t[i-1].connected=!1))}this._ballsCount=i},t.prototype.spawnNewBall=function(){var t=null;if(this._ballsCount>0&&(t=this._balls[this._ballsCount-1]).targetPathDistance<s.Ball.DIAMETER)return null;var e=this._level.getNewBall();if(this.initSpawnedBall(e,t),this._balls[this._ballsCount++]=e,--this._waveBallsToSpawn,0===this._waveBallsToSpawn){var n=this._level.getNewBall();n.init(o.Defs.BALL_MOTOR,this),n.pathDistance=n.targetPathDistance=e.pathDistance-s.Ball.DIAMETER,n.setPositionAlongPath(n.pathDistance),e.connected=!0,this._balls[this._ballsCount++]=n,this.onWaveSpawned.dispatch()}return e},t.prototype.initSpawnedBall=function(t,e){t.init(this.getRandomBallType(i.Config.CONSECUTIVE_TYPES_MAX),this),t.pathDistance=t.targetPathDistance=e&&e.targetPathDistance<1.5*s.Ball.DIAMETER?e.targetPathDistance-s.Ball.DIAMETER:0,t.setPositionAlongPath(t.pathDistance),e&&(e.targetPathDistance>=1.5*s.Ball.DIAMETER?this.attractToNext(e,t):e.connected=!0)},t.prototype.addBallToLayer=function(t,e){0===e?t.isMotor?this._level.bottomBalls.add(t.ballSprite):this._level.bottomBalls.addBall(t):t.isMotor?this._level.topBalls.add(t.ballSprite):this._level.topBalls.addBall(t)},t.prototype.addShadowToLayer=function(t,e){0===e?this._level.bottomBalls.addShadow(t):this._level.topBalls.addShadow(t)},t.prototype.getRandomBallType=function(t){for(var e,n=-1,i=0;i<t;i++){var o=this._ballsCount-1-i;if(o<0){n=-1;break}var r=this._balls[o];if(0===i)n=r.type;else if(r.type!==n){n=-1;break}}do{e=this._level.getRandomBallType()}while(e===n);return e},t.prototype.shrinkBalls=function(){for(var t=0;t<this._ballsCount-1;t++){var e=this._balls[t];if(!e.isMotor&&!e.connected){var n=this._balls[t+1];e.targetPathDistance=n.targetPathDistance+s.Ball.DIAMETER;var o=Math.max(0,e.pathDistance-n.pathDistance)/s.Ball.DIAMETER*i.Config.CHAIN_SHRINK_SPEED;e.setPathDistanceToPrevInterpolation(o,Phaser.Easing.Quadratic.In)}}},t.prototype.isBallDistanceFromEndLessThan=function(t,e){return this._path.pathLength-t.pathDistance<e},t.prototype.gatRandomBallWithoutBonus=function(){if(0===this._ballsCount)return null;var t=this._game.rnd.integerInRange(0,this._ballsCount-1),e=t;do{var n=this._balls[e];if(!n.hasBonus&&n.isBasicType&&!this.isBallDistanceFromEndLessThan(n,100))return n;(e+=1)>=this._ballsCount&&(e=0)}while(e!==t);return null},t}();e.Chain=u},2524:function(t,e,n){"use strict";var i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.DSDAnim=void 0;var o=n(3732),r=function(){function t(t,e,n){this._def=null,this._eventsTimeline=null,this._nodeTimelines=[],this._def=t,this.createEventsTimeline(t.events,n),this.createNodeTimelinePairs(t.timelines,e)}return Object.defineProperty(t.prototype,"name",{get:function(){return this._def.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._def.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLooping",{get:function(){return this._def.loop},enumerable:!1,configurable:!0}),t.prototype.createEventsTimeline=function(t,e){null!=t&&(this._eventsTimeline=new o.DSDTimeline(t,this.length,this.isLooping),this._eventsTimeline.listener=e)},t.prototype.createNodeTimelinePairs=function(t,e){var n,r;for(var s in t){var a=e[s],l=t[s];try{for(var h=(n=void 0,i(l)),u=h.next();!u.done;u=h.next()){var c=u.value,p=new o.DSDTimeline(c,this.length,this.isLooping);this._nodeTimelines.push({node:a,timeline:p})}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}}},t.prototype.reset=function(){var t,e;this._eventsTimeline&&this._eventsTimeline.reset();try{for(var n=i(this._nodeTimelines),o=n.next();!o.done;o=n.next()){o.value.timeline.reset()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.update=function(t){var e,n;this._eventsTimeline&&this._eventsTimeline.step(t);try{for(var o=i(this._nodeTimelines),r=o.next();!r.done;r=o.next()){var s=r.value,a=s.timeline;a.step(t),a.isRef?s.node.updatePropertyRef(a.property,a.valueRef):s.node.updatePropertyFloat(a.property,a.valueFloat)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},t}();e.DSDAnim=r},4525:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.DSDEntity=void 0;var s=n(2524),a=n(4843),l=n(6824),h=function(t){function e(e,n,i,o){var r=t.call(this,e,o)||this;return r.onFinished=new Phaser.Signal,r.onLoop=new Phaser.Signal,r.onEvent=new Phaser.Signal,r._data=null,r._spritesTable=null,r._root=null,r._nodesDict={},r._nodes=[],r._visualNodes=[],r._anims={},r._currentAnim=null,r._currentAnimTime=0,r._totalAnimTime=0,r._timeScale=1,r._animFinished=!1,r._animLoopCount=0,r._animPaused=!1,r._atlasKey=null,r._forceVisualSort=!1,r._data=n,r._atlasKey=i,r._spritesTable=new l.DSDSpritesTable(n.sprites),r._root=r.buildNodeTree(n.tree.root),r._anims=r.createAnims(n.anims),r.reset(),r}return o(e,t),Object.defineProperty(e.prototype,"entityName",{get:function(){return this._data.entity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentAnimName",{get:function(){return this._currentAnim.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._currentAnimTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"totalTime",{get:function(){return this._totalAnimTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeScale",{get:function(){return this._timeScale},set:function(t){this._timeScale=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._animPaused},set:function(t){this._animPaused=t},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this._root.reset(),this._root.updateHierarchy(null),this._forceVisualSort=!0,this.updateVisualNodes()},e.prototype.buildNodeTree=function(t){var e,n,i=this._data.tree.nodes[t],o=new a.DSDNode(t,i,this);if(o.hasSprite){var s=this.game.add.sprite(0,0,this._atlasKey,0,this);o.attachedObj=s,this._visualNodes.push(o)}if(i.nodes)try{for(var l=r(i.nodes),h=l.next();!h.done;h=l.next()){var u=h.value,c=this.buildNodeTree(u);o.addNode(c)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}return this._nodesDict[t]=o,this._nodes.push(o),o},e.prototype.createAnims=function(t){var e={};for(var n in t){var i=t[n];e[n]=new s.DSDAnim(i,this._nodesDict,this)}return e},e.prototype.getNodeByName=function(t){var e,n,i=null;try{for(var o=r(this._nodes),s=o.next();!s.done;s=o.next()){var a=s.value;if(a.name===t){i=a;break}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return i},e.prototype.attachToNode=function(t,e,n){var i=this.getNodeByName(e);i.attachedObj=t,i.z=n,this._visualNodes.push(i),this.add(t),this._forceVisualSort=!0},e.prototype.detachFromNode=function(t){var e=this.getNodeByName(t),n=e.attachedObj;e.attachedObj=null;var i=this._visualNodes.indexOf(e);return i<0?null:(this._visualNodes.splice(i,1),this.remove(n),this._forceVisualSort=!0,n)},e.prototype.sortVisualNodes=function(){var t,e;try{for(var n=r(this._visualNodes),i=n.next();!i.done;i=n.next()){var o=i.value;o.attachedObj.z=o.z}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.sort()},e.prototype.play=function(t){this.setAnim(t,!1)},e.prototype.setAnim=function(t,e){void 0===e&&(e=!0);var n=this._anims[t];if(void 0===n)throw new Error("Animation with nam "+t+" doesn't exist.");this.reset(),n.reset(),this._animFinished=!1,this._animLoopCount=0,this._currentAnim=n,this._currentAnimTime=0,this._totalAnimTime=0,this._animPaused=e,this._currentAnim.update(0),this.refresh()},e.prototype.updateAnim=function(){if(this._currentAnim&&!this._animFinished&&!this._animPaused){var t=Math.min(.1,this.game.time.delta/1e3);t*=this._timeScale,this._currentAnim.update(t),this.refresh(),this.updateTime(t)}},e.prototype.updateTime=function(t){this._currentAnimTime+=t,this._totalAnimTime+=t,this._currentAnimTime>=this._currentAnim.length&&(this._currentAnim.isLooping?(this._currentAnimTime-=this._currentAnim.length,++this._animLoopCount,this.onLoop.dispatch(this,this._animLoopCount)):(this._currentAnimTime=this._currentAnim.length,this._totalAnimTime=this._currentAnimTime,this._animFinished=!0,this.onFinished.dispatch(this)))},e.prototype.refresh=function(){this._root.updateHierarchy(null),this.updateVisualNodes()},e.prototype.updateVisualNodes=function(){this._forceVisualSort&&(this.sortVisualNodes(),this._forceVisualSort=!1);for(var t=0;t<this._visualNodes.length;t++){var e=this._visualNodes[t];e.updateAttachedObj(),e.hasSprite&&e.updateSprite(this._spritesTable)}},e.prototype.onZChange=function(t){this._forceVisualSort=!0},e.prototype.onKey=function(t){this.onEvent.dispatch(this,t.t,t.v)},e}(Phaser.Group);e.DSDEntity=h},4843:function(t,e){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.DSDNode=void 0;var i=function(){function t(t,e,n){this._id=-1,this._nodeDef=null,this._local={x:0,y:0,angle:0,sx:1,sy:1,alpha:1},this._world={x:0,y:0,angle:0,sx:1,sy:1,alpha:1},this._worldVisible=!0,this._frame=null,this._z=0,this._visible=!0,this._attchedObj=null,this._nodes=null,this._zChangeListener=null,this._id=t,this._nodeDef=e,this._zChangeListener=n}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._nodeDef.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){t!==this._z&&(this._z=t,this._zChangeListener.onZChange(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"world",{get:function(){return this._world},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSprite",{get:function(){return null!==this._nodeDef.sprite},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"attachedObj",{get:function(){return this._attchedObj},set:function(t){null!==t&&this._attchedObj,this._attchedObj=t},enumerable:!1,configurable:!0}),t.prototype.reset=function(){var t,e,i=this._local,o=this._nodeDef.transform;i.x=o.x,i.y=o.y,i.angle=o.angle,i.sx=o.sx,i.sy=o.sy,i.alpha=o.alpha;var r=this._nodeDef.sprite;if(null!==r&&(this._frame=r.frame,this._z=r.z,this._visible=r.visible),this._nodes)try{for(var s=n(this._nodes),a=s.next();!a.done;a=s.next()){a.value.reset()}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}},t.prototype.addNode=function(t){null===this._nodes&&(this._nodes=[]),this._nodes.push(t)},t.prototype.updatePropertyFloat=function(t,e){switch(t){case 1:this._local.x=e;break;case 2:this._local.y=e;break;case 5:this._local.angle=e;break;case 3:this._local.sx=e;break;case 4:this._local.sy=e;break;case 6:this._local.alpha=e;break;case 8:e!==this._z&&(this._z=e,null!==this._zChangeListener&&this._zChangeListener.onZChange(this));break;case 9:this._visible=1===e}},t.prototype.updatePropertyRef=function(t,e){switch(t){case 7:this._frame=e}},t.prototype.updateHierarchy=function(t){var e,i,o=t?t.world:null,r=this._world,s=this._local;if(o){if(r.angle=s.angle*Phaser.Math.sign(o.sx)*Phaser.Math.sign(o.sy),r.angle+=o.angle,r.sx=s.sx*o.sx,r.sy=s.sy*o.sy,r.x=s.x*o.sx,r.y=s.y*o.sy,0!==r.x||0!==r.y){var a=o.angle*(Math.PI/180),l=Math.cos(a),h=Math.sin(a),u=r.x,c=r.y;r.x=u*l-c*h,r.y=u*h+c*l}r.x+=o.x,r.y+=o.y,r.alpha=s.alpha*o.alpha,this._worldVisible=t.visible&&this._visible}else r.x=s.x,r.y=s.y,r.angle=s.angle,r.sx=s.sx,r.sy=s.sy,r.alpha=s.alpha,this._worldVisible=this._visible;if(this._nodes)try{for(var p=n(this._nodes),_=p.next();!_.done;_=p.next()){_.value.updateHierarchy(this)}}catch(t){e={error:t}}finally{try{_&&!_.done&&(i=p.return)&&i.call(p)}finally{if(e)throw e.error}}},t.prototype.updateAttachedObj=function(){var t=this._world,e=this._attchedObj;e.position.set(t.x,t.y),e.scale.set(t.sx,t.sy),e.angle=t.angle,e.alpha=t.alpha,e.visible=this._worldVisible},t.prototype.updateSprite=function(t){var e=this._attchedObj;if(e.visible=null!==this._frame,this._frame){var n=t.getEntry(this._frame);e.frameName=n.frame;var i=n.pivot;e.anchor.set(i.x,i.y)}},t}();e.DSDNode=i},6824:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DSDSpritesTable=void 0;var n=function(){function t(t){this._sprites=null,this._sprites=t}return t.prototype.getEntry=function(t){return this._sprites[t]},t}();e.DSDSpritesTable=n},3732:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.DSDTimeline=void 0;var r=n(3415),s=n(5842),a=function(t){function e(e,n,i){var o=t.call(this,e,n,i)||this;return o._property=0,o._currentKey=null,o._currentKeyTime=0,o._nextKey=null,o._nextKeyTime=0,o._checkFirstKey=!1,o._canUpdate=!1,e.property&&(o._property=s.DSDUtils.propertyNameToEnum(e.property)),o}return o(e,t),Object.defineProperty(e.prototype,"property",{get:function(){return this._property},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRef",{get:function(){return this._timeline.ref},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.setTime(0)},e.prototype.setTime=function(t){this._time=t,this._keyIdx=-1;for(var e=this._keys.length-1;e>=0;e--)if(this._keys[e].t<=t){this._keyIdx=e;break}this.setKeys(this._keyIdx),this._checkFirstKey=!0,this._canUpdate=!0},e.prototype.setKeys=function(t){this._currentKey=this.getKey(t),this._currentKeyTime=this.getKeyTime(this._currentKey,t),this._nextKey=this.getKey(t+1),this._nextKeyTime=this.getKeyTime(this._nextKey,t+1)},e.prototype.getKey=function(t){var e=this._keys.length;return t>=e?t%=e:t<0&&(t=(t%e+e)%e),this._keys[t]},e.prototype.getKeyTime=function(t,e){var n=0;return(e>=this._keys.length||e<0)&&(n=Math.floor(e/this._keys.length)*this._duration),t.t+n},e.prototype.step=function(t){if(0!==t&&this._checkFirstKey&&(this._checkFirstKey=!1,this._time===this._currentKeyTime&&this.onKeyPassed(this._currentKey)),this._time+=t,!this._isLooping&&this._time>this._duration&&(this._time=this._duration),this._canUpdate){for(;this._time>=this._nextKeyTime;)if(this.onKeyPassed(this._nextKey),++this._keyIdx,this.setKeys(this._keyIdx),!this._isLooping&&this._keyIdx===this._keys.length-1){this._canUpdate=!1;break}this._keyIdx>=this._keys.length&&(this._time-=this._duration,this._keyIdx-=this._keys.length,this.setKeys(this._keyIdx))}},e.prototype.onKeyPassed=function(t){this.listener&&this.listener.onKey(t)},Object.defineProperty(e.prototype,"valueFloat",{get:function(){var t=this._currentKey,e=this._nextKey;return t===e||this._currentKeyTime===this._nextKeyTime||3===t.rm?t.v:2===t.rm&&2===e.lm?this.evaluateLinear(this._time,this._currentKeyTime,this._nextKeyTime,t.v,e.v):this.evaluateHermite(this._time,this._currentKeyTime,this._nextKeyTime,t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valueRef",{get:function(){return this._currentKey.r},enumerable:!1,configurable:!0}),e.prototype.evaluateLinear=function(t,e,n,i,o){return t=(t-e)/(n-e),Phaser.Math.linear(i,o,t)},e.prototype.evaluateHermite=function(t,e,n,i,o){t=(t-e)/(n-e);var r=n-e,s=i.rt*r,a=o.lt*r,l=t*t,h=l*t,u=h-2*l+t,c=h-l,p=-2*h+3*l;return(2*h-3*l+1)*i.v+u*s+c*a+p*o.v},e}(r.DSDTimelineAbstract);e.DSDTimeline=a},3415:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DSDTimelineAbstract=void 0;var n=function(){function t(t,e,n){this._timeline=null,this._keys=null,this._duration=0,this._isLooping=!1,this._time=0,this._keyIdx=0,this._listener=null,this._timeline=t,this._keys=t.keys,this._duration=e,this._isLooping=n}return Object.defineProperty(t.prototype,"listener",{get:function(){return this._listener},set:function(t){this._listener=t},enumerable:!1,configurable:!0}),t}();e.DSDTimelineAbstract=n},5842:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DSDUtils=void 0;var n=function(){function t(){}return t.propertyNameToEnum=function(e){var n=t.PROP_TO_ENUM[e];if(void 0===n)throw new Error("Property "+e+" missing in property to enum table.");return n},t.PROP_TO_ENUM={x:1,y:2,sx:3,sy:4,angle:5,alpha:6,sprite:7,z:8,visible:9},t}();e.DSDUtils=n},2942:function(t,e){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.DialogAbstract=void 0;var o=function(t){function e(e){var n=t.call(this,e)||this;return n.onShown=new Phaser.Signal,n.onHidden=new Phaser.Signal,n._container=null,n._containerScale=0,n._ignoreContainerScale=!1,n._containerAlpha=0,n._ignoreContainerAlpha=!1,n._hideSourceName=null,n._container=new Phaser.Group(e,n,"DialogContainer"),n.active=!1,n}return i(e,t),Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerX",{get:function(){return this._container.x},set:function(t){this._container.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerY",{get:function(){return this._container.y},set:function(t){this._container.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerScale",{get:function(){return this._containerScale},set:function(t){this._containerScale=t,this._ignoreContainerScale||this._container.scale.set(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerAlpha",{get:function(){return this._containerAlpha},set:function(t){this._containerAlpha=t,this._ignoreContainerAlpha||(this._container.alpha=Math.min(t,1))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ignoreContainerAlpha",{get:function(){return this._ignoreContainerAlpha},set:function(t){this._ignoreContainerAlpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ignoreContainerScale",{get:function(){return this._ignoreContainerScale},set:function(t){this._ignoreContainerScale=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"active",{set:function(t){this.exists=t,this.visible=t},enumerable:!1,configurable:!0}),e.prototype.onShownComplete=function(){this.enableInput(!0),this.onShown.dispatch()},e.prototype.onHideComplete=function(){this.active=!1;var t=this._hideSourceName;this._hideSourceName=null,this.onHidden.dispatch(t)},e.prototype.show=function(t){void 0===t&&(t=!0),this.onResize(this.game.width,this.game.height),this.showPreInit(),this.enableInput(!1),this.active=!0,t?this.animateShow():this.showNoAnim()},e.prototype.hide=function(t){void 0===t&&(t=null),this._hideSourceName=t,this.enableInput(!1),this.animateHide()},e.prototype.updateDialog=function(){},e}(Phaser.Group);e.DialogAbstract=o},488:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.DialogBase=void 0;var r=n(5357),s=n(1391),a=n(1752),l=n(5302),h=n(6223),u=function(t){function e(e,n){var i=t.call(this,e)||this;return i.onElement=new Phaser.Signal,i._priority=0,i._width=0,i._height=0,i._blocker=null,i._bg=null,i._trees=null,i._btnClose=null,i._title=null,i._tweenInPosition=null,i._tweenInAlpha=null,i._tweenOutPosition=null,i._tweenOutAlpha=null,i._blockerAlpha=0,i._ignoreBlockerAlpha=!1,i._priority=n,i}return o(e,t),Object.defineProperty(e.prototype,"priority",{get:function(){return this._priority},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blocker",{get:function(){return this._blocker},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blockerAlpha",{get:function(){return this._blockerAlpha},set:function(t){this._blockerAlpha=t,this._ignoreBlockerAlpha||(this._blocker.alpha=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ignoreBlockerAlpha",{get:function(){return this._ignoreBlockerAlpha},set:function(t){this._ignoreBlockerAlpha=t},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){this.createBlocker(),this.createElements(),this.createAnimation()},e.prototype.createBlocker=function(){var t=this.game.add.sprite(0,0,r.Config.ATLAS_COMMON,"blockWhite",this);t.anchor.set(.5),t.width=this.game.width,t.height=this.game.height,t.tint=0,t.inputEnabled=!0,t.input.priorityID=this.priority,this.sendToBack(t),this._blocker=t,this.blockerAlpha=0},e.prototype.createAnimation=function(){this.createTweens()},e.prototype.createBg=function(t){void 0===t&&(t=550);var e=new Phaser.Sprite(this.game,0,0,r.Config.ATLAS_UI,"dialogBg");this._width=e.width=550,this._height=e.height,e.anchor.set(.5),this.container.add(e),this._bg=e},e.prototype.createTrees=function(){var t=new h.UITreesGroup(this.game,this.container,s.Defs.TREES_DIALOG,0,0,null);this._trees=t},e.prototype.createButton=function(t,e,n){void 0===n&&(n=null);var i=l.UIElementsFactory.createBallButton(t,e);return i.onClick.add(this.onButtonClicked,this),n||(n=this.container),n.add(i),i},e.prototype.createCloseButton=function(){this._btnClose=this.createButton("Close","buttonNo")},e.prototype.createSmallToggle=function(t,e,n,i){void 0===i&&(i=null);var o=l.UIElementsFactory.createSmallToggle(t,e,n,!1,!0);return o.onClick.add(this.onButtonClicked,this),i||(i=this.container),i.add(o),o},e.prototype.createTitle=function(t){this._title=l.UIElementsFactory.createTitle(t),this.container.add(this._title)},e.prototype.createTweens=function(){var t=this.game;this._tweenInPosition=t.add.tween(this).to({containerScale:1,containerAlpha:1},e.TWEEN_DURATION,a.pop5,!1,0),this._tweenInPosition.onComplete.add(this.onShownComplete,this),this._tweenInAlpha=t.add.tween(this).to({blockerAlpha:.9},e.TWEEN_DURATION+0,Phaser.Easing.Cubic.Out,!1),this._tweenOutPosition=t.add.tween(this).to({containerScale:.85,containerAlpha:0},e.TWEEN_DURATION,a.pop5rev,!1,100),this._tweenOutAlpha=t.add.tween(this).to({blockerAlpha:0},e.TWEEN_DURATION,Phaser.Easing.Linear.None,!1,300),this._tweenOutAlpha.onComplete.add(this.onHideComplete,this)},e.prototype.enableInput=function(t){this._btnClose&&(this._btnClose.setEnabled(t),this._btnClose.button.input.priorityID=this.priority+1)},e.prototype.onResize=function(t,n){this._blocker&&(this._blocker.width=t+10,this._blocker.height=n+10);var i=this._height/2;this._trees&&(this._trees.y=-i-20),this._title&&this._title.position.set(0,-i+e.TITLE_OFFSET_Y),this._btnClose&&this._btnClose.position.set(0,i-e.BOTTOM_OFFSET_Y)},e.prototype.showPreInit=function(){this.container.x=0,this.container.scale.set(this.ignoreContainerScale?1:.75),this.container.alpha=this.ignoreContainerAlpha?1:0},e.prototype.showNoAnim=function(){this.container.scale.set(1,1),this.containerAlpha=1,this.blockerAlpha=.9,this.onShownComplete()},e.prototype.animateShow=function(){this._tweenInPosition.resume(),this._tweenInPosition.start(),this._tweenInAlpha.resume(),this._tweenInAlpha.start()},e.prototype.animateHide=function(){this._tweenOutPosition.resume(),this._tweenOutPosition.start(),this._tweenOutAlpha.resume(),this._tweenOutAlpha.start()},e.prototype.onButtonClicked=function(t){this.onElement.dispatch(t.name,t)},e.TWEEN_DURATION=200,e.BORDER_HORIZONTAL=20,e.TITLE_OFFSET_Y=92,e.BOTTOM_OFFSET_Y=18,e}(n(2942).DialogAbstract);e.DialogBase=u},3826:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.DialogCredits=void 0;var r=n(2178),s=n(488),a=n(5302),l=n(1391),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._textLeft=null,e._textRight=null,e._textCopyright=null,e}return o(e,t),e.create=function(){var t=new e(r.App.game,5);return t.initialize(),t},e.prototype.createElements=function(){var t;this.ignoreBlockerAlpha=!0,this.ignoreContainerScale=!0,this.createCloseButton(),this.createTitle("TXT_DLG_CREDITS_TITLE"),(t=a.UIElementsFactory.createText("TXT_DLG_CREDITS_TEXT_LEFT")).anchor.set(0,0),t.align="left",t.tint=l.Defs.COLOR_DIALOG_TEXT_YELLOW,this.container.add(t),this._textLeft=t,(t=a.UIElementsFactory.createText("TXT_DLG_CREDITS_TEXT_RIGHT")).anchor.set(0,0),t.align="left",this.container.add(t),this._textRight=t,t=a.UIElementsFactory.createText("TXT_DLG_CREDITS_TEXT_COPYRIGHT",this._width-2*s.DialogBase.BORDER_HORIZONTAL),this.container.add(t),this._textCopyright=t},e.prototype.onLanguageChange=function(){this._title.textID="TXT_DLG_CREDITS_TITLE",this._textLeft.textID="TXT_DLG_CREDITS_TEXT_LEFT",this._textRight.textID="TXT_DLG_CREDITS_TEXT_RIGHT",this._textCopyright.textID="TXT_DLG_CREDITS_TEXT_COPYRIGHT"},e.prototype.onResize=function(e,n){t.prototype.onResize.call(this,e,n),this._title.y=-250,this._btnClose.y=260;var i=this._title.y+140,o=i+220,r=this._textLeft.textWidth,s=-(r+20+this._textRight.textWidth)/2;this._textLeft.position.set(s,i),s+=r+20,this._textRight.position.set(s,i),this._textCopyright.position.set(0,o)},e}(s.DialogBase);e.DialogCredits=h},4406:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.DialogGameOver=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(7751),h=n(1752),u=n(6020),c=n(7389),p=n(488),_=n(4770),f=n(7493),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onButtonsShown=new Phaser.Signal,e._anim=null,e._buttons=null,e._score=null,e._win=!1,e._levelID=-1,e._newStar=!1,e}return o(e,t),e.create=function(){var t=new e(r.App.game,5);return t.initialize(),t},e.prototype.createElements=function(){if(this._anim=new _.GameOverAnim(this.game),this._anim.onFinished.add(this.handleAnimFinished,this),this.container.add(this._anim),this._buttons=new f.MenuReplayContinuePanel(this.game,this.container),this._buttons.onButton.add(this.onButtonClicked,this),this._buttons.visible=!1,s.Config.SCORE_SYSTEM){var t=new Phaser.BitmapText(this.game,0,0,s.Config.FONT_SCORE_GAME,a.Defs.EMPTY_TEXT,s.Config.FONT_SCORE_WIN_SIZE,"center");t.anchor.set(.5,.5),t.visible=!1,this.add(t),this._score=t}},e.prototype.enableInput=function(t){this._buttons.visible&&this._buttons.enableInput(t,this.priority+1)},e.prototype.onResize=function(e,n){t.prototype.onResize.call(this,e,n),this._anim.y=-60,this._buttons.onResize(),this._buttons.position.set(0,280),this._score&&this._score.position.set(0,-340)},e.prototype.showPreInit=function(){t.prototype.showPreInit.call(this),this.checkDialogIsInitialized()},e.prototype.onShownComplete=function(){this.onShown.dispatch(),this._anim.start(this._win?0:1,this._newStar)},e.prototype.hide=function(t){void 0===t&&(t=null),this._hideSourceName=t,this.enableInput(!1),this._anim.end()},e.prototype.onHideComplete=function(){this.resetDialogInitialization();var t=this._hideSourceName;this._hideSourceName=null,this.onHidden.dispatch(t)},e.prototype.init=function(t,n,i,o,r){this._win=t,this._levelID=n,this._newStar=i,t?(this.blocker.tint=e.BLOCKER_TINT_WIN,this._buttons.step=150,this._buttons.showButtons(!0,!0,!0),this.initScore(o,r)):(this.blocker.tint=e.BLOCKER_TINT_LOSE,this._buttons.step=200,this._buttons.showButtons(!0,!0,!1))},e.prototype.initScore=function(t,e){s.Config.SCORE_SYSTEM&&(this._score.text=a.Defs.SCORE_TEXT+t,this._score.visible=!0,this._score.tint=e?16776960:16777215,e&&this.game.time.events.add(1500,this.bestScoreEffect,this))},e.prototype.bestScoreEffect=function(){this.game.add.tween(this._score.scale).to({x:1.3,y:1.3},600,h.halfSin,!0);var t=l.ParticleDefs.PARAMS[5].area,e=this._score.textWidth;t.x=-e/2,t.width=e;var n=c.Emitters.instance.oneTime(0,this._score,5);n.emitAt(0,0),n.explode(100),u.AudioUtils.playAudioRecord(a.Defs.SFX_PWR_UPGRADE)},e.prototype.checkDialogIsInitialized=function(){if(-1===this._levelID)throw new Error("Dialog not initialized for specific level. Call init() first before show().")},e.prototype.resetDialogInitialization=function(){this._levelID=-1,this._newStar=!1},e.prototype.handleAnimFinished=function(t){t?(this._buttons.visible=!0,this.onButtonsShown.dispatch(),this.enableInput(!0)):(this._buttons.visible=!1,this.onHideComplete())},e.prototype.updateDialog=function(){this._anim.visible&&(this._anim.updateAnim(),c.Emitters.instance.update())},e.BLOCKER_TINT_WIN=1561,e.BLOCKER_TINT_LOSE=2031616,e}(p.DialogBase);e.DialogGameOver=d},7864:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.DialogLanguages=void 0;var s=n(2178),a=n(5357),l=n(1391),h=n(5302),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._flagsGroup=null,e._btnsFlag=[],e._langSelection=null,e._flagCols=0,e._flagRows=0,e._flagWidth=0,e._flagHeight=0,e._helpRect=new Phaser.Rectangle,e}return o(e,t),e.create=function(){var t=new e(s.App.game,5);return t.initialize(),t.calculateGrid(),t},e.prototype.calculateGrid=function(){var t=this.game.cache.getFrameByName(a.Config.ATLAS_UI,"en");this._flagWidth=t.sourceSizeW+3*e.PADDING,this._flagHeight=t.sourceSizeH+3*e.PADDING;var n=this._helpRect;if(n.setTo(0,0,600,0),this.calculateGridDimensions(n,1),this._flagCols=n.x,this._flagRows=n.y,n.height>0&&n.height>350){for(var i=350/n.height,o=i,r=0;r<=10;r++){var s=Phaser.Math.linear(i,1,r/10);n.setTo(0,0,600,0),this.calculateGridDimensions(n,s),n.height<=350&&s>o&&(o=s,this._flagCols=n.x,this._flagRows=n.y)}this._flagsGroup.scale.set(o)}},e.prototype.calculateGridDimensions=function(t,n){var i=a.Config.supportedLanguages.length,o=t.width/n;return t.x=Math.floor((o+2*e.PADDING)/this._flagWidth),t.y=Math.ceil(i/t.x),t.x=Math.min(t.x,Math.ceil(i/t.y)),t.height=(t.y*this._flagHeight-2*e.PADDING)*n,t},e.prototype.createElements=function(){this.ignoreBlockerAlpha=!0,this.ignoreContainerScale=!0,this.createCloseButton(),this.createTitle("TXT_DLG_LANGUAGES_TITLE"),this.createFlags(),this.createSelection(),this.toggleLanguage(s.App.settings.currentLanguage)},e.prototype.createFlags=function(){this._flagsGroup=new Phaser.Group(this.game,this.container);for(var t=0;t<a.Config.supportedLanguages.length;t++){var e=a.Config.supportedLanguages[t],n=this.createFlagToggle(e,e,this._flagsGroup);this._btnsFlag.push(n)}},e.prototype.createFlagToggle=function(t,e,n){void 0===n&&(n=null);var i=h.UIElementsFactory.createFlagToggle(t,e);return i.onDown.add(this.onButtonClicked,this),n||(n=this.container),n.add(i),i},e.prototype.createSelection=function(){this._langSelection=this.game.add.sprite(0,0,a.Config.ATLAS_UI,l.Defs.FRAME_LANG_SELECTED,this._flagsGroup),this._langSelection.anchor.set(.5)},e.prototype.toggleLanguage=function(t){var e,n;try{for(var i=r(this._btnsFlag),o=i.next();!o.done;o=i.next()){var s=o.value;s.toggled=s.name===t}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}this.positionSelection()},e.prototype.positionSelection=function(){var t,e;try{for(var n=r(this._btnsFlag),i=n.next();!i.done;i=n.next()){var o=i.value;if(o.toggled)return void this._langSelection.position.copyFrom(o.position)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.enableInput=function(e){t.prototype.enableInput.call(this,e);for(var n=0;n<this._btnsFlag.length;n++){var i=this._btnsFlag[n];i.setEnabled(e),i.button.input.priorityID=this.priority+1}},e.prototype.onResize=function(e,n){t.prototype.onResize.call(this,e,n),this._title.y=-250,this._btnClose.y=260,this.positionFlags(),this.positionSelection(),this._flagsGroup.position.set(0,25)},e.prototype.positionFlags=function(){for(var t=this._btnsFlag.length,e=0,n=-(this._flagRows-1)*this._flagHeight/2-20,i=0;i<this._flagRows;i++){for(var o=-(Math.min(t-e,this._flagCols)-1)*this._flagWidth/2,r=0;r<this._flagCols&&e<t;r++,e++)this._btnsFlag[e].position.set(o,n),o+=this._flagWidth;if(e===t)break;n+=this._flagHeight}},e.prototype.showPreInit=function(){this._title.textID="TXT_DLG_LANGUAGES_TITLE",t.prototype.showPreInit.call(this)},e.prototype.onLanguageChanged=function(){this._title.textID="TXT_DLG_LANGUAGES_TITLE"},e.prototype.onButtonClicked=function(e){e!==this._btnClose&&this.toggleLanguage(e.name),t.prototype.onButtonClicked.call(this,e)},e.PADDING=20,e}(n(488).DialogBase);e.DialogLanguages=u},5242:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.DialogPause=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(488),h=n(7493),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._icon=null,e._tglSound=null,e._tglMusic=null,e._buttons=null,e}return o(e,t),e.create=function(){var t=new e(r.App.game,5);return t.initialize(),t},e.prototype.createElements=function(){this._icon=this.game.add.sprite(0,0,s.Config.ATLAS_UI,"iconPause",this.container),this._icon.anchor.set(.5),this._tglSound=this.createSmallToggle(a.Defs.DLG_ID_SOUND,"buttonSoundBig","buttonSoundBigOff"),this._tglMusic=this.createSmallToggle(a.Defs.DLG_ID_MUSIC,"buttonMusicBig","buttonMusicBigOff"),this._buttons=new h.MenuReplayContinuePanel(this.game,this.container),this._buttons.onButton.add(this.onButtonClicked,this)},e.prototype.enableInput=function(t){this._tglSound.setEnabled(t),this._tglSound.button.input.priorityID=this.priority+1,this._tglMusic.setEnabled(t),this._tglMusic.button.input.priorityID=this.priority+1,this._buttons.enableInput(t,this.priority+1)},e.prototype.onResize=function(e,n){t.prototype.onResize.call(this,e,n),this._icon.position.set(0,-250);this._tglSound.position.set(-100,0),this._tglMusic.position.set(100,0),this._buttons.onResize(),this._buttons.position.set(0,250)},e.prototype.showPreInit=function(){t.prototype.showPreInit.call(this),this._tglSound.toggled=r.App.settings.soundOn,this._tglMusic.toggled=r.App.settings.musicOn},e}(l.DialogBase);e.DialogPause=u},4541:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.DialogStars=void 0;var r=n(2178),s=n(488),a=n(5302),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._text=null,e._btnYes=null,e._btnNo=null,e._showYesNo=!1,e}return o(e,t),e.create=function(){var t=new e(r.App.game,5);return t.initialize(),t},e.prototype.createElements=function(){this.createBg(),this.createTrees(),this.createTitle(null),this._text=a.UIElementsFactory.createText(null,this._width-2*s.DialogBase.BORDER_HORIZONTAL),this.container.add(this._text),this._btnYes=this.createButton("Yes","buttonYes"),this._btnNo=this.createButton("No","buttonNo")},e.prototype.enableInput=function(t){this._btnYes.setEnabled(t&&this._showYesNo),this._btnYes.button.input.priorityID=this.priority+1,this._btnNo.setEnabled(t),this._btnNo.button.input.priorityID=this.priority+1},e.prototype.onResize=function(e,n){t.prototype.onResize.call(this,e,n);var i=this._height/2;this._text.position.set(0,20);var o=this._showYesNo?80:0,r=i-s.DialogBase.BOTTOM_OFFSET_Y;this._btnNo.position.set(-o,r),this._btnYes.position.set(o,r)},e.prototype.setup=function(t,e,n,i){this._title.textID=t,this._text.setFormattedTextID(e,n),this._btnYes.exists=this._btnYes.visible=i,this._showYesNo=i},e}(s.DialogBase);e.DialogStars=l},4770:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.GameOverAnim=void 0;var r=n(5357),s=n(1391),a=n(713),l=n(6020),h=n(4525),u=n(5327),c=function(t){function e(n){var i=t.call(this,n)||this;return i.onFinished=new Phaser.Signal,i._entity=null,i._star=null,i._starGroup=null,i._winStar=null,i._start=!1,i._newStar=!1,i._entity=new h.DSDEntity(i.game,s.Defs.ANIM_GAME_OVER,r.Config.ATLAS_GAMEOVER,i),i._entity.onFinished.add(i.handleFinished,i),i._entity.onEvent.add(i.handleEvent,i),i._entity.visible=!1,i._starGroup=new Phaser.Group(n,null),i._star=n.add.sprite(0,0,r.Config.ATLAS_GAMEOVER,0,i._starGroup),i._star.anchor.set(.5),i._entity.attachToNode(i._starGroup,e.BACK_STAR_ATTACH_NODE,-2),i}return o(e,t),Object.defineProperty(e.prototype,"winStar",{get:function(){return this._winStar},enumerable:!1,configurable:!0}),e.prototype.start=function(t,n){void 0===n&&(n=!1),this._start=!0,this._type=t,this._newStar=n,0===t?(this._winStar||(this._winStar=new u.WinStar(this.game,null),this._winStar.onFinished.add(this.handleWinStarFinished,this),this._entity.attachToNode(this._winStar,e.WIN_STAR_ATTACH_NODE,5)),this._winStar.starVisible(!n),l.AudioUtils.playAudioRecord(s.Defs.SFX_WIN)):l.AudioUtils.playAudioRecord(s.Defs.SFX_LOSE),this._star.frameName=e.STAR_FRAME_NAME[t],this._entity.visible=!0;var i=this.getAnimName(!1);this._entity.play(i)},e.prototype.end=function(){this._start=!1;var t=this.getAnimName(!0);this._entity.play(t)},e.prototype.getAnimName=function(t){return e.ANIM_NAMES[this._type][t?1:0]},e.prototype.handleFinished=function(t){if(this._start){if(this._newStar)return void this._winStar.playStarAnim()}else this._entity.visible=!1;this.onFinished.dispatch(this._start)},e.prototype.handleEvent=function(t,e,n){0===this._type?l.AudioUtils.playAudioRecord(s.Defs.SFX_WHEEL_SHAKE):0===n?(l.AudioUtils.playAudioRecord(s.Defs.SFX_TOOL_DROP1),l.AudioUtils.playAudioRecord(s.Defs.SFX_TOOL_DROP1)):1===n?(l.AudioUtils.playAudioRecord(s.Defs.SFX_TOOL_DROP2),l.AudioUtils.playAudioRecord(s.Defs.SFX_TOOL_DROP2)):l.AudioUtils.playAudioRecord(s.Defs.SFX_WHEEL_DROP)},e.prototype.handleWinStarFinished=function(){this.onFinished.dispatch(this._start)},e.prototype.updateAnim=function(){var t=this.game.time.delta/1e3;this._entity.visible&&(this._star.angle=a.MathHelp.modulo(this._star.angle-15*t,360)),this._entity.updateAnim(),this._winStar&&this._winStar.visible&&this._winStar.updateAnim()},e.ANIM_NAMES=[["WinStart","WinEnd"],["LoseStart","LoseEnd"]],e.STAR_FRAME_NAME=["Win_back_star","Lose_back_star"],e.BACK_STAR_ATTACH_NODE="Win_back_star",e.WIN_STAR_ATTACH_NODE="Star",e}(Phaser.Group);e.GameOverAnim=c},7493:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.MenuReplayContinuePanel=void 0;var s=n(1391),a=n(5302),l=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.onButton=new Phaser.Signal,i._buttons=[],i._step=150,i.createButton(s.Defs.DLG_ID_MENU,"buttonMenu"),i.createButton(s.Defs.DLG_ID_REPLAY,"buttonReplay"),i.createButton(s.Defs.DLG_ID_CONTINUE,"buttonPlay"),i}return o(e,t),Object.defineProperty(e.prototype,"step",{get:function(){return this._step},set:function(t){this._step=t},enumerable:!1,configurable:!0}),e.prototype.createButton=function(t,e){var n=a.UIElementsFactory.createBallButton(t,e);n.onClick.add(this.onButtonClicked,this),this.add(n),this._buttons.push(n)},e.prototype.showButtons=function(t,e,n){this._buttons[0].visible=t,this._buttons[1].visible=e,this._buttons[2].visible=n,this.onResize()},e.prototype.onButtonClicked=function(t){this.onButton.dispatch(t)},e.prototype.enableInput=function(t,e){for(var n=0;n<this._buttons.length;n++){var i=this._buttons[n];i.visible&&(i.setEnabled(t),i.button.input.priorityID=e)}},e.prototype.onResize=function(){for(var t=this.getButtonsCount(),e=this._step,n=-(t-1)*e/2,i=0;i<this._buttons.length;i++)this._buttons[i].visible&&(this._buttons[i].position.set(n,0),n+=e)},e.prototype.getButtonsCount=function(){var t,e,n=0;try{for(var i=r(this._buttons),o=i.next();!o.done;o=i.next()){o.value.visible&&++n}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},e}(Phaser.Group);e.MenuReplayContinuePanel=l},5327:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WinStar=void 0;var r=n(5357),s=n(1391),a=n(6020),l=n(4525),h=function(t){function e(e,n){var i=t.call(this,e,n)||this;i.onFinished=new Phaser.Signal,i._star=null,i._starAnim=null;var o=e.add.sprite(0,0,r.Config.ATLAS_UI,"Star_big",i);o.anchor.set(.5),i._star=o,o.visible=!1;var a=new l.DSDEntity(i.game,s.Defs.ANIM_STAR,r.Config.ATLAS_UI,i);a.onFinished.add(i.onStarAnimFinished,i),i._starAnim=a,i._starAnim.visible=!1;i._star.scale.set(.75),i._starAnim.scale.set(.75);return i._star.y=10,i._starAnim.y=10,i}return o(e,t),e.prototype.starVisible=function(t){this._star.visible=t},e.prototype.playStarAnim=function(){this._starAnim.play("onComplete"),this._starAnim.visible=!0,a.AudioUtils.playAudioRecord(s.Defs.SFX_STAR)},e.prototype.onStarAnimFinished=function(t){t.visible=!1,this._star.visible=!0,this.onFinished.dispatch()},e.prototype.updateAnim=function(){this._starAnim.updateAnim()},e}(Phaser.Group);e.WinStar=h},6877:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EnvFX=void 0;var i=n(2178),o=function(){function t(e,n,o,r,s,a,l){void 0===a&&(a=0),void 0===l&&(l=1),this._layer=null,this._scale=1,this._randomPt=new Phaser.Point,this._scale=e.alpha,this._layer=n,this._emitterType=o,this._params=r,this._amount=l,this._position=new Phaser.Point(e.x,e.y),this._radius=t.DEFAULT_RADIUS/2*e.sx,this._delay=this.calculateDelay(s,e),this._randomDelayPercent=a,this._next=i.App.game.time.time+Math.floor(Math.random()*this._delay)}return t.prototype.calculateDelay=function(t,e){return t*(1/(e.sx*e.sx))*(1/(0===e.angle?1:e.angle))},t.prototype.update=function(t){t<this._next||(this._next=t+this._delay*(1+this._randomDelayPercent*Math.random()),this.emit())},t.prototype.randomPoint=function(){var t=2*Math.PI*Math.random(),e=Math.random()+Math.random(),n=(e>1?2-e:e)*this._radius;return this._randomPt.set(this._position.x+n*Math.cos(t),this._position.y+n*Math.sin(t)),this._randomPt},t.prototype.setParticleScale=function(t){var e=t.visual,n=e.scale.x*this._scale;e.scale.set(n,n)},t.DEFAULT_RADIUS=100,t}();e.EnvFX=o},7609:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.EnvFXDust=void 0;var r=n(7389),s=function(t){function e(e,n,i){var o=t.call(this,e,n,0,104,15e3,.5,3)||this;return o._cos=Math.cos(i),o._sin=Math.sin(i),o}return o(e,t),e.prototype.emit=function(){var t=r.Emitters.instance.oneTime(this._emitterType,this._layer,this._params);if(t)for(var e=0;e<this._amount;e++){var n=this.randomPoint();t.emitAt(n.x,n.y);for(var i=0;i<this._amount;i++){var o=t.emitParticle();if(o){var s=o.velocity,a=this._cos*s.x-this._sin*s.y,l=this._sin*s.x+this._cos*s.y;s.set(a,l),1!==this._scale&&this.setParticleScale(o)}}}},e}(n(6877).EnvFX);e.EnvFXDust=s},2987:function(t,e){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.EnvFXManager=void 0;var i=function(){function t(){this._fxs=[]}return t.prototype.addFX=function(t){this._fxs.push(t)},t.prototype.update=function(t){var e,i;try{for(var o=n(this._fxs),r=o.next();!r.done;r=o.next()){r.value.update(t)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}},t}();e.EnvFXManager=i},3784:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.EnvFXWater=void 0;var r=n(7389),s=function(t){function e(e,n){return t.call(this,e,n,1,103,5e3,.1)||this}return o(e,t),e.prototype.emit=function(){var t=r.Emitters.instance.oneTime(this._emitterType,this._layer,this._params);if(t)for(var e=0;e<this._amount;e++){var n=this.randomPoint();t.emitAt(n.x,n.y);var i=t.emitParticle();i&&1!==this._scale&&this.setParticleScale(i)}},e}(n(6877).EnvFX);e.EnvFXWater=s},2727:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.CannonQueue=void 0;var r=n(5357),s=n(1391),a=n(6037),l=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i._bg=null,i._icon=null,i._ballsPool=null,i._bg=i.createBg(),i._icon=i.createIcon(),i._ballsPool=i.createBallsPool(),i}return o(e,t),e.prototype.createBg=function(){var t=this.game.add.sprite(0,0,r.Config.ATLAS_HUD,s.Defs.FRAMES_HUD_QUEUE_BG,this);return t.anchor.set(1,.5),t},e.prototype.createIcon=function(){var t=this.game.add.sprite(-e.MARGIN/2,0,r.Config.ATLAS_HUD,s.Defs.FRAMES_HUD_QUEUE_ICON,this);return t.anchor.set(0,.5),t},e.prototype.createBallsPool=function(){var t=this.game,e=new a.UnorderedArrayPool(Phaser.Sprite,4,(function(){var e=new Phaser.Sprite(t,0,0,r.Config.ATLAS_HUD);return e.anchor.set(.5),e}));return e.canGrow=!0,e},e.prototype.updateQueue=function(t){var e=t.size;this.adjustCount(e),e>0&&this.adjustSprites(t)},e.prototype.adjustCount=function(t){for(var e=this._ballsPool.size,n=e-1;n>=t;n--){var i=this._ballsPool.at(n);this.remove(i),this._ballsPool.despawnAt(n)}for(n=e;n<t;n++){i=this._ballsPool.spawn();this.add(i)}},e.prototype.adjustSprites=function(t){for(var n=t.size,i=this.calculateStep(n),o=this._bg.x-e.MARGIN,r=0;r<n;r++,o-=i){var a=t.at(r)-s.Defs.BALL_SPECIAL,l=this._ballsPool.at(n-1-r);l.frameName=s.Defs.POWERUPS[a].queueFrame,l.position.set(o,0)}},e.prototype.calculateStep=function(t){if(1===t)return 0;var n=this._bg.width-2*e.MARGIN;return Math.min(n/(t-1),e.STEP_MAX)},e.MARGIN=8,e.STEP_MAX=32,e}(Phaser.Group);e.CannonQueue=l},7559:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.ElementLimit=void 0;var r=n(5357),s=n(1391),a=n(7751),l=n(7389),h=function(t){function e(e,n,i,o,r){void 0===r&&(r=0);var s=t.call(this,e,n)||this;return s._id=-1,s._value=0,s._limit=0,s._icon=null,s._barBg=null,s._bar1=null,s._barBgLeft=null,s._bar2=null,s._listener=null,s._id=i,s._limit=o,s.createIcon(),s.createBar(),s.addValue(0),s}return o(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldPos",{get:function(){return this._icon.world},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listener",{set:function(t){this._listener=t},enumerable:!1,configurable:!0}),e.prototype.createIcon=function(){var t=this.game.add.sprite(0,0,r.Config.ATLAS_HUD,s.Defs.POWERUPS[this._id].limitFrame,this);t.anchor.set(.5),this._icon=t},e.prototype.createBar=function(){var t=s.Defs.POWERUPS[this._id].limitBarFrame;this._barBg=this.barSprite(s.Defs.FRAME_HUD_LIMITS_BAR_BG),this._bar1=this.barSprite(t),this._barBgLeft=this.barSprite(s.Defs.FRAME_HUD_LIMITS_BAR_BG_LEFT),this._bar2=this.barSprite(t)},e.prototype.barSprite=function(t){var e=this.game.add.sprite(0,0,r.Config.ATLAS_HUD,t,this);return e.anchor.set(.5),e},e.prototype.addValue=function(t){this._value+=t,this._value>=this._limit&&(this._value-=this._limit,this.onLimitReached());var e=this._value/this._limit*360;this._bar1.angle=Math.min(e,180),this._bar2.angle=e,this._bar2.visible=this._bar2.exists=e>180},e.prototype.onLimitReached=function(){this.emitParticles(),this._listener&&this._listener.onLimitFull(this._id)},e.prototype.emitParticles=function(){var t=a.ParticleDefs.PTC_LIMIT_DROP[this._id],e=l.Emitters.instance.spawn(0,this.parent,t);e&&(e.emitAt(this.x,this.y),e.flow(100,2,10)),t=a.ParticleDefs.PTC_LIMIT_REACHED[this._id];var n=l.Emitters.instance.oneTime(0,this.parent,t);n.emitAt(this.x,this.y),n.explode(10)},e}(Phaser.Group);e.ElementLimit=h},2007:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.ElementLimitsPanel=void 0;var s=n(2178),a=n(5357),l=n(1391),h=n(7559),u=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.onLimit=new Phaser.Signal,i._limits=[],i._limitsCount=0,i.createLimits(),i.setLayout(),i}return o(e,t),Object.defineProperty(e.prototype,"panelWidth",{get:function(){return this._limitsCount*e.STEP},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"limitsCount",{get:function(){return this._limitsCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasSomeValue",{get:function(){var t,e;try{for(var n=r(this._limits),i=n.next();!i.done;i=n.next()){var o=i.value;if(o&&o.value>0)return o}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null},enumerable:!1,configurable:!0}),e.prototype.createLimits=function(){for(var t=s.App.settings.data.powerups,e=0;e<l.Defs.ELEMENT_POWERUP_IDS.length;e++){var n=l.Defs.ELEMENT_POWERUP_IDS[e],i=null;(t[n].level>0||(a.Config.DEBUG_ELEMENT_POWERUPS_MASK&1<<e)>0)&&((i=this.createLimit(n)).listener=this,++this._limitsCount),this._limits.push(i)}},e.prototype.createLimit=function(t){return new h.ElementLimit(this.game,this,t,a.Config.ELEMENT_LIMIT)},e.prototype.setLayout=function(){this.setLimitsLayout(24)},e.prototype.setLimitsLayout=function(t){for(var n=a.Config.LIMITS_DISPLAY_VERTICAL?0:e.STEP,i=a.Config.LIMITS_DISPLAY_VERTICAL?e.STEP:0,o=0,r=0;r<this._limits.length;r++)null!==this._limits[r]&&(this._limits[r].position.set(t,o),t+=n,o+=i)},e.prototype.addValue=function(t,e){var n=this._limits[t];null!==n&&n.addValue(e)},e.prototype.onLimitFull=function(t){this.onLimit.dispatch(t)},e.prototype.getLimit=function(t){var e,n;try{for(var i=r(this._limits),o=i.next();!o.done;o=i.next()){var s=o.value;if(s&&s.id===t)return s}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return null},e.STEP=48,e}(Phaser.Group);e.ElementLimitsPanel=u},5808:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.HUD=void 0;var r=n(5302),s=n(5357),a=n(2007),l=n(7122),h=n(2727),u=n(1391),c=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.onClick=new Phaser.Signal,i._btnPause=null,i._limitsPanel=null,i._starDustPanel=null,i._cannonQueue=null,i._score=null,i._btnPause=i.createPauseButton(),i.add(i._btnPause),i._limitsPanel=i.createLimitsPanel(),i._starDustPanel=i.createStarDustPanel(),s.Config.SCORE_SYSTEM&&(i._score=i.createScore(),i.add(i._score)),s.Config.DEBUG_CANNON_QUEUE&&(i._cannonQueue=i.createCannonQueue()),i}return o(e,t),Object.defineProperty(e.prototype,"limits",{get:function(){return this._limitsPanel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"starDust",{get:function(){return this._starDustPanel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"score",{set:function(t){this._score&&(this._score.text=u.Defs.SCORE_TEXT+t)},enumerable:!1,configurable:!0}),e.prototype.createPauseButton=function(){var t=r.UIElementsFactory.createSmallButton("Pause",s.Config.ATLAS_HUD,"buttonPause");return t.onClick.add(this.onButtonClick,this),t},e.prototype.createLimitsPanel=function(){return new a.ElementLimitsPanel(this.game,this)},e.prototype.createStarDustPanel=function(){return new l.StarDustPanel(this.game,this)},e.prototype.createScore=function(){var t=new Phaser.BitmapText(this.game,0,0,s.Config.FONT_SCORE_GAME,u.Defs.SCORE_TEXT+0,s.Config.FONT_SCORE_GAME_SIZE,"left");return t.anchor.set(0,.5),t},e.prototype.createCannonQueue=function(){return new h.CannonQueue(this.game,this)},e.prototype.onResize=function(t,n){var i=this.game.cache.getFrameByName(s.Config.ATLAS_HUD,"buttonPause"),o=t/2-e.BUTTON_OFFSET_X-i.sourceSizeW/2,r=-n/2+e.BUTTON_OFFSET_Y+i.sourceSizeH/2;this._btnPause.position.set(o,r),r=-n/2+35;var a=s.Config.LIMITS_OFFSET_FROM_LEFT,l=(t/2-8-Math.abs(a))*(a>=0?-1:1),h=s.Config.LIMITS_OFFSET_FROM_TOP;this._limitsPanel.position.set(l,r+h);var u=s.Config.STARDUST_OFFSET_FROM_CENTER;if(this._starDustPanel.position.set(u,r),this._score){var c=u+(this._btnPause.x-u)/2-112.5;this._score.position.set(Math.floor(c),r)}this._cannonQueue&&this._cannonQueue.position.set(400,r)},e.prototype.onButtonClick=function(t){this.onClick.dispatch(t)},e.prototype.update=function(){this._starDustPanel&&this._starDustPanel.completeStarAnimRunning&&this._starDustPanel.updateAnim()},e.prototype.updateCannonQueue=function(t){this._cannonQueue&&this._cannonQueue.updateQueue(t)},e.BUTTON_OFFSET_X=-4,e.BUTTON_OFFSET_Y=-1,e}(Phaser.Group);e.HUD=c},7122:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.StarDustPanel=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(6020),h=n(4525),u=n(7389),c=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i._star=null,i._completeStarAnim=null,i._completeStarAnimRunning=!1,i._star=i.createStar(),i._completeStarAnim=i.createCompleteAnim(),i._completeStarAnim.visible=!1,i.setValue(r.App.settings.data.starDust),i}return o(e,t),Object.defineProperty(e.prototype,"completeStarAnimRunning",{get:function(){return this._completeStarAnimRunning},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldPos",{get:function(){return this._star.world},enumerable:!1,configurable:!0}),e.prototype.createStar=function(){var t=this.game.add.sprite(0,0,s.Config.ATLAS_HUD,0,this);return t.anchor.set(.5),t},e.prototype.createCompleteAnim=function(){var t=new h.DSDEntity(this.game,a.Defs.ANIM_STAR,s.Config.ATLAS_UI,this);return t.onFinished.add(this.onCompleteStarAnimFinished,this),t},e.prototype.setValue=function(t){this._star.frameName=a.Defs.FRAMES_HUD_STARDUST[t]},e.prototype.onPicked=function(t){var e=r.App.settings.data.starDust;this.setValue(e);var n=u.Emitters.instance.oneTime(0,this._star,31);n.emitAt(0,0),n.explode(30),t&&this.animateCompleteStar()},e.prototype.animateCompleteStar=function(){var t=this._completeStarAnim;t.setAnim("onComplete"),this.tweenCompleteStarAnim(),t.visible=!0,this._completeStarAnimRunning=!0},e.prototype.tweenCompleteStarAnim=function(){var t=this._completeStarAnim;t.position.copyFrom(this._star.position);this.game.add.tween(t).to({x:-this.x+s.Config.COMPLETED_STAR_OFFSET_X,y:200+s.Config.COMPLETED_STAR_OFFSET_Y},1e3,Phaser.Easing.Cubic.Out,!0,500).onComplete.add((function(){t.paused=!1,l.AudioUtils.playAudioRecord(a.Defs.SFX_STAR)}),this)},e.prototype.onCompleteStarAnimFinished=function(t){t.visible=!1,this._completeStarAnimRunning=!1},e.prototype.updateAnim=function(){this._completeStarAnim.updateAnim()},e}(Phaser.Group);e.StarDustPanel=c},7608:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.Hole=void 0;var s=n(5357),a=n(1391),l=function(t){function e(e,n,i){var o=t.call(this,e,n,i-1,s.Config.ATLAS_SPRITES,a.Defs.FRAMES_HOLE_ROOTS[0])||this;return o._chains=[],o._animateForward=!1,o._animationIndex=0,o._nextAnimationFrameTime=0,o._particlesLayer=null,o._nextParticleTime=0,o.anchor.set(.5),o.visible=!1,o}return o(e,t),Object.defineProperty(e.prototype,"chains",{get:function(){return this._chains},enumerable:!1,configurable:!0}),e.prototype.init=function(t){var e,n;this._particlesLayer=t.effectsLayerTopUnder;var i=-1;try{for(var o=r(t.chains),s=o.next();!s.done;s=o.next()){var a=s.value,l=a.path,h=l.getPointAtDistance(l.pathLength);if(!(Phaser.Math.distanceSq(this.x,this.y,h.x,h.y)>400)){if(this._chains.push(a),-1!==i&&h.layer!==i)throw new Error("Different paths end in different layers");i=h.layer}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}if(-1===i)throw new Error("Orphaned hole - no path ends close to it.");var u=0===i?t.bottomBalls:t.topBalls;u.add(this),u.sendToBack(this)},e.prototype.updateHole=function(t){this._animateForward=t>0,this.visible=!(!this._animateForward&&0===this._animationIndex&&this.game.time.time>this._nextAnimationFrameTime),this._animateForward?this._animationIndex<a.Defs.FRAMES_HOLE_ROOTS.length-1&&this.game.time.time>=this._nextAnimationFrameTime&&(++this._animationIndex,this._nextAnimationFrameTime=this.game.time.time+e.ANIMATION_FRAME_DURATION,this.frameName=a.Defs.FRAMES_HOLE_ROOTS[this._animationIndex]):this._animationIndex>0&&this.game.time.time>=this._nextAnimationFrameTime&&(--this._animationIndex,this._nextAnimationFrameTime=this.game.time.time+e.ANIMATION_FRAME_DURATION,this.frameName=a.Defs.FRAMES_HOLE_ROOTS[this._animationIndex])},e.prototype.emitParticle=function(t){},e.ANIMATION_FRAME_DURATION=100,e}(Phaser.Sprite);e.Hole=l},1138:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LaunchedBall=void 0;var i=n(5357),o=n(1391),r=n(713),s=n(4979),a=function(){function t(t){this.launchPosition=new Phaser.Point,this.direction=new Phaser.Point,this.ball=null,this.throw=!1,this.ballistics=new s.Ballistics,this._trail=null,this._destroy=!1,this._trail=new Phaser.Sprite(t,0,0,i.Config.ATLAS_GAME,o.Defs.FRAME_TRAIL),this._trail.anchor.set(1,.5),this._trail.alpha=.3,this._trail.visible=!1}return Object.defineProperty(t.prototype,"destroy",{get:function(){return this._destroy},enumerable:!1,configurable:!0}),t.prototype.init=function(t,e,n){this.ball=t,this.launchPosition.copyFrom(t.position),this.direction.set(Math.cos(e),Math.sin(e)),this.throw=n,this._destroy=!1,this._trail.visible=!1},t.prototype.clearBall=function(){this.ball=null},t.prototype.showTrail=function(t){t.add(this._trail),t.sendToBack(this._trail),this._trail.rotation=Math.atan2(this.direction.y,this.direction.x),this._trail.position.copyFrom(this.ball.position),this._trail.scale.set(0),this.ball.isBasicType?this._trail.tint=o.Defs.ELEMENTS[this.ball.type].tint:this._trail.tint=o.Defs.POWERUPS[this.ball.type&o.Defs.BALL_SPECIAL_MASK].tint,this._trail.visible=!0},t.prototype.hideTrail=function(){this._trail.visible||(this._destroy=!0)},t.prototype.updateTrail=function(t){var e;this._trail.visible&&(this.ball?(this._trail.position.copyFrom(this.ball.position),(e=this._trail.scale.x)<1&&(e=r.MathHelp.moveTowards(e,1,8*t),this._trail.scale.set(e),this._trail.alpha=.2*e)):(e=this._trail.scale.x)>0&&(e=r.MathHelp.moveTowards(e,0,8*t),this._trail.scale.set(e),this._trail.alpha=.2*e,0===e&&(this._destroy=!0)))},t}();e.LaunchedBall=a},8716:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.Level=void 0;var s,a=n(2178),l=n(5357),h=n(3860),u=n(1391),c=n(7751),p=n(4455),_=n(286),f=n(6e3),d=n(7892),y=n(3059),m=n(6037),g=n(6020),v=n(712),T=n(1532),E=n(4214),b=n(1850),S=n(5384),P=n(113),A=n(8762),O=n(1424),w=n(7609),L=n(2987),C=n(3784),I=n(7608),x=n(1138),D=n(351),R=n(7389),M=n(7446),B=n(7883),N=n(726),F=n(6023),k=n(8519),U=n(9280),G=n(1650),j=n(5314),H=n(4524),W=n(8163),X=n(8291),V=n(7523),Y=n(9159),z=n(6088),K=n(2984),q=n(5714),J=n(3338),Z=n(1735),Q=n(6441),$=n(8980),tt=n(4886),et=n(1342),nt=n(3910),it=n(2755),ot=n(9071),rt=n(5024),st=n(5813),at=n(7709);!function(t){t[t.None=0]="None",t[t.Pressed=1]="Pressed",t[t.Released=2]="Released"}(s||(s={}));var lt=function(t){function e(n,i,o){var s=t.call(this,n,i)||this;return s.onAddScore=new Phaser.Signal,s.onGameOver=new Phaser.Signal,s._id=-1,s._spatial=null,s._bg=null,s._windLayer=null,s._bottomBalls=null,s._bridges=null,s._topBalls=null,s._launchedBallsLayer=null,s._topObjects=null,s._effectsLayerTopUnder=null,s._effectsLayerTop=null,s._comboLayer=null,s._levelStructure=null,s._ballsPool=null,s._wavesManager=null,s._launchedBalls=null,s._chains=null,s._holes=[],s._HUD=null,s._limits=null,s._bonusManager=null,s._scoreBonusRunning=!1,s._starDust=null,s._envFXManager=null,s._pointerPosition=new Phaser.Point,s._pointerEventPosition=new Phaser.Point,s._overTunnel=!1,s._ballStats=null,s._totalBallsDestroyed=0,s._cannon=null,s._ballisticsTrajectory=null,s._ballisticsThrows=0,s._hasBlockingTask=!0,s._gameOver=!1,s._lastMatchTime=0,s._comboCount=0,s._scorePtcIdx=0,s._timeStart=0,s._timePlaying=0,s._windGroup=null,s._ballsRandomizer=[0,0,0,0,0,0],s._id=o,e.BALL_SHIFT_FORWARD=v.Ball.DIAMETER,e.BALL_SHIFT_BACKWARD=v.Ball.DIAMETER-e.BALL_SHIFT_FORWARD,s._levelStructure=_.LevelStructure.instance,s._chains=[],s._spatial=d.SpatialGrid.fromDimensionsAndCell(l.Config.GAME_WIDTH+320,l.Config.GAME_HEIGHT+160,160,160),s._launchedBalls=new m.UnorderedArrayPool(x.LaunchedBall,8,(function(){return new x.LaunchedBall(n)})),s._ballStats=new b.BallStats,s._bg=n.add.sprite(0,0,s._levelStructure.backgroundTexture,0,s),s._bg.anchor.set(.5),s._bottomBalls=new E.BallsGroup(n,s),s._bridges=new P.BridgesGroup(n,s),s._topBalls=new E.BallsGroup(n,s),l.Config.WAVE_FLOWERS&&(s._windLayer=new Phaser.Group(n,s),s._windGroup=new st.WindGroup),s._launchedBallsLayer=new E.BallsGroup(n,s),s._topObjects=new D.ObjectsGroup(n,s),s._effectsLayerTopUnder=new Phaser.Group(n,s),s._effectsLayerTop=new Phaser.Group(n,s),s._ballisticsTrajectory=new T.BallisticsTrajectory(n,s),s._comboLayer=new Phaser.Group(n,s),s._ballsPool=new y.Pool(v.Ball,e.BALLS_POOL_SIZE,(function(){return new v.Ball(n)})),s._ballsPool.canGrow=!0,s._bonusManager=new S.BonusManager(n,s),s._starDust=new F.StarDust(n,s),s._envFXManager=new L.EnvFXManager,s._scorePtcIdx=s.game.cache.getFrameByName(l.Config.ATLAS_GAME,u.Defs.FRAME_SCORE_PTC).index,l.Config.DEBUG_ENABLE_CHEATS&&(n.input.keyboard.addKey(Phaser.KeyCode.Q).onDown.add((function(){this._cannon.enqueueBall(u.Defs.BALL_ELEMENT_BLUE)}),s),n.input.keyboard.addKey(Phaser.KeyCode.W).onDown.add((function(){this._cannon.enqueueBall(u.Defs.BALL_ELEMENT_RED)}),s),n.input.keyboard.addKey(Phaser.KeyCode.E).onDown.add((function(){this._cannon.enqueueBall(u.Defs.BALL_ELEMENT_GREEN)}),s),n.input.keyboard.addKey(Phaser.KeyCode.R).onDown.add((function(){this._cannon.enqueueBall(u.Defs.BALL_ELEMENT_YELLOW)}),s),n.input.keyboard.addKey(Phaser.KeyCode.T).onDown.add((function(){this._cannon.enqueueBall(u.Defs.BALL_ELEMENT_CYAN)}),s),n.input.keyboard.addKey(Phaser.KeyCode.Y).onDown.add((function(){this._cannon.enqueueBall(u.Defs.BALL_ELEMENT_PURPLE)}),s),n.input.keyboard.addKey(Phaser.KeyCode.U).onDown.add((function(){q.Tasks.instance.createTask(k.TaskBonusPopup).init(this,0,0,0,10,this.comboLayer),this._cannon.enqueueBall(u.Defs.BALL_CHAIN_BOMB)}),s),n.input.keyboard.addKey(Phaser.KeyCode.I).onDown.add((function(){q.Tasks.instance.createTask(k.TaskBonusPopup).init(this,0,0,0,11,this.comboLayer),this._cannon.enqueueBall(u.Defs.BALL_CHAIN_STEEL)}),s),n.input.keyboard.addKey(Phaser.KeyCode.O).onDown.add((function(){q.Tasks.instance.createTask(k.TaskBonusPopup).init(this,0,0,0,13,this.comboLayer),this._cannon.enqueueBall(u.Defs.BALL_REWARD_RAINBOW)}),s),n.input.keyboard.addKey(Phaser.KeyCode.A).onDown.add((function(){q.Tasks.instance.createTask(k.TaskBonusPopup).init(this,0,0,0,6,this.comboLayer),this._chains[0].speedManager.handleSlow()}),s),n.input.keyboard.addKey(Phaser.KeyCode.S).onDown.add((function(){q.Tasks.instance.createTask(k.TaskBonusPopup).init(this,0,0,0,7,this.comboLayer),this._chains[0].speedManager.handleFreeze()}),s),n.input.keyboard.addKey(Phaser.KeyCode.D).onDown.add((function(){q.Tasks.instance.createTask(k.TaskBonusPopup).init(this,0,0,0,8,this.comboLayer),this._chains[0].speedManager.handleBack()}),s),n.input.keyboard.addKey(Phaser.KeyCode.F).onDown.add((function(){q.Tasks.instance.createTask(k.TaskBonusPopup).init(this,0,0,0,12,this.comboLayer),this.onThrowBonus()}),s),n.input.keyboard.addKey(Phaser.KeyCode.G).onDown.add((function(){q.Tasks.instance.createTask(k.TaskBonusPopup).init(this,0,0,0,9,this.comboLayer),this.onScoreBonus()}),s),n.input.keyboard.addKey(Phaser.KeyCode.H).onDown.add((function(){this._HUD.starDust.onPicked(!0)}),s),n.input.keyboard.addKey(Phaser.KeyCode.J).onDown.add((function(){this.gameLost(this._chains[0].balls[0])}),s),n.input.keyboard.addKey(Phaser.KeyCode.K).onDown.add((function(){var t,e,n,i,o=q.Tasks.instance._tasks.data;try{for(var s=r(o),a=s.next();!a.done;a=s.next()){var l=a.value;if(null==l?void 0:l._seals)try{for(var h=(n=void 0,r(l._seals)),u=h.next();!u.done;u=h.next()){u.value.activate()}}catch(t){n={error:t}}finally{try{u&&!u.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}}),s)),s}return o(e,t),Object.defineProperty(e.prototype,"doBallistics",{get:function(){return this._ballisticsThrows>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bg",{get:function(){return this._bg},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bridges",{get:function(){return this._bridges},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"chains",{get:function(){return this._chains},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"holes",{get:function(){return this._holes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomBalls",{get:function(){return this._bottomBalls},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topBalls",{get:function(){return this._topBalls},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"effectsLayerTopUnder",{get:function(){return this._effectsLayerTopUnder},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"effectsLayerTop",{get:function(){return this._effectsLayerTop},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"comboLayer",{get:function(){return this._comboLayer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spatial",{get:function(){return this._spatial},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cannon",{get:function(){return this._cannon},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cannonPosition",{get:function(){return this._cannon.position},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HUD",{get:function(){return this._HUD},set:function(t){this._HUD=t,this._limits=t.limits,this._limits.onLimit.add(this.onLimit,this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bonusManager",{get:function(){return this._bonusManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"starDust",{get:function(){return this._starDust},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ballStats",{get:function(){return this._ballStats},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeStart",{get:function(){return this._timeStart},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timePlaying",{get:function(){return this._timePlaying},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"totalBallsDestroyed",{get:function(){return this._totalBallsDestroyed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasBlockingTask",{get:function(){return this._hasBlockingTask},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMultichain",{get:function(){return this._chains.length>1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isGameOver",{get:function(){return this._gameOver},enumerable:!1,configurable:!0}),e.prototype.render=function(){this._spatial.render(this.game)},e.prototype.onShutdown=function(){},e.prototype.onWavesDef=function(t){this._wavesManager=new rt.WavesManager(t,l.Config.LEVELS_DIFFICULTY[this._id+1])},e.prototype.onPath=function(t){this.addPath(t)},e.prototype.shallBakeObject=function(t){return!l.Config.WAVE_FLOWERS||void 0===u.Defs.WAVE_SCALE[t.key]},e.prototype.onObject=function(t,e,n){n?this.addBottomObject(t):this.addTopObject(t,e)},e.prototype.onBridge=function(t){return this.addBridge(t)},e.prototype.onStardust=function(t){this._starDust.positions=t},e.prototype.addPath=function(t){var e=new h.CurvePath(t,l.Config.CURVE_STEP),n=new O.Chain(this.game,this,e);this._chains.push(n),this._wavesManager.addChain(n)},e.prototype.addBottomObject=function(t){if(t.key===u.Defs.OBJ_ID_HOLE){var e=new I.Hole(this.game,t.x,t.y);this._holes.push(e)}else if(l.Config.WAVE_FLOWERS&&void 0!==u.Defs.WAVE_SCALE[t.key]){var n=new at.WindSprite(this.game,t);this._windLayer.add(n),n.isMoving&&this._windGroup.addObject(n)}},e.prototype.addTopObject=function(t,e){if(t.key===u.Defs.OBJ_ID_CANNON)this.createCannon(t.x,t.y);else if(t.key===u.Defs.OBJ_ID_WATER)this._envFXManager.addFX(new C.EnvFXWater(t,this._bg));else if(t.key===u.Defs.OBJ_ID_DUST)this._envFXManager.addFX(new w.EnvFXDust(t,this._effectsLayerTop,this._windGroup.windRotation));else{var n=this._topObjects.addObject(t,e);n.windAffected&&this._windGroup.addObject(n)}},e.prototype.addBridge=function(t){return this._bridges.addBridge(t)},e.prototype.onLevelLoaded=function(){this.initSpatialGrid(),this.resetTime(),this.createPathRevealTasks(),this.initHoles(),this.createPathEndTasks(),l.Config.WAVE_FLOWERS&&this._windGroup.updateWind(this._timePlaying);var t=q.Tasks.instance.createTask(U.TaskDelayedAudio);t&&t.init(.2,u.Defs.SFX_PATH_REVEAL)},e.prototype.createPathRevealTasks=function(){var t,e,n=!0;try{for(var i=r(this._chains),o=i.next();!o.done;o=i.next()){var s=o.value,a=q.Tasks.instance.createTask(K.TaskPathReveal);a.flags=1,a.init(this,s.path,this._bg,this._topBalls),n&&(a.notifyLevelOnFinished=!0,n=!1)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.handleRevealTaskFinished=function(){this.createTutorialTasks()},e.prototype.createTutorialTasks=function(){var t=a.App.settings;t.isTutorialShown(ot.TutorialFlag.Motor)&&!l.Config.DEBUG_TUTORIAL_EVERY_TIME||q.Tasks.instance.createTask(tt.TaskTutorialMotor).init(this);t.isTutorialShown(ot.TutorialFlag.FirstDestroy)&&!l.Config.DEBUG_TUTORIAL_EVERY_TIME||q.Tasks.instance.createTask(Q.TaskTutorialDestory).init(this);t.isTutorialShown(ot.TutorialFlag.StarDust)&&!l.Config.DEBUG_TUTORIAL_EVERY_TIME||q.Tasks.instance.createTask(nt.TaskTutorialStardust).init(this);t.isTutorialShown(ot.TutorialFlag.Game)&&!l.Config.DEBUG_TUTORIAL_EVERY_TIME||q.Tasks.instance.createTask($.TaskTutorialGame).init(this)},e.prototype.initHoles=function(){var t,e;try{for(var n=r(this._holes),i=n.next();!i.done;i=n.next()){i.value.init(this)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.createPathEndTasks=function(){q.Tasks.instance.createTask(z.TaskPathEnd).init(this,this._wavesManager.waves)},e.prototype.createCannon=function(t,e){if(null!==this._cannon)throw new Error("There can't be more than one cannon in level.");this._cannon=new A.Cannon(this.game,this),this._cannon.position.set(t,e),this.setChildIndex(this._cannon,this.getChildIndex(this._bg)+1)},e.prototype.initSpatialGrid=function(){this._levelStructure.physics.addTunnelsIntoSpatialGrid(this._spatial),this._levelStructure.physics.addWallsIntoSpatialGrid(this._spatial)},e.prototype.resetTime=function(){this._timeStart=this.game.time.time,this._timePlaying=0},e.prototype.onPointerDown=function(t,e){this._pointerPosition.copyFrom(t),this._pointerEventPosition.copyFrom(t),this.handleInput(s.Pressed)},e.prototype.onPointerMove=function(t,n){this._pointerPosition.copyFrom(t),Phaser.Math.distanceSq(t.x,t.y,this._pointerEventPosition.x,this._pointerEventPosition.y),e.POINTER_EVENT_RESET_DISTANCE,e.POINTER_EVENT_RESET_DISTANCE},e.prototype.onPointerUp=function(t,e){this._pointerPosition.copyFrom(t),this._pointerEventPosition.copyFrom(t),this.handleInput(s.Released)},e.prototype.handleInput=function(t){if(!this._hasBlockingTask){var e=this.pointOnCanon(this._pointerPosition.x,this._pointerPosition.y),n=this.canThrow()&&!e;e&&t===s.Pressed?this._cannon.swapBalls():e||t!==s.Pressed||n&&!this._ballisticsTrajectory.validTarget||this.launchBall(n)}},e.prototype.handleMoveInput=function(){this._cannon.aimAt(this._pointerPosition);var t=this.canThrow()&&!this.pointOnCanon(this._pointerPosition.x,this._pointerPosition.y);this.updateBallisticsCurve(t)},e.prototype.pointOnCanon=function(t,e){var n=this._cannon.cannonRadius;return Phaser.Math.distanceSq(t,e,this._cannon.x,this._cannon.y)<n*n},e.prototype.canThrow=function(){return this.doBallistics&&this._cannon.canThrow},e.prototype.updateBallisticsCurve=function(t){this._ballisticsTrajectory.visible=t,t&&this._ballisticsTrajectory.setPositions(this._cannon.getLaunchPoint(),this._pointerPosition)},e.prototype.isOutOfScreen=function(t,e,n){var i=this.game.width/2+n,o=this.game.height/2+n;if(!a.App.isLandscape){var r=i;i=o,o=r}return t<-i||t>i||e<-o||e>o},e.prototype.isPointOutOfScreen=function(t,e){return this.isOutOfScreen(t.x,t.y,e)},e.prototype.gameLost=function(t){this.gameOverParticles(t),this._gameOver=!0,this.onGameOver.dispatch(!1)},e.prototype.gameOverParticles=function(t){var e=R.Emitters.instance,n=t.position.x,i=t.position.y,o=e.spawn(0,this._effectsLayerTop,0);o&&(o.emitAt(n,i),o.flow(50,5,45),o.despawnDelay=1e3);var r=e.oneTime(0,this._effectsLayerTop,1);r.emitAt(n,i),r.explode(1);var s=e.oneTime(0,this._effectsLayerTop,2);s.emitAt(n,i),s.explode(1);var a=e.oneTime(0,this._effectsLayerTop,3);a.emitAt(n,i),a.explode(40),g.AudioUtils.playAudioRecord(u.Defs.SFX_END_WHOOSH),this.game.time.events.add(1e3,(function(){t.setVisible(!1),g.AudioUtils.playAudioRecord(u.Defs.SFX_END_EXPLOSION),g.AudioUtils.playAudioRecord(u.Defs.SFX_END_EXPLOSION)}),this)},e.prototype.tutorialUpdate=function(){var t=this.game.time.delta,e=Math.min(t,40)/1e3;this._spatial.clear(),this.handleMoveInput(),this._cannon.updateCannon(e),this.updateLaunchedBalls(e),this._envFXManager.update(this.game.time.time)},e.prototype.updateLevel=function(){var t=this.game.time.delta,e=Math.min(t,40),n=e/1e3,i=q.Tasks.instance;this._hasBlockingTask=i.hasTaskWithFlags(1),this._hasBlockingTask||(this._timePlaying+=e,this._gameOver?(this._cannon.updateCannon(n),this.updateLaunchedBalls(n)):(this._spatial.clear(),this.handleMoveInput(),this._cannon.updateCannon(n),this._wavesManager.update(n),this.updateChains(n),this._wavesManager.waiting&&this._cannon.limitTypes(),this.updateLaunchedBalls(n),this._starDust.updateStarDust(),this._bonusManager.update(),this.checkWin()&&(this._gameOver=!0,this.onGameOver.dispatch(!0)))),this._envFXManager.update(this.game.time.time),l.Config.WAVE_FLOWERS&&this._windGroup.updateWind(this._timePlaying),i.update(n)},e.prototype.checkWin=function(){var t,e;if(!this._wavesManager.finished)return!1;var n=0;try{for(var i=r(this._chains),o=i.next();!o.done;o=i.next()){n+=o.value.ballsCount}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return 0===n},e.prototype.waveCompleted=function(t,e){l.Config.SCORE_SYSTEM&&q.Tasks.instance.createTask(Y.TaskPathCompleted).init(this,t.path,this._bg,this._topBalls,e)},e.prototype.updateChains=function(t){var e,n;try{for(var i=r(this._chains),o=i.next();!o.done;o=i.next()){o.value.updateChain(t)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},e.prototype.updateLaunchedBalls=function(t){var e=this;this._launchedBalls.iterate((function(n){n.ball?e.moveLaunchedBall(n,t)?n.ball.isBasicType||n.ball.updateLaunched(t):(n.clearBall(),n.hideTrail()):n.destroy&&e._launchedBalls.despawn(n),n.updateTrail(t)}))},e.prototype.moveLaunchedBall=function(t,e){var n=t.ball;if(t.throw){var i=t.ballistics;i.step(e);var o=i.getAtCurrent();return n.setPosition(o.position.x,o.position.y),a.App.isLandscape?n.ballSprite.y+=o.height:n.ballSprite.x+=o.height,i.finished?(this.outOfScreenTest(n)||this.wallTest(n,t.direction)||this.chainTest(n,t,t.throw)||(this.starDustTest(n),this.onWallHit(n,t.direction)),!1):!0}for(var r=l.Config.LAUNCHED_BALL_SPEED*e;r>0;){var s=Math.min(8,r);if(r-=s,n.moveBy(t.direction.x*s,t.direction.y*s),this.starDustTest(n),this.outOfScreenTest(n)||this.wallTest(n,t.direction)||this.chainTest(n,t,t.throw))return!1}return!0},e.prototype.outOfScreenTest=function(t){return!!this.isPointOutOfScreen(t.position,v.Ball.RADIUS)&&(t.removeReason=v.BallRemoveReason.OutOfScreen,this.destroyBall(t),!0)},e.prototype.wallTest=function(t,e){return this._overTunnel=!1,!!this.launchedBallWallTest(t)&&(this.onWallHit(t,e),!0)},e.prototype.chainTest=function(t,e,n){var i=this.launchedBallChainTest(t,e.launchPosition,n);if(null!==i){var o=t.type;if(t.isBasicType||o===u.Defs.BALL_REWARD_RAINBOW)return i.chain.resolveCollision(t,i),this.onBallAdded(t),!0;if(this.ballHitSpecial(t,i,e.direction))return t.removeReason=v.BallRemoveReason.Consumed,this.destroyBall(t),!0}return!1},e.prototype.starDustTest=function(t){return this._starDust.canPick&&this._starDust.checkCollision(t.position)},e.prototype.onWallHit=function(t,e){if(t.isBasicType){var n=R.Emitters.instance.spawn(0,null,c.ParticleDefs.PTC_BALL_BREAK_EXPLOSION[t.type]);n&&(n.rotation=Math.atan2(e.y,e.x),n.position.set(t.position.x,t.position.y),n.emitAt(0,0),this._launchedBallsLayer.add(n),n.despawnDelay=550,n.explode(this.game.rnd.integerInRange(5,6)));var i=R.Emitters.instance.oneTime(0,this._launchedBallsLayer,c.ParticleDefs.PTC_BALL_BREAK_DUST[t.type]);i.emitAt(t.position.x,t.position.y),i.explode(6),g.AudioUtils.playAudioRecord(u.Defs.SFX_THROW_IMPACT)}else this.wallHitSpecial(t);t.removeReason=v.BallRemoveReason.WallCrash,this.destroyBall(t)},e.prototype.launchedBallWallTest=function(t){var e=this,n=t.position,i=t.ballSprite,o=!1;return this._spatial.testUnique(n.x,n.y,i.width,i.height,d.SpatialTestType.Static,(function(t){if(t.spatialType===f.SpatialType.Collider){var i=t.spatialObject;i.isTunnel?e._overTunnel=e._overTunnel||i.circleIntersection(n.x,n.y,v.Ball.RADIUS):o=i.circleIntersection(n.x,n.y,.5*v.Ball.RADIUS)}return o}),i.anchor.x,i.anchor.y),o},e.prototype.launchedBallChainTest=function(t,e,n){var i=this,o=t.position,r=t.ballSprite,s=n?v.Ball.RADIUS:v.Ball.RADIUS/3,a=Phaser.Math.distanceSq(t.position.x,t.position.y,e.x,e.y),l=Number.MAX_VALUE,h=null;return this._spatial.testUnique(o.x,o.y,r.width,r.height,d.SpatialTestType.Dynamic,(function(o){if(o.spatialType===f.SpatialType.Ball){var r=o.spatialObject;if(r.removeReason!==v.BallRemoveReason.None)return!1;if(i._overTunnel&&0===r.ballLayer)return!1;if(r.collidedWithCircle(t.position.x,t.position.y,s)){var u=t.collisionDist;u>=0&&u<l&&(n||Phaser.Math.distanceSq(r.position.x,r.position.y,e.x,e.y)>a)&&(l=u,h=r)}}return!1}),r.anchor.x,r.anchor.y),h},e.prototype.wallHitSpecial=function(t){switch(t.type){case u.Defs.BALL_ELEMENT_BLUE:this.emitOnElementBlueBreak(t,null);break;case u.Defs.BALL_ELEMENT_RED:this.emitOnElementRedBreak(t);break;case u.Defs.BALL_ELEMENT_CYAN:this.emitOnElementCyanBreak(t);break;case u.Defs.BALL_ELEMENT_PURPLE:this.emitOnElementPurpleBreak(t);break;case u.Defs.BALL_CHAIN_BOMB:this.onChainBomb(t);break;case u.Defs.BALL_REWARD_RAINBOW:this.emitOnRainbow(t);break;case u.Defs.BALL_CHAIN_STEEL:this.emitOnSteel(t),g.AudioUtils.playAudioRecord(u.Defs.SFX_STEEL_WALL)}},e.prototype.emitOnSteel=function(t){var e=t.position,n=this._topBalls,i=R.Emitters.instance.oneTime(0,n,18);i.emitAt(e.x,e.y),i.explode(1),(i=R.Emitters.instance.oneTime(0,n,19)).emitAt(e.x,e.y),i.explode(1),(i=R.Emitters.instance.oneTime(0,n,20)).emitAt(e.x,e.y),i.explode(5),(i=R.Emitters.instance.oneTime(0,n,21)).emitAt(e.x,e.y),i.explode(15),g.AudioUtils.playAudioRecordRnd(u.Defs.SFX_STEEL_HIT)},e.prototype.emitOnRainbow=function(t){var e=R.Emitters.instance.oneTime(0,this._effectsLayerTopUnder,25);e.emitAt(t.position.x,t.position.y),e.explode(16),(e=R.Emitters.instance.oneTime(0,this._effectsLayerTopUnder,26)).emitAt(t.position.x,t.position.y),e.explode(1),this.emitBallShards(t),g.AudioUtils.playAudioRecord(u.Defs.SFX_RAINBOW_MATCH)},e.prototype.emitOnElementBlueBreak=function(t,e){var n=e?c.ParticleDefs.PTC_ELEMENT_BLUE_SPLAT_SHORT[e.type]:48,i=R.Emitters.instance.oneTime(1,this._topBalls,n);i.emitAt(t.position.x,t.position.y),i.explode(5),this.emitBallShards(t),g.AudioUtils.playAudioRecord(u.Defs.SFX_RECOLOR)},e.prototype.emitOnElementRedBreak=function(t){var e=R.Emitters.instance.oneTime(0,this._topBalls,62);e.emitAt(t.position.x,t.position.y),e.explode(10),this.emitBallShards(t)},e.prototype.emitOnElementCyanBreak=function(t){var e=R.Emitters.instance.oneTime(1,this._topBalls,74);e.emitAt(t.position.x,t.position.y),e.explode(10),this.emitBallShards(t),g.AudioUtils.playAudioRecord(u.Defs.SFX_LGHT_IMPACT)},e.prototype.emitOnElementPurpleBreak=function(t){var e=R.Emitters.instance.oneTime(0,this._topBalls,75);e.emitAt(t.position.x,t.position.y),e.explode(5),this.emitBallShards(t)},e.prototype.emitBallShards=function(t){var e=t.ballSprite,n=R.Emitters.instance.oneTime(0,this._topBalls,22);n.emitAt(e.x,e.y),n.explode(1),(n=R.Emitters.instance.oneTime(0,this._topBalls,23)).emitAt(e.x,e.y),n.explode(3),(n=R.Emitters.instance.spawn(0,null,24))&&(n.angle=e.angle,n.position.set(e.x,e.y),n.emitAt(0,0),this._topBalls.add(n),n.despawnDelay=1200,n.explode(7)),g.AudioUtils.playAudioRecord(u.Defs.SFX_GLASS)},e.prototype.ballHitSpecial=function(t,e,n){var i=!0;switch(t.type){case u.Defs.BALL_ELEMENT_BLUE:this.emitOnElementBlueBreak(t,e),this.onElementBlue(e);break;case u.Defs.BALL_ELEMENT_RED:this.emitOnElementRedBreak(t),this.onElementRed(t,e.chain);break;case u.Defs.BALL_ELEMENT_CYAN:this.emitOnElementCyanBreak(t),this.onElementCyan(e);break;case u.Defs.BALL_ELEMENT_PURPLE:this.emitOnElementPurpleBreak(t),this.onElementPurple(t,e.chain);break;case u.Defs.BALL_CHAIN_BOMB:this.onChainBomb(t);break;case u.Defs.BALL_CHAIN_STEEL:e.destroyWithReason(v.BallRemoveReason.Broken),this.emitOnSteel(t),i=!1}return i},e.prototype.launchBall=function(t){if(this.game.device.desktop&&!l.Config.DEBUG_EMULATE_MOBILE||this.handleMoveInput(),!this._launchedBalls.isFull){var e=this._cannon.launchBall();if(null!==e&&(e.isBasicType||this.onCannonLaunch(e))){e.onCannonLaunch();var n=Phaser.Math.degToRad(this._cannon.angle),i=this._launchedBalls.spawn();if(!i)throw new Error("Can't spawn slot for launched ball.");i.init(e,n,t),t?(--this._ballisticsThrows,this._ballisticsTrajectory.curve.copy(i.ballistics),g.AudioUtils.playAudioRecord(u.Defs.SFX_THROW)):(i.showTrail(this._launchedBallsLayer),g.AudioUtils.playAudioRecord(u.Defs.SFX_BALL_SHOT)),this._launchedBallsLayer.addBallAndShadow(e),N.Shaker.instance.createShake(this._cannon,M.BounceShake,N.ShakerNotAffected.Rotation).init(p.ShakeDefs.FIRE_FEEDBACK,this._cannon.rotation+Math.PI)}}},e.prototype.onCannonLaunch=function(t){switch(t.type){case u.Defs.BALL_ELEMENT_YELLOW:return this.onElementYellow(t),t.removeReason=v.BallRemoveReason.Consumed,this.destroyBall(t),!1;case u.Defs.BALL_ELEMENT_GREEN:return this.onElementGreen(t),!1}return!0},e.prototype.getNewBall=function(){var t=this._ballsPool.spawn();if(null===t)throw new Error("No free balls in pool!");return t},e.prototype.destroyBall=function(t){t.removeReason,v.BallRemoveReason.None,this.updateLimits(t),t.onDestroy(this),this.onBallRemoved(t),t.removeFromParent(),this._ballsPool.despawn(t)},e.prototype.ballTypeInStats=function(t){return this._ballStats.count(t)>0},e.prototype.getLimitedRandomBallType=function(t){var e=this._wavesManager.ballTypes,n=this._ballsRandomizer;if(this._wavesManager.waiting){if(!this._ballStats.getBallsInStats(n,e,100)){if(t)return-1;this.setBallRandomizerDefault(n,e,100)}}else this.setBallRandomizerDefault(n,e,100);return this.getRandomBallTypeFromRandomizer(n,e)},e.prototype.setBallRandomizerDefault=function(t,e,n){for(var i=0;i<e;i++)t[i]=n},e.prototype.getRandomBallTypeFromRandomizer=function(t,e){var n,i;try{for(var o=r(this._chains),s=o.next();!s.done;s=o.next()){var a=s.value;if(0!==a.ballsCount)for(var h=a.path.pathLength-2*l.Config.HOLE_ROOTS_CHECK_DISTANCE,u=a.balls,c=0,p=0;p<a.ballsCount&&(c=u[p].pathDistance-h)>0;){if(a.balls[p].isBasicType){var _=Math.floor(c);t[u[p].type]+=_}++p}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}var f=0;for(p=0;p<e;p++)f+=t[p];var d=this.game.rnd.integerInRange(0,f-1);f=0;for(p=0;p<e;p++)if(d<(f+=t[p]))return p;throw new Error("Should never get here - no random ball can be generated!")},e.prototype.getRandomBallType=function(){var t=this._wavesManager.ballTypes;return l.Config.DEBUG_USE_PROFILES&&l.Config.DEBUG_PROFILE_IDX>0&&(t=l.Config.DEBUG_PROFILES[l.Config.DEBUG_PROFILE_IDX].balls),this.game.rnd.integerInRange(0,t-1)},e.prototype.updateLimits=function(t){if(t.isBasicType&&t.removeReason===v.BallRemoveReason.Match){var e=this._scoreBonusRunning?l.Config.ELEMENT_LIMIT_FAST_FILL:1;this._limits.addValue(t.type,e),++this._totalBallsDestroyed}},e.prototype.onBallAdded=function(t){this._ballStats.add(t.type)},e.prototype.onMatchDetected=function(t,e){this.processCombo(t,e)},e.prototype.processCombo=function(t,e){var n=this.game.time.time;if(n<this._lastMatchTime+l.Config.COMBO_TIME?++this._comboCount:this._comboCount=1,this._lastMatchTime=n,g.AudioUtils.playAudioRecord(u.Defs.SFX_BALL_MATCH[this._comboCount-1]),this._comboCount>1)if(this._comboCount<l.Config.COMBO_MATCHES_FOR_RAINBOW){var i=R.Emitters.instance.oneTime(0,this._comboLayer,c.ParticleDefs.PTC_COMBO[this._comboCount]);i.emitAt(t,e);var o=i.emitParticle();if(o){var r=l.Config.COMBO_NUMS_SCALE;1!==r&&o.resetScale(r,r)}}else{if(this._comboCount=0,this._cannon.enqueueBall(u.Defs.BALL_REWARD_RAINBOW),q.Tasks.instance.createTask(k.TaskBonusPopup).init(this,t,e,0,13,this.comboLayer),!a.App.settings.isTutorialShown(ot.TutorialFlag.Rainbow)||l.Config.DEBUG_TUTORIAL_EVERY_TIME)if(!it.Tutorial.instance.isActive)q.Tasks.instance.createTask(et.TaskTutorialRainbow).init(this,t,e)}},e.prototype.onBallRemoved=function(t){if(t.isBasicType&&null!==t.chain){if(t.removeReason===v.BallRemoveReason.Match||t.removeReason===v.BallRemoveReason.Broken){var e=Phaser.Math.clamp(t.scoreIdx-2,0,20);this.addScore(e),l.Config.SCORE_SYSTEM&&l.Config.SCORE_SYSTEM_PARTICLES&&this.emitScoreParticle(e,t.position.x,t.position.y,this._comboLayer)}this._ballStats.remove(t.type)}},e.prototype.addScore=function(t){var e=l.Config.SCORE_FOR_BALL+20*t;this.onAddScore.dispatch(e)},e.prototype.emitScoreParticle=function(t,e,n,i,o){void 0===o&&(o=1);var r=R.Emitters.instance.oneTime(0,i,6);r.emitAt(e,n);var s=r.emitParticle();s&&(s.setFrame(this._scorePtcIdx+t),s.visual.scale.set(o,o),this._comboLayer.sendToBack(s.visual))},e.prototype.onLimit=function(t){a.App.settings.isTutorialShown(ot.TutorialFlag.Charge)&&!l.Config.DEBUG_TUTORIAL_EVERY_TIME||(it.Tutorial.instance.isActive||q.Tasks.instance.createTask(Z.TaskTutorialCharge).init(this,t));this._cannon.enqueueBall(u.Defs.BALL_SPECIAL+t),g.AudioUtils.playAudioRecord(u.Defs.SFX_LIMIT_FULL)},e.prototype.onBonusActivated=function(t,e){switch(t.bonusType){case 6:e.chain.speedManager.handleSlow();break;case 7:e.chain.speedManager.handleFreeze();break;case 8:e.chain.speedManager.handleBack();break;case 9:this.onScoreBonus();break;case 12:this.onThrowBonus();break;case 10:this._cannon.enqueueBall(u.Defs.BALL_CHAIN_BOMB);break;case 11:for(var n=a.App.settings.data.powerups[11].level,i=u.Defs.POWERUPS[11].levels[n].values[0],o=0;o<i;o++)this._cannon.enqueueBall(u.Defs.BALL_CHAIN_STEEL);break;default:throw new Error("Invalid powerup ID "+t.bonusType+".")}q.Tasks.instance.createTask(k.TaskBonusPopup).init(this,e.position.x,e.position.y,e.ballSprite.angle,t.bonusType,this.comboLayer)},e.prototype.onScoreBonus=function(){if(0!==this._limits.limitsCount){var t=null;if(this._scoreBonusRunning&&(t=q.Tasks.instance.findTaskWithId(1234)),!t){if(this._scoreBonusRunning=!1,!(t=q.Tasks.instance.createTask(J.TaskScoreSigns)))return;t.id=1234,t.init(this,this._limits),this._scoreBonusRunning=!0}var e=a.App.settings.data.powerups[9].level,n=u.Defs.POWERUPS[9].levels[e].values[0];t.setDuration(n)}},e.prototype.onStopScoreBonus=function(){this._scoreBonusRunning=!1},e.prototype.onThrowBonus=function(){var t=Math.max(1,a.App.settings.getPowerupLevel(12)),e=u.Defs.POWERUPS[12].levels[t].values[0];if(this._ballisticsThrows+=e,!this.game.device.desktop&&this._ballisticsThrows===e){var n=this.cannon.rotation,i=this._cannon.getLaunchPoint();this._pointerPosition.set(i.x+250*Math.cos(n),i.y+250*Math.sin(n))}},e.prototype.onElementBlue=function(t){var e=q.Tasks.instance.createTask(G.TaskElementBlue);e&&e.init(t,this)},e.prototype.onElementRed=function(t,e){var n=q.Tasks.instance.createTask(X.TaskElementRed);n&&n.init(t,e,this)},e.prototype.onElementGreen=function(t){var e=q.Tasks.instance.createTask(H.TaskElementGreen);e&&e.init(t,this._cannon,this)},e.prototype.onElementGreenEnded=function(){var t=this._cannon.removeCurrentBall();t.removeReason=v.BallRemoveReason.Consumed,this.destroyBall(t),this._cannon.blocked=!1},e.prototype.onElementYellow=function(t){var e=q.Tasks.instance.createTask(V.TaskElementYellow);e&&e.init(t.position,this._cannon.angle,this)},e.prototype.onElementCyan=function(t){var e=q.Tasks.instance.createTask(j.TaskElementCyan);e&&e.init(t,this)},e.prototype.onElementPurple=function(t,e){var n=q.Tasks.instance.createTask(W.TaskElementPurple);n&&n.init(t,e,this)},e.prototype.onChainBomb=function(t){var e=Math.max(a.App.settings.getPowerupLevel(10),1),n=R.Emitters.instance.oneTime(1,this._effectsLayerTopUnder,c.ParticleDefs.PTC_BOMB_EXPLOSION[e-1]);n.emitAt(t.position.x,t.position.y),n.explode(c.ParticleDefs.PTC_BOMB_EXPLOSION_COUNT[e-1]);var i=R.Emitters.instance.oneTime(0,this._effectsLayerTop,17);i.emitAt(t.position.x,t.position.y),i.explode(3);var o=t.position.x,r=t.position.y,s=u.Defs.POWERUPS[10].levels[e].values[0];this._spatial.testUnique(o,r,2*s,2*s,d.SpatialTestType.Dynamic,(function(t){if(t.spatialType===f.SpatialType.Ball){var e=t.spatialObject;e.removeReason===v.BallRemoveReason.None&&e.getTunnelId()<0&&e.collidedWithCircle(o,r,s)&&e.destroyWithReason(v.BallRemoveReason.Broken)}return!1}),.5,.5),N.Shaker.instance.createShake(this.game.camera,B.PerlinShake).init(p.ShakeDefs.BOMB_SHAKE,1);for(var l=0;l<=2;l++){var h=q.Tasks.instance.createTask(U.TaskDelayedAudio);h&&h.init(.15*l,u.Defs.SFX_EXPLOSION)}},e.prototype.getBallsCount=function(){return this._ballStats.countTotal},e.prototype.getRandomBall=function(){var t=this.game.rnd.integerInRange(0,this._chains.length-1),e=t;do{var n=this._chains[e].gatRandomBallWithoutBonus();if(null!==n)return n;(e+=1)>=this._chains.length&&(e=0)}while(e!==t);return null},e.POINTER_EVENT_RESET_DISTANCE=5,e.BALL_SHIFT_FORWARD=0,e.BALL_SHIFT_BACKWARD=0,e.BALLS_POOL_SIZE=64,e}(Phaser.Group);e.Level=lt},1502:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LevelOpener=void 0;var i=n(5357),o=n(1391),r=n(6020),s=n(4525),a=function(){function t(t){this._game=null,this._doorMask=null,this._doorGroup=null,this._doorAnim=null,this._levelThumb=null,this._running=!1,this._game=t,this._doorGroup=new Phaser.Group(t,null),this.createMask(),this.createAnims()}return Object.defineProperty(t.prototype,"running",{get:function(){return this._running},enumerable:!1,configurable:!0}),t.prototype.createMask=function(){var t=this._game.add.graphics(0,0,this._doorGroup);t.beginFill(16711680),t.drawRoundedRect(-100,-70,200,140,25),t.endFill(),this._doorMask=t},t.prototype.createAnims=function(){this._doorAnim=new s.DSDEntity(this._game,o.Defs.ANIM_LEVEL_GATE,i.Config.ATLAS_LEVELS,this._doorGroup),this._doorAnim.mask=this._doorMask,this._doorAnim.onFinished.add(this.onAnimationFinished,this),this._doorAnim.onEvent.add(this.onAnimationEvent,this),this._doorAnim.setAnim("Unlock")},t.prototype.attachToThumb=function(t){this._levelThumb=t;var e=this._levelThumb.length-1;t.add(this._doorGroup),t.setChildIndex(this._doorGroup,e),this._doorGroup.position.set(t.cx,t.cy)},t.prototype.start=function(){this._running=!0,this._doorAnim.paused=!1,r.AudioUtils.playAudioRecord(o.Defs.SFX_GATE_LOCK)},t.prototype.onAnimationFinished=function(t){this._running=!1,this._doorAnim.visible=!1},t.prototype.onAnimationEvent=function(t,e,n){r.AudioUtils.playAudioRecord(o.Defs.SFX_GATE_OPEN)},t.prototype.animate=function(t){return!!this._running&&(this._doorAnim.updateAnim(),!this._running)},t}();e.LevelOpener=a},1581:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.LevelThumbItem=void 0;var r=n(5357),s=n(1391),a=function(t){function e(n){var i=t.call(this,n)||this;i._cx=0,i._cy=0,i._thumb=null,i._scoreBg=null,i._frame=null,i._levelNum=null,i._star=null,i._score=null;var o=e.itemWidth/2,a=e.itemHeight/2;i._cx=o,i._cy=a;var l=n.add.sprite(o,a,r.Config.ATLAS_LEVELS,0,i);l.anchor.set(.5),l.inputEnabled=!0,l.events.onInputUp.add(i.onInputUp,i),i._thumb=l;var h=n.add.sprite(o+70,a+40,r.Config.ATLAS_LEVELS,s.Defs.FRAME_LEVEL_STAR,i);h.anchor.set(.5),i._star=h;var u=n.add.bitmapText(10,2*a-16,r.Config.FONT_LEVELS,s.Defs.EMPTY_TEXT,55,i);if(u.align="left",u.anchor.set(0,1),i._levelNum=u,r.Config.SCORE_SYSTEM){var c=n.add.sprite(o,0,r.Config.ATLAS_LEVELS,s.Defs.FRAME_LEVEL_SCORE_BG,i);c.anchor.set(.5,0),i._scoreBg=c;var p=n.add.bitmapText(20,6,r.Config.FONT_SCORE_LEVELS,s.Defs.EMPTY_TEXT,r.Config.FONT_SCORE_LEVELS_SIZE,i);p.align="left",i._score=p}var _=n.add.sprite(o,a,r.Config.ATLAS_LEVELS,s.Defs.FRAME_LEVEL_FRAME,i);return _.anchor.set(.5),i._frame=_,i}return o(e,t),Object.defineProperty(e,"itemWidth",{get:function(){return e.ITEM_WIDTH},enumerable:!1,configurable:!0}),Object.defineProperty(e,"itemHeight",{get:function(){return e.ITEM_HEIGHT},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cx",{get:function(){return this._cx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cy",{get:function(){return this._cy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumb",{get:function(){return this._thumb},enumerable:!1,configurable:!0}),e.prototype.onInputUp=function(t,e,n){n&&this.onInputHandler()},e.prototype.setContent=function(n,i){t.prototype.setContent.call(this,n,i);var o=i.unlocked||r.Config.DEBUG_UNLOCK_ALL_LEVELS;if(this._thumb.frameName=o?s.Defs.LEVEL_KEYS[n]:s.Defs.FRAME_LEVEL_CLOSED,o&&(this._levelNum.text=""+(n+1)),this._levelNum.visible=o,this._star.frameName=i.star?s.Defs.FRAME_LEVEL_STAR:s.Defs.FRAME_LEVEL_STAR_EMPTY,this._star.visible=o,r.Config.SCORE_SYSTEM&&(this._scoreBg.visible=this._score.visible=o,this._score.text=s.Defs.SCORE_TEXT+i.score),r.Config.DEBUG_LEVEL_NAMES){var a=this;if(!a.levelName&&n<s.Defs.LEVEL_KEYS.length){var l=new Phaser.BitmapText(this.game,e.ITEM_WIDTH/2,e.ITEM_HEIGHT-5,r.Config.FONT_TUTORIAL_TEXT,s.Defs.EMPTY_TEXT,25,"center");l.anchor.set(.5,1),a.levelName=l,this.add(l)}a.levelName&&(a.levelName.text=n+1+" - "+s.Defs.LEVEL_KEYS[n])}},e.ITEM_WIDTH=202,e.ITEM_HEIGHT=142,e}(n(8439).UIItem);e.LevelThumbItem=a},351:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectsGroup=void 0;var r=n(7709),s=function(t){function e(e,n){return t.call(this,e,n)||this}return o(e,t),e.prototype.addObject=function(t,e){var n=new r.WindSprite(this.game,t);return this.add(n),n.blendMode=e?Phaser.blendModes.ADD:Phaser.blendModes.NORMAL,n},e}(Phaser.Group);e.ObjectsGroup=s},4561:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TransitionEffect=void 0;var r=n(2178),s=n(5357),a=n(1391),l=function(t){function e(e){var n=t.call(this,e)||this;return n.onFinished=new Phaser.Signal,n._sprite=null,n._delay=0,n._currentTime=0,n._reveal=!1,n._running=!1,n._sprite=e.add.sprite(0,0,s.Config.ATLAS_COMMON,a.Defs.FRAMES_TRANSITION_EFFECT_BG,n),n._sprite.anchor.set(.5),n}return o(e,t),Object.defineProperty(e.prototype,"delay",{set:function(t){this._delay=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"running",{get:function(){return this._running},enumerable:!1,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return null===e._instance&&(e._instance=new e(r.App.game)),e._instance},enumerable:!1,configurable:!0}),e.prototype.onEffectFinished=function(){this._running=!1,0===this._sprite.alpha&&this.dettachFromParent(),this.onFinished.dispatch()},e.prototype.onShutDown=function(){this.dettachFromParent()},e.prototype.onResize=function(t,e){this._sprite.width=t,this._sprite.height=e},e.prototype.attachToParent=function(t){t.add(this)},e.prototype.dettachFromParent=function(){null!=this.parent&&this.parent.remove(this)},e.prototype.hide=function(t){this.onResize(r.App.game.width,r.App.game.height),this.attachToParent(t),this._sprite.alpha=0,this._currentTime=0,this._reveal=!1,this._running=!0},e.prototype.reveal=function(t){this.onResize(r.App.game.width,r.App.game.height),this.attachToParent(t),this._sprite.alpha=1,this._currentTime=0,this._reveal=!0,this._running=!0},e.prototype.update=function(){if(this._running){var t=Math.min(this.game.time.delta,50);if(this._delay>0)this._delay-=t;else{t*=1e3/e.DURATION,this._currentTime=Phaser.Math.clamp(this._currentTime+t/1e3,0,1);var n=this._reveal?1-this._currentTime:this._currentTime;this._sprite.alpha=Phaser.Math.linear(0,1,n),1===this._currentTime&&this.onEffectFinished()}}},e.DURATION=250,e._instance=null,e}(Phaser.Group);e.TransitionEffect=l},3033:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.AnimatedParticle=void 0;var r=function(t){function e(e,n){var i=t.call(this,e,n)||this;return void 0!==n&&null===n||(i._anims=n[0]),i}return o(e,t),e.prototype.create=function(){t.prototype.create.call(this);for(var e=this._visual,n=0;n<this._anims.length;n++){var i=this._anims[n];e.key!==i.atlasKey&&e.loadTexture(i.atlasKey);var o=e.animations.add(i.name,i.frames,i.frameRate,i.loop);!i.loop&&i.killOnComplete&&(o.killOnComplete=!0)}},e.prototype.update=function(e,n){void 0===n&&(n=!0);var i=this._delay,o=t.prototype.update.call(this,e,n);return i>0&&this._delay<=0&&this._visual.animations.currentAnim.play(),o},e.prototype.setFrame=function(t){this.setAnim(t)},e.prototype.setAnim=function(t){var e=this._visual;e.animations.stop(null,!0),this._delay<=0?e.animations.play(t):(e.animations.currentAnim=e.animations.getAnimation(t),e.frame=e.animations.currentAnim._frames[0])},e.prototype.setRandomAnim=function(){var t=this._anims[this._game.rnd.integerInRange(0,this._anims.length-1)].name;this.setAnim(t)},e}(n(5489).SpriteParticle);e.AnimatedParticle=r},7389:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Emitters=void 0;var i=n(2178),o=n(5357),r=n(7751),s=n(3033),a=n(8773),l=n(3354),h=n(5489),u=function(){function t(){this._emitters={},this._emittersFlat=[],this._params=null,this._paused=!1;var e=this.createParticleEmitter(8,t.SPRITE_COUNT,h.SpriteParticle);this._emitters[0]=e,this._emittersFlat.push(e);var n=this.createParticleEmitter(8,t.ANIMS_COUNT,s.AnimatedParticle,[r.ParticleDefs.ANIMS]);this._emitters[1]=n,this._emittersFlat.push(n),this._params=a.ParticleParams.readParams(i.App.game,r.ParticleDefs.PARAMS)}return Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return null===t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),t.prototype.createParticleEmitter=function(t,e,n,r){var s=i.App.game;return new l.SharedEmitter(s,t,e,(function(){var t=new n(s,r);return t.textureKey=o.Config.ATLAS_GAME,t.create(),t.on=!1,t}))},t.prototype.update=function(){if(!this._paused)for(var t=this._emittersFlat.length-1;t>=0;t--)this._emittersFlat[t].update()},t.prototype.onDestroy=function(){this.paused=!1;for(var t=this._emittersFlat.length-1;t>=0;t--)this._emittersFlat[t].kill()},t.prototype.loadTexture=function(t,e){this.getEmitter(t).loadTexture(e)},t.prototype.oneTime=function(t,e,n){return void 0===n&&(n=null),"object"!=typeof n&&(n=this._params[n]),this.getEmitter(t).oneTime(e,n)},t.prototype.spawn=function(t,e,n){return void 0===n&&(n=null),"object"!=typeof n&&(n=this._params[n]),this.getEmitter(t).spawn(e,n)},t.prototype.getEmitter=function(t){var e=this._emitters[t];if(null==e)throw new Error("Emitter is "+e);return e},t.prototype.toString=function(){for(var t="-------------------------------\n",e=0;e<this._emittersFlat.length;e++)t+="#"+e+": "+this._emittersFlat[e].toString()+"\n";return t},t.SPRITE_COUNT=256,t.ANIMS_COUNT=128,t._instance=null,t}();e.Emitters=u},1738:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Particle=void 0;var i=n(7748),o=n(8884),r=n(3776),s=function(){function t(e,n){this.maxVelocity=t.MAX_VELOCITY,this._lifetime=0,this._lifeTimeMax=0,this._delay=0,this._velocity=new Phaser.Point(0,0),this._angularVelocity=0,this._friction=0,this._angularDrag=0,this._gravity=0,this._gravityX=0,this._alpha=1,this._scaleChange=0,this._alphaChange=0,this._tintStart=16777215,this._tintEnd=16777215,this._tintChange=null,this._game=e}return Object.defineProperty(t.prototype,"lifetime",{set:function(t){this._lifetime=this._lifeTimeMax=t},enumerable:!1,configurable:!0}),t.prototype.toPortrait=function(t){var e;0===t.directionType&&(e=this._velocity.x,this._velocity.x=this._velocity.y,this._velocity.y=-e),e=this._gravity,this._gravity=this._gravityX,this._gravityX=-e,e=this._scaleX,this._scaleX=this._scaleY,this._scaleY=e,t.rotateIntoVelocity||(this._visual.angle-=90)},Object.defineProperty(t.prototype,"visual",{get:function(){return this._visual},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"on",{set:function(t){this._on=t,this._visual.exists=t,this._visual.visible=t},enumerable:!1,configurable:!0}),t.prototype.remove=function(){var t=this._visual.parent;t&&(t instanceof Phaser.Group?t.remove(this._visual):t.removeChild(this._visual))},t.prototype.bringToTop=function(){var t=this._visual.parent;t instanceof Phaser.Group&&t.bringToTop(this._visual)},t.prototype.sendToBack=function(){var t=this._visual.parent;t instanceof Phaser.Group&&t.sendToBack(this._visual)},Object.defineProperty(t.prototype,"textureKey",{set:function(t){this._textureKey=t},enumerable:!1,configurable:!0}),t.prototype.setScale=function(t,e,n,i,o,r){void 0===e&&(e=0);var s=this._game.rnd.realInRange(n,i),a=void 0===o?s:this._game.rnd.realInRange(o,r);this._visual.scale.set(s,a),this._scaleX=s,this._scaleY=a,this._scaleChange=e,this._scaleChangeType=t,this.updateScale(0)},t.prototype.resetScale=function(t,e){this._scaleX=t,this._scaleY=e},Object.defineProperty(t.prototype,"delay",{get:function(){return this._delay},set:function(t){this._delay=t,this.on=t<=0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{set:function(t){this._visual.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{set:function(t){this._alpha=t,this._visual.alpha=Phaser.Math.clamp(t,0,1),this.updateAlpha(0)},enumerable:!1,configurable:!0}),t.prototype.setAlphaChange=function(t,e){void 0===e&&(e=0),this._alphaChange=e,this._alphaChangeType=t},Object.defineProperty(t.prototype,"tint",{set:function(t){this._tintStart=t,this._tintChangeType=r.ParameterChangeType.NO_CHANGE,this._visual.tint=t},enumerable:!1,configurable:!0}),t.prototype.setTintChange=function(t,e,n){void 0===n&&(n=null),this._tintEnd=t,this._tintChangeType=e,this._tintChange=n},t.prototype.setPhysics=function(t,e,n,i,o,r,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===r&&(r=0),void 0===s&&(s=0),this._velocity.setTo(t,e),this._angularVelocity=n,this._friction=i,this._angularDrag=o,this._gravity=r,this._gravityX=s,this._simplePhysics=0===r&&0===s&&0===i&&0===o},Object.defineProperty(t.prototype,"velocity",{get:function(){return this._velocity},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gravity",{get:function(){return this._gravity},set:function(t){this._gravity=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gravityX",{get:function(){return this._gravityX},set:function(t){this._gravityX=t},enumerable:!1,configurable:!0}),t.prototype.loadTexture=function(t){},t.prototype.setFrame=function(t){},t.prototype.onEmit=function(t){var e=t.visualParent;this._visual.parent!==e&&(t.visualParentIsGroup?e.add(this._visual):e.addChild(this._visual))},t.prototype.onKill=function(){},t.prototype.update=function(t,e){if(void 0===e&&(e=!0),this._delay>0){if((this._delay-=t)>0)return!0;this.on=!0}if(this._lifetime>0&&(this._lifetime-=t)<=0)return!1;if(0===this._velocity.x&&0===this._velocity.y||(this._visual.x+=this._velocity.x*t,this._visual.y+=this._velocity.y*t),0!==this._angularVelocity&&(this._visual.angle+=this._angularVelocity*t),this._simplePhysics||(this._velocity.x+=(this._gravityX-this._friction*this._velocity.x)*t,this._velocity.y+=(this._gravity-this._friction*this._velocity.y)*t,this._angularVelocity+=-this._angularDrag*this._angularVelocity*t),!e)return!0;if(this._scaleChangeType!==r.ParameterChangeType.NO_CHANGE&&this.updateScale(t),this._alphaChangeType!==r.ParameterChangeType.NO_CHANGE&&this.updateAlpha(t),this._tintChangeType!==r.ParameterChangeType.NO_CHANGE&&this._lifeTimeMax>0){var n=1-this._lifetime/this._lifeTimeMax;switch(this._tintChangeType){case r.ParameterChangeType.CURVE:n=i.Curve.evaluate(n,this._tintChange)}this._visual.tint=o.ColorUtils.interpolateTint(this._tintStart,this._tintEnd,n)}return!0},t.prototype.updateAlpha=function(t){switch(this._alphaChangeType){case r.ParameterChangeType.IN_TIME:this._alpha+=this._alphaChange*t,this._alpha<0?(this._visual.alpha=0,this._alphaChange<0&&(this._alphaChangeType=r.ParameterChangeType.NO_CHANGE)):this._alpha>1?(this._visual.alpha=1,this._alphaChange>0&&(this._alphaChangeType=r.ParameterChangeType.NO_CHANGE)):this._visual.alpha=this._alpha;break;case r.ParameterChangeType.CURVE:var e=1-this._lifetime/this._lifeTimeMax,n=i.Curve.evaluateNormalized(e,this._alphaChange);this._visual.alpha=Phaser.Math.clamp(this._alpha*n,0,1);break;case r.ParameterChangeType.TO_VALUE:e=1-this._lifetime/this._lifeTimeMax;this._visual.alpha=Phaser.Math.clamp(Phaser.Math.linear(this._alpha,this._alphaChange,e),0,1);break;case r.ParameterChangeType.TO_PERCENT:e=1-this._lifetime/this._lifeTimeMax;this._visual.alpha=Phaser.Math.clamp(Phaser.Math.linear(this._alpha,this._alpha*this._alphaChange,e),0,1)}},t.prototype.updateScale=function(t){switch(this._scaleChangeType){case r.ParameterChangeType.IN_TIME:var e=this._scaleChange*t;(this._visual.scale.x+=e)<0&&(this._visual.scale.x=0,this._scaleChange<0&&(this._scaleChangeType=r.ParameterChangeType.NO_CHANGE)),(this._visual.scale.y+=e)<0&&(this._visual.scale.y=0,this._scaleChange<0&&(this._scaleChangeType=r.ParameterChangeType.NO_CHANGE));break;case r.ParameterChangeType.CURVE:var n=1-this._lifetime/this._lifeTimeMax,o=i.Curve.evaluateNormalized(n,this._scaleChange);this._visual.scale.set(this._scaleX*o,this._scaleY*o);break;case r.ParameterChangeType.TO_VALUE:n=1-this._lifetime/this._lifeTimeMax;this._visual.scale.set(Phaser.Math.linear(this._scaleX,this._scaleChange,n),Phaser.Math.linear(this._scaleY,this._scaleChange,n));break;case r.ParameterChangeType.TO_PERCENT:n=1-this._lifetime/this._lifeTimeMax;this._visual.scale.set(Phaser.Math.linear(this._scaleX,this._scaleX*this._scaleChange,n),Phaser.Math.linear(this._scaleY,this._scaleY*this._scaleChange,n))}},t.MAX_VELOCITY=1e3,t}();e.Particle=s},3776:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.ParticlesEmitter=e.ParameterChangeType=void 0;var r,s,a=n(2178),l=n(8773),h=n(4465),u=n(5489);!function(t){t[t.NONE=0]="NONE",t[t.FLOW=1]="FLOW",t[t.EXPLODE=2]="EXPLODE"}(r||(r={})),function(t){t[t.NO_CHANGE=0]="NO_CHANGE",t[t.IN_TIME=1]="IN_TIME",t[t.CURVE=2]="CURVE",t[t.TO_VALUE=3]="TO_VALUE",t[t.TO_PERCENT=4]="TO_PERCENT"}(s=e.ParameterChangeType||(e.ParameterChangeType={}));var c=function(t){function e(e,n,i,o){var s=t.call(this,e,null)||this;return s.emitterOffset=new Phaser.Point(0,0),s.emitObject=null,s.particleClass=u.SpriteParticle,s.particleBringToTop=!1,s.particleSendToBack=!1,s.period=100,s._visualParent=null,s._visualParentIsGroup=!1,s._alternativeParams=null,s._on=!1,s._mode=r.NONE,s._flowQuantity=0,s._flowTotal=0,s._flowCounter=0,s._pool=null,s._timer=0,s._emitPoint=new Phaser.Point(0,0),s._shapePoint=new Phaser.Point(0,0),s._pt=new Phaser.Point,s._callback=null,s._callbackContext=null,s._despawnDelay=0,void 0===Phaser.Circle.prototype.randomEdge&&h.PatchAreas.patch(),s._pool=o,s.visualParent=s,s._params=new l.ParticleParams(e),s.position.setTo(n,i),s}return o(e,t),Object.defineProperty(e.prototype,"params",{get:function(){return this._params},set:function(t){this._params=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visualParent",{get:function(){return this._visualParent?this._visualParent:this},set:function(t){this._visualParent=t,this._visualParentIsGroup=t instanceof Phaser.Group},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visualParentIsGroup",{get:function(){return this._visualParentIsGroup},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"despawnDelay",{set:function(t){this._despawnDelay=t},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this._params.clear()},e.prototype.setCallback=function(t,e){this._callback=t,this._callbackContext=e},e.prototype.clearCallback=function(){this._callback=this._callbackContext=null},e.prototype.updateEmitter=function(){if(this._mode===r.NONE)return this._despawnDelay>0&&(this._despawnDelay-=this.game.time.delta,!0);if(this._on&&this.game.time.time>=this._timer&&(this._timer=this.game.time.time+this.period*this.game.time.slowMotion,this._mode===r.FLOW)){if(-1!==this._flowTotal&&this._flowCounter>=this._flowTotal)return this.resetMode(),!1;for(var t=Math.max(1,this._flowQuantity),e=0;e<t&&!(this.emitParticle()&&(this._flowCounter++,-1!==this._flowTotal&&this._flowCounter>=this._flowTotal));e++);}return!0},Object.defineProperty(e.prototype,"on",{set:function(t){this._on=t,this.exists=t,this.visible=t},enumerable:!1,configurable:!0}),e.prototype.explode=function(t,e,n){this._mode=r.NONE,this.on=!0,this.emitParticles(t,e,n)},e.prototype.flow=function(t,e,n,i,o,s){void 0===e&&(e=1),void 0===n&&(n=-1),void 0===i&&(i=!0),void 0===o&&(o=null),void 0===s&&(s=null),this._mode=r.FLOW,this.on=!0,this.period=t,this._flowCounter=0,this._flowQuantity=e,this._flowTotal=n,i&&(this.emitParticles(e,o,s),this._flowCounter+=e,this._timer=this.game.time.time+t*this.game.time.slowMotion)},e.prototype.stop=function(){this.resetMode()},e.prototype.resetMode=function(){this._mode=r.NONE},e.prototype.emitParticles=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=null);for(var i=0;i<t;i++){var o=this.emitParticle();if(null===o)break;null!==e&&e.call(n,o)}},e.prototype.emitParticle=function(t){void 0===t&&(t=!1);var e=this._pool.spawn();if(!e)return null;e.on=!0;var n=null!==this._alternativeParams?this._alternativeParams:this._params;if(this.randomEmitPoint(this._emitPoint,n),e.visual.position.set(this._emitPoint.x,this._emitPoint.y),e.visual.angle=0,t)e.lifetime=-1,e.setScale(s.NO_CHANGE,0,1,1),e.visual.angle=0,e.setAlphaChange(s.NO_CHANGE),e.alpha=1,e.setPhysics();else{if(e.lifetime=this.game.rnd.realInRange(n.minLifetime,n.maxLifetime),e.delay=this.game.rnd.realInRange(n.minDelay,n.maxDelay),n.advScaleMin.x!==n.advScaleMax.x||n.advScaleMin.y!==n.advScaleMax.y)e.visual.scale.set(this.game.rnd.realInRange(n.advScaleMin.x,n.advScaleMax.x),this.game.rnd.realInRange(n.advScaleMin.y,n.advScaleMax.y)),e.setScale(n.scaleChangeType,n.scaleChange,n.advScaleMin.x,n.advScaleMax.x,n.advScaleMin.y,n.advScaleMax.y);else{var i=this.game.rnd.realInRange(n.minScale,n.maxScale);e.visual.scale.set(i,i),e.setScale(n.scaleChangeType,n.scaleChange,n.minScale,n.maxScale)}e.blendMode=n.blendMode,e.alpha=this.game.rnd.realInRange(n.minAlpha,n.maxAlpha),e.setAlphaChange(n.alphaChangeType,n.alphaChange),e.tint="number"==typeof n.tint?n.tint:n.tint[this.game.rnd.integerInRange(0,n.tint.length-1)],n.tintEnd>=0&&e.setTintChange(n.tintEnd,n.tintChangeType,n.tintChange);var o=this.game.rnd.realInRange(n.minSpeedX,n.maxSpeedX),r=void 0;if(0===n.directionType||null===n.area)r=this.game.rnd.realInRange(n.minSpeedY,n.maxSpeedY);else{var l=n.area.directionFromCenter(o,n.directionType,this._shapePoint,this._pt);o=l.x,r=l.y}e.setPhysics(o,r,this.game.rnd.realInRange(n.minAngularSpeed,n.maxAngularSpeed),n.friction,n.angularDrag,n.gravity,n.gravityX),n.rotateIntoVelocity?e.visual.angle=Phaser.Math.radToDeg(Math.atan2(r,o)):e.visual.angle=n.minAngle===n.maxAngle?n.minAngle:this.game.rnd.realInRange(n.minAngle,n.maxAngle),null!==n.frames&&e.setFrame(n.randomFrame())}return e.onEmit(this),null!==this._callback&&null!==this._callbackContext&&this._callback.call(this._callbackContext,e),this.particleBringToTop?e.bringToTop():this.particleSendToBack&&e.sendToBack(),n.orient&&!a.App.isLandscape&&e.toPortrait(n),e},e.prototype.randomEmitPoint=function(t,e){var n=this._shapePoint;return null!==e.area?e.edge?e.area.randomEdge(e.edgeInside,e.edgeOutside,n):e.area.random(n):n.setTo(0,0),t.x=n.x+this.emitterOffset.x,t.y=n.y+this.emitterOffset.y,null!==this.emitObject&&(t.x+=this.emitObject.x,t.y+=this.emitObject.y),t},Object.defineProperty(e.prototype,"area",{set:function(t){this._params.area=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gravity",{set:function(t){this._params.gravity=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gravityX",{set:function(t){this._params.gravityX=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"friction",{set:function(t){this._params.friction=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angularDrag",{set:function(t){this._params.angularDrag=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minScale",{set:function(t){this._params.minScale=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxScale",{set:function(t){this._params.maxScale=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minAngle",{set:function(t){this._params.minAngle=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxAngle",{set:function(t){this._params.maxAngle=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lifetime",{set:function(t){this._params.minLifetime=this._params.maxLifetime=t},enumerable:!1,configurable:!0}),e.prototype.setXSpeed=function(t,e){this._params.setXSpeed(t,e)},e.prototype.setYSpeed=function(t,e){this._params.setYSpeed(t,e)},e.prototype.setAngularSpeed=function(t,e){this._params.setAngularSpeed(t,e)},e.prototype.setAlpha=function(t,e){this._params.setAlpha(t,e)},e.prototype.setAlphaChange=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),this._params.setAlphaChange(t,e,n)},e.prototype.setScale=function(t,e){this._params.setScale(t,e)},e.prototype.setAdvScale=function(t,e,n,i){this._params.setAdvScale(t,e,n,i)},e.prototype.setScaleChange=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),this._params.setScaleChange(t,e,n)},e.prototype.setAngle=function(t,e){this._params.setAngle(t,e)},e.prototype.emitAt=function(t,e){this.emitterOffset.setTo(t,e)},e.prototype.emitAtObject=function(t){t.center?this.emitterOffset.setTo(t.center.x,t.center.y):this.emitterOffset.setTo(t.x,t.y)},e.MAX_PARTICELES=16,e}(Phaser.Group);e.ParticlesEmitter=c},8773:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParticleParams=void 0;var i=n(3776),o=function(){function t(t){this.area=null,this.edge=!1,this.edgeInside=0,this.edgeOutside=0,this.gravity=0,this.gravityX=0,this.minLifetime=1,this.maxLifetime=1,this.minDelay=0,this.maxDelay=0,this.minScale=1,this.maxScale=1,this.scaleChange=0,this.scaleChangeType=i.ParameterChangeType.NO_CHANGE,this.minAngle=0,this.maxAngle=0,this.rotateIntoVelocity=!1,this.minSpeedX=0,this.maxSpeedX=0,this.minSpeedY=0,this.maxSpeedY=0,this.friction=0,this.directionType=0,this.minAngularSpeed=0,this.maxAngularSpeed=0,this.angularDrag=0,this.blendMode=PIXI.blendModes.NORMAL,this.minAlpha=1,this.maxAlpha=1,this.alphaChange=0,this.alphaChangeType=i.ParameterChangeType.NO_CHANGE,this.tint=16777215,this.tintEnd=-1,this.tintChange=null,this.tintChangeType=i.ParameterChangeType.NO_CHANGE,this.frames=null,this._minAdvScale=new Phaser.Point(1,1),this._maxAdvScale=new Phaser.Point(1,1),this.orient=!1,this._game=t}return t.objectKeys=function(t){return Object.keys(t)},t.readParams=function(e,n){var i={};return t.objectKeys(n).forEach((function(o){var r=new t(e);t.doReadParams(r,n,o),i[o]=r})),i},t.doReadParams=function(e,n,i){var o=n[i];if(void 0!==o.parent&&null!==o.parent){var r=o.parent;t.doReadParams(e,n,r)}for(var s in o)"parent"!==s&&(e[s],e[s]=o[s])},t.prototype.clear=function(){this.gravity=this.gravityX=0,this.setXSpeed(0,0),this.setYSpeed(0,0),this.setAngularSpeed(0)},t.prototype.randomFrame=function(){var t=null;return null!==this.frames&&(t=Array.isArray(this.frames)?(this.frames[0],this._game.rnd.pick(this.frames)):this.frames),t},t.prototype.setXSpeed=function(t,e){t=t||0,e=e||0,this.minSpeedX=t,this.maxSpeedX=e},t.prototype.setYSpeed=function(t,e){t=t||0,e=e||0,this.minSpeedY=t,this.maxSpeedY=e},t.prototype.setAngularSpeed=function(t,e){t=t||0,e=e||0,this.minAngularSpeed=t,this.maxAngularSpeed=e},t.prototype.setAlpha=function(t,e){void 0===t&&(t=1),void 0===e&&(e=1),this.minAlpha=t,this.maxAlpha=e},t.prototype.setAlphaChange=function(t,e,n){switch(void 0===e&&(e=0),void 0===n&&(n=1),this.alphaChangeType=t,t){case i.ParameterChangeType.NO_CHANGE:this.alphaChange=0;break;case i.ParameterChangeType.IN_TIME:this.alphaChange=e/n;break;case i.ParameterChangeType.CURVE:this.alphaChange=e}},t.prototype.setTint=function(t,e){void 0===e&&(e=16777215),this.tint=t,this.tintEnd=e},t.prototype.setTintChange=function(t,e){switch(t){case i.ParameterChangeType.CURVE:this.tintChange=e}},t.prototype.setScale=function(t,e){t=t||0,e=e||0,this.minScale=t,this.maxScale=e},Object.defineProperty(t.prototype,"advScaleMin",{get:function(){return this._minAdvScale},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"advScaleMax",{get:function(){return this._maxAdvScale},enumerable:!1,configurable:!0}),t.prototype.setAdvScale=function(t,e,n,i){void 0===t&&(t=1),void 0===e&&(e=1),void 0===n&&(n=1),void 0===i&&(i=1),this._minAdvScale.setTo(t,n),this._maxAdvScale.setTo(e,i)},t.prototype.setScaleChange=function(t,e,n){switch(void 0===e&&(e=0),void 0===n&&(n=1),this.scaleChangeType=t,t){case i.ParameterChangeType.NO_CHANGE:this.scaleChange=0;break;case i.ParameterChangeType.IN_TIME:this.scaleChange=e/n;break;case i.ParameterChangeType.CURVE:this.scaleChange=e}},t.prototype.setAngle=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.minAngle=t,this.maxAngle=e},t}();e.ParticleParams=o},4465:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PatchAreas=void 0;var n=function(){function t(){}return t.patch=function(){t.pointRandom(),t.lineRandomEdge(),t.rectangleRandomEdge(),t.circleRandomEdge(),t.ellipseRandomEdge(),t.pointRandomEdge(),t.lineDirectionFromCenter(),t.rectangelDirectionFromCenter(),t.circleDirectionFromCenter(),t.ellipseDirectionFromCenter(),t.pointDirectionFromCenter()},t.pointRandom=function(){Phaser.Point.prototype.random=function(t){return t.x=this.x,t.y=this.y,t}},t.lineRandomEdge=function(){Phaser.Line.prototype.randomEdge=function(t,e,n){this.random(n);var i=(t*=-1)+Math.random()*(e-t);return n.add(this.normalX*i,this.normalY*i),n}},t.rectangleRandomEdge=function(){Phaser.Rectangle.prototype.randomEdge=function(t,e,n){var i=Math.random()>=.5?-1:1,o=Math.random()>=.5?-1:1;return Math.random()*(this.width+this.height)<=this.width?(n.x=Math.random()*(this.halfWidth+e)*i,n.y=(Math.random()*(e+t)+(this.halfHeight-t))*o):(n.x=(Math.random()*(e+t)+(this.halfWidth-t))*i,n.y=Math.random()*(this.halfHeight+e)*o),n.x+=this.centerX,n.y+=this.centerY,n}},t.circleRandomEdge=function(){Phaser.Circle.prototype.randomEdge=function(t,e,n){var i=2*Math.PI*Math.random(),o=Math.random()+Math.random(),r=Phaser.Math.mapLinear(o>1?2-o:o,0,1,this.radius-t,this.radius+e);return n.x=this.x+r*Math.cos(i),n.y=this.y+r*Math.sin(i),n}},t.ellipseRandomEdge=function(){Phaser.Ellipse.prototype.randomEdge=function(t,e,n){var i=this.width/2,o=this.height/2,r=2*Math.PI*Math.random(),s=Math.random()+Math.random(),a=s>1?2-s:s,l=Phaser.Math.mapLinear(a,0,1,i-t,i+e),h=Phaser.Math.mapLinear(a,0,1,o-t,o+e);return n.x=this.x+i+l*Math.cos(r),n.y=this.y+o+h*Math.sin(r),n}},t.pointRandomEdge=function(){Phaser.Point.prototype.randomEdge=function(t,e,n){return this.random(n)}},t.lineDirectionFromCenter=function(){Phaser.Line.prototype.directionFromCenter=function(e,n,i,o){var r=t.getDirFromType(n);return o.x=this.normalX*r*e,o.y=this.normalY*r*e,o}},t.rectangelDirectionFromCenter=function(){Phaser.Rectangle.prototype.directionFromCenter=function(e,n,i,o){return t.getVelocity(e,n,this.centerX,this.centerY,i.x,i.y,o)}},t.circleDirectionFromCenter=function(){Phaser.Circle.prototype.directionFromCenter=function(e,n,i,o){return t.getVelocity(e,n,this.x,this.y,i.x,i.y,o)}},t.ellipseDirectionFromCenter=function(){Phaser.Ellipse.prototype.directionFromCenter=function(e,n,i,o){return t.getVelocity(e,n,this.centerX,this.centerY,i.x,i.y,o)}},t.pointDirectionFromCenter=function(){Phaser.Point.prototype.directionFromCenter=function(t,e,n,i){var o=2*Math.random()*Math.PI;return i.x=Math.cos(o)*t,i.y=Math.sin(o)*t,i}},t.getVelocity=function(e,n,i,o,r,s,a){var l=Math.atan2(s-o,r-i),h=t.getDirFromType(n)*e;return a.x=Math.cos(l)*h,a.y=Math.sin(l)*h,a},t.getDirFromType=function(t){return 1===t?1:2===t?-1:0},t}();e.PatchAreas=n},3354:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SharedEmitter=void 0;var i=n(6037),o=n(3776),r=function(){function t(e,n,r,s){this._game=null,this._ptcPool=null,this._oneTimeEmitter=null,this._emittersPool=null,this._game=e;var a=new i.UnorderedArrayPool(null,r,s);this._ptcPool=a,t.nameCount=0,this._oneTimeEmitter=new o.ParticlesEmitter(e,0,0,this._ptcPool),this._emittersPool=new i.UnorderedArrayPool(null,n,(function(){var n=new o.ParticlesEmitter(e,0,0,a);return n.name="Emitter "+t.nameCount,++t.nameCount,n}))}return t.prototype.oneTime=function(t,e){return void 0===e&&(e=null),this.setupEmitter(this._oneTimeEmitter,t,e)},t.prototype.spawn=function(t,e){void 0===e&&(e=null);var n=this._emittersPool.spawn();return n?(this.setupEmitter(n,t,e),n):null},t.prototype.setupEmitter=function(t,e,n){return null===e&&(e=t),t.visualParent=e,t.scale.set(1),t.angle=0,t.emitObject=null,t.despawnDelay=0,null!==n&&(t.params=n),t},t.prototype.update=function(){var t=this;this._emittersPool.iterate((function(e){e.updateEmitter()||(t.removeEmitterFromParent(e),t._emittersPool.despawn(e))}));for(var e=this._ptcPool.data,n=this._game.time.delta/1e3,i=this._ptcPool.size-1;i>=0;i--){var o=e[i];o.update(n)||(o.on=!1,o.remove(),this._ptcPool.despawnAt(i))}},t.prototype.kill=function(){for(var t=this,e=this._ptcPool.size-1;e>=0;e--)this._ptcPool.despawnAt(e);var n=this._ptcPool.freeItems;for(e=this._ptcPool.capacity-1;e>=0;e--){var i=n[e];i.on=!1,i.remove()}this.removeEmitterFromParent(this._oneTimeEmitter),this._emittersPool.iterate((function(e){e.resetMode(),t.removeEmitterFromParent(e),t._emittersPool.despawn(e)}))},t.prototype.removeEmitterFromParent=function(t){var e=t.parent;null!=e&&(e instanceof Phaser.Group?e.remove(t):e.removeChild(t))},t.prototype.loadTexture=function(t){this._ptcPool.isEmpty||this.kill();for(var e=this._ptcPool.freeItems,n=e.length-1;n>=0;n--)e[n].loadTexture(t)},t.prototype.toString=function(){var t=this._ptcPool.size,e=this._ptcPool.free;return"total: "+(t+e)+", allocated: "+t+", free: "+e},t.nameCount=0,t}();e.SharedEmitter=r},5489:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.SpriteParticle=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.loadTexture=function(t){this._visual.loadTexture(t)},e.prototype.setFrame=function(t){var e=this._visual;"string"==typeof t?e.frameName=t:e.frame=t},e.prototype.create=function(){var t=new Phaser.Sprite(this._game,0,0,this._textureKey);t.anchor.setTo(.5,.5),this._visual=t},e}(n(1738).Particle);e.SpriteParticle=r},6273:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.PathSeal=void 0;var r=n(5357),s=n(1391),a=n(4455),l=n(6020),h=n(7389),u=n(7446),c=n(726),p=n(5714),_=function(t){function e(n){var i=t.call(this,n)||this;return i._time=0,i._timeScale=0,i._roots=null,i._dirt=null,i._emitter=null,i._stoneCrop=null,i._stoneHeight=0,i._active=!1,i._timeScale=1e3/e.DURATION_MS,i.visible=i.exists=!1,i}return o(e,t),Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pathDistance",{get:function(){return this._pathDistance},set:function(t){this._pathDistance=t},enumerable:!1,configurable:!0}),e.prototype.activate=function(){this._active||(this._roots=this.createRoots(),this._emitter=h.Emitters.instance.spawn(0,this,102),null!==this._emitter&&(this._emitter.emitAt(0,0),this._emitter.despawnDelay=1e3,this._emitter.flow(50,4)),c.Shaker.instance.createShake(this.game.camera,u.BounceShake,c.ShakerNotAffected.Rotation).init(a.ShakeDefs.SEAL_SHAKE),this.visible=this.exists=!0,this._active=!0,l.AudioUtils.playAudioRecord(s.Defs.SFX_PATH_SEAL))},e.prototype.createRoots=function(){var t=p.Tasks.instance.spritesPool.spawn();return t.init(),t.loadFrame(s.Defs.FRAMES_SEAL[0],r.Config.ATLAS_GAME),t.position.set(0,0),this.add(t),t},e.prototype.onKill=function(){null!==this._roots&&(this._roots.crop(null,!1),this._roots.onKill()),null!==this._dirt&&this._dirt.onKill(),this.killEmitter()},e.prototype.killEmitter=function(){null!==this._emitter&&(this._emitter.stop(),this._emitter=null)},e.prototype.updatePathSeal=function(t){this._active&&1!==this._time&&(this._time=Math.min(this._time+t*this._timeScale,1),this.updateRoots(this._time),1===this._time&&this.killEmitter())},e.prototype.updateRoots=function(t){var e=Math.floor(t*(s.Defs.FRAMES_SEAL.length-1));this._roots.frameName=s.Defs.FRAMES_SEAL[e]},e.DURATION_MS=1500,e}(Phaser.Group);e.PathSeal=_},1822:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.PowerupItem=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(9071),h=n(8298),u=function(t){function e(e,n,i,o){var r=t.call(this,e,n)||this;return r.onClick=new Phaser.Signal,r.onOver=new Phaser.Signal,r._itemFrame=null,r._itemFrameSelected=null,r._key=null,r._item=null,r._starsPanel=null,r._available=!1,r._onLevelZero=!1,r._key=i,r.createItem(),r.createStarsPanel(o),r}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"world",{get:function(){return this._item.world},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"available",{get:function(){return this._available},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onLevelZero",{get:function(){return this._onLevelZero},enumerable:!1,configurable:!0}),e.prototype.createItem=function(){var t=a.Defs.POWERUPS[this._key];this._itemFrame=t.shopFrame,this._itemFrameSelected=t.shopFrameSelected;var n=this.game.add.sprite(0,0,s.Config.ATLAS_POWERUPS,t.shopFrame,this);n.anchor.set(.5),n.hitArea=new Phaser.Circle(0,0,2*e.HIT_RADIUS),n.events.onInputUp.add(this.onItemClick,this),n.events.onInputOver.add(this.onItemOver,this),n.events.onInputOut.add(this.onItemOut,this),this._item=n},e.prototype.createStarsPanel=function(t){var e=new h.PowerupStarsPanel(this.game);e.position.set(0,t),this.add(e),this._starsPanel=e},e.prototype.onItemClick=function(t,e,n){n&&this.onClick.dispatch(this,e)},e.prototype.onItemOver=function(t,e){this.onOver.dispatch(this,!0)},e.prototype.onItemOut=function(t,e){this.onOver.dispatch(this,!1)},e.prototype.setup=function(t,e){a.Defs.POWERUPS[this._key].availableFrom>t&&!s.Config.DEBUG_UNLOCK_ALL_POWERUPS?(this._available=!1,this._onLevelZero=!0,this._starsPanel.visible=!1,this._item.tint=0,this.enableInput(!1)):(this._available=!0,this._onLevelZero=0===e,this._starsPanel.visible=!0,this._starsPanel.setLevel(e),this._item.tint=16777215,this.enableInput(!0))},e.prototype.highlight=function(t){this._available&&(this._item.frameName=t?this._itemFrameSelected:this._itemFrame)},e.prototype.enableInput=function(t){this._item.inputEnabled=t},e.prototype.isNew=function(){if(!this._available)return!1;var t=a.Defs.POWERUPS[this._key].tutorialFlag;return t!==l.TutorialFlag.None&&!r.App.settings.isTutorialShown(t)&&(r.App.settings.setTutorialShown(t),!0)},e.HIT_RADIUS=80,e}(Phaser.Group);e.PowerupItem=u},4063:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.PowerupStars=void 0;var r=n(5357),s=n(9820),a=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i._num=null,i._icon=null,i.createNum(),i.createIcon(),i}return o(e,t),e.prototype.createNum=function(){var t=new s.AdvancedBitmapText(this.game,0,-10,r.Config.FONT_POWERUPS_STARS_TEXT,"",r.Config.FONT_POWERUPS_STARS_TEXT_SIZE,"left");t.anchor.set(0,.5),this.add(t),this._num=t},e.prototype.createIcon=function(){var t=this.game.add.sprite(0,0,r.Config.ATLAS_POWERUPS,"pwStarsIcon",this);t.anchor.set(.5),this._icon=t},e.prototype.setLayout=function(){var t=this._num.textWidth,n=this._icon.width,i=-(t+e.SPACING+n)/2;i+=10,this._num.x=i,i+=t+e.SPACING,this._icon.x=i+n/2},Object.defineProperty(e.prototype,"stars",{set:function(t){this._num.text=t.toString(),this.setLayout()},enumerable:!1,configurable:!0}),e.SPACING=10,e}(Phaser.Group);e.PowerupStars=a},8298:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.PowerupStarsPanel=void 0;var r=n(5357),s=n(1391),a=function(t){function e(e){var n=t.call(this,e,0,0,r.Config.ATLAS_POWERUPS)||this;return n.anchor.set(.5,0),n}return o(e,t),e.prototype.setLevel=function(t){this.frameName=s.Defs.FRAMES_POWERUPS_STARS[t]},e}(Phaser.Sprite);e.PowerupStarsPanel=a},800:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s},s=this&&this.__spreadArray||function(t,e){for(var n=0,i=e.length,o=t.length;n<i;n++,o++)t[o]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.PowerupTextPanel=void 0;var a=n(2178),l=n(5357),h=n(1391),u=n(9820),c=n(5341),p=n(5421),_=n(2757),f=function(t){function e(n,i){var o=t.call(this,n,i)||this;return o._panel=null,o._text=null,null===e._textCache&&(e._textCache=new c.TextCache),o.createPanel(),o.createText(),o.setLayout(),o}return o(e,t),e.prototype.createPanel=function(){var t=this.game.add.sprite(0,0,l.Config.ATLAS_POWERUPS,"pwTextBox",this);t.anchor.set(.5),this._panel=t},e.prototype.createText=function(){var t="ja"===a.App.settings.currentLanguage?l.Config.FONT_POWERUPS_TEXT_SIZE_JA:l.Config.FONT_POWERUPS_TEXT_SIZE,e=new u.AdvancedBitmapText(this.game,0,0,l.Config.FONT_POWERUPS_TEXT,"",t,"left");e.anchor.set(.5,.5),e.colors=h.Defs.TEXT_COLORS,this.add(e),this._text=e},e.prototype.setLayout=function(){this._text.maxWidth=a.App.isLandscape?this._panel.width:this._panel.width-460},e.prototype.displayText=function(t,e){this._text.text=this.getText(t,e)},e.prototype.clearText=function(){this._text.text=h.Defs.EMPTY_TEXT},e.prototype.getText=function(t,n){var i=h.Defs.POWERUPS[t];if(void 0===i)return null;var o=i.levels[n],a=e._textCache.getTextID(o.textID);return a||(a=p.StringUtils.format.apply(p.StringUtils,s([_.TextUtils.getText(o.textID)],r(o.values))),e._textCache.setText(o.textID,a)),a},e.BORDER_HOR=24,e.BORDER_VERT=14,e._textCache=null,e}(Phaser.Group);e.PowerupTextPanel=f},6403:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.PowerupsPanel=void 0;var s=n(5357),a=n(1391),l=n(9820),h=n(2757),u=n(1822),c=function(t){function e(e,n,i){var o=t.call(this,e,n)||this;return o._items=[],o._title=null,o.createItems(i),o.createTitle(i),o.setLayout(i),o}return o(e,t),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.createItems=function(t){for(var e=t.items,n=0;n<t.items.length;n++){var i=e[n],o=new u.PowerupItem(this.game,this,i.key,t.starsPanelOffsetY);this._items.push(o)}},e.prototype.createTitle=function(t){var e=h.TextUtils.getText(t.titleID),n=new l.AdvancedBitmapText(this.game,0,0,s.Config.FONT_POWERUPS_PANEL_TEXT,e,s.Config.FONT_POWERUPS_PANEL_TEXT_SIZE,"center");n.anchor.set(.5,.5),n.tint=a.Defs.COLOR_POWERUPS_PANEL_TITLE,this.add(n),this._title=n},e.prototype.setLayout=function(t){this._title.y=t.titleOffsetY;for(var e=0;e<this._items.length;e++){var n=t.items[e];this._items[e].position.set(n.x,n.y)}},e.prototype.hasNew=function(){var t,e;try{for(var n=r(this._items),i=n.next();!i.done;i=n.next()){var o=i.value;if(o.isNew())return o}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null},e}(Phaser.Group);e.PowerupsPanel=c},7446:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.BounceShake=void 0;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._params=null,e._bounceIdx=0,e._direction=new Phaser.Point,e._currentPoint=new Phaser.Point,e._prevPoint=new Phaser.Point,e._currentAngle=0,e._previousAngle=0,e}return o(e,t),e.prototype.init=function(t,e){this._params=t;var n=void 0===e?Math.random()*Math.PI*2:e;this._direction.set(Math.cos(n),Math.sin(n)),this._currentPoint.copyFrom(this._direction).multiply(this._params.strengthPos,this._params.strengthPos),this._currentAngle=(2*Math.random()-1)*this._params.strengthAngle},e.prototype.reset=function(){t.prototype.reset.call(this),this._time=0,this._bounceIdx=0,this._prevPoint.set(0,0),this._previousAngle=0},e.prototype.kill=function(){this.parentPool.despawn(this)},e.prototype.update=function(t){var e=this._params;this._time+=t*e.frequency;var n=0===e.frequency?1:Math.min(this._time,1),i=Phaser.Easing.Quadratic.InOut(n);if(this._shakeX=Phaser.Math.linear(this._prevPoint.x,this._currentPoint.x,i),this._shakeY=Phaser.Math.linear(this._prevPoint.y,this._currentPoint.y,i),this._shakeRot=Phaser.Math.linear(this._previousAngle,this._currentAngle,i),this._time>=1){if(++this._bounceIdx,this._bounceIdx>e.bounces)return this._shakeX=this._currentPoint.x,this._shakeY=this._currentPoint.y,this._shakeRot=this._currentAngle,void(this.finished=!0);this._time=0,this._prevPoint.copyFrom(this._currentPoint),this._previousAngle=this._currentAngle;var o=Math.random()*Math.PI*2;this._direction.set(-this._direction.x+e.randomness*Math.cos(o),-this._direction.y+e.randomness*Math.sin(o)),this._direction.normalize();var r=1-this._bounceIdx/e.bounces,s=r*r*e.strengthPos;this._currentPoint.copyFrom(this._direction).multiply(s,s),this._currentAngle=-Phaser.Math.sign(this._currentAngle)*e.strengthAngle*r*(1-e.randomness+Math.random()*e.randomness)}},e}(n(9460).ShakeBase);e.BounceShake=r},7883:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.PerlinShake=void 0;var s=n(7748),a=n(2516),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._params=null,e._seeds=[],e}return o(e,t),e.prototype.init=function(t,e){this._params=t,this._duration=e,this._nosieNormalized=this.calcNoiseNormalized(t),this.createSeeds(t),this.initSeeds()},e.prototype.calcNoiseNormalized=function(t){var e,n,i=0;try{for(var o=r(t.octaves),s=o.next();!s.done;s=o.next()){i+=s.value.amplitude}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return i},e.prototype.createSeeds=function(t){for(var e=0;e<t.octaves.length-this._seeds.length;e++)this._seeds.push(new Phaser.Point)},e.prototype.initSeeds=function(){var t,e;try{for(var n=r(this._seeds),i=n.next();!i.done;i=n.next()){i.value.set(10*Math.random(),10*Math.random())}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.reset=function(){t.prototype.reset.call(this),this._time=0},e.prototype.kill=function(){this.parentPool.despawn(this)},e.prototype.update=function(t){this._time=Math.min(this._time+t,this._duration);var e=1;if(this._params.envelopeCurve){var n=this._time/this._duration;e=s.Curve.evaluateNormalized(n,this._params.envelopeCurve)}for(var i=0,o=0,r=0,l=0;l<this._params.octaves.length;l++){var h=this._params.octaves[l],u=h.amplitude,c=h.frequency,p=this._seeds[l];i+=a.Perlin.perlin2(p.x+this._time*c,p.y)*u,o+=a.Perlin.perlin2(p.x,p.y+this._time*c)*u,this._params.strengthAngle>0&&(r+=a.Perlin.perlin2(p.x+this._time*c,p.y+this._time*c))}this._shakeX=i/this._nosieNormalized*e*this._params.strengthX,this._shakeY=o/this._nosieNormalized*e*this._params.strengthY,this._shakeRot=r*e*this._params.strengthAngle,this.finished=this._time===this._duration},e}(n(9460).ShakeBase);e.PerlinShake=l},9460:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ShakeBase=void 0;var n=function(){function t(){this._shakeX=0,this._shakeY=0,this._shakeRot=0,this._finished=!1,this._parentPool=null}return Object.defineProperty(t.prototype,"shakeX",{get:function(){return this._shakeX},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shakeY",{get:function(){return this._shakeY},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shakeRot",{get:function(){return this._shakeRot},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"finished",{get:function(){return this._finished},set:function(t){this._finished=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentPool",{get:function(){return this._parentPool},set:function(t){this._parentPool=t},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this._finished=!1,this._shakeX=0,this._shakeY=0,this._shakeRot=0},t}();e.ShakeBase=n},726:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Shaker=e.ShakerNotAffected=void 0;var i,o=n(2178),r=n(7857),s=n(6037);!function(t){t[t.Nothing=0]="Nothing",t[t.Position=1]="Position",t[t.Rotation=2]="Rotation"}(i=e.ShakerNotAffected||(e.ShakerNotAffected={}));var a=function(){function t(){}return Object.defineProperty(t.prototype,"x",{get:function(){return this.camera.view.x+this.camera.view.halfWidth},set:function(t){this.camera.view.x=t-this.camera.view.halfWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.camera.view.y+this.camera.view.halfHeight},set:function(t){this.camera.view.y=t-this.camera.view.halfHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this.world.angle},set:function(t){this.world.angle=t},enumerable:!1,configurable:!0}),t}(),l=function(){this.shakes=new r.UnorderedArray},h=function(){function t(){this._game=null,this._slotsPool=null,this._pools=null,this._cameraWrapper=null,this._game=o.App.game,this._cameraWrapper=new a,this._slotsPool=new s.UnorderedArrayPool(l,2),this._slotsPool.canGrow=!0,this._pools=new Map}return Object.defineProperty(t,"instance",{get:function(){return null===t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),t.prototype.createShake=function(t,e,n){if(void 0===n&&(n=i.Nothing),!this._pools.has(e)){var o=this.createShakePool(e);this._pools.set(e,o)}var r=this._pools.get(e),s=r.spawn();if(!s)throw new Error("Couldn't spawn shake of type "+e.name);s.parentPool=r,s.reset();var a=t===this._game.camera?this._cameraWrapper:t;return a===this._cameraWrapper&&(this._cameraWrapper.camera=this._game.camera,this._cameraWrapper.world=this._game.world),this.getSlot(a,n).shakes.add(s),s},t.prototype.createShakePool=function(t){var e=new s.UnorderedArrayPool(t,1);return e.canGrow=!0,e},t.prototype.getSlot=function(t,e){var n=this,i=null;if(this._slotsPool.iterate((function(e){e.target===t&&(i=e,n._slotsPool.stopIterate())})),!i){if(!(i=this._slotsPool.spawn()))throw new Error("Couldn't spawn shaker slot");i.target=t,i.oldX=t.x,i.oldY=t.y,i.oldAngle=t.angle,i.notAffected=e}return i},t.prototype.update=function(t){var e=this;0!==this._slotsPool.size&&this._slotsPool.iterate((function(n){e.updateSlot(n,t),0===n.shakes.size&&(e.restoreValues(n),e._slotsPool.despawn(n))}))},t.prototype.updateSlot=function(t,e){var n=t.oldX,o=t.oldY,r=t.oldAngle;t.shakes.iterate((function(i){i.update(e),n+=i.shakeX,o+=i.shakeY,r+=i.shakeRot,i.finished&&(i.kill(),t.shakes.remove(t.shakes.currentItem))})),t.notAffected!==i.Position&&(t.target.x=n,t.target.y=o),t.notAffected!==i.Rotation&&(t.target.angle=r)},t.prototype.kill=function(){var t=this;this._slotsPool.iterate((function(e){t.killSlot(e),t._slotsPool.despawn(e)}))},t.prototype.killSlot=function(t){this.restoreValues(t),t.shakes.iterate((function(e){e.kill(),t.shakes.remove(t.shakes.currentItem)}))},t.prototype.restoreValues=function(t){t.notAffected!==i.Position&&(t.target.x=t.oldX,t.target.y=t.oldY),t.notAffected!==i.Rotation&&(t.target.angle=t.oldAngle)},t.prototype.debug=function(t){this._slotsPool;this._pools.forEach((function(t,e){}))},t._instance=null,t}();e.Shaker=h},7113:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpeedManager=void 0;var i=n(2178),o=n(5357),r=n(1391),s=n(713),a=n(712),l=function(){function t(t,e){this._level=null,this._chain=null,this._speed=0,this._spawnTime=0,this._slowTime=0,this._freezeTime=0,this._deltaCoef=1,this._deltaCoefTarget=1,this._spawnCoef=1,this._spawnStep=0,this._currentStep=0,this._chain=t,this._speed=o.Config.CHAIN_SPEED,this._level=e}return Object.defineProperty(t.prototype,"backRunning",{get:function(){return this._deltaCoef<0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spawnRunning",{get:function(){return this._spawnTime>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"slowRunning",{get:function(){return this._slowTime>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"freezeRunning",{get:function(){return this._freezeTime>0},enumerable:!1,configurable:!0}),t.prototype.getDistance=function(t){return t?this._spawnStep:this._currentStep},t.prototype.handleNewWave=function(t,e){this._speed=o.Config.CHAIN_SPEED*(this._level.isMultichain?o.Config.CHAIN_MULTI_COEF:1),this._spawnCoef=1,this._spawnTime=0;var n=e*a.Ball.DIAMETER,i=o.Config.CHAIN_NEW_WAVE_DIST_FAST_RIDE/this._level.chains.length*this._chain.path.pathLength;i=Math.min(i,n),(-1===t||t>i*o.Config.CHAIN_NEW_WAVE_CANCEL_FAST_RIDE)&&(this._spawnCoef=o.Config.CHAIN_SPEED_NEW_WAVE_COEF,this._spawnTime=i/(this._speed*this._spawnCoef))},t.prototype.handleBack=function(){var t=i.App.settings.getPowerupLevel(8);t=Math.max(t,1),this._deltaCoef=r.Defs.POWERUPS[8].levels[t].values[0],this._chain.forceRemove=!0},t.prototype.handleFreeze=function(){var t=i.App.settings.getPowerupLevel(7);t=Math.max(t,1);var e=r.Defs.POWERUPS[7].levels[t].values[0];this._freezeTime=e,this.resetDeltaCoef()},t.prototype.handleSlow=function(){var t=i.App.settings.getPowerupLevel(6);t=Math.max(t,1);var e=r.Defs.POWERUPS[6].levels[t].values[0];this._slowTime=e,this.resetDeltaCoef()},t.prototype.update=function(e){var n=t.SPEED_CHANGE;if(this.resetDeltaCoef(),this.backRunning?n=t.SPEED_CHANGE_BACK:this.freezeRunning?this._freezeTime-=e:this.slowRunning&&(this._slowTime-=e),this._deltaCoef=s.MathHelp.moveTowards(this._deltaCoef,this._deltaCoefTarget,n*e),this.spawnRunning)this._spawnTime-=e;else{var i=t.SPEED_CHANGE_SPAWN*e;Math.abs(this._spawnCoef-this._deltaCoef)>i?this._spawnCoef=Phaser.Math.linear(this._spawnCoef,this._deltaCoef,1-Math.pow(2,-3*e)):this._spawnCoef=s.MathHelp.moveTowards(this._spawnCoef,this._deltaCoef,i)}this._spawnStep=this._speed*e*this._spawnCoef,this._currentStep=this._speed*e*this._deltaCoef},t.prototype.resetDeltaCoef=function(){this.freezeRunning?this._deltaCoefTarget=0:this.slowRunning?this._deltaCoefTarget=o.Config.CHAIN_SLOW_COEF:this._deltaCoefTarget=1},t.SPEED_CHANGE=1,t.SPEED_CHANGE_BACK=2,t.SPEED_CHANGE_SPAWN=1,t}();e.SpeedManager=l},6023:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.StarDust=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(6020),h=n(712),u=n(7389),c=n(3627),p=n(5714),_=function(t){function e(e,n){var i=t.call(this,e,0,0,s.Config.ATLAS_GAME,0)||this;i._level=null,i._active=!1,i._canPick=!1,i._nextTime=0,i._distSq=0,i._smokeEmitter=null,i._posX=null,i._posY=null,i._level=n,i._active=r.App.settings.hasLevelFreeStarDust(n.id),i.anchor.set(.5),i.addAnimations(),i.exists=i.visible=!1,i._active;var o=.75*h.Ball.DIAMETER;return i._distSq=o*o,i.setWaiting(),i}return o(e,t),Object.defineProperty(e.prototype,"canPick",{get:function(){return this._canPick},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"positions",{set:function(t){this._posX=t.x,this._posY=t.y},enumerable:!1,configurable:!0}),e.prototype.render=function(){if(this._posX)for(var t=new Phaser.Circle(0,0),e=0;e<this._posX.length;e++)t.setTo(this._posX[e],this._posY[e],7),this.game.debug.geom(t,"RGBA(255,255,255,1)",!0)},e.prototype.addAnimations=function(){this._active&&(this.animations.add(e.ANIM_SHOW,a.Defs.FRAMES_STARDUST_SHOW,16,!1).onComplete.add(this.onShowComplete,this),this.animations.add(e.ANIM_IDLE,a.Defs.FRAMES_STARDUST_IDLE,8,!0),this.animations.add(e.ANIM_HIDE,a.Defs.FRAMES_STARDUST_HIDE,16,!1).onComplete.add(this.onHideComplete,this))},e.prototype.onShowComplete=function(){this.scale.set(1),this.animations.play(e.ANIM_IDLE)},e.prototype.onHideComplete=function(){this.parent.remove(this),this.visible=this.exists=!1},e.prototype.show=function(){this._nextTime=this._level.timePlaying+s.Config.STARDUST_DURATION;var t=this.game.rnd.integerInRange(0,this._posX.length-1);this.position.set(this._posX[t],this._posY[t]),this._level.topBalls.add(this),this.visible=this.exists=!0,this._canPick=!0,this.angle=r.App.isLandscape?0:-90,this.scale.set(2),this.animations.play(e.ANIM_SHOW),l.AudioUtils.playAudioRecord(a.Defs.SFX_STARDUST_SHOW)},e.prototype.hide=function(){this.scale.set(2),this.animations.play(e.ANIM_HIDE)},e.prototype.checkCollision=function(t){var e=Phaser.Math.distanceSq(this.x,this.y,t.x,t.y)<this._distSq;return e&&(this.animatePick(),this._canPick=!1,l.AudioUtils.playAudioRecord(a.Defs.SFX_STARDUST_PICK)),e},e.prototype.pick=function(){var t=r.App.settings.onStarDustPicked(this._level.id);this.onHideComplete(),this.setWaiting(),this._active=r.App.settings.hasLevelFreeStarDust(this._level.id),this._active,l.AudioUtils.playAudioRecord(a.Defs.SFX_STARDUST_HUD),this._level.HUD.starDust.onPicked(t)},e.prototype.animatePick=function(){this._level.effectsLayerTop.add(this);var t=u.Emitters.instance.spawn(0,this._level.effectsLayerTopUnder,32);t&&(t.position.set(this.x,this.y),t.emitAt(0,0),t.emitObject=this,t.despawnDelay=1e3,t.flow(20,1),this._smokeEmitter=t);var e=this._level.HUD.starDust.position,n=e.x,i=e.y;if(!r.App.isLandscape){var o=n;n=i,i=-o}var s=p.Tasks.instance.createTask(c.TaskCurveMover),a=Phaser.Point.distance(e,this.position),l=a>0?Phaser.Math.mapLinear(a,0,1e3,.3,2):0;s.reset(),s.target(this).endPosition(n,i).duration(l).easing(Phaser.Easing.Sinusoidal.Out).branching(.66,.25).onEnd(this),s.start()},e.prototype.onTaskComplete=function(t){this._smokeEmitter&&(this._smokeEmitter.stop(),this._smokeEmitter=null),this.pick()},e.prototype.setWaiting=function(){this._nextTime=this._level.timePlaying+this.game.rnd.integerInRange(s.Config.STARDUST_WAITING_MIN,s.Config.STARDUST_WAITING_MAX)},e.prototype.updateStarDust=function(){this._active&&(this.visible?this._canPick&&this.updateTime()&&(this.hide(),this._canPick=!1,this.setWaiting()):this.updateTime()&&this.show())},e.prototype.updateTime=function(){return this._level.timePlaying>=this._nextTime},e.ANIM_SHOW="show",e.ANIM_IDLE="idle",e.ANIM_HIDE="hide",e}(Phaser.Sprite);e.StarDust=_},7278:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TaskBase=void 0;var n=function(){function t(t){this._game=null,this._finished=!1,this._parentPool=null,this._game=t}return Object.defineProperty(t.prototype,"finished",{get:function(){return this._finished},set:function(t){this._finished=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentPool",{get:function(){return this._parentPool},set:function(t){this._parentPool=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this._finished=!1,this._flags=0,this._id=0},t}();e.TaskBase=n},8519:function(t,e,n){"use strict";var i,o,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskBonusPopup=void 0;var s=n(2178),a=n(5357),l=n(1391),h=n(7215),u=n(4525),c=function(t){function e(n){var i=t.call(this,n)||this;return i._level=null,i._popBg=null,i._pop=null,i._running=!1,i._hlpPt=new Phaser.Point,i._popBg=i.createPopBg(),i._pop=i.createPop(),i._popBg.attachToNode(i._pop,e.CONTAINER_NAME,3),i}return r(e,t),e.prototype.createPopBg=function(){var t=new u.DSDEntity(this._game,l.Defs.ANIM_POP_BG,a.Config.ATLAS_HUD,null);return t.onFinished.add(this.onFinished,this),t.onEvent.add(this.onEvent,this),t},e.prototype.createPop=function(){return new u.DSDEntity(this._game,l.Defs.ANIM_POP,a.Config.ATLAS_HUD,null)},e.prototype.init=function(t,n,i,o,r,a){this._level=t,this._powerupID=r;var l=this.calcPosition(n,i,o);this._popBg.position.set(l.x,l.y),this._popBg.angle=s.App.isLandscape?0:-90,a.add(this._popBg);var h=e.POWERID_TO_ANIM[r];if(!h)throw new Error("Invalid powerupID.");this._pop.setAnim(h),this._popBg.play("Show"),this._running=!0},e.prototype.calcPosition=function(t,n,i){var o=(a.Config.GAME_WIDTH-e.POP_WIDTH)/2,r=(a.Config.GAME_HEIGHT-e.POP_HEIGHT)/2,s=Phaser.Math.degToRad(i)-Math.PI/2,l=Math.cos(s)*e.SIGN_OFFSET,h=Math.sin(s)*e.SIGN_OFFSET;return(t+l>o||t+l<-o)&&(l*=-1),(n+h>r||n+h<-r)&&(h*=-1),this._hlpPt.set(t+l,n+h),this._hlpPt},e.prototype.onFinished=function(t){this._running=!1},e.prototype.onEvent=function(t,e,n){0===n&&(this._pop.paused=!1,h.AudioUtils.playAudioRecord(l.Defs.POWERID_TO_SFX_KEY[this._powerupID]))},e.prototype.removeFromParent=function(){this._popBg.parent&&(this._popBg.parent instanceof Phaser.Group?this._popBg.parent.remove(this._popBg):this._popBg.parent.removeChild(this._popBg))},e.prototype.kill=function(){this._running=!1,this.removeFromParent(),this.parentPool.despawn(this)},e.prototype.update=function(t){return!!this._running&&(this._level.hasBlockingTask||(this._popBg.updateAnim(),this._pop.updateAnim()),!0)},e.POP_WIDTH=120,e.POP_HEIGHT=70,e.SIGN_OFFSET=70,e.CONTAINER_NAME="Container",e.POWERID_TO_ANIM=((o={})[6]="Slow",o[7]="Freeze",o[8]="Back",o[9]="Score",o[10]="Bomb",o[11]="Steel",o[12]="Throw",o[13]="Rainbow",o),e}(n(7278).TaskBase);e.TaskBonusPopup=c},3627:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskCurveMover=e.CurveMoverDirection=void 0;var r,s=n(7278);!function(t){t[t.RANDOM=0]="RANDOM",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT"}(r=e.CurveMoverDirection||(e.CurveMoverDirection={}));var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._result=new Phaser.Point,e._start=new Phaser.Point,e._mid=new Phaser.Point,e._end=new Phaser.Point,e._listener=null,e._delay=0,e._duration=0,e._time=0,e._direction=r.RANDOM,e._branchAt=.5,e._branchLengthMultiplier=.5,e._easing=null,e._target=null,e._rotateIntoDirection=!1,e._compensateRotation=0,e._lastPostiton=new Phaser.Point,e._running=!1,e}return o(e,t),e.prototype.debug=function(t){var e=new Phaser.Line;e.start.set(this._start.x,this._start.y);for(var n=1;n<=100;n++){var i=this.at(n/100);e.end.set(i.x,i.y),t.geom(e,"RGBA(0, 255, 0, 1)"),e.start.copyFrom(e.end)}var o=new Phaser.Circle(this._start.x,this._start.y,8),r="RGBA(255, 0, 0, 1)";t.geom(o,r),o.setTo(this._mid.x,this._mid.y,8),t.geom(o,r),o.setTo(this._end.x,this._end.y,8),t.geom(o,r)},e.prototype.reset=function(){t.prototype.reset.call(this),this._target=null,this._rotateIntoDirection=!1,this._duration=e.DURATION,this._time=0,this._delay=0,this._direction=r.RANDOM,this._branchAt=.5,this._branchLengthMultiplier=.5,this._easing=null,this._listener=null,this._running=!1},e.prototype.duration=function(t){return this._duration=t,this},e.prototype.delay=function(t){return this._delay=t,this},e.prototype.directon=function(t){return this._direction=t,this},e.prototype.branching=function(t,e){return void 0===e&&(e=.5),this._branchAt=t,this._branchLengthMultiplier=e,this},e.prototype.easing=function(t){return this._easing=t,this},e.prototype.endPosition=function(t,e){return this._end.set(t,e),this},e.prototype.onEnd=function(t){return this._listener=t,this},e.prototype.target=function(t,e){return void 0===e&&(e=!1),this._target=t,this._rotateIntoDirection=e,t&&this._start.set(t.x,t.y),this},e.prototype.init=function(){var t=this._start,e=this._end,n=(e.x-t.x)*this._branchAt,i=(e.y-t.y)*this._branchAt;if(this._mid.set(i,n),this._direction===r.RIGHT||this._direction===r.RANDOM&&Math.random()<.5?this._mid.x*=-1:this._mid.y*=-1,this._mid.setMagnitude(t.distance(e)*this._branchLengthMultiplier),this._mid.add(t.x+n,t.y+i),this._rotateIntoDirection){var o=this.at(.001);this._compensateRotation=Phaser.Math.angleBetween(t.x,t.y,o.x,o.y)}},e.prototype.start=function(){this.init(),this._running=!0},e.prototype.at=function(t){return this._result.x=Phaser.Math.linear(Phaser.Math.linear(this._start.x,this._mid.x,t),Phaser.Math.linear(this._mid.x,this._end.x,t),t),this._result.y=Phaser.Math.linear(Phaser.Math.linear(this._start.y,this._mid.y,t),Phaser.Math.linear(this._mid.y,this._end.y,t),t),this._result},e.prototype.kill=function(){this.parentPool.despawn(this)},e.prototype.update=function(t){if(!this._running)return!0;if(this._delay>0)return this._delay-=t,!0;this._target&&this._rotateIntoDirection&&this._lastPostiton.copyFrom(this._target.position),this._time+=t;var e=Phaser.Math.clamp(this._time/this._duration,0,1),n=1===e;this._easing&&(e=this._easing(e));var i=this.at(e);if(this._target&&(this._target.position.copyFrom(i),this._rotateIntoDirection)){var o=Phaser.Math.angleBetween(this._lastPostiton.x,this._lastPostiton.y,i.x,i.y);this._target.rotation=o-this._compensateRotation}return n&&this._listener&&this._listener.onTaskComplete(this),!n},e.DURATION=1,e}(s.TaskBase);e.TaskCurveMover=a},9280:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskDelayedAudio=void 0;var r=n(6020),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._delay=0,e._audioRecord=null,e}return o(e,t),e.prototype.init=function(t,e){this._delay=t,this._audioRecord=e},e.prototype.kill=function(){this.parentPool.despawn(this)},e.prototype.update=function(t){return!((this._delay-=t)<=0)||(r.AudioUtils.playAudioRecord(this._audioRecord),!1)},e}(n(7278).TaskBase);e.TaskDelayedAudio=s},1650:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskElementBlue=void 0;var r=n(2178),s=n(1391),a=n(7751),l=n(1353),h=n(6020),u=n(7389),c=function(t){function e(e,n){var i=t.call(this,e)||this;return i._sprPool=null,i._level=null,i._newType=0,i._toRecolor=null,i._nextTime=0,i._sprPool=n,i._toRecolor=new l.Queue,i}return o(e,t),e.prototype.init=function(t,e){if(t.isBasicType){this._newType=t.type,this._level=e;var n=r.App.settings.getPowerupLevel(0);n=Math.max(n,1);var i=s.Defs.POWERUPS[0].levels[n].values[0];this.enqueueBalls(t,i),this._nextTime=0}},e.prototype.enqueueBalls=function(t,e){var n=t.chain,i=!0,o=!0,r=n.getChainIdx(t),s=r,a=n.balls,l=n.ballsCount;do{if(r+1>=l)this._toRecolor.enqueue(null),i=!1;else if(a[r].connected&&!a[r+1].isMotor){var h=a[++r];h.addListener(this),this._toRecolor.enqueue(h),--e}else this._toRecolor.enqueue(null),i=!1;if(s<=0)this._toRecolor.enqueue(null),o=!1;else if(a[s-1].connected&&!a[s-1].isMotor){var u=a[--s];u.addListener(this),this._toRecolor.enqueue(u),--e}else this._toRecolor.enqueue(null),o=!1}while(e>0&&(i||o))},e.prototype.changeBallType=function(t,e){var n=this._level.ballStats;n.remove(t.type),t.changeType(e),n.add(e)},e.prototype.kill=function(){var t=this;this._toRecolor.clear((function(e){e&&e.removeListener(t)})),this.parentPool.despawn(this)},e.prototype.update=function(t){if(this._toRecolor.isEmpty)return!1;if(this._game.time.time>=this._nextTime){this._nextTime=this._game.time.time+e.STEP_DELAY;for(var n=0;n<2&&!this._toRecolor.isEmpty;n++){var i=this._toRecolor.dequeue();if(i){if(i.getTunnelId()<0){var o=a.ParticleDefs.PTC_ELEMENT_BLUE_SPLAT_LONG[this._newType],r=u.Emitters.instance.oneTime(1,this._level.effectsLayerTopUnder,o);r.emitAt(i.position.x,i.position.y),r.explode(1),h.AudioUtils.playAudioRecord(s.Defs.SFX_RECOLOR)}this.changeBallType(i,this._newType),i.removeListener(this)}}}return!0},e.prototype.onBallMoved=function(t,e){},e.prototype.onBallDestroyed=function(t){t.removeListener(this),this._toRecolor.remove(t)},e.STEP_DELAY=150,e}(n(7278).TaskBase);e.TaskElementBlue=c},5314:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.TaskElementCyan=void 0;var s=n(2178),a=n(5357),l=n(1391),h=n(712),u=n(6020),c=function(t){function e(e,n){var i=t.call(this,e)||this;return i._sprPool=null,i._level=null,i._balls=[],i._spawned=[],i._spawnedCount=0,i._time=0,i._lastStartIdx=0,i._sprPool=n,i}return o(e,t),e.prototype.init=function(t,e){var n,i,o,a;this._level=e,this._lastStartIdx=-1;var h=Math.max(1,s.App.settings.getPowerupLevel(4)),u=l.Defs.POWERUPS[4].levels[h].values[0],c=this._level.chains;this._balls.length=0;try{for(var p=r(c),_=p.next();!_.done;_=p.next())for(var f=_.value,d=f.balls,y=f.ballsCount-1;y>=0;y--){(b=d[y]).type===t.type&&b.getTunnelId()<0&&(b.tmp=this.ballDistSq(b,t),this._balls.push(b))}}catch(t){n={error:t}}finally{try{_&&!_.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}if(this._balls.sort((function(t,e){return t.tmp-e.tmp})),this._balls[0],this._balls.length=Math.min(this._balls.length,u),this._balls.length>1){var m=this._balls;for(y=m.length-1;y>1;y--){var g=Math.floor(1+Math.random()*y),v=m[y];m[y]=m[g],m[g]=v}}try{for(var T=r(this._balls),E=T.next();!E.done;E=T.next()){var b;(b=E.value).addListener(this)}}catch(t){o={error:t}}finally{try{E&&!E.done&&(a=T.return)&&a.call(T)}finally{if(o)throw o.error}}this._time=0},e.prototype.getSpriteAtIdx=function(t){if(t<this._spawnedCount)return this._spawned[t];var e=this._sprPool.spawn();return null!==e&&(e.init(),this._spawned[this._spawnedCount++]=e),e},e.prototype.despawnFromIdx=function(t){for(;this._spawnedCount>t;){--this._spawnedCount;var e=this._spawned[this._spawnedCount];e.onKill(),this._sprPool.despawn(e),this._spawned[this._spawnedCount]=null}},e.prototype.kill=function(){this.destroyBalls(0,this._balls.length),this.despawnFromIdx(0),this.parentPool.despawn(this)},e.prototype.update=function(t){this._time+=this._game.time.delta;var n=Phaser.Math.clamp(Math.floor((this._time-e.DURATION)/e.TIME_STEP),0,this._balls.length);if(this.destroyBalls(0,n),n===this._balls.length)return!1;var i=Math.min(Math.floor(this._time/e.TIME_STEP),this._balls.length-1);i>this._lastStartIdx&&u.AudioUtils.playAudioRecord(l.Defs.SFX_LGHT_CHAIN),this._lastStartIdx=i;var o=0;return o=this.updateSprites(n,i,o),this.despawnFromIdx(o),!0},e.prototype.updateSprites=function(t,n,i){for(var o=Math.floor(this._time/e.FRAME_DURATION_LINE)%3,r=Math.floor(this._time/e.FRAME_DURATION_SPOT)%3,s=t;s<=n;s++){var h=this._balls[s];if(h&&!(h.getTunnelId()>=0)){var u=this.getSpriteAtIdx(i++);if(u&&(u.loadFrame(l.Defs.FRAMES_BOLT_SPOTS[(r+s)%3],a.Config.ATLAS_EFFECTS),u.scale.set(1),u.anchor.set(.5,.5),u.position.set(h.position.x,h.position.y),this._level.effectsLayerTop.add(u)),s<n){var c=this.getNextBall(s+1,n);if(c){var p=this.getSpriteAtIdx(i++);if(p){var _=Math.sqrt(this.ballDistSq(h,c)),f=this.getFrameIdx(_);p.loadFrame(l.Defs.FRAMES_BOLT[f][(o+s)%3],a.Config.ATLAS_EFFECTS),p.scale.set(1),p.width=_,p.anchor.set(0,.5),p.rotation=Phaser.Math.angleBetween(h.position.x,h.position.y,c.position.x,c.position.y),p.position.set(h.position.x,h.position.y),this._level.effectsLayerTop.add(p)}}}}}return i},e.prototype.destroyBalls=function(t,e){for(var n=t;n<e;n++){var i=this._balls[n];i&&(i.removeListener(this),i.destroyWithReason(h.BallRemoveReason.Broken),this.removeBallAtIdx(n))}},e.prototype.getFrameIdx=function(t){t>>=6;for(var e=0;t>0;)++e,t>>=1;return Math.min(e,3)},e.prototype.ballDistSq=function(t,e){var n=t.position.x-e.position.x,i=t.position.y-e.position.y;return n*n+i*i},e.prototype.getNextBall=function(t,e){for(var n=t;n<=e;n++)if(null!==this._balls[n]&&this._balls[n].getTunnelId()<0)return this._balls[n];return null},e.prototype.removeBallAtIdx=function(t){t<this._balls.length&&(this._balls[t]=null)},e.prototype.onBallMoved=function(t,e){},e.prototype.onBallDestroyed=function(t){for(var e=0;e<this._balls.length&&this._balls[e]!==t;e++);this.removeBallAtIdx(e)},e.TIME_STEP=250,e.DURATION=1e3,e.FRAME_DURATION_LINE=100,e.FRAME_DURATION_SPOT=133,e}(n(7278).TaskBase);e.TaskElementCyan=c},4524:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskElementGreen=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(4455),h=n(6e3),u=n(7892),c=n(6020),p=n(712),_=n(7389),f=n(7446),d=n(726),y=function(t){function e(e,n){var i=t.call(this,e)||this;return i._sprPool=null,i._level=null,i._cannon=null,i._gunBall=null,i._missilesToSpawn=0,i._angleTo=0,i._angleFrom=0,i._timeStep=0,i._timeCurrent=0,i._updateGunBall=!1,i._arrowSlots=[],i._sprPool=n,i.createArrowSlots(),i}return o(e,t),e.prototype.createArrowSlots=function(){for(var t=0;t<e.ARROWS_MAX;t++)this._arrowSlots.push({active:!1,arrow:null,trail:null,rotation:0,delay:0})},e.prototype.init=function(t,n,i){this._level=i,this._cannon=n,this._gunBall=t,this._missilesToSpawn=0;for(var o=Math.max(1,r.App.settings.getPowerupLevel(2)),s=n.getLaunchPoint(),l=a.Defs.POWERUPS[2].levels[o].values[0],h=n.angle-o*e.ANGLE_DEVIATION,u=0;u<l;u++,h+=e.ANGLE_DEVIATION){var p=this._arrowSlots[u],_=e.DELAY*u;if(this.initSlot(p,s,h,_)){var f=Phaser.Math.degToRad(h),d=24*Math.cos(f),y=24*Math.sin(f);p.arrow.x+=d,p.arrow.y+=y,this.slotVisible(p,!1),++this._missilesToSpawn}}0===this._missilesToSpawn&&i.onElementGreenEnded(),this._angleFrom=-(l-1)*e.ANGLE_DEVIATION/2,this._angleTo=-this._angleFrom,this._timeStep=1/((l-1)*e.DELAY),this._timeCurrent=0,this._updateGunBall=!0,this.updateGunBall(0),c.AudioUtils.playAudioRecord(a.Defs.SFX_GUN_SERVO)},e.prototype.initSlot=function(t,e,n,i){var o=this._sprPool.spawn();o.init(),o.loadFrame(a.Defs.FRAME_ELEMENT_GREEN_ARROW_TRAIL,s.Config.ATLAS_EFFECTS),o.anchor.set(1,.5),o.width=0,o.angle=n,o.position.copyFrom(e),this._level.effectsLayerTop.add(o);var r=this._sprPool.spawn();return r.init(),r.loadFrame(a.Defs.FRAME_ELEMENT_GREEN_ARROW,s.Config.ATLAS_EFFECTS),r.anchor.set(.75,.5),r.angle=n,r.position.copyFrom(e),this._level.effectsLayerTop.add(r),t.active=!0,t.rotation=Phaser.Math.degToRad(n),t.trail=o,t.arrow=r,t.delay=i,!0},e.prototype.slotVisible=function(t,e){t.arrow.visible=e,t.trail.visible=e},e.prototype.kill=function(){for(var t=0;t<this._arrowSlots.length;t++){var e=this._arrowSlots[t];this.killSlot(e)}this.parentPool.despawn(this)},e.prototype.killSlot=function(t){this.killArrow(t),this.killTrail(t),t.active=!1},e.prototype.killArrow=function(t){t.arrow&&(t.arrow.onKill(),this._sprPool.despawn(t.arrow),t.arrow=null)},e.prototype.killTrail=function(t){t.trail&&(t.trail.onKill(),this._sprPool.despawn(t.trail),t.trail=null)},e.prototype.updateMissilesToSpawn=function(){0==--this._missilesToSpawn&&(this._updateGunBall=!1,this._level.onElementGreenEnded())},e.prototype.updateGunBall=function(t){this._timeCurrent+=this._timeStep*t,this._timeCurrent=Math.min(this._timeCurrent,1);var e=Phaser.Math.linear(this._angleFrom,this._angleTo,this._timeCurrent);this._gunBall.setAngle(e)},e.prototype.update=function(t){var n=!1;this._updateGunBall&&this.updateGunBall(t);for(var i=0;i<this._arrowSlots.length;i++){var o=this._arrowSlots[i];if(o.active){if(o.delay>=0){if(!((o.delay-=t)<0)){n=!0;continue}this.slotVisible(o,!0),this.emitMuzzle(),d.Shaker.instance.createShake(this._cannon,f.BounceShake).init(l.ShakeDefs.CANNON_SHAKE),c.AudioUtils.playAudioRecord(a.Defs.SFX_GUN_SHOT),this.updateMissilesToSpawn()}if(o.trail&&(!o.arrow||o.trail.width>500)){var r=Math.max(0,o.trail.alpha-e.TRAIL_FADE_SPEED*t);o.trail.alpha=r,0===r&&this.killTrail(o)}if(o.arrow){var s=e.SPEED*t;if(o.arrow.x+=Math.cos(o.rotation)*s,o.arrow.y+=Math.sin(o.rotation)*s,o.trail&&(o.trail.position.copyFrom(o.arrow.position),o.trail.width+=s),this._level.isPointOutOfScreen(o.arrow.position,50)){this.killArrow(o);continue}if(this.checkCollision(o.arrow.x,o.arrow.y)){var h=_.Emitters.instance.oneTime(1,this._level.effectsLayerTopUnder,95);h.emitAt(o.arrow.x,o.arrow.y),h.explode(1),(h=_.Emitters.instance.oneTime(0,this._level.effectsLayerTopUnder,66)).emitAt(o.arrow.x,o.arrow.y),h.explode(25),(h=_.Emitters.instance.oneTime(0,this._level.effectsLayerTop,67)).explode(1),c.AudioUtils.playAudioRecord(a.Defs.SFX_GUN_IMPACT),this.killArrow(o);continue}}o.arrow||o.trail||(o.active=!1),n=!0}}return n},e.prototype.checkCollision=function(t,e){var n=this._level.spatial,i=!1;return n.testUnique(t,e,20,20,u.SpatialTestType.All,(function(n){if(n.spatialType===h.SpatialType.Ball){var o=n.spatialObject;o.removeReason===p.BallRemoveReason.None&&o.getTunnelId()<0&&o.collidedWithCircle(t,e,10)&&(o.destroyWithReason(p.BallRemoveReason.Broken),i=!0)}else if(n.spatialType===h.SpatialType.Collider){var r=n.spatialObject;!r.isTunnel&&r.circleIntersection(t,e,10)&&(i=!0)}return i}),.5,.5),i},e.prototype.emitMuzzle=function(){var t=this._cannon.getLaunchPoint(),e=this._cannon.rotation,n=24*Math.cos(e),i=24*Math.sin(e),o=_.Emitters.instance.oneTime(0,this._level.effectsLayerTop,68);o.emitAt(t.x+n,t.y+i),o.explode(2)},e.ARROWS_MAX=7,e.SPEED=750,e.ANGLE_DEVIATION=13,e.DELAY=.1,e.TRAIL_FADE_SPEED=1.5,e}(n(7278).TaskBase);e.TaskElementGreen=y},8163:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskElementPurple=void 0;var r,s=n(2178),a=n(5357),l=n(1391),h=n(6e3),u=n(7892),c=n(713),p=n(6020),_=n(712),f=n(7389),d=n(7278),y=n(3627),m=n(4460),g=n(5714);!function(t){t[t.None=0]="None",t[t.Sparkles=1]="Sparkles",t[t.Move=2]="Move",t[t.FadeOut=3]="FadeOut",t[t.End=4]="End"}(r||(r={}));var v=function(t){function e(e,n){var i=t.call(this,e)||this;return i._state=r.None,i._chain=null,i._level=null,i._sparklesEmitter=null,i._smokeEmitter=null,i._sprPool=null,i._stagBug=null,i._pathLayer=0,i._pathFollowerTask=null,i._ballsToDestroy=null,i._fadeOutTime=0,i._sprPool=n,i}return o(e,t),e.prototype.init=function(t,e,n){this._chain=e,this._level=n,this.setSparkles(t.position.x,t.position.y)},e.prototype.setSparkles=function(t,e){this._state=r.Sparkles;var n=f.Emitters.instance.spawn(0,this._level.effectsLayerTop,76);if(n){n.position.set(t,e),n.emitObject=n,n.emitAt(0,0),n.despawnDelay=1e3,n.flow(20,1),this._level.effectsLayerTop.add(n),this._sparklesEmitter=n,p.AudioUtils.playAudioRecord(l.Defs.SFX_SUMMON_SPARKLES);var i=f.Emitters.instance.spawn(0,this._level.effectsLayerTopUnder,77);i&&(i.position.set(t,e),i.emitAt(0,0),i.emitObject=n,i.despawnDelay=1e3,i.flow(20,1),this._smokeEmitter=i);var o=this._chain.path.getPointAtDistance(this._chain.path.pathLength),s=g.Tasks.instance.createTask(y.TaskCurveMover);s.reset(),s.target(n).endPosition(o.x,o.y).branching(1/3,.3).delay(1).duration(2).onEnd(this),s.start()}else this.setStagBug()},e.prototype.setStagBug=function(){this._state=r.Move,this.createStagBugSprites();var t=Math.max(1,s.App.settings.getPowerupLevel(5));this._ballsToDestroy=l.Defs.POWERUPS[5].levels[t].values[0];var n=g.Tasks.instance.createTask(m.TaskPathFollower);if(n){n.reset(),n.path(this._chain.path).from(1,!0).to(-100).target(this._stagBug,!0).speed(e.STAGBUG_SPEED).onEnd(this),n.start(),n.update(0),this._pathFollowerTask=n;var i=this._chain.path.getPointAtDistance(this._chain.path.pathLength),o=f.Emitters.instance.oneTime(0,this._level.effectsLayerTop,75);o.emitAt(i.x,i.y),o.explode(10),p.AudioUtils.playAudioRecord(l.Defs.SFX_SUMMON_FOG),p.AudioUtils.playAudioRecord(l.Defs.SFX_BUG_SHOW)}else this._state=r.End},e.prototype.createStagBugSprites=function(){var t=this._sprPool.spawn();t&&(t.init(),t.scale.set(1.4),t.anchor.set(.5),t.loadFrame(l.Defs.FRAMES_ELEMENT_PURPLE_STAGBUG[0],a.Config.ATLAS_GAME),this._level.bottomBalls.add(t),this._stagBug=t)},e.prototype.onTaskComplete=function(t){switch(this._state){case r.Sparkles:this._sparklesEmitter&&(this._sparklesEmitter.stop(),this._sparklesEmitter=null),this._smokeEmitter&&(this._smokeEmitter.stop(),this._smokeEmitter=null),this.setStagBug();break;case r.Move:this._state=r.End}},e.prototype.kill=function(){this._sparklesEmitter&&(this._sparklesEmitter.stop(),this._sparklesEmitter=null),this._smokeEmitter&&(this._smokeEmitter.stop(),this._smokeEmitter=null),this._stagBug&&(this._stagBug.onKill(),this._sprPool.despawn(this._stagBug),this._stagBug=null),this.parentPool.despawn(this)},e.prototype.update=function(t){return this._state===r.Move?this.updateMove(t):this._state===r.FadeOut&&this.fadeOut(),this._state!==r.End},e.prototype.fadeOut=function(){var t=this._game.time.time-this._fadeOutTime;t>=e.FADEOUT_MILLIS?this._state=r.End:this._stagBug.alpha=Math.floor(t/100)%2},e.prototype.updateMove=function(t){if(this._level.isGameOver&&null!==this._pathFollowerTask&&(this._pathFollowerTask.finished=!0,this._pathFollowerTask=null),this._pathFollowerTask){var n=this._pathFollowerTask.currentPathDistance-e.DISTANCE_TO_STAG,i=this._chain.path.getPointAtExtendedDistance(n);this.setLayer(i.layer),this.setStagBugFrame(n),this.updateSpeed(t);var o=this.checkCollision(i.x,i.y);o&&(p.AudioUtils.playAudioRecord(l.Defs.SFX_BUG_CRIP),o.destroyWithReason(_.BallRemoveReason.Broken),this._pathFollowerTask.speed(0),--this._ballsToDestroy<=0&&(this._state=r.FadeOut,this._fadeOutTime=this._game.time.time,p.AudioUtils.playAudioRecord(l.Defs.SFX_BUG_DEATH),this._pathFollowerTask.finished=!0))}},e.prototype.setLayer=function(t){this._pathLayer=t,0===t&&this._stagBug.parent!==this._level.bottomBalls?this._level.bottomBalls.add(this._stagBug):1===t&&this._stagBug.parent!==this._level.topBalls&&this._level.topBalls.add(this._stagBug)},e.prototype.setStagBugFrame=function(t){var e=this._chain.path.pathLength-t,n=Math.floor(e/6)%l.Defs.FRAMES_ELEMENT_PURPLE_STAGBUG.length;this._stagBug.frameName=l.Defs.FRAMES_ELEMENT_PURPLE_STAGBUG[n]},e.prototype.updateSpeed=function(t){var n=this._pathFollowerTask,i=c.MathHelp.moveTowards(n.currentSpeed,e.STAGBUG_SPEED,e.STAGBUG_SPEED*t*2);n.speed(i)},e.prototype.checkCollision=function(t,n){var i=this,o=2*e.STAG_RADIUS,r=this._level.spatial,s=null;return r.testUnique(t,n,o,o,u.SpatialTestType.Dynamic,(function(o){if(o.spatialType===h.SpatialType.Ball){var r=o.spatialObject;r.removeReason===_.BallRemoveReason.None&&i._pathLayer===r.ballLayer&&r.collidedWithCircle(t,n,e.STAG_RADIUS)&&(s=r)}return null!==s}),.5,.5),s},e.STAGBUG_SPEED=200,e.DISTANCE_TO_STAG=10,e.STAG_RADIUS=10,e.FADEOUT_MILLIS=600,e}(d.TaskBase);e.TaskElementPurple=v},8291:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskElementRed=void 0;var r,s=n(2178),a=n(5357),l=n(1391),h=n(6e3),u=n(7892),c=n(7857),p=n(713),_=n(6020),f=n(712),d=n(7389),y=n(7278),m=n(3627),g=n(4460),v=n(5714);!function(t){t[t.None=0]="None",t[t.Sparkles=1]="Sparkles",t[t.Ladybug=2]="Ladybug",t[t.MoveOut=3]="MoveOut",t[t.End=4]="End"}(r||(r={}));var T=function(t){function e(e,n){var i=t.call(this,e)||this;return i._state=r.None,i._chain=null,i._level=null,i._sparklesEmitter=null,i._smokeEmitter=null,i._sprPool=null,i._shadow=null,i._ladybug=null,i._bombShadows=null,i._sprPool=n,i._bombShadows=new c.UnorderedArray,i}return o(e,t),e.prototype.init=function(t,e,n){this._chain=e,this._level=n,this.setSparkles(t.position.x,t.position.y)},e.prototype.setSparkles=function(t,n){this._state=r.Sparkles;var i=d.Emitters.instance.spawn(0,this._level.effectsLayerTop,63);if(i){i.position.set(t,n),i.emitObject=i,i.emitAt(0,0),i.despawnDelay=1e3,i.flow(20,1),this._level.effectsLayerTop.add(i),this._sparklesEmitter=i,_.AudioUtils.playAudioRecord(l.Defs.SFX_SUMMON_SPARKLES);var o=d.Emitters.instance.spawn(0,this._level.effectsLayerTopUnder,64);o&&(o.position.set(t,n),o.emitAt(0,0),o.emitObject=i,o.despawnDelay=1e3,o.flow(20,1),this._smokeEmitter=o);var s=this._chain.path.getPointAtExtendedDistance(-100),a=v.Tasks.instance.createTask(m.TaskCurveMover);a.reset(),a.target(i).endPosition(s.x,s.y+e.LADYBUG_OFFSET_Y).branching(1/3,.3).delay(1).duration(2).onEnd(this),a.start()}else this.setLadybug()},e.prototype.setLadybug=function(){this._state=r.Ladybug,this.createLadybugSprites();var t=s.App.settings.getPowerupLevel(1);t=Math.max(t,1);var n=l.Defs.POWERUPS[1].levels[t].values[0],i=v.Tasks.instance.createTask(g.TaskPathFollower);if(i){i.reset(),i.path(this._chain.path).from(-100).to(1,!0).target(this._shadow,!0).step(n,!1,25).speed(e.LADYBUG_SPEED).onEnd(this).onStep(this),i.start(),i.update(0),this.updateLadybug(0);var o=d.Emitters.instance.oneTime(0,this._level.effectsLayerTop,62);o.emitAt(this._ladybug.x,this._ladybug.y),o.explode(15),_.AudioUtils.playAudioRecord(l.Defs.SFX_SUMMON_FOG),_.AudioUtils.playAudioRecord(l.Defs.SFX_LB_SHOW)}else this._state=r.End},e.prototype.createLadybugSprites=function(){var t=this._sprPool.spawn();t&&(t.init(),t.loadFrame(l.Defs.FRAME_ELEMENT_RED_LADYBUG_SHADOW,a.Config.ATLAS_GAME),t.scale.set(1),t.anchor.set(.5),this._level.effectsLayerTop.add(t),this._shadow=t);var e=this._sprPool.spawn();e&&(e.init(),e.scale.set(1.4),e.anchor.set(.5),e.playAnim(l.Defs.ANIM_LADYBUG),e.alpha=0,this._level.effectsLayerTopUnder.add(e),this._ladybug=e)},e.prototype.spawnBomb=function(t){if(!this._level.isGameOver){var n=this._sprPool.spawn();if(n){n.init();var i=this._sprPool.spawn();i?(i.init(),n.position.copyFrom(this._shadow.position),n.scale.set(1),n.anchor.set(.5),n.loadFrame(l.Defs.FRAME_ELEMENT_RED_LADYBUG_BOMB_SHADOW,a.Config.ATLAS_GAME),n.param1=i,this._level.effectsLayerTopUnder.add(n),i.position.copyFrom(n.position),s.App.isLandscape?i.position.y+=e.LADYBUG_OFFSET_Y:i.position.x+=e.LADYBUG_OFFSET_Y,i.scale.set(1),i.anchor.set(.5),i.loadFrame(l.Defs.FRAME_ELEMENT_RED_LADYBUG_BOMB,a.Config.ATLAS_GAME),i.param1=0,i.param2=t,this._level.effectsLayerTopUnder.add(i),this._bombShadows.add(n),_.AudioUtils.playAudioRecord(l.Defs.SFX_LB_BOMB)):this._sprPool.despawn(n)}}},e.prototype.onTaskStep=function(t,e,n){this._ladybug&&this.spawnBomb(t.getStepDistance())},e.prototype.onTaskComplete=function(t){switch(this._state){case r.Sparkles:this._sparklesEmitter&&(this._sparklesEmitter.stop(),this._sparklesEmitter=null),this._smokeEmitter&&(this._smokeEmitter.stop(),this._smokeEmitter=null),this.setLadybug();break;case r.Ladybug:this._state=r.MoveOut}},e.prototype.kill=function(){var t=this;this._sparklesEmitter&&(this._sparklesEmitter.stop(),this._sparklesEmitter=null),this._smokeEmitter&&(this._smokeEmitter.stop(),this._smokeEmitter=null),this._shadow&&(this._shadow.onKill(),this._sprPool.despawn(this._shadow),this._shadow=null),this._ladybug&&(this._ladybug.onKill(),this._sprPool.despawn(this._ladybug),this._ladybug=null),this._bombShadows.iterate((function(e){t.destroyBomb(e)})),this.parentPool.despawn(this)},e.prototype.destroyBomb=function(t){var e=t.param1;e.onKill(),this._sprPool.despawn(e),t.onKill(),this._sprPool.despawn(t),this._bombShadows.remove(t)},e.prototype.update=function(t){return this.updateBombs(t),this._state===r.Ladybug?this.updateLadybug(t):this._state===r.MoveOut&&this.updateMoveOut(t),this._state!==r.End},e.prototype.updateBombs=function(t){var n=this;this._bombShadows.iterate((function(i){var o=i.param1;o.param1=o.param1+e.GRAVITY*t,o.y=p.MathHelp.moveTowards(o.y,i.y,o.param1*t),o.x=p.MathHelp.moveTowards(o.x,i.x,o.param1*t),Math.abs(i.y-o.y)<1&&Math.abs(i.x-o.x)<1&&(n.explodeBomb(o.x,o.y,o.param2),_.AudioUtils.playAudioRecord(l.Defs.SFX_LB_BOMB_IMPACT),n.destroyBomb(i))}))},e.prototype.explodeBomb=function(t,e,n){var i=d.Emitters.instance.oneTime(1,this._level.effectsLayerTopUnder,65);i.emitAt(t,e),i.explode(1);var o=this.checkCollision(t,e,n);o&&o.destroyWithReason(f.BallRemoveReason.Broken)},e.prototype.checkCollision=function(t,n,i){var o=2*e.BOMB_RADIUS,r=this._level.spatial,s=null;return r.testUnique(t,n,o,o,u.SpatialTestType.Dynamic,(function(i){if(i.spatialType===h.SpatialType.Ball){var o=i.spatialObject;if(o.removeReason===f.BallRemoveReason.None&&o.getTunnelId()<0&&o.collidedWithCircle(t,n,e.BOMB_RADIUS))return s=o,!0}return!1}),.5,.5),s},e.prototype.updateLadybug=function(t){var n=this._shadow,i=this._ladybug;n&&i&&(s.App.isLandscape?(i.x=n.x,i.y=n.y+e.LADYBUG_OFFSET_Y):(i.x=n.x+e.LADYBUG_OFFSET_Y,i.y=n.y),i.angle=n.angle,i.alpha<1&&(i.alpha=Math.min(i.alpha+2*t,1)))},e.prototype.updateMoveOut=function(t){var n=this._shadow;if(n){var i=n.rotation,o=e.LADYBUG_SPEED*t;n.x+=Math.cos(i)*o,n.y+=Math.sin(i)*o,this.updateLadybug(t);this._level.isPointOutOfScreen(n.position,50)&&this._level.isPointOutOfScreen(this._ladybug.position,50)&&(this._state=r.End)}else this._state=r.End},e.LADYBUG_SPEED=400,e.LADYBUG_OFFSET_Y=-100,e.GRAVITY=400,e.BOMB_RADIUS=9,e}(y.TaskBase);e.TaskElementRed=T},7523:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskElementYellow=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(6e3),h=n(7892),u=n(6020),c=n(712),p=n(7389),_=function(t){function e(e,n){var i=t.call(this,e)||this;return i._sprPool=null,i._level=null,i._flameSlots=[],i._sprPool=n,i.createFlameSlots(),i}return o(e,t),e.prototype.createFlameSlots=function(){for(var t=0;t<e.FLAMES_MAX;t++)this._flameSlots.push({emitter:null,delay:0,rotation:0,sprite:null,ballsCount:0,frameChangeDelay:0,angleIdx:0})},e.prototype.init=function(t,n,i){this._level=i;for(var o=Math.max(1,r.App.settings.getPowerupLevel(3)),s=a.Defs.POWERUPS[3].levels[o].values,l=s[0],h=s[1],u=this._game.rnd.sign(),c=0,p=0;p<l;p++){var _=this._flameSlots[p],f=n+e.ANGLE_DEVIATION*c,d=e.DELAY*p;this.initSlot(_,t,f,d,h)&&(_.emitter.despawnDelay=3e4,this.slotVisible(_,!1)),c=u,u*=-1}},e.prototype.initSlot=function(t,n,i,o,r){var l=this.createEmitter();if(!l)return!1;l.position.copyFrom(n),l.emitAt(0,0),l.angle=i,l.emitObject=l,this._level.effectsLayerTop.add(l);var h=this._sprPool.spawn();return h.init(),h.loadFrame(a.Defs.FRAME_ELEMENT_YELLOW_FLAME_HEAD,s.Config.ATLAS_EFFECTS),h.anchor.set(.5),h.scale.set(3),this._level.effectsLayerTop.add(h),t.emitter=l,t.rotation=Phaser.Math.degToRad(i),t.sprite=h,t.delay=o,t.ballsCount=r,t.frameChangeDelay=e.FRAME_CHANGE_DELAY,t.angleIdx=0,!0},e.prototype.slotVisible=function(t,e){t.emitter.visible=e,t.sprite.visible=e},e.prototype.createEmitter=function(){return p.Emitters.instance.spawn(0,this._level.effectsLayerTopUnder,69)},e.prototype.kill=function(){for(var t=0;t<this._flameSlots.length;t++){var e=this._flameSlots[t];null!==e.emitter&&this.killSlot(e)}this.parentPool.despawn(this)},e.prototype.killSlot=function(t){t.emitter.stop(),t.emitter=null,t.sprite&&(t.sprite.onKill(),this._sprPool.despawn(t.sprite),t.sprite=null)},e.prototype.update=function(t){for(var n=!1,i=0;i<this._flameSlots.length;i++){var o=this._flameSlots[i];if(null!==o.emitter){if(o.delay>=0){if(!((o.delay-=t)<0)){n=!0;continue}this.slotVisible(o,!0),o.emitter.despawnDelay=0,o.emitter.flow(10,1),u.AudioUtils.playAudioRecord(a.Defs.SFX_FIRE_LAUNCH)}if((o.frameChangeDelay-=t)<=0){var r=this._game.rnd.integerInRange(1,5);r===o.angleIdx&&(r=0),o.angleIdx=r,o.sprite.angle=60*r,o.frameChangeDelay+=e.FRAME_CHANGE_DELAY}if(o.emitter.x+=Math.cos(o.rotation)*e.SPEED*t,o.emitter.y+=Math.sin(o.rotation)*e.SPEED*t,o.sprite.position.copyFrom(o.emitter.position),this._level.isPointOutOfScreen(o.emitter.position,350))this.killSlot(o);else if(this.checkCollision(o)){var s=p.Emitters.instance.oneTime(0,this._level.effectsLayerTopUnder,70);s.emitAt(o.emitter.x,o.emitter.y),s.explode(5),(s=p.Emitters.instance.oneTime(0,this._level.effectsLayerTop,71)).emitAt(o.emitter.x,o.emitter.y),s.explode(1),u.AudioUtils.playAudioRecord(a.Defs.SFX_FIRE_IMPACT),this.killSlot(o)}else n=!0}}return n},e.prototype.checkCollision=function(t){var e=this,n=t.emitter.x,i=t.emitter.y,o=this._level.spatial,r=!1;return o.testUnique(n,i,80,80,h.SpatialTestType.All,(function(o){if(o.spatialType===l.SpatialType.Ball){var s=o.spatialObject;if(t.ballsCount>0&&s.removeReason===c.BallRemoveReason.None&&s.getTunnelId()<0&&s.collidedWithCircle(n,i,40)){s.destroyWithReason(c.BallRemoveReason.Broken);var h=0===s.ballLayer?e._level.bottomBalls:e._level.topBalls,_=p.Emitters.instance.oneTime(0,h.effectsOver,72);if(_.emitAt(s.position.x,s.position.y),_.explode(1),u.AudioUtils.playAudioRecord(a.Defs.SFX_FIRE_BURN),--t.ballsCount,0===t.ballsCount)return r=!0,!0}}else if(o.spatialType===l.SpatialType.Collider){var f=o.spatialObject;!f.isTunnel&&f.circleIntersection(n,i,40)&&(r=!0)}return!1}),.5,.5),r},e.FLAMES_MAX=3,e.SPEED=750,e.ANGLE_DEVIATION=3.5,e.DELAY=.1,e.FRAME_CHANGE_DELAY=.1,e}(n(7278).TaskBase);e.TaskElementYellow=_},9159:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskPathCompleted=void 0;var r=n(5357),s=n(1391),a=n(6020),l=n(7389),h=n(7278),u=n(4460),c=n(5714),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._layerBottom=null,e._layerTop=null,e._path=null,e._level=null,e._countdown=!1,e._delay=0,e}return o(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),this.flags=2,this._countdown=!1,this._delay=1.5},e.prototype.init=function(t,e,n,i,o){this._level=t,this._path=e,this._layerBottom=n,this._layerTop=i,this.setPathFollower(o)},e.prototype.setPathFollower=function(t){var n=c.Tasks.instance.createTask(u.TaskPathFollower);n?(t=this._path.pathLength-Math.floor((this._path.pathLength-t)/e.STEP)*e.STEP-1,n.reset(),n.path(this._path).delay(1).from(t).to(this._path.pathLength,!1).step(e.STEP,!1).speed(e.SPEED).onEnd(this).onStep(this),n.start(),n.update(0)):this.finished=!0},e.prototype.onTaskStep=function(t,e,n){var i=Phaser.Math.clamp(e,0,20);this._level.addScore(i);var o=this._path.getPointAtDistance(n),h=0===o.layer?this._layerBottom:this._layerTop;if(!(this._path.getTunnelId(n)>=0)){var u=l.Emitters.instance.oneTime(0,h,7);u.emitAt(o.x,o.y),u.explode(8)}r.Config.SCORE_SYSTEM&&this._level.emitScoreParticle(i,o.x,o.y,h,1.5),a.AudioUtils.playAudioRecord(s.Defs.SFX_LB_BOMB_IMPACT)},e.prototype.onTaskComplete=function(t){this._countdown=!0},e.prototype.kill=function(){this.parentPool.despawn(this)},e.prototype.update=function(t){return!this._countdown||(this._delay-=t)>0},e.SPEED=800,e.STEP=150,e}(h.TaskBase);e.TaskPathCompleted=p},6088:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.TaskPathEnd=void 0;var s=n(5357),a=n(6273),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._level=null,e._chains=null,e._holes=null,e._waves=null,e._seals=null,e}return o(e,t),e.prototype.init=function(t,e){this._level=t,this._chains=t.chains,this._holes=t.holes,this._waves=e,this.createSeals()},e.prototype.createSeals=function(){var t,e;this._seals=[];try{for(var n=r(this._chains),i=n.next();!i.done;i=n.next()){var o=i.value,s=new a.PathSeal(this._game);this._level.topBalls.addChild(s);var l=o.path,h=0,u=void 0,c=void 0,p=void 0,_=!1;do{u=l.getPointAtDistance(h),c=this._level.isOutOfScreen(u.x,u.y,0),p=l.getTunnelId(Math.max(0,h-15))>=0,h+=5,_=_||p}while(c||p);h-=5,_||(h+=15,u=l.getPointAtDistance(h)),s.pathDistance=h,s.position.set(u.x,u.y),this._seals.push(s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.kill=function(){var t,e;if(null!==this._seals){try{for(var n=r(this._seals),i=n.next();!i.done;i=n.next()){i.value.onKill()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this._seals=null}this.parentPool.despawn(this)},e.prototype.update=function(t){var e,n;try{for(var i=r(this._holes),o=i.next();!o.done;o=i.next()){var s=o.value;this.checkCloseToEnd(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}for(var a=0;a<this._seals.length;a++){var l=this._seals[a];l.active?l.updatePathSeal(t):this.checkSeal(l,this._chains[a],this._waves[a])}return!0},e.prototype.checkSeal=function(t,e,n){n.finished&&n.spawned&&(0===e.ballsCount||e.balls[e.ballsCount-1].pathDistance>=t.pathDistance+100)&&(t.activate(),e.setSealed(t.pathDistance))},e.prototype.checkCloseToEnd=function(t){var e,n,i=Number.MAX_VALUE;try{for(var o=r(t.chains),a=o.next();!a.done;a=o.next()){var l=a.value;if(0!==l.ballsCount){var h=l.balls[0].pathDistance;i=Math.min(i,l.path.pathLength-h)}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}var u=0;i<=s.Config.HOLE_ROOTS_CHECK_DISTANCE&&(u=Phaser.Math.mapLinear(i,s.Config.HOLE_ROOTS_FULL_DISTANCE,s.Config.HOLE_ROOTS_CHECK_DISTANCE,1,0),u=Phaser.Math.clamp(u,0,1)),t.updateHole(u)},e}(n(7278).TaskBase);e.TaskPathEnd=l},4460:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskPathFollower=void 0;var r,s=n(713),a=n(7278);!function(t){t[t.TowardTarget=0]="TowardTarget",t[t.Interpolate=1]="Interpolate"}(r||(r={}));var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._endListener=null,e._updateListener=null,e._stepListener=null,e._path=null,e._pathStart=0,e._pathEnd=0,e._pathCurrent=0,e._movementType=r.TowardTarget,e._target=null,e._rotateIntoDirection=!1,e._delay=0,e._duration=0,e._easing=null,e._time=0,e._speed=0,e._step=0,e._zeroStep=!1,e._stepRandomOffset=0,e._nextStep=0,e._stepCount=0,e._running=!1,e}return o(e,t),Object.defineProperty(e.prototype,"curvePath",{get:function(){return this._path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentPathDistance",{get:function(){return this._pathCurrent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentSpeed",{get:function(){return this._speed},enumerable:!1,configurable:!0}),e.prototype.reset=function(){t.prototype.reset.call(this),this._target=null,this._rotateIntoDirection=!1,this._path=null,this._pathStart=0,this._pathEnd=0,this._movementType=r.TowardTarget,this._delay=0,this._duration=0,this._easing=null,this._speed=100,this._step=0,this._zeroStep=!1,this._nextStep=0,this._stepCount=0,this._endListener=null,this._updateListener=null,this._stepListener=null,this._running=!1},e.prototype.path=function(t){return this._path=t,this},e.prototype.from=function(t,e){return void 0===e&&(e=!1),this._pathStart=e?this.relativeToDistance(t):t,this},e.prototype.to=function(t,e){return void 0===e&&(e=!1),this._pathEnd=e?this.relativeToDistance(t):t,this},e.prototype.relativeToDistance=function(t){if(!this._path)throw new Error("If setting relative distance, curve must be set first.");return this._path.pathLength*t},e.prototype.target=function(t,e){return void 0===e&&(e=!1),this._target=t,this._rotateIntoDirection=e,this},e.prototype.delay=function(t){return this._delay=t,this},e.prototype.interpolation=function(t,e){return void 0===e&&(e=null),this._movementType=r.Interpolate,this._duration=t,this._easing=e,this},e.prototype.speed=function(t){return this._movementType=r.TowardTarget,this._speed=t,this},e.prototype.step=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=0),this._step=t,this._zeroStep=e,this._stepRandomOffset=n,this},e.prototype.onEnd=function(t){return this._endListener=t,this},e.prototype.onUpdate=function(t){return this._updateListener=t,this},e.prototype.onStep=function(t){return this._stepListener=t,this},e.prototype.setNextStep=function(){this._nextStep+=this._step+(this._stepRandomOffset>0?this._game.rnd.integerInRange(-this._stepRandomOffset,this._stepRandomOffset):0)},e.prototype.init=function(){this._pathCurrent=this._pathStart,this._step>0&&(this._nextStep=this._pathStart,this._pathEnd<this._pathStart&&(this._step*=-1),this._zeroStep||this.setNextStep()),this._time=0},e.prototype.start=function(){this.init(),this._running=!0},e.prototype.kill=function(){this.parentPool.despawn(this)},e.prototype.update=function(t){if(!this._running)return!0;if(this._delay>0)return this._delay-=t,!0;var e=!1;return e=this._movementType===r.TowardTarget?this.updateMoveToward(t):this.updateInterpolation(t),this._target&&this.updateTarget(),this._updateListener&&this._updateListener.onTaskUpdated(this),e&&this._endListener&&this._endListener.onTaskComplete(this),!e},e.prototype.updateTarget=function(){var t=this._path.getPointAtExtendedDistance(this._pathCurrent);if(this._target.position.set(t.x,t.y),this._rotateIntoDirection){var e=t.angle;this._pathEnd<this._pathStart&&(e-=180),this._target.angle=e}},e.prototype.updateMoveToward=function(t){var e=this._speed*t;return this._pathCurrent=s.MathHelp.moveTowards(this._pathCurrent,this._pathEnd,e),0!==this._step&&this.checkStep(),this.isInEnd(this._pathCurrent)},e.prototype.updateInterpolation=function(t){this._time+=t;var e=Phaser.Math.clamp(this._time/this._duration,0,1),n=1===e;return this._easing&&(e=this._easing(e)),this._pathCurrent=Phaser.Math.linear(this._pathStart,this._pathEnd,e),0!==this._step&&this.checkStep(),n},e.prototype.isInEnd=function(t){return Math.abs(t-this._pathEnd)<.1},e.prototype.checkStep=function(){for(;this._step>0&&this._pathCurrent>=this._nextStep||this._step<0&&this._pathCurrent<=this._nextStep;)++this._stepCount,this._stepListener&&this._stepListener.onTaskStep(this,this._stepCount,this._nextStep),this.setNextStep()},e.prototype.getStepDistance=function(){return this._pathStart+this._nextStep},e}(a.TaskBase);e.TaskPathFollower=l},2984:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskPathReveal=void 0;var r=n(7389),s=n(7278),a=n(4460),l=n(5714),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._layerBottom=null,e._layerTop=null,e._path=null,e._level=null,e._notifyLevelOnFinished=!1,e}return o(e,t),Object.defineProperty(e.prototype,"notifyLevelOnFinished",{get:function(){return this._notifyLevelOnFinished},set:function(t){this._notifyLevelOnFinished=t},enumerable:!1,configurable:!0}),e.prototype.reset=function(){t.prototype.reset.call(this),this._notifyLevelOnFinished=!1},e.prototype.init=function(t,e,n,i){this._level=t,this._path=e,this._layerBottom=n,this._layerTop=i,this.setPathFollower()},e.prototype.setPathFollower=function(){var t=l.Tasks.instance.createTask(a.TaskPathFollower);t?(t.reset(),t.path(this._path).from(-100).to(this._path.pathLength-40,!1).step(e.STEP,!1).speed(e.SPEED).onEnd(this).onStep(this),t.start(),t.update(0)):this.finished=!0},e.prototype.onTaskStep=function(t,e,n){var i=this._path.getPointAtDistance(n),o=0===i.layer?this._layerBottom:this._layerTop,s=r.Emitters.instance.oneTime(0,o,100);s.emitAt(i.x,i.y);var a=s.emitParticle();a&&(a.visual.angle=i.angle)},e.prototype.onTaskComplete=function(t){this.finished=!0,this._notifyLevelOnFinished&&this._level.handleRevealTaskFinished()},e.prototype.kill=function(){this.parentPool.despawn(this)},e.prototype.update=function(t){return!this.finished},e.SPEED=1200,e.STEP=40,e}(s.TaskBase);e.TaskPathReveal=h},3338:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskScoreSigns=void 0;var r=n(7751),s=n(7389),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._level=null,e._duration=0,e._emitter=null,e}return o(e,t),e.prototype.reset=function(){this._level=null,this._duration=0},e.prototype.setDuration=function(t){this._duration=t},e.prototype.init=function(t,e){this._level=t,r.ParticleDefs.PARAMS[47].area.setTo(-e.panelWidth/2,-25,e.panelWidth,50);var n=s.Emitters.instance.spawn(0,null,47);n?(n.despawnDelay=1e3,n.flow(100+20*(6-e.limitsCount),2),e.add(n),e.sendToBack(n),n.emitAt(0,0),n.position.set(e.panelWidth/2,0),this._emitter=n):this.finished=!0},e.prototype.kill=function(){this._emitter&&(this._emitter.stop(),this._emitter=null),this.parentPool.despawn(this)},e.prototype.update=function(t){this._duration-=t;var e=this._duration>0;return e||this._level.onStopScoreBonus(),e},e}(n(7278).TaskBase);e.TaskScoreSigns=a},7809:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.TaskSprite=void 0;var s=n(5357),a=function(t){function e(e,n){var i=t.call(this,e,0,0,s.Config.ATLAS_GAME)||this;return i._listener=null,i.createAnims(n),i}return o(e,t),Object.defineProperty(e.prototype,"param1",{get:function(){return this._param1},set:function(t){this._param1=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"param2",{get:function(){return this._param2},set:function(t){this._param2=t},enumerable:!1,configurable:!0}),e.prototype.createAnims=function(t){var n,i;try{for(var o=r(t),s=o.next();!s.done;s=o.next()){var a=s.value;void 0===e.ANIM_KEYS[a.name]&&(e.ANIM_KEYS[a.name]=a.atlasKey),this.key!==a.atlasKey&&this.loadTexture(a.atlasKey);var l=this.animations.add(a.name,a.frames,a.frameRate,a.loop);!a.loop&&a.killOnComplete&&(l.killOnComplete=!0,l.onComplete.add(this.onAnimationComplete,this))}}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e.prototype.init=function(){this.anchor.set(.5),this.scale.set(1),this.angle=0,this.alpha=1},e.prototype.loadFrame=function(t,e){void 0===e&&(e=null),null!==e&&e!==this.key&&this.loadTexture(e),"number"==typeof t?this.frame=t:this.frameName=t},e.prototype.playAnim=function(t,n){void 0===n&&(n=null),this._listener=n;var i=e.ANIM_KEYS[t];this.key!==i&&this.loadTexture(i),this.animations.play(t)},e.prototype.onAnimationComplete=function(t,e){this._listener&&(this._listener.onTaskSpriteAnimCompleted(t,e),this._listener=null)},e.prototype.onKill=function(){this.animations.stop(),this.parent&&(this.parent instanceof Phaser.Group?this.parent.remove(this):this.parent.removeChild(this)),this._listener=null},e.ANIM_KEYS={},e}(Phaser.Sprite);e.TaskSprite=a},5714:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tasks=void 0;var i=n(2178),o=n(1391),r=n(7857),s=n(6037),a=n(7809),l=function(){function t(){this._game=null,this._tasks=null,this._spritesPool=null,this._pools=null,this._game=i.App.game,this._tasks=new r.UnorderedArray,this.createSpritesPool(),this._pools=new Map}return Object.defineProperty(t,"instance",{get:function(){return null===t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spritesPool",{get:function(){return this._spritesPool},enumerable:!1,configurable:!0}),t.prototype.createTask=function(t){if(!this._pools.has(t)){var e=this.createTaskPool(t);this._pools.set(t,e)}var n=this._pools.get(t),i=n.spawn();if(!i)throw new Error("Couldn't allocate task of type "+t.name);return i.parentPool=n,i.reset(),this._tasks.add(i),i},t.prototype.createTaskPool=function(t){var e=this._game,n=this._spritesPool,i=new s.UnorderedArrayPool(t,1,(function(){return new t(e,n)}));return i.canGrow=!0,i},t.prototype.createSpritesPool=function(){var e=this._game,n=o.Defs.TASK_SPRITES_ANIMS;this._spritesPool=new s.UnorderedArrayPool(a.TaskSprite,t.TASK_SPRITES_CAPACITY,(function(){return new a.TaskSprite(e,n)})),this._spritesPool.canGrow=!0},t.prototype.hasTaskWithFlags=function(t){var e=this,n=!1;return this._tasks.iterate((function(i){i.flags&t&&(n=!0,e._tasks.stopIterate())})),n},t.prototype.findTaskWithId=function(t){var e=this,n=null;return this._tasks.iterate((function(i){i.id===t&&(n=i,e._tasks.stopIterate())})),n},t.prototype.update=function(t){var e=this;this._tasks.iterate((function(n){!n.finished&&n.update(t)||(n.kill(),e._tasks.remove(e._tasks.currentItem))}))},t.prototype.kill=function(){var t=this;this._tasks.iterate((function(e){e.kill(),t._tasks.remove(t._tasks.currentItem)})),this._spritesPool.iterate((function(e){e.onKill(),t._spritesPool.despawn(e)}))},t.prototype.debug=function(t){this._spritesPool;this._pools.forEach((function(t,e){}))},t.prototype.debugTasks=function(){var t=this;this._tasks.iterate((function(e){void 0!==e.debug&&e.debug(t._game.debug)}))},t.TASK_SPRITES_CAPACITY=32,t._instance=null,t}();e.Tasks=l},109:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskTutorialBase=void 0;var r=n(7278),s=n(2755),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._level=null,e._checking=!1,e._tutorialOn=!1,e}return o(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),this._checking=!0,this._tutorialOn=!1},e.prototype.init=function(t){this._level=t},e.prototype.kill=function(){this.parentPool.despawn(this)},e.prototype.update=function(t){return this._checking?this.initTutorial(t)&&(this._checking=!1,this._tutorialOn=!0):this._tutorialOn&&(this.finished=this.closeTutorial()),!this.finished},e.prototype.initTutorial=function(t){return!0},e.prototype.closeTutorial=function(){return!s.Tutorial.instance.isActive},e}(r.TaskBase);e.TaskTutorialBase=a},1735:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskTutorialCharge=void 0;var r=n(2178),s=n(3100),a=n(7389),l=n(109),h=n(2755),u=n(9071),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._limit=null,e._limitPosition=new Phaser.Point,e}return o(e,t),e.prototype.init=function(e,n){t.prototype.init.call(this,e),this._powerupID=n,this._game.time.events.add(350,this.showTutorial,this)},e.prototype.showTutorial=function(){var t=h.Tutorial.instance;this.flags=1,this._limit=this._level.HUD.limits.getLimit(this._powerupID),t.enqueueRequest(1,0,null,s.TutorialDefs.CHARGE).requeryPosition=this.requeryPosition.bind(this),t.show(this._level.parent),this._checking=!1,this._tutorialOn=!0,a.Emitters.instance.paused=!0},e.prototype.requeryPosition=function(){var t=this._level.HUD.limits.x+this._limit.x,e=this._level.HUD.limits.y+this._limit.y;return this._limitPosition.set(t,e),this._limitPosition},e.prototype.initTutorial=function(t){return!1},e.prototype.closeTutorial=function(){var e=t.prototype.closeTutorial.call(this);return e&&(r.App.settings.setTutorialShown(u.TutorialFlag.Charge),a.Emitters.instance.paused=!1),e},e}(l.TaskTutorialBase);e.TaskTutorialCharge=c},6441:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskTutorialDestory=void 0;var r=n(2178),s=n(3100),a=n(109),l=n(2755),h=n(9071),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._limit=null,e._limitPosition=new Phaser.Point,e}return o(e,t),e.prototype.initTutorial=function(t){var e=l.Tutorial.instance;if(e.isActive)return!1;var n=this._level.HUD.limits.hasSomeValue;if(!n)return!1;this._limit=n,this.flags=1;var i=s.TutorialDefs.DESTORY;return e.enqueueRequest(1,1e3,n.worldPos,i).requeryPosition=this.requeryPosition.bind(this),e.show(this._level.parent),!0},e.prototype.requeryPosition=function(){var t=this._level.HUD.limits.x+this._limit.x,e=this._level.HUD.limits.y+this._limit.y;return this._limitPosition.set(t,e),this._limitPosition},e.prototype.closeTutorial=function(){var e=t.prototype.closeTutorial.call(this);return e&&r.App.settings.setTutorialShown(h.TutorialFlag.FirstDestroy),e},e}(a.TaskTutorialBase);e.TaskTutorialDestory=u},8980:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskTutorialGame=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(3100),h=n(5714),u=n(109),c=n(2755),p=n(9071),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._target=null,e._lockInput=!1,e}return o(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.createTarget(),this.showTutorial()},e.prototype.createTarget=function(){var t=h.Tasks.instance.spritesPool.spawn();t.init(),t.loadFrame(a.Defs.FRAMES_TUTORIAL_TARGET,s.Config.ATLAS_COMMON),t.scale.set(1),t.anchor.set(.5),this._level.bottomBalls.add(t),this._target=t},e.prototype.showTutorial=function(){var t=c.Tutorial.instance;this.flags=1;var n=t.enqueueRequest(0,0,e.TARGET_POSITION[0],l.TutorialDefs.GAME_0);n.handleUpdate=this.handleUpdate.bind(this),n.handleClick=this.handleClick.bind(this),n.handleProcessed=this.handleProcessed.bind(this);var i=t.enqueueRequest(1,0,e.TARGET_POSITION[1],l.TutorialDefs.GAME_1);i.handleUpdate=this.handleUpdate.bind(this),i.handleClick=this.handleClick.bind(this),i.handleProcessed=this.handleProcessed.bind(this);var o=t.enqueueRequest(2,0,this._level.cannonPosition,l.TutorialDefs.GAME_2);o.handleUpdate=this.handleUpdate.bind(this),o.handleClick=this.handleClick.bind(this),o.handleProcessed=this.handleProcessed.bind(this),t.enqueueRequest(3,0,this._level.cannonPosition,l.TutorialDefs.GAME_3).handleProcessed=this.handleProcessed.bind(this),t.show(this._level.parent),this._checking=!1,this._tutorialOn=!0,this._lockInput=!1},e.prototype.handleUpdate=function(t){this._level.tutorialUpdate()},e.prototype.handleClick=function(t,e,n){if(this._lockInput)return!1;var i=this._target.width/2*(t<=1?1:1.2),o=i*i;return Phaser.Math.distanceSq(e,n,this._target.x,this._target.y)<=o&&(t<=1?this._level.launchBall(!1):this._level.cannon.swapBalls(),this._lockInput=!0,this._game.time.events.add(750,(function(){c.Tutorial.instance.next(),this._lockInput=!1}),this)),!1},e.prototype.handleProcessed=function(t){t<=1?(this._target.position.copyFrom(e.TARGET_POSITION[t]),this._target.visible=!0):2===t?(this._target.position.copyFrom(this._level.cannonPosition),this._target.scale.set(1.2)):(this._target.onKill(),h.Tasks.instance.spritesPool.despawn(this._target),this._game.time.events.add(3e3,(function(){c.Tutorial.instance.next()}),this))},e.prototype.initTutorial=function(t){return!1},e.prototype.closeTutorial=function(){var e=t.prototype.closeTutorial.call(this);return e&&r.App.settings.setTutorialShown(p.TutorialFlag.Game),e},e.TARGET_POSITION=[new Phaser.Point(330,-70),new Phaser.Point(-280,-200)],e}(u.TaskTutorialBase);e.TaskTutorialGame=_},4886:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.TaskTutorialMotor=void 0;var s=n(2178),a=n(3100),l=n(109),h=n(2755),u=n(9071),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.initTutorial=function(t){var e,n,i=h.Tutorial.instance;if(!i.isActive)try{for(var o=r(this._level.chains),s=o.next();!s.done;s=o.next()){var l=s.value;if(0!==l.ballsCount){var u=l.balls[l.ballsCount-1];if(u.isMotor&&u.pathDistance>350)return this.flags=1,i.enqueueRequest(1,0,u.position,a.TutorialDefs.MOTOR),i.show(this._level.parent),!0}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return!1},e.prototype.closeTutorial=function(){var e=t.prototype.closeTutorial.call(this);return e&&s.App.settings.setTutorialShown(u.TutorialFlag.Motor),e},e}(l.TaskTutorialBase);e.TaskTutorialMotor=c},1342:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskTutorialRainbow=void 0;var r=n(2178),s=n(3100),a=n(109),l=n(2755),h=n(9071),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._position=new Phaser.Point,e}return o(e,t),e.prototype.init=function(e,n,i){t.prototype.init.call(this,e),this._level=e,this._position.set(n,i-70),this._game.time.events.add(750,this.showTutorial,this)},e.prototype.showTutorial=function(){var t=l.Tutorial.instance;this.flags=1,t.enqueueRequest(1,0,this._position,s.TutorialDefs.RAINBOW),t.show(this._level.parent),this._checking=!1,this._tutorialOn=!0},e.prototype.initTutorial=function(t){return!1},e.prototype.closeTutorial=function(){var e=t.prototype.closeTutorial.call(this);return e&&r.App.settings.setTutorialShown(h.TutorialFlag.Rainbow),e},e}(a.TaskTutorialBase);e.TaskTutorialRainbow=u},3910:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TaskTutorialStardust=void 0;var r=n(2178),s=n(3100),a=n(109),l=n(2755),h=n(9071),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._starDustPosition=new Phaser.Point,e}return o(e,t),e.prototype.initTutorial=function(t){var e=l.Tutorial.instance,n=this._level.starDust;return!(e.isActive||!n.canPick)&&(this.flags=1,e.enqueueRequest(1,1e3,n.position,s.TutorialDefs.STARDUST_0),e.enqueueRequest(1,0,null,s.TutorialDefs.STARDUST_1).requeryPosition=this.requeryPosition.bind(this),e.show(this._level.parent),!0)},e.prototype.requeryPosition=function(){var t=this._level.HUD.x+this._level.HUD.starDust.x,e=this._level.HUD.y+this._level.HUD.starDust.y;return this._starDustPosition.set(t,e),this._starDustPosition},e.prototype.closeTutorial=function(){var e=t.prototype.closeTutorial.call(this);return e&&r.App.settings.setTutorialShown(h.TutorialFlag.StarDust),e},e}(a.TaskTutorialBase);e.TaskTutorialStardust=u},2755:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Tutorial=void 0;var r=n(2178),s=n(1353),a=n(6286),l=n(3024),h=n(903),u=function(t){function e(e){var n=t.call(this,e,null)||this;return n.onClosed=new Phaser.Signal,n.onRequest=new Phaser.Signal,n._blocker=null,n._bg=null,n._text=null,n._requests=null,n._currentRequest=null,n._requests=new s.Queue,n._blocker=n.createBlocker(),n.add(n._blocker),n._bg=new a.TutorialBg(e),n.add(n._bg),n._text=new l.TutorialText(e),n.add(n._text),n}return o(e,t),Object.defineProperty(e,"instance",{get:function(){return null===e._instance&&(e._instance=new e(r.App.game)),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isActive",{get:function(){return null!=this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasRequests",{get:function(){return!this._requests.isEmpty},enumerable:!1,configurable:!0}),e.prototype.createBlocker=function(){var t=this.game.add.sprite(0,0);return t.anchor.set(.5),t.events.onInputDown.add(this.handleClick,this),t},e.prototype.enableBlocker=function(t){this._blocker.inputEnabled=t,t&&(this._blocker.input.priorityID=e.INPUT_PRIORITY)},e.prototype.resize=function(t,e){this.isActive&&(this.updateRequestPosition(this._currentRequest),this.resizeBlocker(t,e),this._bg.requestPosition=this._currentRequest.position,this._bg.resize(t,e),this.positionText())},e.prototype.resizeBlocker=function(t,e){this._blocker.width=t,this._blocker.height=e},e.prototype.handleClick=function(t,e){if(!this._text.animationRunning&&this._currentRequest){var n=e.worldX,i=e.worldY;if(void 0!==this._currentRequest.def.handleOrientation&&this._currentRequest.def.handleOrientation&&!r.App.isLandscape){var o=n;n=i,i=-o}if(this._currentRequest.handleClick){if(!this._currentRequest.handleClick(this._currentRequest.id,n,i))return;this.next()}else this.next()}},e.prototype.closeTutorial=function(){this._currentRequest=null,null!=this.parent&&this.parent.remove(this),this.enableBlocker(!1),this.onClosed.dispatch()},e.prototype.enqueueRequest=function(t,e,n,i){var o={id:t,delay:e,position:n,def:i};return this._requests.enqueue(o),o},e.prototype.next=function(){this.hasRequests?this.processRequest():this.closeTutorial()},e.prototype.processRequest=function(){var t=this._requests.dequeue();this._currentRequest=null,t.delay?this.game.time.events.add(t.delay,(function(){this.doProcessRequest(t)}),this):this.doProcessRequest(t)},e.prototype.doProcessRequest=function(t){this._currentRequest=t;var e=void 0!==t.def.handleOrientation&&t.def.handleOrientation;this.updateRequestPosition(t),this._bg.setAppearance(t.position,t.def.bg,e),this._text.setAppearance(t.def.textbox),this._text.setText(t.def.textId),this.positionText(),this.makeVisible(!0),t.handleProcessed&&t.handleProcessed(t.id),this.onRequest.dispatch(t)},e.prototype.updateRequestPosition=function(t){t.requeryPosition&&(t.position=t.requeryPosition(t.id))},e.prototype.positionText=function(){var t=this._currentRequest,e=void 0!==this._currentRequest.def.handleOrientation&&this._currentRequest.def.handleOrientation;if(t.def.fixedPosition){var n=!r.App.isLandscape&&t.def.fixedPosition.length>1?1:0,i=t.def.fixedPosition[n],o=this.game.width/2,s=this.game.height/2,a=this._text.textWidth,l=this._text.textHeight,h=i.x-a/2,u=i.y-l/2;h<-o&&(h=-o),h+a>o&&(h=o-a),u<-s&&(u=-s),u+l>s&&(u=s-l),this._text.position.set(h,u)}else{var c=t.position.x,p=t.position.y;if(e&&!r.App.isLandscape){var _=c;c=-p,p=_}var f=!r.App.isLandscape&&t.def.bg.size.length>1?1:0,d=t.def.bg.size[f];this.placeText(c,p,d.width,d.height,t.def.textPlacement)}},e.prototype.placeText=function(t,e,n,i,o){var r,s,a,l,u,c=this.game.width,p=this.game.height,_=40,f=this._text.textHeight+80,d=this._text.textWidth+80;if(void 0!==o?(r=o===h.TutorialTextPlacement.Above?1:0,s=o===h.TutorialTextPlacement.Below?1:0,a=o==h.TutorialTextPlacement.Left?1:0,l=o==h.TutorialTextPlacement.Right?1:0,u=o===h.TutorialTextPlacement.Above||o===h.TutorialTextPlacement.Below):(r=e+(p-i)/2-f,s=(p-i)/2-e-f,a=t+(c-n)/2-d,l=(c-n)/2-t-d,u=Math.max(r,s)>Math.max(a,l)),u){this._text.y=r>s?e-i/2-_-this._text.textHeight:e+i/2+_;var y=t-this._text.textWidth/2;y=Phaser.Math.clamp(y,-c/2+_,c/2-_-this._text.textWidth),this._text.x=y}else{this._text.x=a>=l?t-n/2-_-this._text.textWidth:t+n/2+_;var m=e-this._text.textHeight/2;m=Phaser.Math.clamp(m,-p/2+_,p/2-_-this._text.textHeight),this._text.y=m}},e.prototype.show=function(t){this.hasRequests&&(t.add(this),this.enableBlocker(!0),this.resizeBlocker(this.game.width,this.game.height),this.makeVisible(!1),this.next())},e.prototype.makeVisible=function(t){this._bg.visible=t,this._text.visible=t},e.prototype.update=function(){this._currentRequest&&this._currentRequest.handleUpdate&&this._currentRequest.handleUpdate(this._currentRequest.id)},e.INPUT_PRIORITY=100,e._instance=null,e}(Phaser.Group);e.Tutorial=u},6286:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TutorialBg=void 0;var r=n(2178),s=n(5357),a=n(1391),l=function(t){function e(e){var n=t.call(this,e)||this;return n._sprites=[],n._requestPosition=new Phaser.Point,n._requestBg=null,n.createSprites(),n}return o(e,t),Object.defineProperty(e.prototype,"requestPosition",{set:function(t){this._requestPosition.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype.createSprites=function(){for(var t=this._sprites,e=0;e<5;e++){var n=this.game.add.sprite(0,0,s.Config.ATLAS_COMMON,a.Defs.FRAMES_TUTORIAL_BG,this);t.push(n)}t[0].anchor.set(.5,1),t[1].anchor.set(1,0),t[2].anchor.set(0,0),t[3].anchor.set(.5,0),t[4].anchor.set(.5)},e.prototype.resize=function(t,e){this.setLayout();var n=this._sprites[0];n.width=t,n.height=n.y+e/2,(n=this._sprites[1]).width=n.x+t/2,(n=this._sprites[2]).width=t-(n.x+t/2),(n=this._sprites[3]).width=t,n.height=e/2-n.y},e.prototype.setAppearance=function(t,e,n){this.requestPosition=t,this._requestBg=e,this._handleOrientation=n,this.resize(this.game.width,this.game.height)},e.prototype.setLayout=function(){var t=this._requestBg,e=this._requestPosition,n=Math.round(e.x),i=Math.round(e.y);if(this._handleOrientation&&!r.App.isLandscape){var o=n;n=-i,i=o}var s=!r.App.isLandscape&&t.size.length>1?1:0,a=t.size[s],l=-2&a.width,h=a.height&=-2,u=this._sprites[4];u.frameName=t.frame,u.position.set(n,i),u.width=l,u.height=h,this._sprites[0].position.set(0,i-h/2),this._sprites[1].position.set(n-l/2,i-h/2),this._sprites[2].position.set(n+l/2,i-h/2),this._sprites[3].position.set(0,i+h/2),this._sprites[1].height=this._sprites[2].height=h;for(var c=0;c<this._sprites.length;c++){var p=this._sprites[c],_=c<4;p.tint=_||t.tintFrame?t.tint:16777215,p.alpha=_||t.alphaFrame?t.alpha:1,p.visible=p.alpha>0}},e}(Phaser.Group);e.TutorialBg=l},9071:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TutorialFlag=void 0,function(t){t[t.None=0]="None",t[t.Powerups=1]="Powerups",t[t.Game=2]="Game",t[t.Motor=4]="Motor",t[t.FirstDestroy=8]="FirstDestroy",t[t.StarDust=16]="StarDust",t[t.Rainbow=32]="Rainbow",t[t.Charge=64]="Charge",t[t.PwYellow=128]="PwYellow",t[t.PwCyan=256]="PwCyan",t[t.PwPurple=512]="PwPurple",t[t.PwBomb=1024]="PwBomb",t[t.PwFreeze=2048]="PwFreeze",t[t.PwThrow=4096]="PwThrow",t[t.PwScore=8192]="PwScore",t[t.PwSteel=16384]="PwSteel",t[t.PwBack=32768]="PwBack"}(e.TutorialFlag||(e.TutorialFlag={}))},3024:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.TutorialText=void 0;var r=n(5357),s=n(1391),a=n(9820),l=n(2757),h=function(t){function e(n){var i=t.call(this,n)||this;i._bg=null,i._text=null,i._tween=null,i._animationRunning=!1;var o=e.TUTORIAL_TEXT_BG_MARGIN;return i._bg=i.game.add.sprite(-o,-o,r.Config.ATLAS_COMMON,s.Defs.FRAMES_TUTORIAL_TEXT_BG,i),i._text=new a.AdvancedBitmapText(n,0,0,r.Config.FONT_TUTORIAL_TEXT,"",r.Config.FONT_TUTORIAL_TEXT_SIZE,"left"),i.add(i._text),i._tween=n.add.tween(i._text).to({y:0,alpha:1},e.TWEEN_DURATION,Phaser.Easing.Linear.None,!1),i._tween.onComplete.add((function(){this._animationRunning=!1}),i),i}return o(e,t),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this._text.textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this._text.textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"animationRunning",{get:function(){return this._animationRunning},enumerable:!1,configurable:!0}),e.prototype.setAppearance=function(t){var n;this._bg.visible=t.showBg,t.showBg&&(this._bg.tint=t.tint,this._bg.alpha=t.alpha),this._text.maxWidth=null!==(n=t.maxWidth)&&void 0!==n?n:e.TUTORIAL_TEXT_WIDTH_MAX},e.prototype.setText=function(t){var e=l.TextUtils.getText(t);this._text.text=e,this.resizeBg(this.textWidth,this.textHeight),this.startAnimation()},e.prototype.startAnimation=function(){this._text.alpha=0,this._text.y=7,this._tween.start(),this._animationRunning=!0},e.prototype.resizeBg=function(t,n){if(null!==this._bg){var i=2*e.TUTORIAL_TEXT_BG_MARGIN;this._bg.width=t+i,this._bg.height=n+i}},e.TUTORIAL_TEXT_BG_MARGIN=16,e.TUTORIAL_TEXT_WIDTH_MAX=400,e.TWEEN_DURATION=500,e}(Phaser.Group);e.TutorialText=h},903:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TutorialTextPlacement=void 0,function(t){t[t.Above=0]="Above",t[t.Below=1]="Below",t[t.Left=2]="Left",t[t.Right=3]="Right"}(e.TutorialTextPlacement||(e.TutorialTextPlacement={}))},1395:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.UIBg=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(3824),h=function(t){function e(n){var i=t.call(this,n)||this;i._pool=null,i._used=[],i._textureSize=new Phaser.Point,i._pool=new l.Pool(Phaser.Sprite,e.INITIAL_POOL_CAPACTIY,(function(){return new Phaser.Sprite(n,0,0,s.Config.ATLAS_UI,a.Defs.FRAME_BG_UI)})),i._pool.canGrow=!0;var o=n.cache.getFrameByName(s.Config.ATLAS_UI,a.Defs.FRAME_BG_UI);return i._textureSize.set(o.sourceSizeW,o.sourceSizeH),i}return o(e,t),Object.defineProperty(e,"instance",{get:function(){return null===e._instance&&(e._instance=new e(r.App.game)),e._instance},enumerable:!1,configurable:!0}),e.prototype.clean=function(){for(var t=0;t<this._used.length;t++){var e=this._used[t];this.remove(e),this._pool.despawn(e)}this._used.length=0},e.prototype.setLayout=function(t,e){for(var n=-t*this._textureSize.x/2,i=-e*this._textureSize.y/2,o=0;o<e;o++){for(var r=n,s=0;s<t;s++){var a=this._pool.spawn();a.position.set(r,i),this.add(a),this._used.push(a),r+=this._textureSize.x}i+=this._textureSize.y}},e.prototype.onResize=function(t,e){this.clean();var n=Math.ceil(t/this._textureSize.x),i=Math.ceil(e/this._textureSize.y);this.setLayout(n,i)},e.prototype.onShutdown=function(){this.parent&&this.parent.remove(this)},e.INITIAL_POOL_CAPACTIY=20,e._instance=null,e}(Phaser.Group);e.UIBg=h},1050:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.UITrees=void 0;var r=n(2178),s=n(1391),a=n(5813),l=n(6223),h=function(t){function e(e){var n=t.call(this,e,null)||this;return n._windGroup=null,n._treeGroups=[],n._treePositions=[new Phaser.Point,new Phaser.Point,new Phaser.Point,new Phaser.Point],n._sourcePositions=null,n._windGroup=new a.WindGroup,n.createTrees(),n}return o(e,t),Object.defineProperty(e,"instance",{get:function(){return null===e._instance&&(e._instance=new e(r.App.game)),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"treePositions",{set:function(t){this._sourcePositions=t,this.setTargetPositions(t)},enumerable:!1,configurable:!0}),e.prototype.onTreeCreated=function(t){this._windGroup.addObject(t)},e.prototype.resetPositions=function(){for(var t=0;t<this._treeGroups.length;t++){var e=this._treePositions[t];this._treeGroups[t].position.set(e.x,e.y)}},e.prototype.onResize=function(t,e){this._sourcePositions&&this.setTargetPositions(this._sourcePositions)},e.prototype.setTargetPositions=function(t){var e=this.game.width/2,n=this.game.height/2,i=this._treePositions;i[0].x=t[0].x+640-e,i[0].y=t[0].y+400-n,i[1].x=t[1].x-640+e,i[1].y=t[1].y+400-n,i[2].x=t[2].x+640-e,i[2].y=t[2].y-400+n,i[3].x=t[3].x-640+e,i[3].y=t[3].y-400+n},e.prototype.createTrees=function(){this._treeGroups.push(new l.UITreesGroup(this.game,this,s.Defs.TREES_TOP_LEFT,-640,-400,this)),this._treeGroups.push(new l.UITreesGroup(this.game,this,s.Defs.TREES_TOP_RIGHT,640,-400,this)),this._treeGroups.push(new l.UITreesGroup(this.game,this,s.Defs.TREES_BOTTOM_LEFT,-640,400,this)),this._treeGroups.push(new l.UITreesGroup(this.game,this,s.Defs.TREES_BOTTOM_RIGHT,640,400,this))},e.prototype.updateTrees=function(){this.updatePosition(),this._windGroup.updateWind(this.game.time.time)},e.prototype.updatePosition=function(){for(var t=this.game.time.delta/1e3,e=0;e<this._treeGroups.length;e++){var n=this._treePositions[e],i=this._treeGroups[e].position;i.set(Phaser.Math.linear(n.x,i.x,Math.pow(2,-3*t)),Phaser.Math.linear(n.y,i.y,Math.pow(2,-3*t)))}},e.prototype.onShutdown=function(){this.parent&&this.parent.remove(this)},e._instance=null,e}(Phaser.Group);e.UITrees=h},6223:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.UITreesGroup=void 0;var s=n(6680),a=n(7709),l=function(t){function e(e,n,i,o,r,s){void 0===s&&(s=null);var a=t.call(this,e,n)||this;return a.decodeTrees(i,o,r,s),a}return o(e,t),e.prototype.decodeTrees=function(t,e,n,i){var o,s;try{for(var l=r(t),h=l.next();!h.done;h=l.next()){var u=h.value,c=this.decodeTree(u);c.x-=e,c.y-=n;var p=new a.WindSprite(this.game,c);this.add(p),i&&i.onTreeCreated(p)}}catch(t){o={error:t}}finally{try{h&&!h.done&&(s=l.return)&&s.call(l)}finally{if(o)throw o.error}}},e.prototype.decodeTree=function(t){return s.decode(t,e._tmpLevelItem)},e._tmpLevelItem={key:"",x:0,y:0,sx:0,sy:0,angle:0,alpha:1,tint:16777215},e}(Phaser.Group);e.UITreesGroup=l},2383:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.BallButton=void 0;var r=function(t){function e(n,i,o,r,s){var a=t.call(this,n,i,o,r,!1)||this;return a._shadow=null,a._shadowScale=1,a.createShadow(o,s),a.setMetrics(),a._shadow.y=(e.BUTTON_OFFSET_ON_DOWN+1)*a._shadowScale,a._shadow.scale.set(a._shadowScale),a.offsetOnDown.set(0,e.BUTTON_OFFSET_ON_DOWN*a._shadowScale),a.scaleOnDown.set(e.BUTTON_SCALE_ON_DOWN),a.scaleOnOver.set(e.BUTTON_SCALE_ON_OVER),a.setHitArea(new Phaser.Circle(0,0,.85*a._button.width)),a}return o(e,t),e.prototype.createShadow=function(t,e){var n=this.game.add.sprite(0,0,t,e,this);n.anchor.set(.5,.5),this.sendToBack(n),this._shadow=n},e.prototype.setMetrics=function(){this._shadowScale=this._button.width/e.BUTTON_BASE_WIDTH},e.prototype.outAction=function(){this._shadow.scale.set(this._shadowScale)},e.prototype.downAction=function(){t.prototype.downAction.call(this),this._shadow.scale.set(e.SHADOW_SCALE_ON_DOWN*this._shadowScale)},e.prototype.upAction=function(){this._shadow.scale.set(this._shadowScale)},e.prototype.cancelAction=function(){this._shadow.scale.set(this._shadowScale)},e.BUTTON_BASE_WIDTH=118,e.BUTTON_OFFSET_ON_DOWN=5,e.BUTTON_SCALE_ON_DOWN=.97,e.BUTTON_SCALE_ON_OVER=1.05,e.SHADOW_SCALE_ON_DOWN=e.BUTTON_SCALE_ON_DOWN,e}(n(3005).Button);e.BallButton=r},2842:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.FlagToggle=void 0;var r=n(1391),s=function(t){function e(e,n,i,o,s,a){var l=t.call(this,e,n,i,o,s,a)||this;return l.createShadow(i,r.Defs.FRAME_LANG_SHADOW),l}return o(e,t),e.prototype.createShadow=function(t,e){var n=this.game.add.sprite(0,0,t,e,this);n.anchor.set(.5,.5),n.y=4,this.sendToBack(n)},e.prototype.overAction=function(){this._button.tint=this._tintToggled},e.prototype.outAction=function(){this._button.tint=this._toggled?this._tintToggled:this._tintUntoggled},e}(n(3005).Toggle);e.FlagToggle=s},5427:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.ScrollBar=void 0;var r=n(7998),s=n(5357),a=function(t){function e(n,i,o,r){void 0===r&&(r=!1);var a=t.call(this,n,i,o)||this;a._thumbBg=null,a._thumbSprite=null,a._onScreenEdge=!1;var l=n.device.desktop?"levelsScrollbarDesktop":"levelsScrollbar";return a._thumbBg=n.add.sprite(-e.BORDER,0,s.Config.ATLAS_LEVELS,l,a),a._thumbBg.tint=0,a._thumbBg.alpha=.8,a._thumbBg.width+=2*e.BORDER,a._thumbSprite=n.add.sprite(0,0,s.Config.ATLAS_LEVELS,l,a),a._onScreenEdge=r,a}return o(e,t),e.prototype.resize=function(){t.prototype.resize.call(this),this.angle=this._isHorizontal?-90:0,this._thumbBg.y=this._marginStart-e.BORDER,this._thumbBg.height=this._trackLength+2*e.BORDER,this._thumbSprite.height=this._thumbLength,this._thumbSprite.y=(this._trackLength-this._thumbLength)*this._percent+this._marginStart},e.prototype.onPositionChange=function(t,e,n){var i=this.parent.toLocal(t.position,t.parent);this._isHorizontal?i.y+=t.viewSize.y+16:this._onScreenEdge?i.x=this.game.width/2-this._thumbSprite.width-11:i.x+=t.viewSize.x+30-this._thumbSprite.width,this.position.set(i.x,i.y)},e.BORDER=3,e}(r.AbstractScrollBar);e.ScrollBar=a},7059:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.ScrollBarActive=void 0;var r=function(t){function e(e,n,i,o,r){void 0===r&&(r=!1);var s=t.call(this,e,i,o,r)||this;return s._thumbBounds=new Phaser.Rectangle,s._dragging=!1,s._scroller=n,s.enableThumbInput(),s}return o(e,t),e.prototype.setMargin=function(e,n){t.prototype.setMargin.call(this,e,n),this.setThumbBounds(0,this._marginStart,20,this._scroller.viewSize.y-this._marginStart-this._marginEnd)},e.prototype.enableThumbInput=function(){var t=this._thumbSprite;t.inputEnabled=!0,t.input.priorityID=100,t.input.enableDrag(),t.input.allowHorizontalDrag=!1,t.events.onDragStart.add(this.onDragStart,this),t.events.onDragStop.add(this.onDragStop,this),t.events.onDragUpdate.add(this.onDragUpdate,this),t.input.boundsRect=this._thumbBounds,this.setThumbBounds(0,this._marginStart,20,this._scroller.viewSize.y-this._marginStart-this._marginEnd)},e.prototype.setThumbBounds=function(t,e,n,i){this._thumbBounds.setTo(t,e,n,i)},e.prototype.onDragStart=function(){this._dragging=!0},e.prototype.onDragStop=function(){this._dragging=!1},e.prototype.onDragUpdate=function(t,e,n,i,o,r,s,a){var l=this._thumbBounds.height-this._thumbLength,h=(t.y-this._thumbBounds.y)/l;this._scroller.setViewPosition(0,(this._scroller.area.height-this._scroller.viewSize.y)*h)},e.prototype.onViewMove=function(e,n,i){this._dragging||t.prototype.onViewMove.call(this,e,n,i)},e}(n(5427).ScrollBar);e.ScrollBarActive=r},5302:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UIElementsFactory=void 0;var i=n(2178),o=n(5357),r=n(1391),s=n(9820),a=n(3005),l=n(2383),h=n(2842),u=function(){function t(){}return t.createTitle=function(t){var e=new s.AdvancedBitmapText(i.App.game,0,0,o.Config.FONT_DIALOG_TITLE,"",o.Config.FONT_DIALOG_TITLE_SIZE,"center");return e.anchor.set(.5,0),e.tint=r.Defs.COLOR_DIALOG_TITLE,e.textID=t,e},t.createText=function(t,e){void 0===e&&(e=0);var n=new s.AdvancedBitmapText(i.App.game,0,0,o.Config.FONT_DIALOG_TEXT,"",o.Config.FONT_DIALOG_TEXT_SIZE,"center");return n.anchor.set(.5,.5),n.tint=r.Defs.COLOR_DIALOG_TEXT,n.maxWidth=e,n.textID=t,n.colors=r.Defs.TEXT_COLORS,n},t.createBallButton=function(t,e,n){return void 0===n&&(n=null),n||(n=r.Defs.FRAME_BUTTON_SHADOW_BALL),new l.BallButton(i.App.game,t,o.Config.ATLAS_UI,e,n)},t.createSmallButton=function(e,n,o){var r=new a.Button(i.App.game,e,n,o,!1);return r.setHitArea(new Phaser.Rectangle(-27,-30,54,54)),t.setButtonBehaviour(r),r},t.createSmallToggle=function(e,n,i,o,r){return void 0===o&&(o=!0),void 0===r&&(r=!1),t.createToggle(a.Toggle,e,n,i,o,r)},t.createFlagToggle=function(e,n){var i=t.createToggle(h.FlagToggle,e,null,n);return i.offsetOnDown.set(0,0),i.setToggleTint(9474192,16777215),i},t.createToggle=function(e,n,r,s,a,l){void 0===a&&(a=!0),void 0===l&&(l=!1);var h=new e(i.App.game,n,o.Config.ATLAS_UI,s,r,!1);return h.changeOnDown=a,l&&(h.downAction=function(){}),t.setButtonBehaviour(h),h},t.setButtonBehaviour=function(t){t.scaleOnOver.set(1.05),t.offsetOnDown.set(0,4)},t}();e.UIElementsFactory=u},2260:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Wave=void 0;n(2178);var i=n(5357),o=function(){function t(t,e,n){this._def=null,this._manager=null,this._chain=null,this._state=1,this._current=-1,this._delay=0,this._spawned=!1,this._finished=!1,this._def=t,this._manager=e,this._chain=n,n.onWaveSpawned.add(this.handleSpawned,this),n.onWaveDestroyed.add(this.handleDestroyed,this),this.loadWave()}return Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spawned",{get:function(){return this._spawned},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"finished",{get:function(){return this._finished},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"waiting",{get:function(){return 1===this._state||this.waveData.destroy&&this._spawned||this._delay>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"waveData",{get:function(){return this._def[this._current]},enumerable:!1,configurable:!0}),t.prototype.handleSpawned=function(){this._spawned=!0,this.finished||this.waveData.destroy||this.loadWave()},t.prototype.handleDestroyed=function(t){t===this._current&&!this.finished&&this.waveData.destroy&&this.loadWave()},t.prototype.loadWave=function(){++this._current,this._spawned=!1,this._delay=this.waveData.delay*(75/i.Config.CHAIN_SPEED)+this._manager.difficultyAddDelaySec,this._state=this.waveData.sync?1:0,this._current+1===this._def.length&&(this._finished=!0)},t.prototype.update=function(t){this.updateSync()&&(this._delay<0||(this.updateDelay(t)||0===this._chain.ballsCount)&&(this._delay=-1,this._chain.nextWave(this._current,this.waveData.count,this._finished)))},t.prototype.updateSync=function(){return 1===this._state&&this._manager.checkSync(this)&&(this._state=0),1!==this._state},t.prototype.updateDelay=function(t){return(this._delay-=t)<0},t}();e.Wave=o},5024:function(t,e,n){"use strict";var i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.WavesManager=void 0;var o=n(2260),r=function(){function t(t,e){this._def=null,this._waves=[],this._finished=!1,this._waiting=!1,this._levelDifficulty=null,this._def=t,this._levelDifficulty=e}return Object.defineProperty(t.prototype,"ballTypes",{get:function(){return this._def.ballTypes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"finished",{get:function(){return this._finished},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"waiting",{get:function(){return this._waiting},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"waves",{get:function(){return this._waves},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"difficultyAddDelaySec",{get:function(){var t,e;return null!==(e=null===(t=this._levelDifficulty)||void 0===t?void 0:t.addDelaySec)&&void 0!==e?e:0},enumerable:!1,configurable:!0}),t.prototype.addChain=function(t){var e=new o.Wave(this._def.waves[this._waves.length],this,t);this._waves.push(e)},t.prototype.checkSync=function(t){var e,n;try{for(var o=i(this._waves),r=o.next();!r.done;r=o.next()){var s=r.value;if(s!==t&&s.current<t.current)return!1}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return!0},t.prototype.update=function(t){var e,n;this._finished=!0,this._waiting=!0;try{for(var o=i(this._waves),r=o.next();!r.done;r=o.next()){var s=r.value;s.update(t),this._finished=this._finished&&s.finished&&s.spawned,this._waiting=this._waiting&&(s.waiting||s.spawned)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},t}();e.WavesManager=r},5813:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WindGroup=void 0;var i=n(2516),o=function(){function t(){this._items=[],this._wind=null,this._windRotation=0,this.precalcNoise();this._windRotation=2*Math.random()*Math.PI,this._wind=this.createWind(this._windRotation,5)}return Object.defineProperty(t.prototype,"windRotation",{get:function(){return this._windRotation},enumerable:!1,configurable:!0}),t.prototype.precalcNoise=function(){if(!t.NOISE){for(var e=[],n=Math.floor(100*Math.random()),o=Math.floor(100*Math.random()),r=0;r<4096;r++)e[r]=i.Perlin.perlin2(n+r/64,o+r/64);t.NOISE=e}},t.prototype.createWind=function(t,e){return new Phaser.Point(Math.cos(t)*e,Math.sin(t)*e)},t.prototype.addObject=function(t){this._items.push(t)},t.prototype.updateWind=function(t){for(var e=.06*t,n=0;n<this._items.length;n++){var i=this._items[n],o=i.originalPosition,r=this.getNoise(o.x,o.y,e),s=this._wind.x*r,a=this._wind.y*r;i.doWind(r,s,a)}},t.prototype.getNoise=function(e,n,i){var o=e+(n<<10)+i,r=Math.floor(o),s=r+1,a=o-r,l=t.NOISE[4095&r],h=t.NOISE[4095&s];return Phaser.Math.linear(l,h,a)},t.NOISE=null,t}();e.WindGroup=o},7709:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WindSprite=void 0;var r=n(5357),s=n(1391),a=function(t){function e(e,n){var i=t.call(this,e,n.x,n.y,r.Config.ATLAS_SPRITES,n.key)||this;i._windAffected=!1,i._originalPosition=null,i._originalAngle=0,i._moveScale=1,i._rotationScale=1,i._doMovement=!1,i._doRotation=!1,i.scale.set(n.sx,n.sy),i.anchor.set(.5),i.angle=n.angle,i.alpha=n.alpha,i.tint=n.tint,i._originalPosition=new Phaser.Point(n.x,n.y),i._originalAngle=n.angle;var o=s.Defs.WAVE_SCALE[n.key];return void 0!==o&&(i._windAffected=!0,i._moveScale=o.moveScale*(n.sx+n.sy)/2,i._rotationScale=o.rotationScale,i._doMovement=o.movement,i._doRotation=o.rotation),i}return o(e,t),Object.defineProperty(e.prototype,"windAffected",{get:function(){return this._windAffected},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originalPosition",{get:function(){return this._originalPosition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"windScale",{get:function(){return this._moveScale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMoving",{get:function(){return this._doMovement||this._doRotation},enumerable:!1,configurable:!0}),e.prototype.doWind=function(t,e,n){this._doMovement&&this.position.set(this._originalPosition.x+e*this._moveScale,this._originalPosition.y+n*this._moveScale),this._doRotation&&(this.angle=this._originalAngle+t*this._rotationScale)},e}(Phaser.Sprite);e.WindSprite=a},240:function(t,e,n){"use strict";var i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.Settings=void 0;var o=n(3545),r=n(5357),s=n(1391),a=n(1873),l=function(){function t(t){this._data=null,this._saveKey=null,this._saveKey=t,this._data=new a.SettingsData}return Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"soundOn",{get:function(){return this._data.soundOn},set:function(t){this._data.soundOn=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"musicOn",{get:function(){return this._data.musicOn},set:function(t){this._data.musicOn=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentLanguage",{get:function(){return this._data.currentLanguage},set:function(t){this._data.currentLanguage=t},enumerable:!1,configurable:!0}),t.prototype.load=function(t){var e=this;o.StorageUtils.load(this._saveKey).then((function(n){null!=n?e._data=n:e.initDefaultData(),t&&t()}))},t.prototype.save=function(t){o.StorageUtils.save(this._saveKey,this._data).then((function(){t&&t()}))},t.prototype.initDefaultData=function(){var t=this.data.powerups;for(var e in s.Defs.POWERUPS)t[e]={level:0};for(var n=this.data.levelStates,i=0;i<r.Config.LEVEL_MAX;i++)n.push({unlocked:!1,star:!1,starDust:0,score:0});this.data.stars=0},t.prototype.getPowerupLevel=function(t){return this._data.powerups[t].level},t.prototype.hasLevelFreeStarDust=function(t){return this._data.levelStates[t].starDust<r.Config.STARDUST_LEVEL_LIMIT},t.prototype.onStarDustPicked=function(t){var e=!1;return++this._data.levelStates[t].starDust,5==++this._data.starDust&&(++this._data.stars,this._data.starDust=0,e=!0),this.save(),e},t.prototype.getLevelScore=function(t){return this._data.levelStates[t].score},t.prototype.setLevelScore=function(t,e){this._data.levelStates[t].score=e},t.prototype.totalScore=function(){var t,e,n=0;try{for(var o=i(this._data.levelStates),r=o.next();!r.done;r=o.next()){n+=r.value.score}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n},t.prototype.isTutorialShown=function(t){return(this._data.tutorialsShown&t)>0},t.prototype.setTutorialShown=function(t){this._data.tutorialsShown|=t,this.save()},t}();e.Settings=l},1873:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SettingsData=void 0;var n=function(){this.musicOn=!0,this.soundOn=!0,this.currentLanguage="en",this.firstRun=!0,this.stars=0,this.starDust=0,this.powerups={},this.levelStates=[],this.animateOpening=!1,this.selectedLevelId=0,this.tutorialsShown=0,this.congratsShown=!1};e.SettingsData=n},8630:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sounds=void 0;var n=function(){function t(){}return t.AUDIO_JSON={resources:["assets\\sound\\Sfx.ogg","assets\\sound\\Sfx.m4a"],spritemap:{back:{start:0,end:1.0018367346938775,loop:!1},ballConnect:{start:3,end:3.0853061224489795,loop:!1},ballMatch1:{start:5,end:5.350385487528345,loop:!1},ballMatch2:{start:7,end:7.350997732426304,loop:!1},ballMatch3:{start:9,end:9.350204081632652,loop:!1},ballMatch4:{start:11,end:11.350340136054422,loop:!1},ballMatch5:{start:13,end:13.356485260770976,loop:!1},ballShot:{start:15,end:15.09968253968254,loop:!1},ballSwitch:{start:17,end:17.16736961451247,loop:!1},bombGet:{start:19,end:20.07768707482993,loop:!1},bugCrip:{start:22,end:22.347891156462584,loop:!1},bugDeath:{start:24,end:24.471678004535146,loop:!1},bugShow:{start:26,end:27.000861678004537,loop:!1},click:{start:29,end:29.107573696145124,loop:!1},endExplosion:{start:31,end:32.45176870748299,loop:!1},endWhoosh:{start:34,end:34.80755102040816,loop:!1},explosion:{start:36,end:37.18424036281179,loop:!1},fireBurn:{start:39,end:39.709977324263036,loop:!1},fireImpact:{start:41,end:42.374489795918365,loop:!1},fireLaunch:{start:44,end:44.51299319727891,loop:!1},freeze:{start:46,end:47.001836734693875,loop:!1},gateLock:{start:49,end:50.40337868480726,loop:!1},gateOpen:{start:52,end:52.800657596371884,loop:!1},glass:{start:54,end:54.51866213151927,loop:!1},gunImpact:{start:56,end:56.806507936507934,loop:!1},gunServo:{start:58,end:58.874580498866216,loop:!1},gunShot:{start:60,end:60.473174603174606,loop:!1},lbBomb:{start:62,end:62.11628117913832,loop:!1},lbBombImpact:{start:64,end:64.28777777777778,loop:!1},lbShow:{start:66,end:67.67163265306122,loop:!1},lghtChain:{start:69,end:70.00165532879818,loop:!1},lghtImpact:{start:72,end:72.44639455782313,loop:!1},limitFull:{start:74,end:74.74848072562358,loop:!1},lose:{start:76,end:80.00086167800454,loop:!1},motorDeath:{start:82,end:83.75537414965986,loop:!1},pathReveal:{start:85,end:88.05893424036282,loop:!1},pathSeal:{start:90,end:91.50034013605442,loop:!1},pwrUpgrade:{start:93,end:94.36936507936508,loop:!1},rainbowGet:{start:96,end:96.86179138321995,loop:!1},rainbowMatch:{start:98,end:99.36015873015873,loop:!1},recolor:{start:101,end:101.09258503401361,loop:!1},score:{start:103,end:103.96718820861678,loop:!1},slow:{start:105,end:106.00557823129252,loop:!1},star:{start:108,end:110.22566893424036,loop:!1},stardustHUD:{start:112,end:112.90680272108844,loop:!1},stardustPick:{start:114,end:115.3887074829932,loop:!1},stardustShow:{start:117,end:119.72174603174604,loop:!1},steelGet:{start:121,end:122.00505668934241,loop:!1},steelHit1:{start:124,end:124.14283446712018,loop:!1},steelHit2:{start:126,end:126.15580498866213,loop:!1},steelHit3:{start:128,end:128.16374149659865,loop:!1},steelWall:{start:130,end:130.95009070294785,loop:!1},summonFog:{start:132,end:132.48530612244897,loop:!1},summonSparkles:{start:134,end:137.55265306122448,loop:!1},throw:{start:139,end:139.37215419501135,loop:!1},throwGet:{start:141,end:141.79090702947846,loop:!1},throwImpact:{start:143,end:143.31625850340137,loop:!1},toolDrop1:{start:145,end:145.15226757369615,loop:!1},toolDrop2:{start:147,end:147.2501814058957,loop:!1},wheelDrop:{start:149,end:150.20002267573696,loop:!1},wheelShake:{start:152,end:152.43396825396826,loop:!1},win:{start:154,end:158.86854875283447,loop:!1}}},t}();e.Sounds=n},6e3:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpatialType=void 0,function(t){t[t.Ball=0]="Ball",t[t.Collider=1]="Collider"}(e.SpatialType||(e.SpatialType={}))},7892:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpatialGrid=e.SpatialTestType=void 0;var i,o=n(2178);!function(t){t[t.All=0]="All",t[t.Static=1]="Static",t[t.Dynamic=2]="Dynamic"}(i=e.SpatialTestType||(e.SpatialTestType={}));var r=function(t,e){this.x=t,this.y=e},s=function(t,e,n,i){this.x1=t,this.y1=e,this.x2=n,this.y2=i},a=function(){function t(t,e,n,i,o,r){this._size=null,this._grid=null,this._cell=null,this._cellInv=null,this._anchor=null,this._offset=null,this._bins=null,this._binsFlat=null,this._testID=0,this._rect=new s(0,0,0,0),this._l=new Phaser.Line,this.calculateDimensions(t,e,n,i),this.calculateAnchor(o,r),this.createBins()}return t.prototype.render=function(t){for(var e=-this._offset.x,n=-this._offset.y,i="RGBA(100,100,255,1)",r=0;r<=this._grid.y;r++){var s=n+r*this._cell.y;this._l.setTo(e,s,e+this._size.x,s),t.debug.geom(this._l,i,!0)}for(var a=0;a<=this._grid.x;a++){var l=e+a*this._cell.x;this._l.setTo(l,n,l,n+this._size.y),t.debug.geom(this._l,i,!0)}for(r=0;r<this._bins.length;r++){var h=this._bins[r];for(a=0;a<h.length;a++){var u=this._bins[r][a];t.debug.text(u.totalCount+" / "+u.staticCount,e+o.App.game.width/2+a*this._cell.x,n+o.App.game.height/2+r*this._cell.y+16,"RGBA(100,100,255,1)","14px monospace")}}},t.fromDimensionsAndGrid=function(e,n,i,o,r,s){return void 0===r&&(r=0),void 0===s&&(s=0),new t(i,o,Math.ceil(e/i),Math.ceil(n/o),r,s)},t.fromDimensionsAndCell=function(e,n,i,o,r,s){return void 0===r&&(r=0),void 0===s&&(s=0),new t(Math.ceil(e/i),Math.ceil(n/o),i,o,r,s)},t.fromCellAndGrid=function(e,n,i,o,r,s){return void 0===r&&(r=0),void 0===s&&(s=0),new t(e,n,i,o,r,s)},t.prototype.calculateDimensions=function(t,e,n,i){this._size=new r(t*n,e*i),this._grid=new r(t,e),this._cell=new r(n,i),this._cellInv=new r(1/n,1/i)},t.prototype.calculateAnchor=function(t,e){this._anchor=new r(t,e),this._offset=new r(Math.round(this._size.x/2),Math.round(this._size.y/2))},t.prototype.createBins=function(){for(var t=[],e=[],n=0;n<this._grid.y;n++){e[n]=[];for(var i=0;i<this._grid.x;i++){var o={objs:[],staticCount:0,totalCount:0};e[n][i]=o,t.push(o)}}this._bins=e,this._binsFlat=t},t.prototype.clear=function(t){void 0===t&&(t=!1);for(var e=0;e<this._binsFlat.length;e++){var n=this._binsFlat[e];t&&(n.staticCount=0),n.totalCount=n.staticCount}},t.prototype.addStatic=function(t,e,n,i,o,r,s){void 0===r&&(r=0),void 0===s&&(s=0);for(var a=0;a<this._binsFlat.length;a++){if((l=this._binsFlat[a]).totalCount>l.staticCount)throw new Error("Staic objects must be added into Spatial grid first before any dynamic objects")}this.add(t,e,n,i,o,r,s);for(a=0;a<this._binsFlat.length;a++){var l;(l=this._binsFlat[a]).staticCount=l.totalCount}},t.prototype.add=function(t,e,n,i,o,r,s){void 0===r&&(r=0),void 0===s&&(s=0);var a=this.setRect(e,n,i,o,r,s);if(a.x1!==a.x2||a.y1!==a.y2)for(var l=a.y1;l<=a.y2;l++)for(var h=a.x1;h<=a.x2;h++){if(!this.outOfGrid(h,l))(u=this._bins[l][h]).objs[u.totalCount++]=t}else{if(this.outOfGrid(a.x1,a.y1))return;var u;(u=this._bins[a.y1][a.x1]).objs[u.totalCount++]=t}},t.prototype.test=function(t,e,n,i,o,r,s,a){void 0===s&&(s=0),void 0===a&&(a=0);var l=this.setRect(t,e,n,i,s,a);this.doTest(l,o,r,!1)},t.prototype.testUnique=function(t,e,n,i,o,r,s,a){void 0===s&&(s=0),void 0===a&&(a=0),++this._testID;var l=this.setRect(t,e,n,i,s,a);this.doTest(l,o,r,!0)},t.prototype.doTest=function(t,e,n,o){for(var r=t.y1;r<=t.y2;r++)for(var s=t.x1;s<=t.x2;s++)if(!this.outOfGrid(s,r))for(var a=this._bins[r][s],l=a.objs,h=e===i.Dynamic?a.staticCount:0,u=e===i.Static?a.staticCount:a.totalCount,c=h;c<u;c++){var p=l[c];if(o){if(p.spatialTestID===this._testID)continue;p.spatialTestID=this._testID}if(n(p))return}},t.prototype.outOfGrid=function(t,e){return t<0||t>=this._grid.x||e<0||e>=this._grid.y},t.prototype.setRect=function(t,e,n,i,o,r){var s=this._rect,a=(t+=this._offset.x)-n*o,l=a+n-1,h=(e+=this._offset.y)-i*r,u=h+i-1,c=this._cellInv.x,p=this._cellInv.y;return s.x1=Math.floor(a*c),s.x2=Math.floor(l*c),s.y1=Math.floor(h*p),s.y2=Math.floor(u*p),s},t}();e.SpatialGrid=a},2014:function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.getSponsorFeatures=e.SPONSOR_FEATURES=void 0;var o=n(8553);e.SPONSOR_FEATURES=((i={})[o.eSponsorID.NONE]={id:o.eSponsorID.NONE,name:"none",hasConfig:!0,defaultLanguage:"en"},i[o.eSponsorID.WKB]={id:o.eSponsorID.WKB,name:"wkb",hasConfig:!0,defaultLanguage:"ja"},i[o.eSponsorID.WANTED5GAMES]={id:o.eSponsorID.WANTED5GAMES,name:"wanted5games",hasConfig:!1,defaultLanguage:"en"},i[o.eSponsorID.ORANGE_FR]={id:o.eSponsorID.ORANGE_FR,name:"orange_fr",hasConfig:!1,defaultLanguage:"en"},i[o.eSponsorID.TATAKI]={id:o.eSponsorID.TATAKI,name:"tataki",hasConfig:!0,defaultLanguage:"en"},i[o.eSponsorID.YANDEX]={id:o.eSponsorID.YANDEX,name:"yandex",hasConfig:!1,defaultLanguage:"en"},i[o.eSponsorID.GAMEDISTRIBUTION]={id:o.eSponsorID.GAMEDISTRIBUTION,name:"gamedistribution",hasConfig:!1,defaultLanguage:"en",showPreRollAd:!0,showMidRollAd:!0},i[o.eSponsorID.COOLMATHGAMES]={id:o.eSponsorID.COOLMATHGAMES,name:"coolmathgames",hasConfig:!0,defaultLanguage:"en",logo:!0},i),e.getSponsorFeatures=function(t){if(null==e.SPONSOR_FEATURES[t])throw new Error("Features for sponsor "+o.eSponsorID[t]+" are not in SPONSOR_FEATURES list.");return e.SPONSOR_FEATURES[t]}},9782:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Boot=void 0;var r=n(2178),s=n(5357),a=n(6020),l=n(7306),h=n(4740),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._userScale=new Phaser.Point(1,1),e._gameDims=new Phaser.Point,e._orientationChange=!1,e}return o(e,t),e.prototype.init=function(){this.input.maxPointers=1,this.stage.disableVisibilityChange=!1,this.game.device.iOS&&(this.stage.disableVisibilityChange=!0),this.calcGameDims(),this.scale.fullScreenScaleMode=Phaser.ScaleManager.USER_SCALE,this.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.scale.setUserScale(this._userScale.x,this._userScale.y),this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.scale.setResizeCallback(this.gameResized,this);var t=!1;this.game.device.ie&&this.game.device.mspointer&&(t=!0),(!this.game.device.desktop&&!t||s.Config.DEBUG_EMULATE_MOBILE)&&(s.Config.ENABLE_PORTRAIT||this.scale.forceOrientation(!0,!1),this.scale.onOrientationChange.add(this.orientationChange,this)),r.App.isLandscape=!s.Config.ENABLE_PORTRAIT||!this.game.device.desktop&&this.scale.isLandscape||this.game.device.desktop&&window.innerWidth>=window.innerHeight,this.sound.onStateChange.add((function(t){"interrupted"===t&&this.resumeInterruptedContext()}),this)},e.prototype.resumeInterruptedContext=function(){var t=document.getElementById("sbc_game_content"),e=this;t.addEventListener("pointerdown",(function n(){a.AudioUtils.playSound("click"),e.sound.context.resume(),t.removeEventListener("pointerdown",n,!1)}),!1)},e.prototype.create=function(){l.Utils.isFeatureOn("logo")?(this.game.state.add("Logo",h.Logo),this.game.state.start("Logo")):this.game.state.start("Preloader")},e.prototype.calcGameDims=function(){var t=window.innerWidth,e=window.innerHeight;if(s.Config.DEBUG_NO_SCALE&&(t=s.Config.GAME_WIDTH,e=s.Config.GAME_HEIGHT),0!=t&&0!=e){var n=s.Config.GAME_WIDTH,i=s.Config.GAME_HEIGHT;if(this.game.device.desktop&&s.Config.ENABLE_PORTRAIT){var o=r.App.isLandscape;r.App.isLandscape=t>=e,r.App.isLandscape!==o&&(this._orientationChange=!0)}if(!r.App.isLandscape&&s.Config.ENABLE_PORTRAIT){var a=n;n=i,i=a}var l=1;r.App.isLandscape?t/e>=n/i?(l=e/i,n=Math.min(t/l,2048)):(l=t/n,i=Math.min(e/l,1024)):e/t>=i/n?(l=t/n,i=Math.min(e/l,2048)):(l=e/i,n=Math.min(t/l,1024)),this._userScale.set(l,l),this._gameDims.set(n,i)}},e.prototype.gameResized=function(t,e){if(!t.incorrectOrientation||s.Config.ENABLE_PORTRAIT){var n=this._userScale.x,i=this._userScale.y;this.calcGameDims();var o=this._gameDims,r=this._userScale;if(o.x!==this.game.width||o.y!==this.game.height||Math.abs(r.x-n)>.001||Math.abs(r.y-i)>.001){this.scale.setGameSize(o.x,o.y),this.scale.setUserScale(r.x,r.y);var a=this.game.state.getCurrentState();"function"==typeof a.onResize&&a.onResize(o.x,o.y)}}this._orientationChange&&(this._orientationChange=!1,this.onOrientationChanged())},e.prototype.orientationChange=function(t,e,n){s.Config.DO_NOT_HANDLE_ORIENTATION||(t.isLandscape?this.leaveIncorrectOrientation():this.enterIncorrectOrientation())},e.prototype.enterIncorrectOrientation=function(){if(s.Config.ENABLE_PORTRAIT)r.App.isLandscape=!1,this._orientationChange=!0;else{document.getElementById("sbc_orientation").style.display="block";var t=this.game.state.getCurrentState();"function"==typeof t.onPause&&t.onPause()}},e.prototype.leaveIncorrectOrientation=function(){if(s.Config.ENABLE_PORTRAIT)r.App.isLandscape=!0,this._orientationChange=!0;else{document.getElementById("sbc_orientation").style.display="none";var t=this.game.state.getCurrentState();"function"==typeof t.onResume&&t.onResume()}},e.prototype.onOrientationChanged=function(){var t=this.game.state.getCurrentState();"function"==typeof t.handleOrientationChange&&t.handleOrientationChange(r.App.isLandscape)},e}(Phaser.State);e.Boot=u},5733:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Congrats=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(5302),h=n(9820),u=n(7215),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._icon=null,e._text=null,e._button=null,e}return o(e,t),e.prototype.doPreCreate=function(){this.createBg(),this.createLight();var t=r.App.isLandscape?a.Defs.TREES_MENU_POSITIONS:a.Defs.TREES_MENU_POSITIONS_PORTRAIT;this.createTrees(t,!0),this.createIcon(),this.createText(),this.createBackButton(),this.playMusic(a.Defs.MUSIC_MENU_KEY,a.Defs.MUSIC_VOLUME[a.Defs.MUSIC_MENU_KEY])},e.prototype.createIcon=function(){var t=this.game.add.sprite(0,0,s.Config.ATLAS_UI,a.Defs.FRAME_CONGRATS,this.world);t.anchor.set(.5,1),this._icon=t},e.prototype.createText=function(){var t=new h.AdvancedBitmapText(this.game,0,0,s.Config.FONT_DIALOG_TITLE,"",s.Config.FONT_DIALOG_TITLE_SIZE,"center");t.anchor.set(.5,0),t.colors=a.Defs.TEXT_COLORS,t.text=u.TextUtils.getText("TXT_CONGRATS"),this.world.add(t),this._text=t},e.prototype.textWidth=function(){return r.App.isLandscape?1e3:740},e.prototype.createBackButton=function(){var t=l.UIElementsFactory.createBallButton("Back","buttonNo");t.onClick.add(this.handleBackButton,this),this.world.add(t),this._button=t},e.prototype.handleBackButton=function(){this.inputLocked||(r.App.settings.data.congratsShown=!0,r.App.settings.save(),this.transitionHide())},e.prototype.onResize=function(e,n){t.prototype.onResize.call(this,e,n),this._light.position.set(0,170),this._text.maxWidth=this.textWidth();var i=this._text.textHeight,o=-(this._icon.height+20+i+20+this._button.button.height)/2+this._icon.height;this._icon.y=o,o+=20,this._text.position.set(0,o),o+=i+20+this._button.button.height/2,this._button.position.y=o},e.prototype.handleOrientationChange=function(t){this.onResize(this.game.width,this.game.height),this._trees.treePositions=t?a.Defs.TREES_MENU_POSITIONS:a.Defs.TREES_MENU_POSITIONS_PORTRAIT,this._trees.resetPositions()},e.prototype.onTransitionHideFinished=function(){this.state.states.Menu.doTransitionOnEnter=!0,this.state.start("Menu",!0,!1,!1)},e}(n(7318).SceneUIBase);e.Congrats=c},5020:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Levels=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(1502),h=n(1581),u=n(5427),c=n(7059),p=n(5302),_=n(2517),f=n(4129),d=n(6020),y=n(5443),m=n(7318),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._treesFromOutOfScreen=!1,e._listBox=null,e._scrollBar=null,e._animateLevelOpening=!1,e._animateDelay=0,e._levelOpener=null,e._thumbSprite=null,e._btnBack=null,e}return o(e,t),e.prototype.init=function(t,n){this._treesFromOutOfScreen=n,this._levelOpener=null,this._animateLevelOpening=t&&!s.Config.DEBUG_UNLOCK_ALL_LEVELS,this._animateDelay=e.ANIMATE_DELAY,r.App.settings.data.animateOpening=!1,r.App.settings.save()},e.prototype.doPreCreate=function(){this.createBg(),this.createLight(),this.createCenterGroup(),this.createThumbsListBox();var t=r.App.isLandscape?a.Defs.TREES_LEVELS_POSITIONS:a.Defs.TREES_LEVELS_POSITIONS_PORTRAIT;if(this.createTrees(t,this._treesFromOutOfScreen),this.world.bringToTop(this._centerGroup),this.createButtons(),!this.doTransitionOnEnter){this._centerGroup.alpha=0,this.showCenterGroup();var e=this._listBox.scroller;e.alpha=0,this.game.add.tween(e).to({alpha:1},m.SceneUIBase.CENTER_TWEEN_DURATION,Phaser.Easing.Linear.None,!0)}this.playMusic(a.Defs.MUSIC_MENU_KEY,a.Defs.MUSIC_VOLUME[a.Defs.MUSIC_MENU_KEY])},e.prototype.createThumbsListBox=function(){var t=this.game.width-80,n=this.game.height-20,i=new f.Scroller(this.game,t,n,this.world,{useMask:!1}),o=r.App.isLandscape?e.LISTBOX_OPTIONS:e.LISTBOX_OPTIONS_PORTRAIT;this._listBox=new _.ListBox(this.game,h.LevelThumbItem,i,o),this._listBox.setPosition(-t/2,-n/2),this._listBox.onItemClick.add(this.onLevelThumbClicked,this);var s=this.game.device.desktop?new c.ScrollBarActive(this.game,i,this._centerGroup,!1,!0):new u.ScrollBar(this.game,this._centerGroup,!1,!0);s.setMargin(20,20),this._listBox.scroller.addListener(s),this._scrollBar=s},e.prototype.handleCreateCompleted=function(){this._listBox.content=r.App.settings.data.levelStates,this._listBox.focusOnItemIndex(r.App.settings.data.selectedLevelId),this.createLevelOpener(),this.animateOpening()},e.prototype.createLevelOpener=function(){if(this._thumbSprite=null,this._animateLevelOpening){var t=this.findLastUnlockedLevel(),e=this._listBox.items[t];r.App.settings.data.selectedLevelId=t;var n=new l.LevelOpener(this.game);this._levelOpener=n,n.attachToThumb(e),this._thumbSprite=e.thumb,this._thumbSprite.visible=!1}},e.prototype.createButtons=function(){var t=p.UIElementsFactory.createBallButton("Back","buttonBackBig");this._btnBack=this.createButton(t,this._centerGroup,this.onButton,this)},e.prototype.onResize=function(e,n){t.prototype.onResize.call(this,e,n),this._light.position.set(0,170);var i=this._btnBack.button.width/2+y.SceneBase.BUTTON_OFFSET_X,o=this._btnBack.button.height/2+y.SceneBase.BUTTON_OFFSET_Y;r.App.isLandscape||(o+=s.Config.PORTRAIT_BOTTOM_BUTTONS_OFFSET),this._btnBack.position.set(-e/2+i,n/2-o),this._scrollBar.onPositionChange(this._listBox.scroller,0,0)},e.prototype.handleOrientationChange=function(t){this._trees.treePositions=t?a.Defs.TREES_LEVELS_POSITIONS:a.Defs.TREES_LEVELS_POSITIONS_PORTRAIT,this._trees.resetPositions(),this._listBox.options=t?e.LISTBOX_OPTIONS:e.LISTBOX_OPTIONS_PORTRAIT,this._listBox.content=r.App.settings.data.levelStates;var n=this.game.width-80,i=this.game.height-20;this._listBox.setViewSize(n,i),this._listBox.setPosition(-n/2,-i/2),this._listBox.focusOnItemIndex(r.App.settings.data.selectedLevelId),this.onResize(this.game.width,this.game.height)},e.prototype.onButton=function(t){if(!this.inputLocked&&!this._animateLevelOpening){var e=this._listBox.scroller;this.game.add.tween(e).to({alpha:0},m.SceneUIBase.CENTER_TWEEN_DURATION,Phaser.Easing.Linear.None,!0),this.hideCenterGroup()}},e.prototype.onCenterGroupHidden=function(){this.state.start("Menu",!0,!1,!1)},e.prototype.onLevelThumbClicked=function(t,e,n){this._animateLevelOpening||(r.App.settings.data.levelStates[e].unlocked||s.Config.DEBUG_UNLOCK_ALL_LEVELS)&&(r.App.settings.data.selectedLevelId=e,d.AudioUtils.playAudioRecord(a.Defs.SFX_CLICK),r.App.settings.data.stars>0?this.state.start("Powerups",!0,!1,!1,e):this.transitionHide())},e.prototype.onTransitionHideFinished=function(){this.state.states.Play.doTransitionOnEnter=!0,this.state.start("Play",!0,!1,r.App.settings.data.selectedLevelId)},e.prototype.animateOpening=function(){this._levelOpener&&(this._listBox.scroller.inputEnabled=!1,this.time.events.add(500,(function(){this._levelOpener.start()}),this))},e.prototype.update=function(){t.prototype.update.call(this);var e=Math.min(this.time.delta,50);this._animateLevelOpening&&(this._animateDelay>0?(this._animateDelay-=this.time.delta,this._animateDelay<=0&&this._thumbSprite&&(this._thumbSprite.visible=!0)):this._levelOpener.animate(e)&&(this._listBox.scroller.inputEnabled=!0,this._animateLevelOpening=!1))},e.prototype.shutdown=function(){t.prototype.shutdown.call(this),this._listBox.scroller.inputEnabled=!1},e.ANIMATE_DELAY=500,e.LISTBOX_OPTIONS={gridColumns:4,spacingV:20,spacingH:20,marginTop:110,marginBottom:110},e.LISTBOX_OPTIONS_PORTRAIT={gridColumns:3,spacingV:20,spacingH:20,marginTop:150,marginBottom:200},e}(m.SceneUIBase);e.Levels=g},4740:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Logo=void 0;var r=n(2178),s=n(1391),a=n(1752),l=n(8553),h=n(8884),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._screenColor=0,e}return o(e,t),Object.defineProperty(e.prototype,"screenColor",{get:function(){return this._screenColor},set:function(t){this.stage.backgroundColor=h.ColorUtils.interpolateTint(1842204,s.Defs.COLOR_BG,t)},enumerable:!1,configurable:!0}),e.prototype.preload=function(){var t="assets/sponsor/"+r.App.sponsor.features.name+"/logo.png";this.game.load.image("Logo",t)},e.prototype.doPostCreate=function(){r.App.sponsor.id===l.eSponsorID.COOLMATHGAMES&&this.coolMathGamesLogo(),this.time.events.add(3e3,(function(){this.state.start("Preloader",!0,!1)}),this)},e.prototype.coolMathGamesLogo=function(){this.stage.backgroundColor=1842204;var t=this.game.add.image(0,0,"Logo");t.anchor.set(.5,.5),t.scale.set(.5),t.alpha=0;var e=250;this.game.add.tween(t.scale).to({x:1,y:1},e,a.pop5,!0,100),this.game.add.tween(t).to({alpha:1},e,Phaser.Easing.Linear.None,!0,100),this.game.time.events.add(2500,(function(){this.game.add.tween(t).to({alpha:0},e,Phaser.Easing.Linear.None,!0),this.game.add.tween(this).to({screenColor:1},e,Phaser.Easing.Linear.None,!0,150)}),this)},e.prototype.shutdown=function(){this.cache.removeImage("Logo")},e}(n(5443).SceneBase);e.Logo=u},2267:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Menu=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(3826),h=n(7864),u=n(4525),c=n(5302),p=n(1752),_=n(8553),f=n(7318),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._treesFromOutOfScreen=!1,e._title=null,e._btnsPanel=null,e._btnStart=null,e._btnPowerups=null,e._btnLanguages=null,e._btnCredits=null,e._tglSound=null,e._tglMusic=null,e._score=null,e._dlgCredits=null,e._dlgLanguages=null,e}return o(e,t),e.prototype.init=function(t){this._treesFromOutOfScreen=t},e.prototype.doPreCreate=function(){this.createBg(),this.createLight();var t=r.App.isLandscape?a.Defs.TREES_MENU_POSITIONS:a.Defs.TREES_MENU_POSITIONS_PORTRAIT;if(this.createTrees(t,this._treesFromOutOfScreen),this.createCenterGroup(),this.fillCenterGroup(),this.createDialogs(),this._tglSound.toggled=r.App.settings.soundOn,this._tglMusic.toggled=r.App.settings.musicOn,this._centerGroup.alpha=0,this.showCenterGroup(),this.playMusic(a.Defs.MUSIC_MENU_KEY,a.Defs.MUSIC_VOLUME[a.Defs.MUSIC_MENU_KEY]),s.Config.DEBUG_USE_PROFILES){var e=new Phaser.BitmapText(this.game,0,-250,s.Config.FONT_DIALOG_TEXT,"Profile: balls = "+(-1==s.Config.DEBUG_BALLS?"default":s.Config.DEBUG_BALLS),s.Config.FONT_DIALOG_TEXT_SIZE,"center");e.anchor.set(.5,.5),this.world.add(e),this.game.input.keyboard.addKey(Phaser.KeyCode.P).onDown.add((function(){s.Config.DEBUG_PROFILE_IDX=(s.Config.DEBUG_PROFILE_IDX+1)%s.Config.DEBUG_PROFILES.length,r.App.settings.data.powerups=s.Config.DEBUG_PROFILES[s.Config.DEBUG_PROFILE_IDX].powerups,s.Config.DEBUG_BALLS=s.Config.DEBUG_PROFILES[s.Config.DEBUG_PROFILE_IDX].balls,e.text="Profile: balls = "+(-1==s.Config.DEBUG_BALLS?"default":s.Config.DEBUG_BALLS)}),this)}},e.prototype.fillCenterGroup=function(){this.createTitle(),this.createStartButton(),!r.App.settings.data.firstRun&&r.App.settings.data.levelStates[0].star&&this.createPowerupsButton(),this.createButtons(),s.Config.SCORE_SYSTEM&&this.createScore()},e.prototype.createTitle=function(){var t=new u.DSDEntity(this.game,a.Defs.ANIM_TITLE,s.Config.ATLAS_UI,this._centerGroup);t.play("Title"),this._title=t},e.prototype.createStartButton=function(){var t=c.UIElementsFactory.createBallButton("Start","buttonPlayBig");this._btnStart=this.createButton(t,this._centerGroup,this.onStartButton,this),this.add.tween(t.scale).to({x:1.05,y:1.05},500,(function(t){return p.sinWithExpDecay(t,2,3)}),!0,1e3,-1).repeatDelay(3e3)},e.prototype.createPowerupsButton=function(){var t=c.UIElementsFactory.createBallButton("Powerup","buttonPowerup",a.Defs.FRAME_BUTTON_SHADOW_POWERUP);this._btnPowerups=this.createButton(t,this._centerGroup,this.onPowerupsButton,this)},e.prototype.createButtons=function(){var t=new Phaser.Group(this.game,this._centerGroup);this.game.add.sprite(0,0,s.Config.ATLAS_UI,"settingsBg",t).anchor.set(.5),this._btnsPanel=t;var e=c.UIElementsFactory.createSmallToggle("Sound","buttonSound","buttonSoundOff",!1,!0);e.onClick.add(this.onSoundToggle,this),t.add(e),this._tglSound=e;var n=c.UIElementsFactory.createSmallToggle("Music","buttonMusic","buttonMusicOff",!1,!0);if(n.onClick.add(this.onMusicToggle,this),t.add(n),this._tglMusic=n,s.Config.SHOW_LANGUAGES){var i=c.UIElementsFactory.createSmallButton("Languages",s.Config.ATLAS_UI,"buttonLang");this._btnLanguages=this.createButton(i,t,this.onLanguagesButton,this)}if(s.Config.SHOW_CREDITS){i=c.UIElementsFactory.createSmallButton("Credits",s.Config.ATLAS_UI,"buttonAbout");this._btnCredits=this.createButton(i,t,this.onCreditsButton,this)}},e.prototype.createScore=function(){var t=r.App.settings.totalScore();if(0!==t){var e=new Phaser.BitmapText(this.game,0,0,s.Config.FONT_SCORE_GAME,a.Defs.SCORE_TEXT+t,s.Config.FONT_SCORE_MENU_SIZE,"center");e.anchor.set(.5,1),this._centerGroup.add(e),this._score=e}},e.prototype.createDialogs=function(){var t=l.DialogCredits.create();t.onElement.add(this.onCreditsDlg,this),t.onShown.add(this.onDlgShown,this),t.onHidden.add(this.onDlgHidden,this),this._dlgCredits=t;var e=h.DialogLanguages.create();e.onElement.add(this.onLanguagesDlg,this),e.onShown.add(this.onDlgShown,this),e.onHidden.add(this.onDlgHidden,this),this._dlgLanguages=e},e.prototype.onResize=function(e,n){t.prototype.onResize.call(this,e,n);var i=r.App.isLandscape,o=i&&this._score?-40:0;this._light.position.set(0,170),this._title.position.set(0,0+o),this._btnStart.position.set(0,275+o),this._btnPowerups&&this._btnPowerups.position.set(132,216+o),this._btnsPanel.position.set(0,-n/2+50),this.positionButtons(),this._score&&(this._score.y=i?n/2-10:n/2-130)},e.prototype.handleOrientationChange=function(t){this.onResize(this.game.width,this.game.height),this._trees.treePositions=t?a.Defs.TREES_MENU_POSITIONS:a.Defs.TREES_MENU_POSITIONS_PORTRAIT,this._trees.resetPositions()},e.prototype.onInputLocked=function(t){var e=!t;this._btnStart.setEnabled(e),this._tglSound.setEnabled(e),this._tglMusic.setEnabled(e),this._btnPowerups&&this._btnPowerups.setEnabled(e),this._btnLanguages&&this._btnLanguages.setEnabled(e),this._btnCredits&&this._btnCredits.setEnabled(e)},e.prototype.positionButtons=function(){var t=-90*(2+(this._btnLanguages?1:0)+(this._btnCredits?1:0)-1)/2;this._tglSound.position.set(t,3),t+=90,this._tglMusic.position.set(t,3),t+=90,this._btnLanguages&&(this._btnLanguages.position.set(t,3),t+=90),this._btnCredits&&(this._btnCredits.position.set(t,3),t+=90)},e.prototype.onStartButton=function(t){if(!this.inputLocked){var e=r.App.settings.data.firstRun,n=r.App.settings;e&&(n.data.firstRun=!1,n.data.levelStates[0].unlocked=!0,n.data.animateOpening=!0,n.save()),e&&s.Config.PLAY_ON_FIRST_RUN?this.transitionHide():(this.hideCenterGroup(f.HideCenterReason.Levels),r.App.sponsorID===_.eSponsorID.COOLMATHGAMES&&r.App.sponsor.startGameSession("start"))}},e.prototype.onTransitionHideFinished=function(){r.App.settings.data.animateOpening=!1,r.App.settings.save(),this.state.states.Play.doTransitionOnEnter=!0,this.state.start("Play",!0,!1,0)},e.prototype.onPowerupsButton=function(t){this.inputLocked||this.hideCenterGroup(f.HideCenterReason.Powerups)},e.prototype.onSoundToggle=function(t){this.inputLocked||this.toggleSound(t.toggled)},e.prototype.onMusicToggle=function(t){this.inputLocked||this.toggleMusic(t.toggled)},e.prototype.onLanguagesButton=function(t){this.inputLocked||this.showDialogDelayed(e.DIALOG_DELAY,this._dlgLanguages)},e.prototype.onCreditsButton=function(t){this.inputLocked||this.showDialogDelayed(e.DIALOG_DELAY,this._dlgCredits)},e.prototype.showDialogDelayed=function(t,e){this.hideCenterGroup(),this.game.time.events.add(t,(function(){e.show()}),this)},e.prototype.onDlgShown=function(){this.inputLocked=!1},e.prototype.onDlgHidden=function(){this.game.time.events.add(f.SceneUIBase.CENTER_DELAY,(function(){this.showCenterGroup()}),this)},e.prototype.onCreditsDlg=function(t){this.inputLocked=!0,this._dlgCredits.hide()},e.prototype.onLanguagesDlg=function(t){"Close"!==t?this.onLanguageChanged(t):(this.inputLocked=!0,this._dlgLanguages.hide())},e.prototype.onLanguageChanged=function(t){s.Config.supportedLanguages.indexOf(t)<0||(r.App.settings.currentLanguage=t,r.App.settings.save(),this._dlgLanguages.onLanguageChanged(),this._dlgCredits.onLanguageChange())},e.prototype.update=function(){t.prototype.update.call(this),this._title.updateAnim()},e.prototype.onCenterGroupHidden=function(){switch(this._hideCenterReason){case f.HideCenterReason.Levels:this.state.start("Levels",!0,!1,r.App.settings.data.animateOpening,!1);break;case f.HideCenterReason.Powerups:this.state.start("Powerups",!0,!1,!0,null)}},e.DIALOG_DELAY=f.SceneUIBase.CENTER_TWEEN_DURATION+250,e}(f.SceneUIBase);e.Menu=d},9510:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Play=void 0;var r=n(2178),s=n(5357),a=n(1391),l=n(286),h=n(4406),u=n(5242),c=n(5808),p=n(8716),_=n(7389),f=n(726),d=n(5714),y=n(2755),m=n(7653),g=n(3061),v=n(7306),T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._levelId=0,e._level=null,e._replay=!1,e._touchCapturer=null,e._pointerPosition=new Phaser.Point,e._hud=null,e._dlgPause=null,e._dlgGameOver=null,e._dialogActionName=null,e._score=0,e._paused=!1,e._gameOver=!1,e._win=!1,e._waitingGameOver=!1,e._gameOverDelay=0,e._showCongrats=!1,e._backToMainMenu=!1,e}return o(e,t),e.prototype.init=function(t,e){void 0===e&&(e=!1),this._levelId=t,this._level=null,this._replay=e,this._score=0,this.stopMusic()},e.prototype.doPreCreate=function(){this.createLevel(),this.setMouseHandlers(),this.createHUD(),this.createDialogs();var t=_.Emitters.instance;t.loadTexture(0,s.Config.ATLAS_EFFECTS),t.loadTexture(1,s.Config.ATLAS_EFFECTS),this._level.HUD=this._hud},e.prototype.doPostCreate=function(){this._paused=!0,this._gameOver=!1,this._waitingGameOver=!1,this.time.events.add(3500,(function(){var t=m.MusicManager.instance.getGameplayMusic();this.playMusic(t,a.Defs.MUSIC_VOLUME[t])}),this),this._level.angle=r.App.isLandscape?0:90,this.startGameSession()},e.prototype.createLevel=function(){var t=a.Defs.LEVEL_KEYS[this._levelId],e=s.Config.DEBUG_LOAD_INDIVIDUAL_LEVEL_FILES?this.cache.getJSON(t):this.cache.getJSON("Levels")[t],n=new p.Level(this.game,this.world,this._levelId);n.onGameOver.add(this.handleGameOver,this),l.LevelStructure.instance.loadLevel(this._levelId,e,n),n.onLevelLoaded(),n.onAddScore.add(this.handleAddScore,this),this._level=n},e.prototype.createHUD=function(){var t=new c.HUD(this.game,this.world);t.onClick.add(this.onHUDButton,this),this._hud=t},e.prototype.createDialogs=function(){this._dlgPause=u.DialogPause.create(),this._dlgPause.onElement.add(this.onPauseDlg,this),this._dlgPause.onHidden.add(this.onDialogHidden,this),this._dlgGameOver=h.DialogGameOver.create(),this._dlgGameOver.onElement.add(this.onGameOverDlg,this),this._dlgGameOver.onHidden.add(this.onDialogHidden,this),this._dlgGameOver.onButtonsShown.add(this.handleGameOverButtonShown,this)},e.prototype.setMouseHandlers=function(){var t=this.game.add.sprite(0,0);t.anchor.set(.5),t.inputEnabled=!0,t.input.priorityID=0,t.events.onInputDown.add(this.onTouchCapturerDown,this),t.events.onInputUp.add(this.onTouchCapturerUp,this),t.renderable=!1,this._touchCapturer=t,this.game.input.addMoveCallback(this.onPointerMove,this)},e.prototype.onResize=function(e,n){t.prototype.onResize.call(this,e,n),this._touchCapturer.width=e,this._touchCapturer.height=n,this._hud.onResize(e,n),this._dlgPause.onResize(e,n),this._dlgGameOver.onResize(e,n),y.Tutorial.instance&&y.Tutorial.instance.isActive&&y.Tutorial.instance.resize(e,n)},e.prototype.handleOrientationChange=function(t){this._level.angle=t?0:90,this._level.bonusManager.handleOrientationChange(),this.onResize(this.game.width,this.game.height)},e.prototype.onTouchCapturerDown=function(t,e){this.inputLocked||this.onPointerDown(e)},e.prototype.onTouchCapturerUp=function(t,e){this.inputLocked||this.onPointerUp(e)},e.prototype.onPointerDown=function(t){this._paused||(this.setPointer(t.worldX,t.worldY),this._pointerDown=!0,this._level.onPointerDown(this._pointerPosition,this._pointerDown))},e.prototype.onPointerMove=function(t,e,n,i){this.inputLocked||this._paused||(this.setPointer(t.worldX,t.worldY),this._level.onPointerMove(this._pointerPosition,this._pointerDown))},e.prototype.onPointerUp=function(t){this._paused||(this.setPointer(t.worldX,t.worldY),this._pointerDown=!1,this._level.onPointerUp(this._pointerPosition,this._pointerDown))},e.prototype.setPointer=function(t,e){r.App.isLandscape?this._pointerPosition.set(t,e):this._pointerPosition.set(e,-t)},e.prototype.onHUDButton=function(t){this.inputLocked||"Pause"===t.name&&this.showPauseDialog(!0)},e.prototype.handleAddScore=function(t){this._score+=t,this._hud.score=this._score},e.prototype.showPauseDialog=function(t){this._paused=!0,this._dlgPause.show(t)},e.prototype.onPauseDlg=function(t,e){switch(t){case a.Defs.DLG_ID_SOUND:this.toggleSound(e.toggled);break;case a.Defs.DLG_ID_MUSIC:this.toggleMusic(e.toggled);break;case a.Defs.DLG_ID_MENU:case a.Defs.DLG_ID_REPLAY:this.onGameInterrupted(),this._dlgPause.hide(t);break;case a.Defs.DLG_ID_CONTINUE:this._dlgPause.hide(t)}},e.prototype.onGameOverDlg=function(t){t===a.Defs.DLG_ID_CONTINUE&&(t=a.Defs.DLG_ID_NEXT),this._dlgGameOver.hide(t)},e.prototype.onDialogHidden=function(t){t!==a.Defs.DLG_ID_CONTINUE?(this._dialogActionName=t,this._paused=!0,this.transitionHide(250)):this._paused=!1},e.prototype.handleGameOver=function(t){this._gameOver||(this._gameOver=!0,this.inputLocked=!0,t?this.fadeMusicVolumeTo(0):this.stopMusic(),this._win=t,this._waitingGameOver=!0,this._gameOverDelay=e.GAMEOVER_DELAY)},e.prototype.doHandleGameOver=function(t){if(f.Shaker.instance.kill(),this._paused=!0,t){var e=r.App.settings,n=e.data,i=n.levelStates[this._levelId],o=i.star;o||++n.stars,i.star=!0;var a=this._levelId+1<s.Config.LEVEL_MAX;if(a){var l=n.levelStates[this._levelId+1].unlocked;n.levelStates[this._levelId+1].unlocked=!0,n.animateOpening=n.animateOpening||!l}this._backToMainMenu=!a,this._showCongrats=!a&&!r.App.settings.data.congratsShown;var h=!1;s.Config.SCORE_SYSTEM&&this._score>i.score&&(i.score=this._score,h=!0),e.save(),this._dlgGameOver.init(!0,this._levelId,!o,this._score,h),this._dlgGameOver.show()}else this._dlgGameOver.init(!1,this._levelId,!1,-1,!1),this._dlgGameOver.show()},e.prototype.onPause=function(){this.paused()},e.prototype.paused=function(){this.inputLocked||this._paused||y.Tutorial.instance.isActive||this.showPauseDialog(!1)},e.prototype.update=function(){if(this.updateDialogs(),!this._paused){this._level.updateLevel(),_.Emitters.instance.update();var t=Math.min(this.time.delta,50)/1e3;f.Shaker.instance.update(t),this._waitingGameOver&&(this._gameOverDelay-=this.time.delta)<=0&&!d.Tasks.instance.hasTaskWithFlags(2)&&(this._waitingGameOver=!1,this.doHandleGameOver(this._win))}},e.prototype.handleGameOverButtonShown=function(){var t=s.Config.SEND_TOTAL_SCORE?r.App.settings.totalScore():this._win||s.Config.SEND_SCORE_WHEN_LOST?this._score:0;this.endGameSession(t)},e.prototype.onGameInterrupted=function(){r.App.sponsorID===g.eSponsorID.WKB?this.showAd():this.endGameSession(0)},e.prototype.startGameSession=function(){var t={eventName:this._replay?"replay":"start",eventValue:this._levelId};r.App.sponsor.startGameSession(t)},e.prototype.endGameSession=function(t){r.App.sponsor.endGameSession(t)},e.prototype.showAd=function(){r.App.sponsor.showAd()},e.prototype.updateDialogs=function(){this._dlgGameOver.visible&&this._dlgGameOver.updateDialog()},e.prototype.onTransitionRevealFinished=function(){t.prototype.onTransitionRevealFinished.call(this),this._paused=!1},e.prototype.onTransitionHideFinished=function(){switch(v.Utils.isFeatureOn("showMidRollAd")&&r.App.sponsor.showAd(),this._dialogActionName){case a.Defs.DLG_ID_MENU:this.state.states.Menu.doTransitionOnEnter=!0,this.state.start("Menu",!0,!1,!0);break;case a.Defs.DLG_ID_REPLAY:this.state.states.Play.doTransitionOnEnter=!0,this.state.start("Play",!0,!1,this._levelId,!0);break;case a.Defs.DLG_ID_NEXT:this._showCongrats?(this._showCongrats=!1,this.state.states.Congrats.doTransitionOnEnter=!0,this.state.start("Congrats")):this._backToMainMenu?(this._backToMainMenu=!1,this.state.states.Menu.doTransitionOnEnter=!0,this.state.start("Menu",!0,!1,!0)):(this.state.states.Levels.doTransitionOnEnter=!0,this.state.start("Levels",!0,!1,r.App.settings.data.animateOpening,!0))}},e.prototype.shutdown=function(){t.prototype.shutdown.call(this),this._level.onShutdown()},e.GAMEOVER_DELAY=2e3,e}(n(5443).SceneBase);e.Play=T},447:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.Powerups=void 0;var s=n(2178),a=n(5357),l=n(1391),h=n(3100),u=n(4541),c=n(7389),p=n(6403),_=n(4063),f=n(800),d=n(2755),y=n(9071),m=n(5302),g=n(6020),v=n(5443),T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._elementsPanel=null,e._chainPanel=null,e._stars=null,e._textPanel=null,e._btnBack=null,e._btnPlay=null,e._dlgStars=null,e._fromMenu=!1,e._levelId=0,e._desktopMode=!1,e._selected=null,e._tutorialPosition=new Phaser.Point,e}return o(e,t),e.prototype.init=function(t,e){this._fromMenu=t,this._levelId=e},e.prototype.doPreCreate=function(){var t=this.findLastUnlockedLevel();this._desktopMode=this.game.device.desktop,this.createBg(),this.createLight();var e=s.App.isLandscape?l.Defs.TREES_POWERUPS_POSITIONS:l.Defs.TREES_POWERUPS_POSITIONS_PORTRAIT;this.createTrees(e,!1),this.createCenterGroup();var n=s.App.isLandscape?l.Defs.PANEL_ELEMENTS:l.Defs.PANEL_ELEMENTS_PORTRAIT;this._elementsPanel=this.createPanel(n,t);var i=s.App.isLandscape?l.Defs.PANEL_CHAIN:l.Defs.PANEL_CHAIN_PORTRAIT;this._chainPanel=this.createPanel(i,t),this.createStars(),this.createTextPanel(),this.createBackButton(),this.createPlayButton(),this.createDialogs(),c.Emitters.instance.loadTexture(0,a.Config.ATLAS_HUD),this._centerGroup.alpha=0,this.showCenterGroup()},e.prototype.doPostCreate=function(){this.showTutorial()},e.prototype.handleCreateCompleted=function(){d.Tutorial.instance.isActive||this.newPowerupTutorial()},e.prototype.createPanel=function(t,e){var n,i,o=new p.PowerupsPanel(this.game,this._centerGroup,t),a=s.App.settings.data.powerups;try{for(var l=r(o.items),h=l.next();!h.done;h=l.next()){var u=h.value;u.setup(e,a[u.key].level),u.onClick.add(this.onPowerupClick,this),u.onOver.add(this.onPowerupOver,this)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}return o},e.prototype.createStars=function(){this._stars=new _.PowerupStars(this.game,this._centerGroup),this._stars.stars=s.App.settings.data.stars},e.prototype.createTextPanel=function(){this._textPanel=new f.PowerupTextPanel(this.game,this._centerGroup)},e.prototype.createBackButton=function(){var t=m.UIElementsFactory.createBallButton("Back","buttonBackBig");this._btnBack=this.createButton(t,this._centerGroup,this.onBackButton,this)},e.prototype.createPlayButton=function(){if(this._fromMenu)this._btnPlay=null;else{var t=m.UIElementsFactory.createBallButton("Back","buttonPlayBig");this._btnPlay=this.createButton(t,this._centerGroup,this.onPlayButton,this)}},e.prototype.createDialogs=function(){this._dlgStars=u.DialogStars.create(),this._dlgStars.onElement.add(this.onStarsDlg,this)},e.prototype.onResize=function(e,n){t.prototype.onResize.call(this,e,n),this._light.position.set(0,170),s.App.isLandscape?(this._elementsPanel.position.set(0,-148),this._chainPanel.position.set(0,88)):(this._elementsPanel.position.set(0,-248),this._chainPanel.position.set(0,188)),this._stars.position.set(0,-n/2+84);var i=this._btnBack.button.width/2+v.SceneBase.BUTTON_OFFSET_X,o=this._btnBack.button.height/2+v.SceneBase.BUTTON_OFFSET_Y;s.App.isLandscape||(o+=a.Config.PORTRAIT_BOTTOM_BUTTONS_OFFSET),this._btnBack.position.set(-e/2+i,n/2-o),this._textPanel.position.set(0,n/2-o),null!==this._btnPlay&&this._btnPlay.position.set(e/2-i,n/2-o),this._dlgStars.onResize(e,n),d.Tutorial.instance&&d.Tutorial.instance.isActive&&d.Tutorial.instance.resize(e,n)},e.prototype.handleOrientationChange=function(t){this._trees.treePositions=t?l.Defs.TREES_POWERUPS_POSITIONS:l.Defs.TREES_POWERUPS_POSITIONS_PORTRAIT,this._trees.resetPositions(),this._elementsPanel.setLayout(t?l.Defs.PANEL_ELEMENTS:l.Defs.PANEL_ELEMENTS_PORTRAIT),this._chainPanel.setLayout(t?l.Defs.PANEL_CHAIN:l.Defs.PANEL_CHAIN_PORTRAIT),this._textPanel.setLayout(),this.onResize(this.game.width,this.game.height)},e.prototype.onPowerupClick=function(t,e){this.inputLocked||(g.AudioUtils.playAudioRecord(l.Defs.SFX_CLICK),this._desktopMode?(t.enableInput(!1),this.clearPowerupSelection(t),this.upgradePowerup(t),t.enableInput(!0)):this._selected!==t?(this.clearPowerupSelection(this._selected),this.setPowerupSelection(t),this._selected=t):(t.enableInput(!1),this.clearPowerupSelection(t),this.upgradePowerup(t),this._selected=null,t.enableInput(!0)))},e.prototype.onPowerupOver=function(t,e){this._desktopMode&&(e?this.setPowerupSelection(t):this.clearPowerupSelection(t))},e.prototype.setPowerupSelection=function(t){this._textPanel.displayText(t.key,s.App.settings.data.powerups[t.key].level),t.highlight(!0)},e.prototype.clearPowerupSelection=function(t){this._textPanel.clearText(),null!==t&&t.highlight(!1)},e.prototype.onBackButton=function(t){this.inputLocked||this.state.start(this._fromMenu?"Menu":"Levels")},e.prototype.onPlayButton=function(t){this.inputLocked||this.transitionHide()},e.prototype.onTransitionHideFinished=function(){this.state.states.Play.doTransitionOnEnter=!0,this.state.start("Play",!0,!1,this._levelId)},e.prototype.onStarsDlg=function(t){this._dlgStars.hide(t)},e.prototype.upgradePowerup=function(t){var e=s.App.settings,n=e.data.powerups[t.key];if(3!==n.level){var i=n.level+1;if(e.data.stars<i)return this._dlgStars.setup("TXT_DLG_POWERUP_FAIL_TITLE","TXT_DLG_POWERUP_FAIL_TEXT",i,!1),void this._dlgStars.show();this._dlgStars.setup("TXT_DLG_POWERUP_CONFIRM_TITLE","TXT_DLG_POWERUP_CONFIRM_TEXT",i,!0),this._dlgStars.onHidden.addOnce((function(e){"Yes"===e&&this.doPowerupUpgrade(t)}),this),this._dlgStars.show()}},e.prototype.doPowerupUpgrade=function(t){var e=s.App.settings,n=e.data.powerups[t.key];++n.level,e.data.stars-=n.level,this._stars.stars=e.data.stars,t.setup(this.findLastUnlockedLevel(),n.level),this.emitParticles(t.world),g.AudioUtils.playAudioRecord(l.Defs.SFX_PWR_UPGRADE),e.save()},e.prototype.emitParticles=function(t){var e=c.Emitters.instance.spawn(0,this._bg,4);e&&(e.emitAt(t.x,t.y),e.flow(50,8,30))},e.prototype.showTutorial=function(){if(!s.App.settings.isTutorialShown(y.TutorialFlag.Powerups)||a.Config.DEBUG_TUTORIAL_EVERY_TIME){var t=d.Tutorial.instance,e=t.enqueueRequest(0,0,null,h.TutorialDefs.POWERUP_0);e.requeryPosition=this.requeryPosition.bind(this),(e=t.enqueueRequest(1,0,null,h.TutorialDefs.POWERUP_1)).requeryPosition=this.requeryPosition.bind(this),(e=t.enqueueRequest(2,0,null,h.TutorialDefs.POWERUP_2)).requeryPosition=this.requeryPosition.bind(this),(e=t.enqueueRequest(3,0,null,h.TutorialDefs.POWERUP_3)).requeryPosition=this.requeryPosition.bind(this),(e=t.enqueueRequest(4,0,null,h.TutorialDefs.POWERUP_4)).requeryPosition=this.requeryPosition.bind(this),t.show(this.world),s.App.settings.setTutorialShown(y.TutorialFlag.Powerups)}},e.prototype.requeryPosition=function(t){s.App.isLandscape;switch(t){case 0:this._tutorialPosition.set(0,-30);break;case 1:this._tutorialPosition.set(0,-this.game.height/2+84-10);break;case 2:case 3:this._tutorialPosition.copyFrom(this._elementsPanel.position);break;case 4:this._tutorialPosition.copyFrom(this._chainPanel.position)}return this._tutorialPosition},e.prototype.newPowerupTutorial=function(){var t,e=null!==(t=this._elementsPanel.hasNew())&&void 0!==t?t:this._chainPanel.hasNew();if(e&&!a.Config.DEBUG_UNLOCK_ALL_POWERUPS){var n=new Phaser.Point(e.parent.x+e.x,e.parent.y+e.y),i=d.Tutorial.instance;i.enqueueRequest(0,0,n,h.TutorialDefs.NEW_POWERUP),i.show(this.world)}},e}(n(7318).SceneUIBase);e.Powerups=T},9952:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{l(i.next(t))}catch(t){r(t)}}function a(t){try{l(i.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.Preloader=void 0;var l=n(2178),h=n(5357),u=n(1391),c=n(712),p=n(7389),_=n(8630),f=n(7653),d=n(9833),y=n(2516),m=n(3061),g=n(7306),v=n(6020),T=n(8683),E=n(2757),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._barGroup=null,e._ready=!1,e._canProceedToNextState=!1,e}return o(e,t),e.prototype.preload=function(){this.setView(this.game.width,this.game.height),this.stage.backgroundColor=u.Defs.COLOR_BG,this.createLoadingBar(),this.preloadSounds(),this.loadTexturesFromLists(this.load,h.Config.TEXTURES),this.load.atlas(h.Config.ATLAS_GAME,"assets/atlas/Game.png","assets/atlas/Game.json"),this.load.atlas(h.Config.ATLAS_UI,"assets/atlas/UI.png","assets/atlas/UI.json"),this.load.atlas(h.Config.ATLAS_LEVELS,"assets/atlas/Levels.png","assets/atlas/Levels.json"),this.load.image(h.Config.IMAGE_TRAJECTORY,"assets/sprites/trajectory.png"),this.load.xml(h.Config.FONT+"XML","assets/font/Font.xml"),this.load.xml(h.Config.FONT_STARS+"XML","assets/font/StarsNum.xml"),this.load.xml(h.Config.FONT_LEVELS+"XML","assets/font/LevelsNum.xml"),this.load.xml(h.Config.FONT_SCORE_GAME+"XML","assets/font/ScoreGame.xml"),this.load.xml(h.Config.FONT_SCORE_LEVELS+"XML","assets/font/ScoreLevels.xml"),this.loadLevels(this.load),this.load.json("Texts","assets/text/text.json"),this.load.json("AnimStar","assets/anims/Star.json"),this.load.json("AnimPopBG","assets/anims/PopBG.json"),this.load.json("AnimPop","assets/anims/Pop.json"),this.load.json("AnimLevelGate","assets/anims/LevelUnlock.json"),this.load.json("AnimGameOver","assets/anims/GameOver.json"),l.App.sponsorID===m.eSponsorID.WKB?this.load.json("AnimTitle","assets/anims/Title_jpn.json"):this.load.json("AnimTitle","assets/anims/Title.json"),this.onResize(this.game.width,this.game.height)},e.prototype.loadTexturesFromLists=function(t,e){var n,i;if(e)for(var o in e){var r=e[o],s=r.path+"/",l=r.images;try{for(var h=(n=void 0,a(l)),u=h.next();!u.done;u=h.next()){var c=u.value,p=c.substr(0,c.indexOf(".")),_=""+s+c;t.image(p,_)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}},e.prototype.loadLevels=function(t){var e,n;if(h.Config.DEBUG_LOAD_INDIVIDUAL_LEVEL_FILES){var i="debugLevels/";try{for(var o=a(u.Defs.LEVEL_KEYS),r=o.next();!r.done;r=o.next()){var s=r.value;t.json(s,""+i+s+".json")}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}}else{i="assets/levels/";t.json("Levels",i+"levels.json")}},e.prototype.preloadSounds=function(){var t="assets/music/";if(this.game.device.ie||Phaser.Device.isAndroidStockBrowser()){for(var e in _.Sounds.AUDIO_JSON.spritemap)this.load.audio(e,"assets/sound/"+e+".mp3");this.load.audio("Menu",t+"Menu.m4a"),this.load.audio("Game1",t+"Game1.m4a")}else{var n=0;this.game.device.iOS&&(n=.1);var i=0;for(var e in _.Sounds.AUDIO_JSON.spritemap){var o=_.Sounds.AUDIO_JSON.spritemap[e];0!==i&&(o.start-=n),++i}this.load.audiosprite("Sfx",_.Sounds.AUDIO_JSON.resources,null,_.Sounds.AUDIO_JSON),this.load.audio("Menu",[t+"Menu.ogg",t+"Menu.m4a"]),this.load.audio("Game1",[t+"Game1.ogg",t+"Game1.m4a"])}},e.prototype.onResize=function(e,n){t.prototype.onResize.call(this,e,n)},e.prototype.doPostCreate=function(){var t=this;this._barGroup.visible=!1,this.finalizeFonts(),this.finalizeSounds(),this.finalizeAnims(),E.TextUtils.setTexts(this.game.cache.getJSON("Texts")),g.Utils.hasFeature("defaultLanguage")&&(l.App.settings.currentLanguage=l.App.sponsor.features.defaultLanguage),l.App.settings.load((function(){t.afterSettingsLoaded(),h.Config.DEBUG_USE_PROFILES&&(h.Config.DEBUG_PROFILES[0].powerups=l.App.settings.data.powerups),h.Config.DEBUG_STARS>0&&(l.App.settings.data.stars=h.Config.DEBUG_STARS)})),c.Ball.calculateBallMetrics(this.game),p.Emitters.instance,y.Perlin.seed(Math.random())},e.prototype.finalizeFonts=function(){void 0===this.cache.addBitmapFontFromImage&&T.PhaserUtils.AddBitmapFontAddMethod(),this.cache.addBitmapFontFromImage(h.Config.FONT,null,h.Config.ATLAS_FONT,this.cache.getXML(h.Config.FONT+"XML"),"xml"),this.cache.addBitmapFontFromImage(h.Config.FONT_STARS,null,h.Config.ATLAS_POWERUPS,this.cache.getXML(h.Config.FONT_STARS+"XML"),"xml"),this.cache.addBitmapFontFromImage(h.Config.FONT_LEVELS,null,h.Config.ATLAS_LEVELS,this.cache.getXML(h.Config.FONT_LEVELS+"XML"),"xml"),this.cache.addBitmapFontFromImage(h.Config.FONT_SCORE_GAME,null,h.Config.ATLAS_GAME,this.cache.getXML(h.Config.FONT_SCORE_GAME+"XML"),"xml"),this.cache.addBitmapFontFromImage(h.Config.FONT_SCORE_LEVELS,null,h.Config.ATLAS_LEVELS,this.cache.getXML(h.Config.FONT_SCORE_LEVELS+"XML"),"xml"),d.FontUtils.addSpriteIntoFont(this.game,h.Config.FONT,h.Config.ATLAS_FONT,"charStar",20480,"0",d.FontUtils.ALIGN_CENTER,.45),d.FontUtils.addSpriteIntoFont(this.game,h.Config.FONT_SCORE_GAME,h.Config.ATLAS_GAME,"charScore",20481,"0",d.FontUtils.ALIGN_CENTER,.45),d.FontUtils.addSpriteIntoFont(this.game,h.Config.FONT_SCORE_LEVELS,h.Config.ATLAS_LEVELS,"charScore",20481,"0",d.FontUtils.ALIGN_CENTER,.45)},e.prototype.finalizeSounds=function(){var t=this.add.audio("Menu");if(v.AudioUtils.addMusic("Menu",t),f.MusicManager.instance.loadMusic(),this.game.device.ie||Phaser.Device.isAndroidStockBrowser())for(var e in v.AudioUtils.setSounds(null),_.Sounds.AUDIO_JSON.spritemap){(i=this.add.audio(e)).allowMultiple=!0,v.AudioUtils.addSound(e,i)}else{var n=this.add.audioSprite("Sfx");for(var e in _.Sounds.AUDIO_JSON.spritemap){var i;(i=n.sounds[e]).allowMultiple=!0}v.AudioUtils.setSounds(n)}},e.prototype.finalizeAnims=function(){u.Defs.ANIM_STAR=this.game.cache.getJSON("AnimStar"),u.Defs.ANIM_POP_BG=this.game.cache.getJSON("AnimPopBG"),u.Defs.ANIM_POP=this.game.cache.getJSON("AnimPop"),u.Defs.ANIM_LEVEL_GATE=this.game.cache.getJSON("AnimLevelGate"),u.Defs.ANIM_GAME_OVER=this.game.cache.getJSON("AnimGameOver"),u.Defs.ANIM_TITLE=this.game.cache.getJSON("AnimTitle")},e.prototype.afterSettingsLoaded=function(){return r(this,void 0,void 0,(function(){var t;return s(this,(function(e){return h.Config.checkLanguage?(l.App.settings.data.firstRun||h.Config.checkLanguageEveryTime)&&(t=E.TextUtils.getLanguage(),h.Config.supportedLanguages.indexOf(t)>=0?l.App.settings.currentLanguage=t:l.App.settings.currentLanguage=l.App.sponsor.features.defaultLanguage):(t=l.App.sponsor.features.defaultLanguage,l.App.settings.currentLanguage=t),this._canProceedToNextState=!0,[2]}))}))},e.prototype.createLoadingBar=function(){var t=e.LOADING_BAR_WIDTH,n=e.LOADING_BAR_HEIGHT,i=this.add.graphics(-t/2-4,0);i.beginFill(2456148),i.drawRect(0,-n/2-4,t+8,n+8),this._loadingBarBg=i,(i=this.add.graphics(-t/2,0)).beginFill(13238246),i.drawRect(0,-n/2,t,n),this._loadingBar=i,this._loadingBar.width=0,this._barGroup=new Phaser.Group(this.game,this.world),this._barGroup.add(this._loadingBarBg),this._barGroup.add(this._loadingBar),this._barGroup.y=40},e.prototype.loadUpdate=function(){this._loadingBar.width=e.LOADING_BAR_WIDTH*this.load.progress/100},e.prototype.update=function(){!this._ready&&this._canProceedToNextState&&(this._ready=!0,h.Config.FORCE_TOUCH_TO_START?this.time.events.add(750,(function(){this.showTapHand()}),this):this.transitionHide())},e.prototype.showTapHand=function(){var t=this.add.sprite(0,50,h.Config.ATLAS_UI,u.Defs.FRAMES_FORCE_TOUCH[0]);t.tint=6940081,t.anchor.set(.5),t.animations.add("Touch",u.Defs.FRAMES_FORCE_TOUCH,8,!0,!1),t.animations.play("Touch"),this.input.onDown.add((function(){this.inputLocked||this.transitionHide()}),this)},e.prototype.onTransitionHideFinished=function(){this.state.states.Menu.doTransitionOnEnter=!0,this.state.start("Menu",!0,!1,!0)},e.LOADING_BAR_WIDTH=400,e.LOADING_BAR_HEIGHT=50,e}(n(5443).SceneBase);e.Preloader=b},5443:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.SceneBase=void 0;var r=n(2178),s=n(1391),a=n(4561),l=n(7389),h=n(726),u=n(5714),c=n(6020),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._inputLocked=!1,e._shouldPlayMusic=!1,e._musicName=null,e._musicVolume=0,e._doTransitionOnEnter=!1,e}return o(e,t),Object.defineProperty(e.prototype,"inputLocked",{get:function(){return this._inputLocked},set:function(t){this._inputLocked=t,this.onInputLocked(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doTransitionOnEnter",{get:function(){return this._doTransitionOnEnter},set:function(t){this._doTransitionOnEnter=t},enumerable:!1,configurable:!0}),e.prototype.create=function(){this._inputLocked=!1,this.stage.backgroundColor=s.Defs.COLOR_BG,this.setView(this.game.width,this.game.height),this.doPreCreate(),this.doPostCreate(),this.onResize(this.game.width,this.game.height),this.doTransitionOnEnter&&(this.doTransitionOnEnter=!1,this.inputLocked=!0,this.transitionReveal()),this.handleCreateCompleted()},e.prototype.doPreCreate=function(){},e.prototype.doPostCreate=function(){},e.prototype.handleCreateCompleted=function(){},e.prototype.handleOrientationChange=function(t){},e.prototype.setView=function(t,e){this.camera.bounds=null,this.world.setBounds(-t/2,-e/2,t,e),this.camera.focusOnXY(0,0)},e.prototype.createButton=function(t,e,n,i){return void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),null!==n&&t.onClick.add(n,i),null!=e&&e.add(t),t},e.prototype.onResize=function(t,e){this.setView(t,e)},e.prototype.onInputLocked=function(t){},e.prototype.toggleSound=function(t){r.App.settings.soundOn=t,c.AudioUtils.playAudioRecord(s.Defs.SFX_CLICK),r.App.settings.save()},e.prototype.toggleMusic=function(t){r.App.settings.musicOn=t,c.AudioUtils.playAudioRecord(s.Defs.SFX_CLICK),r.App.settings.save(),this.onMusicChanged(t)},e.prototype.onMusicChanged=function(t){t?this._shouldPlayMusic&&this._musicName&&this.playMusic(this._musicName,this._musicVolume):c.AudioUtils.stopMusic()},e.prototype.playMusic=function(t,e){void 0===e&&(e=1),c.AudioUtils.playMusic(t),c.AudioUtils.musicVolume=e,this._shouldPlayMusic=!0,this._musicName=t,this._musicVolume=e},e.prototype.stopMusic=function(){c.AudioUtils.stopMusic(),this._shouldPlayMusic=!1},e.prototype.fadeMusicVolumeTo=function(t){var e=c.AudioUtils.currentMusicSound;null!==e&&e.fadeTo(250,t),this._musicVolume=t},e.prototype.findLastUnlockedLevel=function(){for(var t=r.App.settings.data.levelStates,e=t.length-1;e>=0;e--)if(t[e].unlocked)return e;return-1},e.prototype.transitionReveal=function(){this.inputLocked=!0;var t=a.TransitionEffect.instance;t.onFinished.addOnce(this.onTransitionRevealFinished,this),t.reveal(this.world)},e.prototype.transitionHide=function(t){void 0===t&&(t=0),this.inputLocked=!0;var e=a.TransitionEffect.instance;e.delay=t,e.onFinished.addOnce(this.onTransitionHideFinished,this),e.hide(this.world)},e.prototype.onTransitionRevealFinished=function(){this.inputLocked=!1},e.prototype.onTransitionHideFinished=function(){},e.prototype.shutdown=function(){h.Shaker.instance.kill(),a.TransitionEffect.instance.onShutDown(),l.Emitters.instance.onDestroy(),u.Tasks.instance.kill()},e.BUTTON_OFFSET_X=34,e.BUTTON_OFFSET_Y=38,e}(Phaser.State);e.SceneBase=p},7318:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.SceneUIBase=e.HideCenterReason=void 0;var r,s=n(2178),a=n(5357),l=n(1391),h=n(7389),u=n(1395),c=n(1050),p=n(5443);!function(t){t[t.None=0]="None",t[t.Levels=1]="Levels",t[t.Powerups=2]="Powerups"}(r=e.HideCenterReason||(e.HideCenterReason={}));var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._bg=null,e._light=null,e._trees=null,e._centerGroup=null,e._tweenCenterIn=null,e._tweenCenterOut=null,e._hideCenterReason=r.None,e}return o(e,t),e.prototype.createBg=function(){this._bg=u.UIBg.instance,this.world.add(this._bg)},e.prototype.createLight=function(){var t=this.game.add.sprite(0,0,a.Config.ATLAS_UI,l.Defs.FRAME_MENU_BG_LIGHT,this.world);t.anchor.set(.5),t.tint=l.Defs.COLOR_BG_LIGHT,t.scale.set(8,5),this._light=t},e.prototype.createTrees=function(t,e){this._trees=this.world.add(c.UITrees.instance),e&&(this._trees.treePositions=s.App.isLandscape?l.Defs.TREES_OUT_POSITIONS:l.Defs.TREES_OUT_POSITIONS_PORTRAIT,this._trees.resetPositions()),this._trees.treePositions=t},e.prototype.createCenterGroup=function(){this._centerGroup=new Phaser.Group(this.game,this.world);var t=e.CENTER_TWEEN_DURATION;this._tweenCenterIn=this.game.add.tween(this._centerGroup).to({alpha:1},t,Phaser.Easing.Linear.None,!1),this._tweenCenterIn.onComplete.add(this.onCenterGroupShown,this),this._tweenCenterOut=this.game.add.tween(this._centerGroup).to({alpha:0},t,Phaser.Easing.Linear.None,!1),this._tweenCenterOut.onComplete.add(this.onCenterGroupHidden,this)},e.prototype.onResize=function(e,n){t.prototype.onResize.call(this,e,n),this._bg.onResize(e,n),this._trees&&this._trees.onResize(e,n)},e.prototype.showCenterGroup=function(){this.inputLocked=!0,this.game.time.events.add(1,(function(){this._tweenCenterIn.resume(),this._tweenCenterIn.start()}),this)},e.prototype.hideCenterGroup=function(t){void 0===t&&(t=r.None),this._hideCenterReason=t,this.inputLocked=!0,this._tweenCenterOut.resume(),this._tweenCenterOut.start()},e.prototype.onCenterGroupShown=function(){this.inputLocked=!1},e.prototype.onCenterGroupHidden=function(){},e.prototype.update=function(){this._trees.updateTrees(),h.Emitters.instance.update()},e.prototype.shutdown=function(){t.prototype.shutdown.call(this),this._trees.onShutdown(),this._trees=null,this._bg.onShutdown(),this._bg=null},e.CENTER_TWEEN_DURATION=200,e.CENTER_DELAY=250,e}(p.SceneBase);e.SceneUIBase=_},9820:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.AdvancedBitmapText=void 0;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colors=[],e._boldCount=0,e}return o(e,t),Object.defineProperty(e.prototype,"colors",{get:function(){return this._colors},set:function(t){this._colors=t},enumerable:!1,configurable:!0}),e.prototype.getTint=function(){return void 0===this._colorsStack||0===this._colorsStack.length?this.tint:this._colorsStack[this._colorsStack.length-1]},e.prototype.scanLine=function(t,e,n){for(var i=0,o=0,r=-1,s=0,a=null,l=this.maxWidth>0?this.maxWidth:null,h=[],u=0;u<n.length;u++){var c=u===n.length-1;if(/(?:\r\n|\r|\n)/.test(n.charAt(u)))return{width:o,text:n.substr(0,u),end:c,chars:h};var p,_=n.charCodeAt(u),f=t.chars[_];void 0===f&&(_=32,f=t.chars[_]);var d=a&&f.kerning[a]?f.kerning[a]:0;if(/(\s)/.test(n.charAt(u))&&(r=u,s=o),"|"!==n.charAt(u)){if(p=(d+f.texture.width+f.xOffset)*e,l&&o+p>=l&&r>-1)return{width:s||o,text:n.substr(0,u-(u-r)),end:!1,chars:h};o+=(f.xAdvance+d+this.letterSpacing)*e,h.push(i+(f.xOffset+d+this.letterSpacing)*e),i+=(f.xAdvance+d+this.letterSpacing)*e,a=_}else{var y=u+1,m=n.charAt(y),g="~"===m;g&&(m=n.charAt(++y)),"b"===m?u+=1+(g?1:0):"c"===m&&(u+=2),c=u===n.length-1}}return{width:o,text:n,end:c,chars:h}},e.prototype.updateText=function(){void 0===this._colorsStack&&(this._colorsStack=[],this._boldCount=0),this._colorsStack.length=0,this._boldCount=0;var t=this._data.font;if(t){var e=this.text,n=this.fontSize/t.size,i=[],o=0;this.textWidth=0;do{(u=this.scanLine(t,n,e)).y=o,i.push(u),u.width>this.textWidth&&(this.textWidth=u.width),o+=t.lineHeight*n,e=e.substr(u.text.length+1)}while(!1===u.end);this.textHeight=o;for(var r=0,s=0,a=this.textWidth*this.anchor.x,l=this.textHeight*this.anchor.y,h=0;h<i.length;h++){var u=i[h];"right"===this.align?s=this.textWidth-u.width:"center"===this.align&&(s=(this.textWidth-u.width)/2);for(var c=0,p=0;c<u.text.length;c++){var _=u.text.charCodeAt(c),f=t.chars[_];if(void 0===f&&(_=32,f=t.chars[_]),"|"===u.text.charAt(c)){var d=c+1,y=u.text.charAt(d),m="~"===y;if(m&&(y=u.text.charAt(++d)),"b"===y){this._boldCount+=m?-1:1,c+=1+(m?1:0);continue}if("c"===y){if(m)this._colorsStack.pop();else{var g=u.text.charCodeAt(++d)-48;this._colorsStack.push(this._colors[g])}c+=2;continue}}for(var v=0;v<=this._boldCount;v++){var T=this._glyphs[r];T?T.texture=f.texture:((T=new PIXI.Sprite(f.texture)).name=u.text[c],this._glyphs.push(T)),T.position.x=u.chars[p]+s-a+v,T.position.y=u.y+f.yOffset*n-l,T.scale.set(n,n),T.tint=this.getTint(),T.texture.requiresReTint=!0,T.cachedTint=16777215,T.parent||this.addChild(T),r++}p++}}for(h=r;h<this._glyphs.length;h++)this.removeChild(this._glyphs[h])}},e}(n(8169).BitmapText);e.AdvancedBitmapText=r},6912:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapDataUtils=void 0;var i=n(2178),o=function(){function t(){}return t.tilesIntoBmd=function(t,e,n){void 0===n&&(n=!1);for(var o=t.context,r=i.App.game.cache.getImage(e),s=r.width,a=r.height,l=Math.ceil(t.width/s),h=Math.ceil(t.height/a),u=0;u<h;u++)for(var c=0;c<l;c++)n&&(o.save(),o.beginPath(),o.rect(c*s,u*a,s,a),o.clip()),t.draw(e,c*s,u*a,s,a),n&&o.restore();return t},t}();e.BitmapDataUtils=o},8169:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapText=void 0;var r=n(1391),s=n(2757),a=n(5421),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"textID",{set:function(t){if(null!=t){var e=s.TextUtils.getText(t);this.text=e}else this.text=r.Defs.EMPTY_TEXT},enumerable:!1,configurable:!0}),e.prototype.setFormattedTextID=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(null!=t){var i=s.TextUtils.getText(t);this.text=a.StringUtils.format(i,e)}else this.text=r.Defs.EMPTY_TEXT},e}(Phaser.BitmapText);e.BitmapText=l},7653:function(t,e,n){"use strict";var i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.MusicManager=void 0;var o=n(2178),r=n(6020),s=function(){function t(e){this._musicIdx=0,this._game=e,this._loader=new Phaser.Loader(e),this._musicIdx=this._game.rnd.integerInRange(0,t.MUSIC_NAMES.length-1),t._instance=this}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t(o.App.game)),t._instance},enumerable:!1,configurable:!0}),t.prototype.loadMusic=function(){var e,n,o="assets/music/";try{for(var r=i(t.MUSIC_NAMES),s=r.next();!s.done;s=r.next()){var a=s.value;this._loader.audio(a,[o+a+".ogg",o+a+".m4a"])}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this._loader.onFileComplete.add(this.onFileComplete,this),this._loader.start()},t.prototype.onFileComplete=function(t,e,n,i,o){var s=this._game.add.audio(e);r.AudioUtils.addMusic(e,s)},t.prototype.getMusicByName=function(e){return this._game.cache.getSound(e)&&this._game.cache.isSoundDecoded(e)||(e=t.MUSIC_NAME_FALLBACK),e},t.prototype.getGameplayMusic=function(){var e=t.MUSIC_NAMES.length,n=this._musicIdx;this._musicIdx=(this._musicIdx+1)%e;var i=n;do{var o=t.MUSIC_NAMES[i];if(this._game.cache.checkSoundKey(o)&&this._game.cache.isSoundDecoded(o))return o;i=(i+1)%e}while(i!==n);return t.MUSIC_NAME_FALLBACK},t.MUSIC_NAMES=["Game1","Game2","Game3"],t.MUSIC_NAME_FALLBACK="Menu",t._instance=null,t}();e.MusicManager=s},5341:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextCache=void 0;var i=n(2178),o=function(){function t(){this._language=null,this._cache=null}return t.prototype.getTextID=function(t){this.checkLanguage();var e=this._cache[t];return void 0!==e?e:null},t.prototype.setText=function(t,e){this.checkLanguage(),this._cache[t]=e},t.prototype.checkLanguage=function(){var t=i.App.settings.currentLanguage;this._language!==t&&(this._language=t,this._cache={})},t}();e.TextCache=o},3059:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Pool=void 0;var n=function(){function t(t,e,n){void 0===n&&(n=null),this._newFunction=null,this._count=0,this._pool=[],this._canGrow=!1,this._capacity=0,this._classType=t,this._newFunction=n;for(var i=0;i<e;i++){var o=this.newItem();this._pool[this._count++]=o}}return Object.defineProperty(t.prototype,"freeItems",{get:function(){return this._pool},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spawned",{get:function(){return this._capacity-this._count},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"free",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"capacity",{get:function(){return this._capacity},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canGrow",{get:function(){return this._canGrow},set:function(t){this._canGrow=t},enumerable:!1,configurable:!0}),t.prototype.spawn=function(){return 0===this._count?this._canGrow?this.newItem():null:this._pool[--this._count]},t.prototype.despawn=function(t){this._pool[this._count++]=t},t.prototype.despawnAll=function(){},Object.defineProperty(t.prototype,"newFunction",{set:function(t){this._newFunction=t},enumerable:!1,configurable:!0}),t.prototype.newItem=function(){return++this._capacity,null!==this._newFunction?this._newFunction():new this._classType},t}();e.Pool=n},6944:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PriorityQueue=void 0;var i=n(3059),o=function(){},r=function(){function t(t,e){void 0===t&&(t=1/0),void 0===e&&(e=16),this._data=[],this._nodePool=null,this._capacity=t,e=Math.min(e,t),this._nodePool=new i.Pool(o,e),this._nodePool.canGrow=!0}return Object.defineProperty(t.prototype,"size",{get:function(){return this._data.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this._data.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFull",{get:function(){return this._data.length===this._capacity},enumerable:!1,configurable:!0}),t.prototype.enqueue=function(t,e){if(void 0===e&&(e=1),this.isFull)return!1;var n=this._nodePool.spawn();if(null===n)throw new Error("Can't spawn node.");n.item=t,n.priority=e,this._data.push(n);for(var i=this._data.length-2;i>=0;i--){var o=this._data[i];if(n.priority<=o.priority)break;this._data[i+1]=o,this._data[i]=n}return!0},t.prototype.dequeue=function(){if(this.isEmpty)return null;var t=this._data.shift(),e=t.item;return this._nodePool.despawn(t),e},t.prototype.peek=function(){return this.isEmpty?null:this._data[0].item},t.prototype.at=function(t){return this._data[t].item},t.prototype.remove=function(t){var e=this.getItemIdx(t);return-1!==e&&(this.removeAt(e),!0)},t.prototype.removeAt=function(t){var e=this._data.splice(t,1);if(0===e.length)return null;var n=e[0],i=n.item;return n.item=null,this._nodePool.despawn(n),i},t.prototype.getItemIdx=function(t){for(var e=0;e<this._data.length;e++)if(this._data[e].item===t)return e;return-1},t.prototype.clear=function(t){void 0===t&&(t=null);for(var e=0;e<this._data.length;e++){var n=this._data[e];t&&t(n.item),n.item=null,this._nodePool.despawn(n),this._data[e]=null}this._data.length=0},t}();e.PriorityQueue=r},1353:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Queue=void 0;var n=function(){function t(t){void 0===t&&(t=1/0),this._data=[],this._capacity=t}return Object.defineProperty(t.prototype,"size",{get:function(){return this._data.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this._data.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFull",{get:function(){return this._data.length===this._capacity},enumerable:!1,configurable:!0}),t.prototype.enqueue=function(t){return!this.isFull&&(this._data.push(t),!0)},t.prototype.dequeue=function(){return this.isEmpty?null:this._data.shift()},t.prototype.peek=function(){return this.isEmpty?null:this._data[0]},t.prototype.at=function(t){return this._data[t]},t.prototype.remove=function(t){var e=this._data.indexOf(t);return-1!==e&&(this.removeAt(e),!0)},t.prototype.removeAt=function(t){var e=this._data.splice(t,1);return e.length>0?e[0]:null},t.prototype.clear=function(t){void 0===t&&(t=null);for(var e=0;e<this._data.length;e++)t&&t(this._data[e]),this._data[e]=null;this._data.length=0},t}();e.Queue=n},7857:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UnorderedArray=void 0;var n=function(){function t(t){void 0===t&&(t=1/0),this._capacity=1/0,this._data=[],this._count=0,this._iterationRunning=!1,this._currentItem=null,this._currentIdx=null,this._capacity=t}return Object.defineProperty(t.prototype,"size",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this._count},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFull",{get:function(){return this._count===this._capacity},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentItem",{get:function(){if(!this._iterationRunning)throw new Error("Can't call currentItem when iteration is not running");return this._currentItem},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentIdx",{get:function(){if(!this._iterationRunning)throw new Error("Can't call currentItem when iteration is not running");return this._currentIdx},enumerable:!1,configurable:!0}),t.prototype.add=function(t){if(this.isFull)throw new Error("Can't add item - capactiy ("+this._capacity+") is reached.");this._data[this._count++]=t},t.prototype.remove=function(t){var e=this._iterationRunning&&t===this._currentItem?this._currentIdx:this.getItemIdx(t);return-1!==e&&(this.removeAt(e),!0)},t.prototype.removeAt=function(t){var e=this._data[t];return this._data[t]=this._data[--this._count],this._data[this._count]=null,e},t.prototype.clear=function(){for(var t=0;t<this._count;t++)this._data[t]=null;this._count=0},t.prototype.contains=function(t){return-1!==this.getItemIdx(t)},t.prototype.iterate=function(t){this._iterationRunning=!0;for(var e=this._count-1;e>=0&&this._iterationRunning;e--)this._currentItem=this._data[e],this._currentIdx=e,t(this._currentItem);this._iterationRunning=!1},t.prototype.stopIterate=function(){this._iterationRunning=!1},t.prototype.getItemIdx=function(t){for(var e=0;e<this._count;e++)if(this._data[e]===t)return e;return-1},t.prototype.toString=function(){for(var t="",e=0;e<this._count;e++)t+="#"+e+": "+this._data[e]+"\n";return t},t}();e.UnorderedArray=n},6037:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UnorderedArrayPool=void 0;var i=n(3059),o=function(){function t(t,e,n){void 0===n&&(n=null),this._data=[],this._count=0,this._iterationRunning=!1,this._currentItem=null,this._currentIdx=null,this._pool=null,this._pool=new i.Pool(t,e,n)}return Object.defineProperty(t.prototype,"size",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this._count},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFull",{get:function(){return this._count===this._pool.capacity},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"freeItems",{get:function(){return this._pool.freeItems},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spawned",{get:function(){return this._pool.spawned},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"free",{get:function(){return this._pool.free},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"capacity",{get:function(){return this._pool.capacity},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canGrow",{get:function(){return this._pool.canGrow},set:function(t){this._pool.canGrow=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentItem",{get:function(){if(!this._iterationRunning)throw new Error("Can't call currentItem when iteration is not running");return this._currentItem},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentIdx",{get:function(){if(!this._iterationRunning)throw new Error("Can't call currentItem when iteration is not running");return this._currentIdx},enumerable:!1,configurable:!0}),t.prototype.spawn=function(){if(this.isFull&&!this.canGrow)return null;var t=this._pool.spawn();return this._data[this._count++]=t,t},t.prototype.despawn=function(t){var e=this._iterationRunning&&t===this._currentItem?this._currentIdx:this.getItemIdx(t);-1!==e&&this.despawnAt(e)},t.prototype.despawnAt=function(t){this._pool.despawn(this._data[t]),this._data[t]=this._data[--this._count],this._data[this._count]=null},t.prototype.despawnAll=function(){for(var t=0;t<this._count;t++)this._pool.despawn(this._data[t]),this._data[t]=null;this._count=0},t.prototype.at=function(t){return this._data[t]},t.prototype.contains=function(t){return-1!==this.getItemIdx(t)},t.prototype.iterate=function(t){this._iterationRunning=!0;for(var e=this._count-1;e>=0&&this._iterationRunning;e--)this._currentItem=this._data[e],this._currentIdx=e,t(this._currentItem);this._iterationRunning=!1},t.prototype.stopIterate=function(){this._iterationRunning=!1},t.prototype.getItemIdx=function(t){for(var e=0;e<this._count;e++)if(this._data[e]===t)return e;return-1},t.prototype.toString=function(){for(var t="",e=0;e<this._count;e++)t+="#"+e+": "+this._data[e]+"\n";return t},t}();e.UnorderedArrayPool=o},3824:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(3059),e)},9833:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FontUtils=void 0;var n=function(){function t(){}return t.addSpriteIntoFont=function(e,n,i,o,r,s,a,l){void 0===s&&(s="0"),void 0===a&&(a=t.ALIGN_CENTER),void 0===l&&(l=.5),"string"==typeof s&&(s=s.charCodeAt(0));var h=e.cache.getBitmapFont(n),u=h.font.chars,c=u[s];if(null==c)throw new Error("Reference character "+String.fromCharCode(s)+" with code "+s+" is mssing in font. Try another.");var p=null,_=(p="string"==typeof o?e.cache.getFrameByName(i,o):e.cache.getFrameByIndex(i,o)).sourceSizeW,f=p.sourceSizeH,d=c.yOffset+(a===t.ALIGN_CENTER?c.height/2:a===t.ALIGN_BOTTOM?c.height:0),y=Math.round(d-f*l);u[r]={x:p.x,y:p.y,width:p.width,height:p.height,xOffset:0,yOffset:y,xAdvance:_+2,kerning:[],texture:new PIXI.Texture(h.base,new PIXI.Rectangle(p.x,p.y,p.width,p.height))}},t.ALIGN_TOP=0,t.ALIGN_CENTER=1,t.ALIGN_BOTTOM=2,t}();e.FontUtils=n},7748:function(t,e){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.Curve=e.CurveType=void 0,function(t){t[t.LINEAR=0]="LINEAR",t[t.HERMITE=1]="HERMITE",t[t.BEZIER=2]="BEZIER"}(n=e.CurveType||(e.CurveType={}));var i=function(){function t(){}return t.debug=function(e,n,i,o,r,s,a,l,h){void 0===i&&(i=0),void 0===o&&(o=0),void 0===r&&(r=300),void 0===s&&(s=300),void 0===a&&(a=0);var u=n.keys[0].x,c=n.keys[n.keys.length-1].x;l=l||0,h=h||1;var p=new Phaser.Line;p.start.set(u+i,-t.evaluate(u,n)+o);for(var _=1;_<100;_++){var f=(c-u)/100*_,d=r/(c-u)*f+i,y=s/(h-l)*-t.evaluate(f,n)+o;p.end.set(d,y),e.geom(p,"RGBA(0, 255, 0, 1)"),p.start.copyFrom(p.end)}if(a>=u&&a<=c){var m=-t.evaluate(a,n),g=new Phaser.Circle(r/(c-u)*a+i,s/(h-l)*m+o,8);e.geom(g,"RGBA(255, 0, 0, 1)")}},t.evaluateNormalized=function(e,n,i,o){void 0===i&&(i=!1),void 0===o&&(o=0);var r=Phaser.Math.linear(n.keys[0].x,n.keys[n.keys.length-1].x,e);return t.evaluate(r,n,i,o)},t.evaluate=function(e,i,o,r){void 0===o&&(o=!1),void 0===r&&(r=0);var s=i.keys[0].x,a=i.keys[i.keys.length-1].x;if(e<s||e>a)throw new Error("value x ("+e+") is out of range defined with curve keys ("+s+" ... "+a+")");for(var l=i.keys.length-2;i.keys[l].x>e&&l>0;)--l;var h=i.keys[l],u=i.keys[l+1],c=(e-h.x)/(u.x-h.x),p=-1;switch(i.type){case n.LINEAR:p=t.evaluateLinear(c,h,u);break;case n.HERMITE:p=t.evaluateHermite(c,h,u);break;case n.BEZIER:p=t.evaluateBezier(c,h,u)}if(o){var _=Math.pow(10,r);p=Math.round(p/_)*_}return p},t.evaluateLinear=function(t,e,n){return Phaser.Math.linear(e.y,n.y,t)},t.evaluateHermite=function(t,e,n){var i="number"==typeof e.slope?e.slope:e.slope.out,o="number"==typeof n.slope?n.slope:n.slope.in,r=n.x-e.x,s=i*r,a=o*r,l=t*t,h=l*t,u=h-2*l+t,c=h-l,p=-2*h+3*l;return(2*h-3*l+1)*e.y+u*s+c*a+p*n.y},t.evaluateBezier=function(t,e,n){var i=t*t,o=i*t,r=1-t,s=r-r*t;return(s-s*t)*e.y+3*t*s*e.c1+3*i*r*e.c2+o*n.y},t.duration=function(t){return t.keys[t.keys.length-1].x},t}();e.Curve=i},1752:function(t,e){"use strict";function n(t){return-2*t*t+3*t}Object.defineProperty(e,"__esModule",{value:!0}),e.sinWithPeriod=e.halfSin=e.sin=e.pop5rev=e.pop5=e.sinWithExpDecay=e.wiggle=void 0,e.wiggle=function(t,e,n){var i=t*Math.PI*2*e,o=t*(2*Math.PI*n+Math.PI/2);return Math.sin(i)*Math.cos(o)},e.sinWithExpDecay=function(t,e,n){var i=t*Math.PI*2*e,o=-t*n;return Math.sin(i)*Math.exp(o)},e.pop5=n,e.pop5rev=function(t){return-(n(1-t)-1)},e.sin=function(t){return Math.sin(2*t*Math.PI)},e.halfSin=function(t){return Math.sin(t*Math.PI)},e.sinWithPeriod=function(t,e){return Math.sin(2*t*Math.PI*e)}},713:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MathHelp=void 0;var n=function(){function t(){}return t.angleLinear=function(t,e,n){return t<e?e-t>180&&(e-=360):t-e>180&&(t-=360),t+(e-t)*n},t.moveTowards=function(t,e,n){return Math.abs(e-t)<=n?e:t+Math.sign(e-t)*n},t.movePointTowards=function(t,e,n){var i=e.x-t.x,o=e.y-t.y,r=Math.sqrt(i*i+o*o);if(r<=n||0==r)t.copyFrom(e);else{var s=n/r;t.set(t.x+i*s,t.y+o*s)}return t},t.pointLinear=function(t,e,n,i){return void 0===i&&(i=new Phaser.Point),i.set(Phaser.Math.linear(t.x,e.x,n),Phaser.Math.linear(t.y,e.y,n)),i},t.modulo=function(t,e){return(t%e+e)%e},t.repeat=function(t,e){return t-Math.floor(t/e)*e},t.repeatNormalized=function(e,n){return t.repeat(e,n)/n},t.pingPong=function(e,n){return e=t.repeat(e,2*n),n-Math.abs(e-n)},t.pingPongNormalized=function(e,n){return t.pingPong(e,n)/n},t.inverseLinear=function(t,e,n){return Math.abs(e-t)<1e-5?0:Phaser.Math.clamp((n-t)/(e-t),0,1)},t}();e.MathHelp=n},2516:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Perlin=void 0;var n=function(){function t(t,e,n){this.x=t,this.y=e,this.z=n}return t.prototype.dot2=function(t,e){return this.x*t+this.y*e},t.prototype.dot3=function(t,e,n){return this.x*t+this.y*e+this.z*n},t}(),i=function(){function t(){}return t.seed=function(e){e>0&&e<1&&(e*=65536),(e=Math.floor(e))<256&&(e|=e<<8);for(var n=0;n<256;n++){var i;i=1&n?t.p[n]^255&e:t.p[n]^e>>8&255,t.perm[n]=t.perm[n+256]=i,t.gradP[n]=t.gradP[n+256]=t.grad3[i%12]}},t.simplex2=function(e,n){var i,o,r=(e+n)*t.F2,s=Math.floor(e+r),a=Math.floor(n+r),l=(s+a)*t.G2,h=e-s+l,u=n-a+l;h>u?(i=1,o=0):(i=0,o=1);var c=h-i+t.G2,p=u-o+t.G2,_=h-1+2*t.G2,f=u-1+2*t.G2;s&=255,a&=255;var d=t.gradP[s+t.perm[a]],y=t.gradP[s+i+t.perm[a+o]],m=t.gradP[s+1+t.perm[a+1]],g=.5-h*h-u*u,v=.5-c*c-p*p,T=.5-_*_-f*f;return 70*((g<0?0:(g*=g)*g*d.dot2(h,u))+(v<0?0:(v*=v)*v*y.dot2(c,p))+(T<0?0:(T*=T)*T*m.dot2(_,f)))},t.simplex3=function(e,n,i){var o,r,s,a,l,h,u=(e+n+i)*t.F3,c=Math.floor(e+u),p=Math.floor(n+u),_=Math.floor(i+u),f=(c+p+_)*t.G3,d=e-c+f,y=n-p+f,m=i-_+f;d>=y?y>=m?(o=1,r=0,s=0,a=1,l=1,h=0):d>=m?(o=1,r=0,s=0,a=1,l=0,h=1):(o=0,r=0,s=1,a=1,l=0,h=1):y<m?(o=0,r=0,s=1,a=0,l=1,h=1):d<m?(o=0,r=1,s=0,a=0,l=1,h=1):(o=0,r=1,s=0,a=1,l=1,h=0);var g=d-o+t.G3,v=y-r+t.G3,T=m-s+t.G3,E=d-a+2*t.G3,b=y-l+2*t.G3,S=m-h+2*t.G3,P=d-1+3*t.G3,A=y-1+3*t.G3,O=m-1+3*t.G3;c&=255,p&=255,_&=255;var w=t.gradP[c+t.perm[p+t.perm[_]]],L=t.gradP[c+o+t.perm[p+r+t.perm[_+s]]],C=t.gradP[c+a+t.perm[p+l+t.perm[_+h]]],I=t.gradP[c+1+t.perm[p+1+t.perm[_+1]]],x=.6-d*d-y*y-m*m,D=.6-g*g-v*v-T*T,R=.6-E*E-b*b-S*S,M=.6-P*P-A*A-O*O;return 32*((x<0?0:(x*=x)*x*w.dot3(d,y,m))+(D<0?0:(D*=D)*D*L.dot3(g,v,T))+(R<0?0:(R*=R)*R*C.dot3(E,b,S))+(M<0?0:(M*=M)*M*I.dot3(P,A,O)))},t.fade=function(t){return t*t*t*(t*(6*t-15)+10)},t.lerp=function(t,e,n){return(1-n)*t+n*e},t.perlin2=function(e,n){var i=Math.floor(e),o=Math.floor(n);e-=i,n-=o,i&=255,o&=255;var r=t.gradP[i+t.perm[o]].dot2(e,n),s=t.gradP[i+t.perm[o+1]].dot2(e,n-1),a=t.gradP[i+1+t.perm[o]].dot2(e-1,n),l=t.gradP[i+1+t.perm[o+1]].dot2(e-1,n-1),h=t.fade(e);return t.lerp(t.lerp(r,a,h),t.lerp(s,l,h),t.fade(n))},t.perlin3=function(e,n,i){var o=Math.floor(e),r=Math.floor(n),s=Math.floor(i);e-=o,n-=r,i-=s,o&=255,r&=255,s&=255;var a=t.gradP[o+t.perm[r+t.perm[s]]].dot3(e,n,i),l=t.gradP[o+t.perm[r+t.perm[s+1]]].dot3(e,n,i-1),h=t.gradP[o+t.perm[r+1+t.perm[s]]].dot3(e,n-1,i),u=t.gradP[o+t.perm[r+1+t.perm[s+1]]].dot3(e,n-1,i-1),c=t.gradP[o+1+t.perm[r+t.perm[s]]].dot3(e-1,n,i),p=t.gradP[o+1+t.perm[r+t.perm[s+1]]].dot3(e-1,n,i-1),_=t.gradP[o+1+t.perm[r+1+t.perm[s]]].dot3(e-1,n-1,i),f=t.gradP[o+1+t.perm[r+1+t.perm[s+1]]].dot3(e-1,n-1,i-1),d=t.fade(e),y=t.fade(n),m=t.fade(i);return t.lerp(t.lerp(t.lerp(a,c,d),t.lerp(l,p,d),m),t.lerp(t.lerp(h,_,d),t.lerp(u,f,d),m),y)},t.grad3=[new n(1,1,0),new n(-1,1,0),new n(1,-1,0),new n(-1,-1,0),new n(1,0,1),new n(-1,0,1),new n(1,0,-1),new n(-1,0,-1),new n(0,1,1),new n(0,-1,1),new n(0,1,-1),new n(0,-1,-1)],t.p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],t.perm=new Array(512),t.gradP=new Array(512),t.F2=.5*(Math.sqrt(3)-1),t.G2=(3-Math.sqrt(3))/6,t.F3=1/3,t.G3=1/6,t}();e.Perlin=i},1025:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},8553:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.eSponsorID=void 0,function(t){t[t.NONE=0]="NONE",t[t.COOLMATHGAMES=1]="COOLMATHGAMES",t[t.DOCOMO=2]="DOCOMO",t[t.FBINSTANT=3]="FBINSTANT",t[t.GAMEARTER=4]="GAMEARTER",t[t.GAMEDISTRIBUTION=5]="GAMEDISTRIBUTION",t[t.GAMEE=6]="GAMEE",t[t.FAMOBI=7]="FAMOBI",t[t.KAPOW=8]="KAPOW",t[t.MONDIA=9]="MONDIA",t[t.ORANGE_FR=10]="ORANGE_FR",t[t.PMCONNECT=11]="PMCONNECT",t[t.TATAKI=12]="TATAKI",t[t.THEBALANCE=13]="THEBALANCE",t[t.SBC_GAMES=14]="SBC_GAMES",t[t.WANTED5GAMES=15]="WANTED5GAMES",t[t.WKB=16]="WKB",t[t.YANDEX=17]="YANDEX",t[t.ZYGOMATIC=18]="ZYGOMATIC"}(e.eSponsorID||(e.eSponsorID={}))},6409:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sponsor=void 0;n(8553);var i=n(7306),o=function(){function t(e){this._features=null,this._game=null,t._instance=this,this._features=e,i.Utils.api=this,i.Utils.id=e.id}return Object.defineProperty(t,"instance",{get:function(){if(null==t._instance)throw new Error("Sponsor is "+t._instance+". Sponsor must be always initialized.");return t._instance},enumerable:!1,configurable:!0}),Object.defineProperty(t,"initialized",{get:function(){return null!=t._instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.features.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return this._features},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"game",{set:function(t){this._game=t},enumerable:!1,configurable:!0}),t.prototype.startGameSession=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.endGameSession=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.submitScore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.showAd=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.onMoreGames=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.getSponsorLogoLink=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return null},t.LOG_BLUE="color: blue",t._instance=null,t}();e.Sponsor=o},9498:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.SponsorCoolmathGames=void 0;var r=function(t){function e(e){var n=t.call(this,e)||this;return document.title=document.title+" - Play it now at CoolmathGames.com",n}return o(e,t),e.prototype.startGameSession=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("string"!=typeof t[0]){var n=t[0];n&&"object"==typeof n&&void 0!==n.eventName&&void 0!==n.eventValue&&this.sendGameEvent(n.eventName,(n.eventValue+1).toString())}else this.sendGameEvent(t[0])},e.prototype.sendGameEvent=function(t,e){parent&&parent.cmgGameEvent&&(void 0===e?parent.cmgGameEvent(t):parent.cmgGameEvent(t,e))},e.prototype.sendDataEvent=function(t,e){parent&&parent.cmgDataEvent&&(void 0===e?parent.cmgDataEvent(t):parent.cmgDataEvent(t,e))},e}(n(6409).Sponsor);e.SponsorCoolmathGames=r},8564:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.SponsorGTM=void 0;var r=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o._publisher=n,o._productKey=i,o}return o(e,t),e.prototype.startGameSession=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t.prototype.startGameSession.call(this,e),window.dataLayer){var i={event:"levelStart",publisher:this._publisher,productKey:this._productKey};window.dataLayer.push(i)}},e.prototype.endGameSession=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t.prototype.endGameSession.call(this,e),window.dataLayer){var i={event:"levelCompletion",publisher:this._publisher,productKey:this._productKey};window.dataLayer.push(i)}},e}(n(6409).Sponsor);e.SponsorGTM=r},4060:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.SponsorGameDistribution=void 0;var r=function(t){function e(e,n,i){void 0===i&&(i=null);var o=t.call(this,e)||this;o._sdk=null;var r,s,a,l,h,u=o;return window.GD_OPTIONS={gameId:n,onEvent:function(t){switch(t.name){case"SDK_READY":u._sdk=window.gdsdk,i&&i();break;case"SDK_GAME_START":u._game.paused=!1,u._game.sound.mute=!1;break;case"SDK_GAME_PAUSE":u._game.paused=!0,u._game.sound.mute=!0}}},r=document,s="script",a="gamedistribution-jssdk",h=r.getElementsByTagName(s)[0],r.getElementById(a)||((l=r.createElement(s)).id=a,l.src="main.min.js",h.parentNode.insertBefore(l,h)),o}return o(e,t),e.prototype.showAd=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.showAd.call(this,e),null!=this._sdk&&this._sdk.showAd()},e}(n(6409).Sponsor);e.SponsorGameDistribution=r},5409:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.SponsorNone=void 0;n(8553);var r=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e.prototype.onMoreGames=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.length>0&&null!=t[0]&&void 0!==t[0].none?t[0].none:this.features.moreGamesLink;null!=n&&window.open("http://"+n,"_blank")},e.prototype.getSponsorLogoLink=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"assets/sponsor/logo/LogoNone.png"},e}(n(6409).Sponsor);e.SponsorNone=r},7417:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.SponsorWKB=e.check_time_for_score_reset=void 0;var r=n(6409),s=n(2178),a=n(5357),l=n(7215),h=0;e.check_time_for_score_reset=function(t,e){if(a.Config.resetScores){var n=a.Config.resetScoresUrls[a.Config.resetScoresUrlType],i=s.App.settings.last_reset_time;h=null==i?0:parseInt(i);var o=new XMLHttpRequest;o.open("GET",n,!0),o.onload=function(){if(o.status>=200&&o.status<400){var n=JSON.parse(o.responseText);t.call(e,(i=new Date(1e3*n.epoch),r=function(t){return window.moment(t).startOf("isoWeek").valueOf()}(i),h<r&&(h=Date.parse(i),s.App.settings.last_reset_time=h.toString(),!0)))}var i,r},o.onerror=function(t){},o.send()}};var u=function(t){function e(e,n,i){void 0===i&&(i=!0);var o=t.call(this,e)||this;if(i&&(l.StorageUtils.sponsorStorage=o),void 0===n){var r={};window.wkbGetUserData=function(t){return(r=JSON.parse(localStorage.getItem("wkbUserData"))||{})[t]},window.wkbSetUserData=function(t,e){r[t]=e,localStorage.setItem("wkbUserData",JSON.stringify(r))},window.wkbRemoveUserData=function(t){delete r[t],localStorage.setItem("wkbUserData",JSON.stringify(r))},n={callbackStart:function(){},callbackShowAd:function(){},callbackSendScore:function(){},callbackError:function(){},callbackStartLog:function(){}}}else window.wkbGetUserData&&window.wkbSetUserData&&window.wkbRemoveUserData||(l.StorageUtils.sponsorStorage=null);return o._callbacksTable=n,o}return o(e,t),e.prototype.startGameSession=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];void 0!==this._callbacksTable.callbackStartLog&&null!==this._callbacksTable.callbackStartLog&&this._callbacksTable.callbackStartLog()},e.prototype.endGameSession=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if("number"==typeof e[0])t={score:e[0]};else{if("object"!=typeof e[0]||void 0===e[0].score)return;t=e[0]}void 0!==this._callbacksTable.callbackSendScore&&null!==this._callbacksTable.callbackSendScore&&this._callbacksTable.callbackSendScore(t)},e.prototype.showAd=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];void 0!==this._callbacksTable.callbackShowAd&&null!==this._callbacksTable.callbackShowAd&&this._callbacksTable.callbackShowAd()},e.prototype.onMoreGames=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=a.Config.moreGamesUrls[a.Config.moreGamesUrlType];window.open(n,"_blank")},e.prototype.reportError=function(){void 0!==this._callbacksTable.callbackError&&null!==this._callbacksTable.callbackError&&this._callbacksTable.callbackError()},e.prototype.save=function(t,e){return new Promise((function(t){window.wkbSetUserData("data",JSON.stringify(e)),t()}))},e.prototype.load=function(t){return new Promise((function(t){var e=window.wkbGetUserData("data"),n=null;e&&(n=JSON.parse(e)),t(n)}))},e.prototype.fallbackToStandardStorage=function(){return!1},e}(r.Sponsor);e.SponsorWKB=u},6819:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.SponsorWanted5Games=void 0;var r=function(t){function e(e,n){var i=t.call(this,e)||this;i._sdk=null,i._sdk=window.CloudAPI,i._sdk.init({id:n,splash:!1});var o=i;return i._sdk.mute=function(){return null!==o._game&&(o._game.sound.mute=!0),!0},i._sdk.unmute=function(){return null!==o._game&&(o._game.sound.mute=!1),!0},i}return o(e,t),e.prototype.startGameSession=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.startGameSession.call(this,e),this._sdk.play()},e.prototype.endGameSession=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.endGameSession.call(this,e),this._sdk.gameOver()},e.prototype.showAd=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.showAd.call(this,e),this._sdk.showAd()},e.prototype.onMoreGames=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];t.prototype.onMoreGames.call(this,n);var o=n[0];if(null!=o){var r=null;void 0!==o.wanted5games&&(r=o.wanted5games,this.linksActive()&&(e.VALID_LINK_TYPES.indexOf(r)<0||window.open(this.getLink(r),"_blank")))}},e.prototype.getSponsorLogoLink=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];t.prototype.getSponsorLogoLink.call(this,n);var o=n[0];if(null==o)return null;var r=null;if(void 0===o.wanted5games)return null;if(r=o.wanted5games,!this.logosActive())return null;if(e.VALID_LOGO_KEYS.indexOf(r)<0)return null;var s,a=function(t){return s||(s=document.createElement("a")),s.href=t,s.href},l=this.getLogoLink(r);return l=a(l)},e.prototype.linksActive=function(){return this._sdk.links.active()},e.prototype.getLink=function(t){var e=this._sdk.links.list();return void 0===e[t]?null:e[t]},e.prototype.logosActive=function(){return this._sdk.logos.active()},e.prototype.getLogoLink=function(t){return this._sdk.logos.list()[t]},e.VALID_LINK_TYPES=["games","logo"],e.VALID_LOGO_KEYS=["vertical","horizontal"],e}(n(6409).Sponsor);e.SponsorWanted5Games=r},2902:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.SponsorYandex=void 0;var r=function(t){function e(e,n){var i=t.call(this,e)||this;return i._ysdk=null,i._savedMuteState=!1,YaGames.init({screen:n,adv:{onAdvClose:function(t){i.afterAd()}}}).then((function(t){i._ysdk=t})),i}return o(e,t),e.prototype.showAd=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.prototype.showAd.call(this,e),this.beforeAd();var i=e[0],o=null!=i?i.yandex:void 0;this._ysdk.adv.showFullscreenAdv(o)},e.prototype.beforeAd=function(){null!==this._game&&(this._savedMuteState=this._game.sound.mute,this._game.sound.mute=!0)},e.prototype.afterAd=function(){null!==this._game&&(this._game.sound.mute=this._savedMuteState)},e}(n(6409).Sponsor);e.SponsorYandex=r},7306:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Utils=void 0;var n=function(){function t(){}return Object.defineProperty(t,"api",{get:function(){return t._api},set:function(e){t._api=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"id",{get:function(){return t._id},set:function(e){t._id=e},enumerable:!1,configurable:!0}),t.is=function(e){return t._id===e},t.features=function(){return t._api.features},t.hasFeature=function(e){return void 0!==t._api.features[e]},t.isFeatureOn=function(e){if(!t.hasFeature(e))return!1;var n=t._api.features[e];return"boolean"==typeof n&&n},t}();e.Utils=n},3061:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(1025),e),o(n(8553),e),o(n(6409),e),o(n(7306),e)},8903:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Button=void 0;var r=n(6020),s=function(t){function e(e,n,i,o,r,s,a){var l=t.call(this,e)||this;l.onClick=new Phaser.Signal,l.onDown=new Phaser.Signal,l.scaleOnOver=new Phaser.Point(1,1),l.scaleOnDown=new Phaser.Point(1,1),l.offsetOnOver=new Phaser.Point(0,0),l.offsetOnDown=new Phaser.Point(0,0),l._tinted=!1,l._normalTint=65280,l._downTint=8421504,l._overTint=16777215,l._savePosition=new Phaser.Point,l._saveScale=new Phaser.Point,l._over=!1,l._down=!1,l.name=n;var h=new Phaser.Button(e,0,0,i);return l.add(h),l._button=h,void 0!==r&&r&&(l._tinted=!0),void 0===s&&(s="string"==typeof o?o+"Down":null,(l._tinted||s&&!e.cache.getFrameByName(i,s))&&(s=o)),void 0===a&&(a="string"==typeof o?o+"Over":null,(l._tinted||a&&!e.cache.getFrameByName(i,a))&&(a=o)),h.setFrames(a,o,s,o),h.anchor.setTo(.5,.5),h.name=n,h.onInputOver.add(l.overEvent,l),h.onInputOut.add(l.outEvent,l),h.onInputDown.add(l.downEvent,l),h.onInputUp.add(l.upEvent,l),l}return o(e,t),e.prototype.debug=function(){var t=this._button,e=t.hitArea,n=this.game.camera.x+this.worldTransform.tx,i=this.game.camera.y+this.worldTransform.ty,o=null;if(e)if(e instanceof Phaser.Rectangle){var r=e;o=new Phaser.Rectangle(n+r.x,i+r.y,r.width,r.height)}else e instanceof Phaser.Circle&&(o=new Phaser.Circle(n,i,e.diameter));else o=new Phaser.Rectangle(n-t.width*t.anchor.x,i-t.height*t.anchor.y,t.width,t.height);this.game.debug.geom(o,"RGBA(0,255,0,0.20)",!0)},Object.defineProperty(e.prototype,"button",{get:function(){return this._button},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._button.anchor},enumerable:!1,configurable:!0}),e.prototype.setEnabled=function(t){this._button.inputEnabled=t},e.prototype.setHitArea=function(t){this._button.hitArea=t},e.prototype.setTint=function(t,e,n){void 0===n&&(n=0),this._normalTint=t,this._downTint=e,this._overTint=n,this.applyTint(this._normalTint)},e.prototype.overEvent=function(t,e){this.setButton(!0,this._down),this.overAction()},e.prototype.outEvent=function(t,e){this.setButton(!1,!1),this.outAction()},e.prototype.downEvent=function(t,e){this.setButton(this._over,!0),this.downAction(),this.onDown.dispatch(this)},e.prototype.upEvent=function(t,e,n){this.setButton(this._over,!1),this.upAction(),n?this.onClick.dispatch(this):this.cancelAction()},e.prototype.setButton=function(t,e){this._over||this._down||(this._saveScale.copyFrom(this._button.scale),this._savePosition.copyFrom(this._button.position)),this._down=e,this._over=t,e?(Phaser.Point.multiply(this._saveScale,this.scaleOnDown,this._button.scale),Phaser.Point.add(this._savePosition,this.offsetOnDown,this._button.position),this._tinted&&this.applyTint(this._downTint)):t?(Phaser.Point.multiply(this._saveScale,this.scaleOnOver,this._button.scale),Phaser.Point.add(this._savePosition,this.offsetOnOver,this._button.position),this._tinted&&this.applyTint(this._overTint)):(this._button.scale.copyFrom(this._saveScale),this._button.position.copyFrom(this._savePosition),this._tinted&&this.applyTint(this._normalTint))},e.prototype.applyTint=function(t){this._button.tint=t;for(var e=0;e<this._button.children.length;e++)this._button.getChildAt(e).tint=t},e.prototype.overAction=function(){},e.prototype.outAction=function(){},e.prototype.downAction=function(){r.AudioUtils.playSound(e.SFX_CLICK)},e.prototype.upAction=function(){},e.prototype.cancelAction=function(){},e.prototype.reset=function(){for(var t=this._button.input._pointerData,e=0;e<10;e++)t[e]={id:e,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1};this.setButton(!1,!1)},e.SFX_CLICK="click",e}(Phaser.Group);e.Button=s},7780:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.CheckBox=void 0;var r=function(t){function e(e,n,i,o,r,s,a,l){var h=t.call(this,e,n,i,o,s,a,l)||this;h._changeOnDown=!1,h._checkFramePosition=new Phaser.Point,h._checked=!1;var u=r+"On";h.game.cache.getFrameByName(i,u),h._frameChecked=u;var c=r+"Off";h.game.cache.getFrameByName(i,u)||(c=null),h._frameUnchecked=c;var p=new Phaser.Sprite(e,0,0,i);return p.anchor.set(.5,.5),h.addChild(p),h._checkSprite=p,h.checked=!1,h}return o(e,t),Object.defineProperty(e.prototype,"checked",{get:function(){return this._checked},set:function(t){if(this._checked=t,t)this._checkSprite.frameName=this._frameChecked,this._checkSprite.visible=!0;else{var e=null!==this._frameUnchecked;e&&(this._checkSprite.frameName=this._frameUnchecked),this._checkSprite.visible=e}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"changeOnDown",{get:function(){return this._changeOnDown},set:function(t){this._changeOnDown=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"checkSprite",{get:function(){return this._checkSprite},enumerable:!1,configurable:!0}),e.prototype.setCheckPosition=function(t,e){this._checkSprite.position.set(t,e)},e.prototype.downEvent=function(){this.setButton(this._over,!0),this._changeOnDown&&(this.checked=!this.checked),this.downAction(),this.onDown.dispatch(this,this._checked)},e.prototype.upEvent=function(t,e,n){this.setButton(this._over,!1),this.upAction(),n&&(this._changeOnDown||(this.checked=!this.checked),this.onClick.dispatch(this,this._checked))},e}(n(8903).Button);e.CheckBox=r},7998:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractScrollBar=void 0;var r=n(7682),s=function(t){function e(n,i,o,s){var a=t.call(this,n,i)||this;return a._isHorizontal=!0,a._policy=r.ScrollBarPolicy.ALWAYS,a._minThumbLength=0,a._trackLength=0,a._thumbLength=0,a._screens=1,a._percent=0,a._marginStart=0,a._marginEnd=0,void 0===s&&(s=e.MIN_THUMB_LENGTH),a._minThumbLength=s,a._isHorizontal=o,a}return o(e,t),Object.defineProperty(e.prototype,"isHorizontal",{get:function(){return this._isHorizontal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"policy",{get:function(){return this._policy},set:function(t){this._policy=t,this.resize()},enumerable:!1,configurable:!0}),e.prototype.setMargin=function(t,e){this._marginStart=t,this._marginEnd=e},e.prototype.resize=function(){var t;switch(this._policy){case r.ScrollBarPolicy.ALWAYS:t=!0;break;case r.ScrollBarPolicy.NEVER:t=!1;break;case r.ScrollBarPolicy.WHEN_NEEDED:t=this._screens>1}this.exists=this.visible=t},e.prototype.onDimensionsChange=function(t){this._isHorizontal?(this._trackLength=t.viewSize.x-this._marginStart-this._marginEnd,this._thumbLength=Math.max(this._minThumbLength,this._trackLength/t.horizontalScreens),this._screens=t.horizontalScreens):(this._trackLength=t.viewSize.y-this._marginStart-this._marginEnd,this._thumbLength=Math.max(this._minThumbLength,this._trackLength/t.verticalScreens),this._screens=t.verticalScreens),this.resize()},e.prototype.onPositionChange=function(t,e,n){},e.prototype.onViewMove=function(t,e,n){this._percent=this._isHorizontal?e:n,this.resize()},e.MIN_THUMB_LENGTH=128,e}(Phaser.Group);e.AbstractScrollBar=s},2517:function(t,e,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.ListBox=void 0;var o=n(3824),r={gridColumns:1,gridRows:-1,rowOrdered:!0,spacingH:0,spacingV:0,marginTop:0,marginBottom:0,marginLeft:0,marginRight:0},s=function(){function t(t,e,n,i){this._game=null,this.onItemClick=new Phaser.Signal,this._options=null,this._scroller=null,this._itemsPool=null,this._content=null,this._contentGrid=new Phaser.Point,this._contentArea=new Phaser.Rectangle,this._usedItems=[],this._debugGraphics=null,this._hlp=new Phaser.Point,this._game=t,this._itemType=e,this._scroller=n,null==i&&(i={}),this.options=i,this._itemsPool=new o.Pool(null,8,(function(){return new e(t)})),this._itemsPool.canGrow=!0}return Object.defineProperty(t.prototype,"options",{get:function(){return this._options},set:function(t){this._options=i(i({},r),t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"itemType",{get:function(){return this._itemType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this._content},set:function(t){this._content=t,this.recalc()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scroller",{get:function(){return this._scroller},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this._usedItems},enumerable:!1,configurable:!0}),t.prototype.setDebug=function(t,e,n,i){if(void 0===e&&(e=65280),void 0===n&&(n=.5),void 0===i&&(i=!1),t){null===this._debugGraphics&&(this._debugGraphics=this._game.add.graphics(0,0,this._scroller.view),this._scroller.view.sendToBack(this._debugGraphics));var o=this._contentArea,r=this._scroller.viewSize;this._debugGraphics.clear(),this._debugGraphics.beginFill(e,n),this._debugGraphics.drawRect(o.width<r.x&&i?o.x-(r.x-o.width)/2:o.x,o.height<r.y&&i?o.y-(r.y-o.height)/2:o.y,i?Math.max(o.width,r.x):o.width,i?Math.max(o.height,r.y):o.height),this._debugGraphics.endFill()}else null!==this._debugGraphics&&(this._scroller.view.remove(this._debugGraphics),this._debugGraphics.destroy(),this._debugGraphics=null)},t.prototype.setViewSize=function(t,e){this._scroller.setViewSize(t,e)},t.prototype.setPosition=function(t,e){this._scroller.setPosition(t,e)},t.prototype.setViewPosition=function(t,e){this._scroller.setViewPosition(t,e,!1)},t.prototype.focusOnXY=function(t,e){this._scroller.setViewPosition(t,e,!0)},t.prototype.focusOnItem=function(t){this._scroller.setViewPosition(t.x+this._itemType.itemWidth/2,t.y+this._itemType.itemHeight/2)},t.prototype.focusOnItemIndex=function(t){var e=this.getItemPosition(t);this._scroller.setViewPosition(e.x+this._itemType.itemWidth/2,e.y+this._itemType.itemHeight/2,!0)},t.prototype.recalc=function(){this.calcualteContentGridDims(),this._scroller.area=this.calculateContentArea(),this.fill()},t.prototype.calcualteContentGridDims=function(){var t=this._options.gridColumns,e=this._options.gridRows;if(-1===t&&-1===e){var n=this._scroller.viewSize.x;n-=this._options.marginLeft+this._options.marginRight,n+=this._options.spacingH,t=Math.floor(n/(this._itemType.itemWidth+this._options.spacingH)),t=Math.max(t,1)}var i=this._content.length;return this._contentGrid.set(-1===t?Math.ceil(i/e):t,-1===e?Math.ceil(i/t):e),this._contentGrid},t.prototype.calculateContentArea=function(){var t=this._contentGrid;return this._contentArea.setTo(0,0,this._itemType.itemWidth*t.x+this._options.spacingH*(t.x-1)+this._options.marginLeft+this._options.marginRight,this._itemType.itemHeight*t.y+this._options.spacingV*(t.y-1)+this._options.marginTop+this._options.marginBottom),this._contentArea},t.prototype.getItemPosition=function(t,e){var n,i;return null==e&&(e=this._hlp),this._options.rowOrdered?(n=t%this._contentGrid.x,i=Math.floor(t/this._contentGrid.x)):(n=Math.floor(t/this._contentGrid.y),i=t%this._contentGrid.y),e.set(n*(this._itemType.itemWidth+this._options.spacingH)+this._options.marginLeft,i*(this._itemType.itemHeight+this._options.spacingV)+this._options.marginTop)},t.prototype.fill=function(){this.removeAllItems();for(var t=0;t<this._content.length;t++)this.addItem(t)},t.prototype.removeAllItems=function(){for(var t=this._usedItems.length;--t>=0;){var e=this._usedItems[t];e.active=!1,this._scroller.view.remove(e),e.onInput.removeAll(),this._itemsPool.despawn(e)}this._usedItems.length=0},t.prototype.addItem=function(t){var e=this.createItem(t);return this.getItemPosition(t,e.position),this.addItemToView(e),this._usedItems.push(e),e},t.prototype.createItem=function(t){var e=this._itemsPool.spawn();return null==e?null:(e.setContent(t,this._content[t]),e.active=!0,e.onInput.add(this.onItemInput,this),e)},t.prototype.addItemToView=function(t){this._scroller.view.add(t)},t.prototype.onItemInput=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];this._scroller.scrollingInProgress&&this._scroller.scrollDeltaMagnitudeSq>2500||this._scroller.inputDownWhileScrolling||this._scroller.inputMovedDistanceSq>100||this.onItemClick.dispatch(t,e,n)},t.prototype.getItemAtPosition=function(t,e,n){if(null==this._usedItems||0===this._usedItems.length)return null;if(t<this._contentArea.x||e<this._contentArea.y||t>this._contentArea.x+this._contentArea.width||e>this._contentArea.y+this._contentArea.height)return null;var i=this._itemType.itemWidth,o=this._itemType.itemHeight,r=0,s=0;n&&(i+=this._options.spacingH,o+=this._options.spacingV,r=-this._options.spacingH/2,s=-this._options.spacingV/2);for(var a=0;a<this._usedItems.length;a++){var l=this._usedItems[a],h=l.x+r,u=l.y+s;if(!(t<h||t>h+i||e<u||e>u+o))return l}return null},t}();e.ListBox=s},8523:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ListenerList=void 0;var n=function(){function t(){this._listeners=[]}return Object.defineProperty(t.prototype,"listeners",{get:function(){return this._listeners},enumerable:!1,configurable:!0}),t.prototype.add=function(t){this.has(t)||this._listeners.push(t)},t.prototype.remove=function(t){for(var e=this._listeners.length-1;e>=0;e--)this._listeners[e]===t&&(this._listeners[e]=this._listeners[this._listeners.length-1],--this._listeners.length)},t.prototype.removeAll=function(){this._listeners.length=0},t.prototype.has=function(t){for(var e=0;e<this._listeners.length;e++)if(this._listeners[e]===t)return!0;return!1},t}();e.ListenerList=n},7682:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScrollBarPolicy=void 0,function(t){t[t.NEVER=0]="NEVER",t[t.ALWAYS=1]="ALWAYS",t[t.WHEN_NEEDED=2]="WHEN_NEEDED"}(e.ScrollBarPolicy||(e.ScrollBarPolicy={}))},8635:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultScrollSnapper=void 0;var n=function(){function t(){}return Object.defineProperty(t.prototype,"ignoreSmallDistances",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ignoreWhenLongDelay",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.snapOffset=function(t,e){return e},t}();e.DefaultScrollSnapper=n},4129:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Scroller=void 0;var s=n(8523),a=n(3670),l=n(8635),h={useMask:!0,onlyMouseWheel:!1,allowHorizontal:!1,allowVertical:!0,keepViewInArea:!0,scrollUpToCenterX:!1,scrollUpToCenterY:!1,scrollUpToCenterItemSize:{x:0,y:0},scrollCutOff:.2,scrollMaxVelocity:1500,centerAreaHorizontally:!0,centerAreaVertically:!0},u=function(t){function e(n,i,o,u,c,p){var _=t.call(this,n,u)||this;return _.onScrollUpdate=new Phaser.Signal,_.onScrollUpdateFinished=new Phaser.Signal,_._options=null,_._listenersList=null,_._area=new Phaser.Rectangle(0,0,e.DEFAULT_AREA_SIZE,e.DEFAULT_AREA_SIZE),_._view=null,_._viewSize=new Phaser.Point,_._viewMask=null,_._viewMaskSize=new Phaser.Point(-1,-1),_._horizontalViewPercent=0,_._verticalViewPercent=0,_._horizontalScreens=0,_._verticalScreens=0,_._scrollerUpdater=null,_._scrollSnapper=null,_._inputEnabled=!1,_._inputDown=!1,_._inputTime=0,_._inputStartPos=new Phaser.Point,_._inputEndPos=new Phaser.Point,_._inputScrollPrevPos=new Phaser.Point,_._inputScrollVelocity=new Phaser.Point,_._inputScrollTarget=new Phaser.Point,_._inputDownWhileScrolling=!1,_._inputScrollerLastDelta=new Phaser.Point,_._mouseWheelStep=50,_._debug=!1,_._debugView=null,_._debugArea=null,null==c&&(c={}),_._options=r(r({},h),c),_._listenersList=new s.ListenerList,_._scrollerUpdater=null!=p?p:new a.KineticScrollerUpdater(n),_._scrollSnapper=new l.DefaultScrollSnapper,_.createView(i,o),_.inputEnabled=!0,_}return o(e,t),Object.defineProperty(e.prototype,"area",{get:function(){return this._area},set:function(t){this._area=t,this.recalc()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewSize",{get:function(){return this._viewSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"horizontalViewPercent",{get:function(){return this._horizontalViewPercent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalViewPercent",{get:function(){return this._verticalViewPercent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"horizontalScreens",{get:function(){return this._horizontalScreens},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalScreens",{get:function(){return this._verticalScreens},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inputEnabled",{get:function(){return this._inputEnabled},set:function(t){this.removeInputCallbacks(),t&&this.addInputCallbacks(),this._inputEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollingInProgress",{get:function(){return!this._scrollerUpdater.finished},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inputDownWhileScrolling",{get:function(){return this._inputDownWhileScrolling},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollVelocityMagnitudeSq",{get:function(){return this._inputScrollVelocity.getMagnitudeSq()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollDeltaMagnitudeSq",{get:function(){return this._inputScrollerLastDelta.getMagnitudeSq()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inputMovedDistanceSq",{get:function(){var t=this._inputEndPos.x-this._inputStartPos.x,e=this._inputEndPos.y-this._inputStartPos.y;return t*t+e*e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollSnapper",{set:function(t){this._scrollSnapper=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewTopInArea",{get:function(){return-this._view.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewCenterYInArea",{get:function(){return this._area.height<this._viewSize.y?this._area.height/2:-this._view.y+this._viewSize.y/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewBottomInArea",{get:function(){return-this._view.y+this._viewSize.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewLeftInArea",{get:function(){return-this._view.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewCenterXInArea",{get:function(){return this._area.width<this._viewSize.x?this._area.width/2:-this._view.x+this._viewSize.x/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewRightInArea",{get:function(){return-this._view.x+this._viewSize.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mouseWheelStep",{get:function(){return this._mouseWheelStep},set:function(t){this._mouseWheelStep=t},enumerable:!1,configurable:!0}),e.prototype.setDebug=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1),this._debug=t,t&&e||null!==this._debugView&&(this.remove(this._debugView),this._debugView.destroy(),this._debugView=null),t&&n||null!==this._debugArea&&(this.view.remove(this._debugArea),this._debugArea.destroy(),this._debugArea=null),t&&e&&null===this._debugView&&(this._debugView=this.game.add.graphics(0,0,this),this.view.sendToBack(this._debugView)),null!==this._debugView&&(this._debugView.clear(),this._debugView.lineStyle(1,16711680,1),this._debugView.drawRect(0,0,this.viewSize.x,this.viewSize.y)),t&&n&&null===this._debugArea&&(this._debugArea=this.game.add.graphics(0,0,this.view),this.view.sendToBack(this._debugArea)),null!==this._debugArea&&(this._debugArea.clear(),this._debugArea.beginFill(65280,.25),this._debugArea.drawRect(this.area.x,this.area.y,this.area.width,this.area.height),this._debugArea.endFill)},e.prototype.createView=function(t,e){this._view=new Phaser.Group(this.game,this),this._options.useMask&&(this._viewMask=this.game.add.graphics(0,0,this),this._view.mask=this._viewMask),this.setViewSize(t,e)},e.prototype.setViewSize=function(t,e){this._viewSize.set(t,e),this.updateMask(),this.recalc()},e.prototype.setViewPosition=function(t,e,n){void 0===n&&(n=!1),this._view.x=-t,this._view.y=-e,n&&(this._view.x+=this._viewSize.x/2,this._view.y+=this._viewSize.y/2),this._inputScrollVelocity.set(0,0),this.setScrollUpdater()},e.prototype.setPosition=function(t,e){this.position.set(t,e),this.onPositionChange()},e.prototype.recalc=function(){this.calculateScreens(),this.onDimensionsChange(),this.updatePosition(0,0),this._debug&&this.setDebug(this._debug,null!==this._debugView,null!==this._debugArea)},e.prototype.calculateScreens=function(){this._horizontalScreens=Math.max(1,this._area.width/this._viewSize.x),this._verticalScreens=Math.max(1,this._area.height/this._viewSize.y)},e.prototype.updateMask=function(){this._options.useMask&&(this._viewMaskSize.x===this._viewSize.x&&this._viewMaskSize.y===this._viewSize.y||(this._viewMask.clear(),this._viewMask.beginFill(0,1),this._viewMask.drawRect(0,0,this._viewSize.x,this._viewSize.y),this._viewMask.endFill()))},e.prototype.addInputCallbacks=function(){this._options.onlyMouseWheel||(this.game.input.onDown.add(this.onMoveStart,this),this.game.input.addMoveCallback(this.onMove,this),this.game.input.onUp.add(this.onMoveEnd,this)),this.game.input.mouseWheel.callback=this.onMouseWheel.bind(this)},e.prototype.removeInputCallbacks=function(){this._options.onlyMouseWheel||(this.game.input.onDown.remove(this.onMoveStart,this),this.game.input.deleteMoveCallback(this.onMove,this),this.game.input.onUp.remove(this.onMoveEnd,this)),this.game.input.mouseWheel.callback=null},e.prototype.onMoveStart=function(t){this._inputDown||this.insideView(t.worldX,t.worldY)&&(this._inputStartPos.set(t.x,t.y),this._inputEndPos.set(t.x,t.y),this._inputScrollPrevPos.set(t.x,t.y),this._inputDownWhileScrolling=!this._scrollerUpdater.finished&&this.scrollDeltaMagnitudeSq>2500,this._scrollerUpdater.reset(0,0),this._inputDown=!0,this._inputTime=t.timeDown,this._inputScrollVelocity.set(0,0))},e.prototype.onMove=function(t,e,n,i){if(this._inputDown)if(this.insideView(t.worldX,t.worldY)){this._inputEndPos.set(t.x,t.y);var o=this.game.time.time,r=Math.max(1,o-this._inputTime)/1e3,s=0,a=0;if(this._options.allowVertical){var l=(a=t.y-this._inputScrollPrevPos.y)/r;this._inputScrollVelocity.y=this._inputScrollVelocity.y*this._options.scrollCutOff+l*(1-this._options.scrollCutOff)}if(this._options.allowHorizontal){l=(s=t.x-this._inputScrollPrevPos.x)/r;this._inputScrollVelocity.x=this._inputScrollVelocity.x*this._options.scrollCutOff+l*(1-this._options.scrollCutOff)}this._inputScrollPrevPos.set(t.x,t.y),this._inputTime=o,this.updatePosition(s,a)}else this.onMoveEnd(t)},e.prototype.onMoveEnd=function(t){if(this._inputDown&&(this._inputDown=!1,this._inputEndPos.set(t.x,t.y),!(this.game.time.time-this._inputTime>30&&(this._inputScrollVelocity.set(0,0),this._scrollSnapper.ignoreWhenLongDelay)||this.inputMovedDistanceSq<900&&(this._inputScrollVelocity.set(0,0),this._scrollSnapper.ignoreSmallDistances)))){var e=this._options.scrollMaxVelocity,n=this._inputScrollVelocity.x,i=this._inputScrollVelocity.y;this._inputScrollVelocity.set(e*(1-Math.exp(-Math.abs(n)/e))*Phaser.Math.sign(n),e*(1-Math.exp(-Math.abs(i)/e))*Phaser.Math.sign(i)),this.setScrollUpdater()}},e.prototype.onMouseWheel=function(t){this.updatePosition(0,this.game.input.mouseWheel.delta*this._mouseWheelStep)},e.prototype.insideView=function(t,e){var n=this.game.camera.x+this.worldTransform.tx,i=this.game.camera.y+this.worldTransform.ty;return!(t<n||t>=n+this._viewSize.x||e<i||e>=i+this._viewSize.y)},e.prototype.setScrollUpdater=function(){this._inputScrollVelocity=this._scrollSnapper.snapOffset(this._view.position,this._inputScrollVelocity),(!this._options.allowHorizontal||this._viewSize.x>this._area.width)&&(this._inputScrollVelocity.x=0),(!this._options.allowVertical||this._viewSize.y>this._area.height)&&(this._inputScrollVelocity.y=0),this._inputScrollTarget.set(Math.round(this._view.x+this._inputScrollVelocity.x),Math.round(this._view.y+this._inputScrollVelocity.y)),this._scrollerUpdater.reset(this._inputScrollVelocity.x,this._inputScrollVelocity.y),this._scrollerUpdater.finished&&(this.updatePosition(0,0),this.onScrollUpdateFinished.dispatch(this))},e.prototype.update=function(){var e=this.game.time.delta;if(this._scrollerUpdater.finished)this._inputScrollerLastDelta.set(0,0);else{var n=this._scrollerUpdater.update(e),i=this._inputScrollTarget.x-this._view.x-n.x,o=this._inputScrollTarget.y-this._view.y-n.y;e>0&&this._inputScrollerLastDelta.set(1e3*i/e,1e3*o/e),this.updatePosition(i,o),this._scrollerUpdater.finished&&this.onScrollUpdateFinished.dispatch(this)}t.prototype.update.call(this)},e.prototype.updatePosition=function(t,e){this._view.x+=t,this._view.y+=e,this._options.keepViewInArea&&this.keepViewInArea(),this.onViewMove()},e.prototype.keepViewInArea=function(){var t=this._area.x,e=this._area.y,n=this._area.x+this._area.width-this._viewSize.x,i=this._area.y+this._area.height-this._viewSize.y;this._options.scrollUpToCenterX&&(t-=this._viewSize.x/2-this._options.scrollUpToCenterItemSize.x/2,n+=this._viewSize.x/2-this._options.scrollUpToCenterItemSize.x/2),this._options.scrollUpToCenterY&&(e-=this._viewSize.y/2-this._options.scrollUpToCenterItemSize.y/2,i+=this._viewSize.y/2-this._options.scrollUpToCenterItemSize.y/2);var o=!1,r=!1;this._area.width<this._viewSize.x?(this._view.x=-t,this._options.centerAreaHorizontally&&(this._view.x+=(this._viewSize.x-this._area.width)/2),this._horizontalViewPercent=1,o=!0):(this._view.x=Phaser.Math.clamp(this._view.x,-n,-t),this._view.x!==-n&&this._view.x!==-t||(o=!0),this._horizontalViewPercent=n>t?(-this.view.x-t)/(n-t):1),this._area.height<this._viewSize.y?(this._view.y=-e,this._options.centerAreaVertically&&(this._view.y+=+(this._viewSize.y-this._area.height)/2),this._verticalViewPercent=1,r=!0):(this._view.y=Phaser.Math.clamp(this._view.y,-i,-e),this._view.y!==-i&&this._view.y!==-e||(r=!0),this._verticalViewPercent=i>e?(-this.view.y-e)/(i-e):1),o&&r&&this._scrollerUpdater.reset(0,0)},e.prototype.addListener=function(t){this._listenersList.add(t),t.onPositionChange(this,this.x,this.y),t.onDimensionsChange(this),t.onViewMove(this,this._horizontalViewPercent,this._verticalViewPercent)},e.prototype.removeListener=function(t){this._listenersList.remove(t)},e.prototype.removeAllListeners=function(){this._listenersList.removeAll()},e.prototype.onDimensionsChange=function(){for(var t=this._listenersList.listeners,e=0;e<t.length;e++)t[e].onDimensionsChange(this)},e.prototype.onPositionChange=function(){for(var t=this._listenersList.listeners,e=0;e<t.length;e++)t[e].onPositionChange(this,this.x,this.y)},e.prototype.onViewMove=function(){for(var t=this._listenersList.listeners,e=0;e<t.length;e++)t[e].onViewMove(this,this._horizontalViewPercent,this._verticalViewPercent);this.onScrollUpdate.dispatch(this)},e.prototype.isCoordinateInView=function(t,e){return!(t<this.viewLeftInArea||t>this.viewRightInArea||e<this.viewTopInArea||e>this.viewBottomInArea)},e.prototype.isPositionInView=function(t){return this.isCoordinateInView(t.x,t.y)},e.prototype.isPointInView=function(t){return this.isCoordinateInView(t.x,t.y)},e.prototype.isAreaInView=function(t,e,n,i){return this.isCoordinateInView(t,e)&&this.isCoordinateInView(t+n,e+i)},e.prototype.isRectangleInView=function(t){return this.isAreaInView(t.x,t.y,t.width,t.height)},e.DEFAULT_AREA_SIZE=1e3,e}(Phaser.Group);e.Scroller=u},5619:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractScrollerUpdater=void 0;var n=function(){function t(t){this._game=null,this._finished=!0,this._startTime=0,this._initialOffset=new Phaser.Point,this._currentOffset=new Phaser.Point,this._game=t}return Object.defineProperty(t.prototype,"finished",{get:function(){return this._finished},set:function(t){this._finished=t},enumerable:!1,configurable:!0}),t.prototype.reset=function(t,e){this._initialOffset.set(t,e),this._startTime=this._game.time.time,this._finished=0===t&&0===e},t.prototype.update=function(t){return this._finished?(this._currentOffset.set(0,0),this._currentOffset):this.calculateCurrentOffset(t)},t}();e.AbstractScrollerUpdater=n},3670:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.KineticScrollerUpdater=void 0;var r=function(t){function e(e,n){void 0===n&&(n=325);var i=t.call(this,e)||this;return i._timeConstant=325,i._timeConstant=n,i}return o(e,t),e.prototype.calculateCurrentOffset=function(t){var e=this._game.time.time-this._startTime;return this._currentOffset.set(this._initialOffset.x*Math.exp(-e/this._timeConstant),this._initialOffset.y*Math.exp(-e/this._timeConstant)),Math.abs(this._currentOffset.x)<.5&&Math.abs(this._currentOffset.y)<.5&&(this._currentOffset.set(0,0),this._finished=!0),this._currentOffset},e}(n(5619).AbstractScrollerUpdater);e.KineticScrollerUpdater=r},8439:function(t,e){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.UIItem=void 0;var o=function(t){function e(e){var n=t.call(this,e)||this;return n.onInput=new Phaser.Signal,n._id=-1,n._content=null,n.active=!1,n}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){return this.exists&&this.visible},set:function(t){this.visible=this.exists=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"itemWidth",{get:function(){return-1},enumerable:!1,configurable:!0}),Object.defineProperty(e,"itemHeight",{get:function(){return-1},enumerable:!1,configurable:!0}),e.prototype.onInputHandler=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onInput.dispatch(this,this.id,t)},e.prototype.setContent=function(t,e){this._id=t,this._content=e},e}(Phaser.Group);e.UIItem=o},9653:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Toggle=void 0;var r=function(t){function e(e,n,i,o,r,s){var a=t.call(this,e,n,i,o,s,r)||this;return a._toggled=!1,a._changeOnDown=!0,a._toggleTint=!1,a._tintToggled=16777215,a._tintUntoggled=8421504,a._frameToggled=r,a._frameUntoggled=o,a._frameToggledDown=r,a._frameUntoggledDown=o,a.toggled=a._toggled,a}return o(e,t),e.prototype.setDownFrames=function(t,e){void 0!==e&&(this._frameToggledDown=e),void 0!==t&&(this._frameUntoggledDown=t)},e.prototype.setToggleTint=function(t,e){this._toggleTint=!0,this._tintUntoggled=t,this._tintToggled=e},Object.defineProperty(e.prototype,"toggled",{get:function(){return this._toggled},set:function(t){var e,n;if(this._toggled=t,t){var i=null!==(e=this._frameToggled)&&void 0!==e?e:this._frameUntoggled,o=null!==(n=this._frameToggledDown)&&void 0!==n?n:this._frameUntoggledDown;this.changeFrame(null,i,o,i),this.changeTint(this._tintToggled)}else this.changeFrame(null,this._frameUntoggled,this._frameUntoggledDown,this._frameUntoggled),this.changeTint(this._tintUntoggled)},enumerable:!1,configurable:!0}),e.prototype.changeFrame=function(t,e,n,i){this._button.setFrames(t,e,n,i),this._changeOnDown&&(this._button.frameName=e)},e.prototype.changeTint=function(t){this._toggleTint&&this._changeOnDown&&(this._button.tint=t)},Object.defineProperty(e.prototype,"changeOnDown",{get:function(){return this._changeOnDown},set:function(t){this._changeOnDown=t},enumerable:!1,configurable:!0}),e.prototype.downEvent=function(){this.setButton(this._over,!0),this._changeOnDown&&(this.toggled=!this.toggled),this.downAction(),this.onDown.dispatch(this,this._toggled)},e.prototype.upEvent=function(t,e,n){this.setButton(this._over,!1),this.upAction(),n&&(this._changeOnDown||(this.toggled=!this.toggled),this.onClick.dispatch(this,this._toggled))},e}(n(8903).Button);e.Toggle=r},9028:function(t,e){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.UILayer=e.eGroupPlacement=void 0,function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP=1]="TOP",t[t.TOP_RIGHT=2]="TOP_RIGHT",t[t.LEFT=3]="LEFT",t[t.CENTER=4]="CENTER",t[t.RIGHT=5]="RIGHT",t[t.BOTTOM_LEFT=6]="BOTTOM_LEFT",t[t.BOTTOM=7]="BOTTOM",t[t.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"}(e.eGroupPlacement||(e.eGroupPlacement={}));var o=function(t){function e(e,n){void 0===n&&(n=null);var i=t.call(this,e,n)||this;return i._groups=[],i}return i(e,t),e.prototype.hasGroupAt=function(t){var e=this._groups[t];return null!=e},e.prototype.groupAt=function(t,e){void 0===e&&(e=!0);var n=this._groups[t];return null==n&&e&&((n=new Phaser.Group(this.game,this)).fixedToCamera=!0,this._groups[t]=n,this.arrangeGroup(t)),n},e.prototype.arrangeGroups=function(){for(var t=0;t<this._groups.length;t++){var e=this._groups[t];null!=e&&this.arrangeGroup(t)}},e.prototype.arrangeGroup=function(t){var e=t%3,n=Math.floor(t/3),i=this._groups[t];if(null!=i){var o=this.game.width*e/2,r=this.game.height*n/2;i.cameraOffset.set(o,r)}},e}(Phaser.Group);e.UILayer=o},3005:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(8903),e),o(n(9653),e),o(n(7780),e),o(n(9028),e)},6020:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AudioUtils=void 0;var i=n(2178),o=function(){function t(){}return t.setSounds=function(e,n){void 0===n&&(n=null),t._sfx=e,t._sfxIds=n,t._isAudioSprite=null!==e&&e instanceof Phaser.AudioSprite},t.addSound=function(e,n){t._sfxs[e]=n},t.playAudioRecordRnd=function(e,n,i){e&&0!==e.length&&t.playAudioRecord(Phaser.ArrayUtils.getRandomItem(e,n,i))},t.playAudioRecord=function(e){t.playSound(e.key,e.volume)},t.playSoundRnd=function(e,n,i){e&&0!==e.length&&t.playSound(Phaser.ArrayUtils.getRandomItem(e,n,i))},t.playSound=function(e,n){void 0===n&&(n=1);var o=t.getSoundName(e);i.App.settings.soundOn&&(null!==t._sfx?t._isAudioSprite?t._sfx.play(o,n):t._sfx.play(o,0,n):void 0!==t._sfxs[o]&&t._sfxs[o].play("",0,n))},t.stopSound=function(e){var n=t.getSoundName(e);null!==t._sfx?t._isAudioSprite&&t._sfx.stop(n):void 0!==t._sfxs[n]&&t._sfxs[n].stop()},t.getSoundName=function(e){return"number"==typeof e?t._sfxIds[e]:e},Object.defineProperty(t,"currentMusic",{get:function(){return t._currentMusic},enumerable:!1,configurable:!0}),Object.defineProperty(t,"currentMusicSound",{get:function(){if(null==t._currentMusic||0===t._currentMusic.length)return null;var e=t._music[t._currentMusic];return e.isPlaying?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(t,"isMusicPlaying",{get:function(){return null!==this._currentMusic&&0!==this._currentMusic.length&&t._music[t._currentMusic].isPlaying},enumerable:!1,configurable:!0}),t.addMusic=function(e,n){t._music[e]=n},t.playMusic=function(e,n){if(void 0===n&&(n=!0),t._currentMusic!==e&&(null!==t._currentMusic&&t._currentMusic.length>0&&t.stopMusic(),e in t._music&&i.App.settings.musicOn)){t._currentMusic=e;var o=t._music[e];o.loop=n,o.play(),n||o.onStop.addOnce((function(){t.onFinished.dispatch(e)}),this)}},t.stopMusic=function(){if(null!==t._currentMusic&&t._currentMusic.length>0){var e=t._music[t._currentMusic];e.isPlaying&&e.stop(),t._currentMusic=""}},t.pauseMusic=function(){if(null!==t._currentMusic&&t._currentMusic.length>0){var e=t._music[t._currentMusic];e.isPlaying&&e.pause()}},t.resumeMusic=function(){if(null!==t._currentMusic&&t._currentMusic.length>0){var e=t._music[t._currentMusic];e.paused&&e.resume()}},Object.defineProperty(t,"musicVolume",{set:function(e){if(null!=t._currentMusic&&0!==t._currentMusic.length){var n=t._music[t._currentMusic];n.isPlaying&&(n.volume=e)}},enumerable:!1,configurable:!0}),t._sfx=null,t._isAudioSprite=!1,t._sfxs={},t._music={},t._currentMusic="",t.onFinished=new Phaser.Signal,t}();e.AudioUtils=o},8884:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ColorUtils=void 0;var n=function(){function t(){}return t.interpolateTint=function(t,e,n){var i=t>>16&255,o=t>>8&255,r=255&t,s=e>>16&255,a=e>>8&255,l=255&e;return Phaser.Math.linear(i,s,n)<<16|Phaser.Math.linear(o,a,n)<<8|Phaser.Math.linear(r,l,n)},t}();e.ColorUtils=n},2592:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FileUtils=void 0;var n=function(){function t(){}return t.fileExists=function(t){var e=new XMLHttpRequest;return e.open("HEAD",t,!1),e.send(),404!==e.status},t.saveTextAsFile=function(e,n){var i=new Blob([e],{type:"text/plain"});null!==t._file&&window.URL.revokeObjectURL(t._file),t._file=window.URL.createObjectURL(i);var o=document.createElement("a");o.download=n,o.href=t._file,o.onclick=function(t){document.body.removeChild(t.target)},o.style.display="none",document.body.appendChild(o),o.click()},t.saveCanvasAsFile=function(e,n){e.toBlob((function(e){null!==t._file&&window.URL.revokeObjectURL(t._file),t._file=window.URL.createObjectURL(e);var i=document.createElement("a");i.download=n,i.href=t._file,i.onclick=function(t){document.body.removeChild(t.target)},i.style.display="none",document.body.appendChild(i),i.click()}))},t.initScreenshotTaker=function(e,n,i,o,r,s){var a=i.toLowerCase(),l=i.toUpperCase(),h=!1,u=document.createElement("script");document.head.appendChild(u),u.onload=function(){h=!0},u.onerror=function(){},u.src="tools/html2canvas.min.js";var c=0;document.addEventListener("keydown",(function(i){h&&i.ctrlKey===o&&i.shiftKey===r&&i.altKey===s&&(i.keyCode!=a.charCodeAt(0)&&i.keyCode!=l.charCodeAt(0)||window.html2canvas(e.canvas).then((function(e){var i=n+"-html5_screen_"+e.width+"x"+e.height+"_"+ ++c;t.saveCanvasAsFile(e,i)})))}),!1)},t._file=null,t}();e.FileUtils=n},2493:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FullscreenUtils=void 0;var i=n(2178),o=function(){function t(){}return t.supported=function(){return i.App.game.scale.compatibility.supportsFullScreen},t.isFullscreen=function(){return i.App.game.scale.isFullScreen},t.changeFullscreen=function(){var t=i.App.game;t.scale.isFullScreen?t.scale.stopFullScreen():t.scale.startFullScreen(!1,!1)},t}();e.FullscreenUtils=o},4983:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectUtils=void 0;var n=function(){function t(){}return t.loadJson=function(t){return new Promise((function(e,n){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="text",i.onload=function(){if(4===i.readyState&&i.status>=400&&i.status<=599)n(new Error("Error loading "+t+": "+i.statusText));else{var o=i.responseText;o=JSON.parse(o),e(o)}},i.onerror=function(){n(new Error("Network error while loading "+t))},i.send()}))},t.loadValuesIntoObject=function(t,e){for(var n in t)e[n]=t[n]},t}();e.ObjectUtils=n},8683:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PhaserUtils=void 0;var n=function(){function t(){}return t.ChangeAnimationPhaserJSONData=function(t){Phaser.AnimationParser.myCallback=t,Phaser.AnimationParser.JSONData=function(t,e){if(!e.frames)return null;for(var n=new Phaser.FrameData,i=e.frames,o=0;o<i.length;o++){var r=n.addFrame(new Phaser.Frame(o,i[o].frame.x,i[o].frame.y,i[o].frame.w,i[o].frame.h,i[o].filename));i[o].trimmed&&r.setTrim(i[o].trimmed,i[o].sourceSize.w,i[o].sourceSize.h,i[o].spriteSourceSize.x,i[o].spriteSourceSize.y,i[o].spriteSourceSize.w,i[o].spriteSourceSize.h),Phaser.AnimationParser.myCallback(r,i[o])}return n}},t.AdjustTweenFunctions=function(){Phaser.TweenManager.prototype.removeFromUpdateQueue=function(t){var e=this._tweens.indexOf(t);-1!==e?this._tweens.splice(e,1):-1!==(e=this._add.indexOf(t))&&this._add.splice(e,1)},Phaser.Tween.prototype.stopAndRemoveFromUpdateQueue=function(t){var e=this,n=e.stop(t);return e.manager.removeFromUpdateQueue(e),e.pendingDelete=!1,n}},t.AddBitmapFontAddMethod=function(){Phaser.Cache.prototype.addBitmapFontFromImage=function(t,e,n,i,o,r,s){var a=this.getImage(n,!0),l={url:e,data:a.data,font:null,base:a.base};void 0===r&&(r=0),void 0===s&&(s=0),l.font="json"===o?Phaser.LoaderParser.jsonBitmapFont(i,l.base,r,s):Phaser.LoaderParser.xmlBitmapFont(i,l.base,r,s),this._cache.bitmapFont[t]=l,this._resolveURL(e,l)}},t}();e.PhaserUtils=n},6535:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScreenUtils=e.eOrientation=e.ScreenMetrics=void 0;var n,i=function(){};e.ScreenMetrics=i,function(t){t[t.PORTRAIT=0]="PORTRAIT",t[t.LANDSCAPE=1]="LANDSCAPE"}(n=e.eOrientation||(e.eOrientation={}));var o=function(){function t(){}return t.calculateScreenMetrics=function(t,e,o,r,s,a){var l,h;if(void 0===o&&(o=n.LANDSCAPE),((l=window.innerWidth)<(h=window.innerHeight)&&o===n.LANDSCAPE||h<l&&o===n.PORTRAIT)&&!r){var u=l;l=h,h=u}void 0!==s&&void 0!==a||(o===n.LANDSCAPE?(s=Math.round(1024*t/960),a=Math.round(720*e/600)):(s=Math.round(720*t/600),a=Math.round(1024*e/960)));var c=l/h,p=0,_=0,f=0,d=0;c>t/e?(d=e,f=2*Math.ceil(d*c/2),p=((f=Math.min(f,s))-t)/2,_=0):(f=t,d=2*Math.ceil(f/c/2),p=0,_=((d=Math.min(d,a))-e)/2);var y=(l+.01)/f,m=(h+.01)/d;return r&&o===n.LANDSCAPE&&(y=m),this.screenMetrics=new i,this.screenMetrics.windowWidth=l,this.screenMetrics.windowHeight=h,this.screenMetrics.defaultGameWidth=t,this.screenMetrics.defaultGameHeight=e,this.screenMetrics.maxGameWidth=s,this.screenMetrics.maxGameHeight=a,this.screenMetrics.gameWidth=f,this.screenMetrics.gameHeight=d,this.screenMetrics.scaleX=y,this.screenMetrics.scaleY=m,this.screenMetrics.offsetX=p,this.screenMetrics.offsetY=_,this.screenMetrics},t}();e.ScreenUtils=o},3545:function(t,e){"use strict";var n=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{l(i.next(t))}catch(t){r(t)}}function a(t){try{l(i.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((i=i.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.StorageUtils=void 0;var o=function(){function t(){}return Object.defineProperty(t,"sponsorStorage",{set:function(e){t._sponsorStorage=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"allowMultipleRequests",{set:function(e){t._allowMultipleRequests=e},enumerable:!1,configurable:!0}),t.save=function(e,o){return n(this,void 0,void 0,(function(){var n,r,s;return i(this,(function(i){switch(i.label){case 0:if(!t._allowMultipleRequests&&t._requestsCounter>0)throw new Error("Previous load/save request was not finished yet");return++t._requestsCounter,null===(n=t._sponsorStorage)?[3,2]:[4,n.save(e,o)];case 1:if(i.sent(),!n.fallbackToStandardStorage())return--t._requestsCounter,[2];i.label=2;case 2:if(null===(r=t.getLocalStorage()))throw--t._requestsCounter,new Error("Standard storage not available");return s=JSON.stringify(o),r.setItem(e,s),--t._requestsCounter,[2]}}))}))},t.load=function(e){return n(this,void 0,void 0,(function(){var n,o,r,s;return i(this,(function(i){switch(i.label){case 0:if(!t._allowMultipleRequests&&t._requestsCounter>0)throw new Error("Previous load/save request was not finished yet");return++t._requestsCounter,n=null,null===(o=t._sponsorStorage)?[3,2]:[4,o.load(e)];case 1:if(null!=(n=i.sent())||!o.fallbackToStandardStorage())return--t._requestsCounter,[2,n];i.label=2;case 2:if(null===(r=t.getLocalStorage()))throw--t._requestsCounter,new Error("Standard storage not available");return s=r.getItem(e),n=JSON.parse(s),--t._requestsCounter,[2,n]}}))}))},t.getLocalStorage=function(){try{if("localStorage"in window&&null!=window.localStorage)return localStorage}catch(t){return null}return null},t._sponsorStorage=null,t._allowMultipleRequests=!0,t._requestsCounter=0,t}();e.StorageUtils=o},5421:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StringUtils=void 0;var n=function(){function t(){}return t.padNumber=function(t,e,n){void 0===n&&(n="0");var i=t+"";return i.length>=e?i:new Array(e-i.length+1).join(n)+i},t.addSpacingToNumber=function(t,e){return void 0===e&&(e=" "),(""+t).replace(/\B(?=(\d{3})+(?!\d))/g,e)},t.formatTime=function(e,n,i,o){void 0===i&&(i=-1),void 0===o&&(o=":");var r=!1,s="";if((e=Math.floor(e))>3600||0===n){var a=Math.floor(e/3600);s+=(-1!==i?t.padNumber(a,i):a)+o,e%=3600,r=!0}if(!0===r||e>60||1===n){var l=Math.floor(e/60);s+=(-1!==i?t.padNumber(l,i):l)+o,e%=60,r=!0}var h=e;return s+=-1!==i?t.padNumber(h,i):h},t.format=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(0===n.length)return e;for(var o=e,r=0;r<n.length;r++){var s="string"==typeof n[r]?n[r]:n[r].toString(),a=r<t.SEARCH_TEXTS.length?t.SEARCH_TEXTS[r]:"{"+r+"}";o=o.replace(a,s)}return o},t.SEARCH_TEXTS=["{0}","{1}","{2}","{3}","{4}","{5}","{6}","{7}","{8}","{9}"],t}();e.StringUtils=n},2757:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextUtils=void 0;var i=n(2178),o=function(){function t(){}return t.setTexts=function(e){t._texts=e},Object.defineProperty(t,"sponsorText",{set:function(e){t._sponsorText=e},enumerable:!1,configurable:!0}),t.getLanguage=function(){var t=null;return navigator&&navigator.userAgent&&(t=navigator.userAgent.match(/android.*\W(\w\w)-(\w\w)\W/i))&&(t=t[1]),!t&&navigator?(navigator.language?t=navigator.language:navigator.languages&&navigator.languages.length>0?t=navigator.languages[0]:navigator.browserLanguage?t=navigator.browserLanguage:navigator.systemLanguage?t=navigator.systemLanguage:navigator.userLanguage&&(t=navigator.userLanguage),t=t.substr(0,2).toLowerCase()):t="en",t},t.getText=function(e,n){if(null!==t._sponsorText)return t._sponsorText.getText(e,n);if(null===t._texts)throw new Error("Texts are not set.");void 0===n&&(n=i.App.settings.currentLanguage);var o=t._texts[n];if(void 0===o)throw new Error("Invalid language ID "+n+".");var r=o[e];if(void 0===r)throw new Error("Text with text id: "+e+" for language "+n+" is missing.");return r},t._texts=null,t._sponsorText=null,t}();e.TextUtils=o},6674:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Host=e.Device=void 0;var n=function(){function t(){}return t.isAndroidStockBrowser=function(){var t=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);return t&&parseFloat(t[1])<537},t.androidVersion=function(){var t=navigator.userAgent.match(/Android\s([0-9\.]*)/);return t?parseFloat(t[1]):-1},t.androidUnlockAudio=function(t){t.device.android&&t.device.chrome&&t.device.chromeVersion>=55&&(t.sound.touchLocked=!0,t.input.addTouchLockCallback((function(){if(this.noAudio||!this.touchLocked||null!==this._unlockSource)return!0;if(this.usingWebAudio){var t=this.context.createBuffer(1,1,22050);this._unlockSource=this.context.createBufferSource(),this._unlockSource.buffer=t,this._unlockSource.connect(this.context.destination),void 0===this._unlockSource.start?this._unlockSource.noteOn(0):this._unlockSource.start(0),"suspended"===this._unlockSource.context.state&&this._unlockSource.context.resume()}return!0}),t.sound,!0))},t}();e.Device=n;var i=function(){function t(){}return t.isLocal=function(){var t=window.location.hostname;return!("localhost"!==t&&"127.0.0.1"!==t&&""!==t&&!t.match(/192.168.[0-9.]+$/))},t}();e.Host=i},7215:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(6020),e),o(n(2592),e),o(n(2493),e),o(n(4983),e),o(n(8683),e),o(n(6535),e),o(n(3545),e),o(n(5421),e),o(n(2757),e),o(n(6674),e)}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}return n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n(6852),n(2178)}()}));