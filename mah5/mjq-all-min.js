function mjq_formatIntNumber(a){if(1e3>a)return a;if(1e6>a){var b=Math.floor(a/1e3),c=a%1e3,d="";return 10>c?d="00":100>c&&(d="0"),b+","+d+c}var e=Math.floor(a/1e6),b=Math.floor(a%1e6/1e3),f="";10>b?f="00":100>b&&(f="0");var c=a%1e3,d="";return 10>c?d="00":100>c&&(d="0"),e+","+f+b+","+d+c}function mjq_getRandomInt(a,b){if(a>=b)return a;var c=b-a;c+=1;var d=Math.floor(mjq_randomGen.random()*c);return d===c&&(d=c-1),d+a}function mjq_scaledValue(a,b){var c=0>a;a=Math.abs(a);var d=0;return void 0!==b&&b>=1?(d=Math.ceil(mjq_scaledPixelRatio*a),b>d&&(d=b),c?0-d:d):(d=Math.ceil(mjq_scaledPixelRatio*a),c?0-d:d)}function mjq_getVisibilityHiddenProp(){var a=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var b=0;b<a.length;b++)if(a[b]+"Hidden"in document)return a[b]+"Hidden";return null}function mjq_isHidden(){var a=mjq_getVisibilityHiddenProp();return a?document[a]:!1}function mjq_visibilityChanged(){null!==mjq_gameScript&&void 0!==mjq_gameScript&&mjq_gameScript.visibilityChanged(mjq_isHidden())}function TweenDelegate(){}function mjq_calcResolutionSet(){var a=screen.height;screen.width<screen.height&&(a=screen.width),mjq_resolutionSet=a*mjq_devicePixelRatio,mjq_debugOut("mjq_resolutionSet: "+mjq_resolutionSet+", minScreenValue: "+a+", mjq_devicePixelRatio: "+mjq_devicePixelRatio+", screen.width: "+screen.width+", screen.height: "+screen.height)}function MJQ_AnimationManager(a,b,c){var d=this;this.name="MJQ_AnimationManager",this.cast=null,this.primary=b,this.canvasOffsetLeft=0,this.canvasOffsetTop=0,this.inputHandler=c,this.anims=[],this.numCycles=0,this.forceRepaintCycles=1,this.script=null,this.repaintAllSetting=mjq_touchable?!1:!1,this.forceSync=!1,this.MOUSEDOWN=1,this.MOUSEUP=2,this.MOUSEMOVE=3,this.canvas=a,this.width=this.canvas.width,this.height=this.canvas.height,this.context=this.canvas.getContext("2d"),this.touchID=-1,this.touches=null,this.mousePressed=!1,this.lastMouseDownEvent=null,this.lastMouseUpEvent=null,this.lastMouseMoveEvent=null,this.dirtyRects=[],this.time=(new Date).getTime(),this.lastTime=this.time,this.timeArray=[],this.timeCounter=0,this.mouseMoveListener=null,this.repaintAllFlag=!1,this.masterInput=!0,this.lastMouseX=0,this.lastMouseY=0,this.lastMouseTime=0,this.hovering=!1,this.HOVER_DELAY=1e3,this.inputHandler&&this.initListeners(),this.primary&&(mjq_touchable||this.forceSync?!function e(){mjq_requestAnimFrame(e),mjq_animateCount++,mjq_elementOffsetLeft=d.canvas.elementOffsetLeft,mjq_elementOffsetTop=d.canvas.elementOffsetTop,d.doit();for(var a=d.anims,b=a.length,c=0;b>c;c++)a[c].doit()}():this.loop=setInterval(function(){mjq_animateCount++,mjq_elementOffsetLeft=d.canvas.elementOffsetLeft,mjq_elementOffsetTop=d.canvas.elementOffsetTop,d.doit();for(var a=d.anims,b=a.length,c=0;b>c;c++)a[c].doit()},16.667))}function MJQ_Cast(a){this.anim=a,this.name="MJQ_Cast",this.mouseDownTime=0,this.CLICK_TIME=500,this.draggedObj=null,this.trackedObj=null,this.prevMouseOverObj=null,this.mouseHoverObj=null,this.dialog=null,this.inputCatcher=null,this.modeless=!1,this.members=[],this.dirtyRects=[],this.receivers=[],this.restricted=[]}function MJQ_CastMember(){this.name="no name MJQ_CastMember",this.type="MJQ_CastMember",this.json={},this.curTime=0,this.tweenValue=0,this.scaleTweenValue=0,this.rotateTweenValue=0,this.receiver=null,this.receiverLocked=!1,this.imageBuffer=null,this.SNAP_DISTANCE=5,this.CLICK_DISTANCE=25,this.CLICK_TIME=750,this.MOVE_CUE=1,this.TIME_CUE=2,this.BLINK_CUE=3,this.FADE_CUE=4,this.SCALE_CUE=5,this.ROTATE_CUE=6,this.CYCLE_CUE=7,this.SPECIAL_CUE=100,this.CANCEL_MOUSE_OPERATIONS=1e4,this.ALPHA_THRESHOLD=40,this.usePerPixelAccuracy=!1,this.usingBezierPts=!1,this.tween=null,this.scaleTween=null,this.rotateTween=null,this.usingTween=!1,this.name,this.id,this.cast=null,this.doCheckRect=!0,this.scale={x:1,y:1},this.rotation=0,this.rect={x:0,y:0,width:0,height:0,xOffset:0},this.dirtyRect={x:0,y:0,width:0,height:0},this.hotRect={x:0,y:0,width:0,height:0,xOffset:0},this.receiver,this.priority=100,this.highestPriorityOnDrag=!0,this.dirty=!0,this.visible=!1,this.inputAllowed=!1,this.inputAllowedWhileMoving=!1,this.draggingAllowed=!1,this.clicksAllowed=!1,this.mouseMovesAllowed=!1,this.moving=!1,this.cycling=!1,this.scaling=!1,this.rotating=!1,this.dragging=!1,this.tracking=!1,this.mouseDownTime,this.lastTrackingState=1,this.prevPri,this.prevX,this.prevY,this.mouseDownOffsetX,this.mouseDownOffsetY,this.mouseDownX=0,this.mouseDownY=0,this.movingToX=0,this.movingToY=0,this.moveToTime=0,this.moveToOrigX=0,this.moveToOrigY=0,this.arrived=!1,this.exactX=0,this.exactY=0,this.moveToDistance=0,this.doPrevPriAfterMoveTo=!1,this.mouseDownAdjustmentX=0,this.mouseDownAdjustmentY=0,this.script=null,this.blinkScript=null,this.alpha=1,this.fadeStartAlpha=0,this.fadeStartTime=0,this.fadeTime=0,this.fadeTo=0,this.fadeListener=null,this.fadingIn=!1,this.fadingOut=!1,this.hideAfterFade=!1,this.removeAfterFade=!1,this.hideAfterMove=!1,this.cueListener=null,this.moveCue=!1,this.cycleCue=!1,this.scaleCue=!1,this.rotateCue=!1,this.cueTime,this.cueDuration,this.blinkCue=!1,this.moveToBezierPts=[],this.allowShadows=!0,this.shadowVisible=!1,this.shadowColor="black",this.shadowBlur=0,this.specialCue=0,mjq_numCastMembersCreated++}function MJQ_CastMemberImage(a){this.mjq_callSuper(MJQ_CastMember),this.json=a,this.name="no name MJQ_CastMemberImage",this.type="MJQ_CastMemberImage",this.imgHolder=null,this.img=new Image,this.frame=0,this.row=0,void 0!==a&&(this.name=a.name,this.setImage(mjq_imageHolders[a.imgName]),this.numRows=this.imgHolder.rows.length,this.numFrames=this.imgHolder.rows[0].length,this.setPos(a.pos),this.setCast(window["mjq_"+a.cast]),this.checkRect(a.checkRect),this.setPriority(a.priority),void 0!==a.usePerPixelAccuracy&&(this.usePerPixelAccuracy=a.usePerPixelAccuracy),void 0!==a.frame&&this.setFrame(a.frame),void 0!==a.row&&this.setRow(a.row),a.show?this.show():this.hide(),void 0!==a.scale&&this.setScale(a.scale.x,a.scale.y),void 0!==a.rotation&&this.setRotation(a.rotation,!0),this.cycleDirection=MJQ_CastMember.CYCLE_FORWARD,this.cycleStartTime=0,this.cycleFrameDuration=0,this.cycles=1,this.cycleStopFrame=0,this.rotationOriginX=void 0!==a.rotationOrigin?a.rotationOrigin.x/1e3:.5,this.rotationOriginY=void 0!==a.rotationOrigin?a.rotationOrigin.y/1e3:.5)}function MJQ_CastMemberButton(a,b){this.mjq_callSuper(MJQ_CastMemberImage,a),void 0!==a&&(this.type="MJQ_CastMemberButton",this.numButtonStates=a.numStates,this.checkRect(!0),this.buttonListener=null,this.enabled=a.enabled,this.over=!1,this.setFrame(0),this.allowMouseMoves(!0),void 0!==a.hotRect&&(this.hotRect.x=mjq_scaledValue(a.hotRect.x),this.hotRect.y=mjq_scaledValue(a.hotRect.y),this.hotRect.width=mjq_scaledValue(a.hotRect.width),this.hotRect.height=mjq_scaledValue(a.hotRect.height)),this.init(),this.id=b[a.id],this.setButtonListener(b))}function MJQ_CastMemberText(a){if(this.mjq_callSuper(MJQ_CastMember),this.json=a,void 0!==a){this.type="MJQ_CastMemberText",this.name=a.name,this.mustRefactor=!1,this.shadowDist=1,this.text=a.text,this.heightMultiplier=.25,this.fontStyle=a.font.style,this.fontSize=mjq_scaledValue(mjq_usingiPhone?a.font.sizePhone:a.font.size),this.fontName=a.font.name,this.setFont(this.fontName,this.fontSize,this.fontStyle),this.ascent=Math.round(this.fontSize*this.heightMultiplier),this.fontHeight=this.fontSize+this.ascent+Math.round(this.fontSize*this.heightMultiplier)+mjq_scaledValue(this.shadowDist,1),this.yOffset=Math.round(mjq_scaledValue(this.fontHeight/2)),this.rect.width=1,this.rect.height=this.fontHeight,this.renderX=0,this.renderY=0;var b=window[a.pos.justification];this.justification=b,this.color=a.color.text,this.color2=a.color.buttonDown,this.shadowColor=a.color.shadow,this.useColor=this.color,this.buttonListener,this.extraShadow=!1,this.noShadow=!1,this.hideAfterFlash=!1,""!==this.color2&&(this.allowInput(!0),this.allowClicks(!0),this.allowMouseMoves(!0)),this.buffer=null,this.shadowBlur=a.shadow.blur,this.allowShadows=a.shadow.allow,this.shadowVisible=a.shadow.visible,this.checkRect(a.checkRect),this.setCast(window["mjq_"+a.cast]),this.setText(a.text),void 0!==a.hotRect&&(this.hotRect.x=mjq_scaledValue(a.hotRect.x),this.hotRect.y=mjq_scaledValue(a.hotRect.y),this.hotRect.width=mjq_scaledValue(a.hotRect.width),this.hotRect.height=mjq_scaledValue(a.hotRect.height));var c=void 0!==a.pos.offsetFromRight?mjq_scaledValue(a.pos.offsetFromRight):0,d=void 0!==a.pos.offsetFromBottom?mjq_scaledValue(a.pos.offsetFromBottom):0;this.rect.x=void 0!==a.pos.centerX&&a.pos.centerX?Math.round(MJQ_ACTIVITY_WIDTH/2-this.rect.width/2)+c:void 0!==a.pos.offsetFromRight?MJQ_ACTIVITY_WIDTH+c:mjq_scaledValue(a.pos.x),this.rect.y=void 0!==a.pos.centerY&&a.pos.centerY?Math.round(MJQ_ACTIVITY_HEIGHT/2-this.rect.height/2)+d:void 0!==a.pos.offsetFromBottom?MJQ_ACTIVITY_HEIGHT+d:mjq_scaledValue(a.pos.y),this.setPriority(a.priority),a.show?this.show():this.hide(),void 0!==a.scale&&this.setScale(a.scale.x,a.scale.y)}}function MJQ_Script(){this.type="MJQ_Script",this.resetScript(),this.parent=null,this.subScript=null}function MJQ_BlinkScript(a,b,c,d,e){this.mjq_callSuper(MJQ_Script),this.type="MJQ_BlinkScript",this.parent=a,this.blinkRate=500,this.blinkRateOff=500,this.blinkTimes=1,this.hideAfterBlink=!1,void 0!==b&&(this.blinkRate=b),void 0!==c&&(this.blinkRateOff=c),void 0!==d&&(this.blinkTimes=d),void 0!==e&&(this.hideAfterBlink=e),this.blinkCounter=0,this.changeState(1)}function MJQ_Config(){this.name="MJQ_Config"}function MJQ_CastMemberDialog(a,b,c){this.mjq_callSuper(MJQ_CastMember),this.id=b,this.name="MJQ_CastMemberDialog",this.type="MJQ_CastMemberDialog",this.img=new Image,this.textJustify=MJQ_TEXT_LEFT,this.dialogFontSize=mjq_scaledValue(32),this.numFrames=1,this.numRows=1,this.frame=0,this.row=0,this.listener=void 0===c?null:c,this.anim=a,this.foreColor="#ffffff",this.shadowColor="#000000",this.borderColor="#ffffff",this.borderColor2="#000000",this.fontName="Arial",this.fontSize=this.dialogFontSize,this.fontStyle=MJQ_TEXT_BOLD,this.backImgHolder=null,this.b1ImgHolder=null,this.b1Frame=0,this.b2ImgHolder=null,this.b2Frame=0,this.b3ImgHolder=null,this.b3Frame=0,this.iconImgHolder=null,this.iconFrame=0,this.checkImgHolder=null,this.checkFrame=0,this.radioImgHolder=null,this.radioFrame=0,this.time,this.modeless,this.trackingItem=null,this.button1Item=null,this.button2Item=null,this.button3Item=null,this.buttonDown,this.buttonTracked,this.textX,this.borderThickness=1,this.textShadowDepth=1,this.items=[],this.buttonItems=[],this.shown=!1,this.opening=!1,this.buttonSet,this.buttonAdded=!1,this.sizeSet=!1,this.allowInput(!0),this.allowDragging(!0),this.useAbsolutePositioning=!1,this.disposeOnMouseDownOutside=!0,this.usePerPixelAccuracy=!0}function MJQ_DialogItem(a,b,c,d,e,f){this.name="MJQ_DialogItem "+b+", "+c+",  "+d,this.type="MJQ_DialogItem",this.owner=a,this.detachOnClick=!0,this.enabled=!0,this.type=b,this.id=e,this.subID,this.x=c,this.y=d,this.x2,this.y2,this.buttonPadding=0,this.offsetY=0,this.text=null,this.textWidth=0,this.textHeight=0,this.color1="#000000",this.color2=this.owner.shadowColor,null===this.color2&&(this.color2="#FFFFFF"),this.textXOffset=0,this.textBuffer=null,this.shadowDepth=0,this.textRenderX=this.x,this.textRenderY=this.y,this.mustRefactorText=!0,this.fontSize,this.fontStyle=MJQ_TEXT_PLAIN,this.font=null,this.ascent=0,this.fontHeight=0,this.heightMultiplier=.25,this.lineSize=1,this.state=!1,this.lastState=!1,this.imgHolder=null,this.frameWidth,this.frameHeight,this.numFrames=1,void 0!==f&&(this.numFrames=f),this.numFrames<1&&(this.numFrames=1),this.numRows=1,this.frame=0,this.row=0,this.over,this.width=0,this.height=0,this.justify=0,this.hotRectPadding=0}function MJQ_CastMemberNumber(a){if(this.mjq_callSuper(MJQ_CastMemberImage,a),this.json=a,this.name="no name MJQ_CastMemberNumber",this.type="MJQ_CastMemberNumber",this.buffer=null,void 0!==a){var b=window[a.pos.justification];this.justification=b;var c=a.digitpadding;void 0===c&&(c=0),this.digitPadding=mjq_scaledValue(c),this.text="",this.value=0,this.useHatchMark=!1}}function MJQ_Resource(a,b){this.image=new Image,this.image.onloadObj=b,this.image.addEventListener("load",this.imgLoaded,!1),this.image.src=a,this.buffer=null}function mjq_createAudioSprite(a,b,c,d){return new Howl({src:[a,b],autoplay:!1,onload:function(){void 0!==d&&d()},onloaderror:function(){mjq_debugOut("Audio Sprite failed to load"),null!==script&&void 0!==script&&script.changeState(state,delay)},sprite:c})}function mjq_playSound(a,b){var c=0;return mjq_soundOn&&null!==mjq_audioSprite&&void 0!==mjq_audioSprite&&(c=mjq_audioSprite.play(a),b&&mjq_audioSprite.loop(!0,c)),c}function mjq_stopSound(a){0!==a&&null!==mjq_audioSprite&&void 0!==mjq_audioSprite&&mjq_audioSprite.stop(a)}function mjq_loadMusic(a,b){var c=mjq_audioPath+""+a+mjq_musicQualityModifier,d=new Howl({src:[c+".mp3",c+".ogg"],loop:!0,autoplay:!1,onload:function(){void 0!==b&&b()}});return d}function mjq_playMusic(a){if(mjq_musicOn&&null!==a){var b=a.play();a.musicID=b,a.volume(1,b)}mjq_handleActiveMusic(a)}function mjq_handleMusicOption(a){for(var b=null,c=0;c<a.length;c++)b=a[c],null!==b&&(mjq_musicOn?0===b.musicID?void 0!==b.activeMusic&&b.activeMusic&&mjq_playMusic(b):void 0!==b.activeMusic&&b.activeMusic&&(b.volume(1),b.play()):b.pause())}function mjq_fadeOutMusic(a,b){null!==a&&a.fade(1,0,b)}function mjq_fadeInMusic(a,b){mjq_musicOn&&null!==a&&a.fade(0,1,b),mjq_handleActiveMusic(a)}function mjq_handleActiveMusic(a){null!==a&&(a.activeMusic=!0);for(var b=mjq_game.script.musicObjects,c=0;c<b.length;c++)null!==b[c]&&b[c]!==a&&(b[c].activeMusic=!1)}function mjq_unloadMusic(a){null!==a&&a.unload()}function mjq_muteAllAudio(){Howler.mute(!0)}function mjq_unmuteAllAudio(){Howler.mute(!1)}function MJQ_Timer(a,b){this.mjq_callSuper(MJQ_CastMemberNumber,b),this.type="MJQ_CastMemberNumber",this.name="MJQ_Timer",this.gameScript=a,this.startTime=0,this.started=!1,this.countDown=!1,this.startSeconds=0,this.addedSeconds=0,this.tenths=0,this.showFractn=!1,this.TIMER_TOCK_START_TIME=170,this.lastTock=0,this.loop=-1,this.paused=!1,this.pauseStartTime=0}function MJQ_BigTextScript(a,b){this.mjq_callSuper(MJQ_Script),this.type="MJQ_BigTextScript",this.bigtextObj=a,this.changeState(b)}function MJQ_BigText(a,b,c,d){this.mjq_callSuper(MJQ_CastMemberImage,b),this.type="MJQ_CastMemberImage",this.name=b.name,this.startState=b.startState,this.gameScript=a,this.nextGameState=c,this.nextStateTime=void 0===d?1:d,this.setScript(new MJQ_BigTextScript(this,this.startState))}function MJQ_TimerBar(a){this.mjq_callSuper(MJQ_CastMemberImage,a),this.name="MJQ_TimerBar",this.clipX=0,this.timerBarWidth=mjq_scaledValue(424)}function MJQ_MultiplierBar(a){this.mjq_callSuper(MJQ_CastMemberImage,a),this.name="MJQ_MultiplierBar",this.multiplierValues=[],this.clipX=0,this.multiplierBarWidth=mjq_scaledValue(424),this.barValue=0,this.started=!1,this.loop=-1,this.paused=!1,this.timed=!1}function MJQ_Progress(){this.northLevels=[],this.southLevels=[],this.eastLevels=[],this.westLevels=[];for(var a=1;a<=mjq_gameScript.NUMLEVELS;a++)this.northLevels[a]={score:0,coins:0},this.southLevels[a]={score:0,coins:0},this.eastLevels[a]={score:0,coins:0},this.westLevels[a]={score:0,coins:0};this.init()}function MJQ_Console(progress){this.progress=progress,this.startTime=0,this.loadingNum=0,this.initialLoadingComplete=!1,this.loadingPercentages=[0,.07,.19,.3,.38,.43,.52,.6,.66,.73,.81,.89,.95,1],this.scriptToCall=null,this.scriptStateNext=0,this.scriptStateTime=0,this.gameDataArrived=!1,this.user=null}function MJQ_Tile(a,b,c,d,e,f,g,h,i,j){if(this.mjq_callSuper(MJQ_CastMemberImage,a),void 0!==a){this.allowMouseMoves(!1),this.mouseOverObj=f,mjq_outputTileInfoToDebug&&this.allowMouseMoves(!0),this.name="MJQ_Tile",this.type="MJQ_CastMemberImage",this.game=b,this.moveNumID=-1,this.positionAdjusted=!1,this.animatedIn=!1,this.tileBlank=g,this.tileFaces=h,this.tileFacesSelected=i,this.tileFacesDark=j,this.imageRow=0,this.imageFrame=0,this.layout=this.game.layout,this.layoutLayer=-1,this.layoutPosX=-1,this.layoutPosY=-1,this.layoutIndex=-1,this.sValue="",this.rank=c,this.suit=d,this.copyNum=e,this.value=0,this.numInMatch=0,this.extraTime=0,this.playable=!1,this.origPriority=0,this.origX=0,this.origY=0,this.pointsBeforePlayed=0,this.pointsFromMultiplier=0,this.pointsFromTimer=0,this.pointsFromBonusTimer=0,this.multiplierBeforePlayed=1,this.mouseOver=!1,this.dark=!1,this.hilite=!1,this.hideFace=!1,this.clickSucceeded=!1,this.setImageFrame(),this.allowClicks(!0),this.allowDragging(!1),this.setHighestPriorityOnDrag(!1);var k=this.tileBlank.rows[0][0];this.hotRect.x=k.width-MJQ_TILE_FACE_WIDTH-1,this.hotRect.y=0,this.hotRect.width=0-(k.width-MJQ_TILE_FACE_WIDTH)+1,this.hotRect.height=0-(k.height-MJQ_TILE_FACE_HEIGHT)+1}}function MJQ_Deck(a,b,c,d){this.name="MJQ_Deck",this.type="MJQ_Deck",this.game=a,this.cast=b,this.tiles=[],this.anchoredMultiplierTiles=[],this.anchoredWildTiles=[],this.anchoredTimeTiles=[],this.anchoredFirecrackerTiles=[],this.anchoredWallTiles=[],this.anchoredYinYangTiles=[],this.playedTiles=[],this.tileBlank=mjq_imageHolders.tileblank,this.tileFaces=mjq_imageHolders.tiles,this.tileFacesSelected=mjq_imageHolders.tilesselected,this.tileFacesDark=mjq_imageHolders.tilesdark,this.createDeck(c,d),this.tileImagesCreated=!0}function mjq_testiOSVersion(){if(/iP(hone|od|ad)/.test(navigator.platform)){var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3]||0,10)]}}function mjq_setBodyBackground(){if(mjq_android){var a=document.createElement("canvas");a.width=mjq_backgroundWidths[mjq_resolutionIndex],a.height=mjq_resolutionHeights[mjq_resolutionIndex];var b=a.getContext("2d"),c=b.createLinearGradient(0,0,0,a.height);c.addColorStop(0,"#60382C"),c.addColorStop(.3,"#000000"),c.addColorStop(.5,"#000000"),c.addColorStop(1,"#183024"),b.fillStyle=c,b.fillRect(0,0,a.width,a.height),b.stroke();var d=new Image;d.src=a.toDataURL(),document.body.style.backgroundImage="url("+d.src+")"}}function mjq_gameStart(){mjq_resolutionJSONName="mjq.json",mjq_resolutionIndex=0,MJQ_ACTIVITY_WIDTH=mjq_resolutionWidths[0],MJQ_ACTIVITY_HEIGHT=mjq_resolutionHeights[0],mjq_artAssetsName="artassets"+mjq_resolutionHeights[0]+".json?v="+MJQ_VERSION_TEXT,mjq_artAssetsNameLocations="artassetslocations"+mjq_resolutionHeights[0]+".json?v="+MJQ_VERSION_TEXT,mjq_artAssetsNameNorth="artassetsnorth"+mjq_resolutionHeights[0]+".json?v="+MJQ_VERSION_TEXT,mjq_artAssetsNameSouth="artassetssouth"+mjq_resolutionHeights[0]+".json?v="+MJQ_VERSION_TEXT,mjq_artAssetsNameEast="artassetseast"+mjq_resolutionHeights[0]+".json?v="+MJQ_VERSION_TEXT,mjq_artAssetsNameWest="artassetswest"+mjq_resolutionHeights[0]+".json?v="+MJQ_VERSION_TEXT,mjq_objectsName="objects.json?v="+MJQ_VERSION_TEXT;var a=mjq_resolutionWidths.length-1;for(i=0;i<a;i++)mjq_resolutionSet>mjq_resolutionHeights[i]&&(mjq_resolutionIndex=i+1,MJQ_ACTIVITY_WIDTH=mjq_resolutionWidths[i+1],MJQ_ACTIVITY_HEIGHT=mjq_resolutionHeights[i+1],mjq_artAssetsName="artassets"+mjq_resolutionHeights[i+1]+".json?v="+MJQ_VERSION_TEXT,mjq_artAssetsNameLocations="artassetslocations"+mjq_resolutionHeights[i+1]+".json?v="+MJQ_VERSION_TEXT,mjq_artAssetsNameNorth="artassetsnorth"+mjq_resolutionHeights[i+1]+".json?v="+MJQ_VERSION_TEXT,mjq_artAssetsNameSouth="artassetssouth"+mjq_resolutionHeights[i+1]+".json?v="+MJQ_VERSION_TEXT,mjq_artAssetsNameEast="artassetseast"+mjq_resolutionHeights[i+1]+".json?v="+MJQ_VERSION_TEXT,mjq_artAssetsNameWest="artassetswest"+mjq_resolutionHeights[i+1]+".json?v="+MJQ_VERSION_TEXT);mjq_scaledWidth=MJQ_ACTIVITY_WIDTH,mjq_scaledHeight=MJQ_ACTIVITY_HEIGHT,mjq_setBodyBackground(),768>MJQ_ACTIVITY_HEIGHT&&(mjq_musicQualityModifier="low"),mjq_scaledPixelRatio=mjq_scaledWidth/MJQ_MAX_ACTIVITY_WIDTH,mjq_debugOut("Activity Width: "+MJQ_ACTIVITY_WIDTH+", Activity Height: "+MJQ_ACTIVITY_HEIGHT),mjq_pathsConfig=new MJQ_Config,mjq_pathsConfig.init("paths.json",mjq_pathsConfigLoaded,-1)}function mjq_pathsConfigLoaded(a){mjq_audioPath=a.json.audiopath,mjq_imagesPath=a.json.imagespath,mjq_layoutsPath=a.json.layoutspath,mjq_levelsPath=a.json.levelspath,mjq_gameDefinitionsPath=a.json.gamedefinitionspath,mjq_game=new MJQ_MahjongGame(mjq_gameDefinitionsPath+mjq_resolutionJSONName,mahjongQuestGameLoaded,-1,"1")}function mahjongQuestGameLoaded(){mjq_gameLoaded=!0;var a=mjq_GetGameContainer(),b=document.createElement("canvas");if(null!==b&&void 0!==b){b.setAttribute("style","border: 0px; position: absolute; top: 0px; left: 0px; z-index: 13; width: "+MJQ_ACTIVITY_WIDTH+"px; height: "+MJQ_ACTIVITY_HEIGHT+"px;"),b.setAttribute("id","layerForeground"),a.appendChild(b),b.width=MJQ_ACTIVITY_WIDTH,b.height=MJQ_ACTIVITY_HEIGHT;var c=document.createElement("canvas");c.setAttribute("style","border: 0px; position: absolute; top: 0px; left: 0px; z-index: 12; width: "+MJQ_ACTIVITY_WIDTH+"px; height: "+MJQ_ACTIVITY_HEIGHT+"px;"),c.setAttribute("id","layerGameLayer"),a.appendChild(c),c.width=MJQ_ACTIVITY_WIDTH,c.height=MJQ_ACTIVITY_HEIGHT;var d=document.createElement("canvas");d.setAttribute("style","border: 0px; position: absolute; top: 0px; left: 0px; z-index: 11; width: "+MJQ_ACTIVITY_WIDTH+"px; height: "+MJQ_ACTIVITY_HEIGHT+"px;"),d.setAttribute("id","layerBackground"),a.appendChild(d),d.width=MJQ_ACTIVITY_WIDTH,d.height=MJQ_ACTIVITY_HEIGHT;var e=new MJQ_AnimationManager(b,!0,!0);mjq_castForeground=new MJQ_Cast(e),e.setCast(mjq_castForeground),mjq_castForeground.name="castForeground",e.name="animManagerForeground";var f=new MJQ_AnimationManager(c,!1,!1);mjq_castGameLayer=new MJQ_Cast(f),f.setCast(mjq_castGameLayer),mjq_castGameLayer.name="castGameLayer",f.name="animManagerGameLayer";var g=new MJQ_AnimationManager(d,!1,!1);mjq_castBackground=new MJQ_Cast(g),g.setCast(mjq_castBackground),mjq_castBackground.name="castBackground",g.name="animManagerBackground",e.setAdditionalAnimManager(f),e.setAdditionalAnimManager(g),mjq_gameScript=new MJQ_GameScript(mjq_castBackground,mjq_castGameLayer,mjq_castForeground),mjq_game.setScript(mjq_gameScript),f.setScript(mjq_gameScript),mjq_gameScript.changeState(0),mjq_onResizeCalled(),window.addEventListener("orientationchange",mjq_onOrientationChangeCalled,!1),window.addEventListener("resize",mjq_onResizeCalled,!1),document.addEventListener("visibilitychange",mjq_onResizeCalled,!1),document.addEventListener("webkitvisibilitychange",mjq_onResizeCalled,!1),window.onbeforeunload=mjq_gameLogout,mjq_gameLogin()}}function mjq_GetGameContainer(){return document.getElementById("gameContainer")}function mjq_GetBackgroundCanvas(){return document.getElementById("layerBackground")}function mjq_GetGameCanvas(){return document.getElementById("layerGameLayer")}function mjq_GetForgroundCanvas(){return document.getElementById("layerForeground")}function mjq_GetBackgroundArea1(){return document.getElementById("gamebackgroundarea1")}function mjq_GetBackgroundArea2(){return document.getElementById("gamebackgroundarea2")}function mjq_fadeInBackground(a,b){if(0===mjq_fadeInStartTime){mjq_fadeInStartTime=Date.now();var c=function(){var d=Date.now(),e=d-mjq_fadeInStartTime,f=e/b;f>=1&&(f=1),a.style.opacity=f,a.style.display="block",1>f?window.mjq_requestAnimFrame(c):mjq_fadeInStartTime=0};mjq_fadeRequestAnimationFrameID=window.mjq_requestAnimFrame(c)}}function mjq_fadeOutBackground(a,b){if(0===mjq_fadeOutStartTime){mjq_fadeOutStartTime=Date.now();var c=function(){var d=Date.now(),e=d-mjq_fadeOutStartTime,f=1-e/b;0>=f&&(f=0),a.style.opacity=f,f>0?window.mjq_requestAnimFrame(c):(mjq_fadeOutStartTime=0,a.style.display="none")};window.mjq_requestAnimFrame(c)}}function mjq_onOrientationChangeCalled(){mjq_onResizeCalled()}function mjq_onResizeCalled(){var a=mjq_GetGameContainer(),b=mjq_GetBackgroundCanvas(),c=mjq_GetGameCanvas(),d=mjq_GetForgroundCanvas(),e=MJQ_ACTIVITY_WIDTH/MJQ_ACTIVITY_HEIGHT;mjq_scaledWidth=window.innerWidth,mjq_scaledHeight=window.innerHeight;var f=mjq_scaledWidth/mjq_scaledHeight;f>e?mjq_scaledWidth=Math.floor(mjq_scaledHeight*e):mjq_scaledHeight=Math.floor(mjq_scaledWidth/e),a.style.width=mjq_scaledWidth+"px",a.style.height=mjq_scaledHeight+"px",d.style.width=mjq_scaledWidth+"px",d.style.height=mjq_scaledHeight+"px",c.style.width=mjq_scaledWidth+"px",c.style.height=mjq_scaledHeight+"px",b.style.width=mjq_scaledWidth+"px",b.style.height=mjq_scaledHeight+"px";var g=window.innerHeight-a.offsetHeight,h=0;g>=1&&(h=Math.floor(Math.abs(g)/2)),a.style.marginTop=h+"px"}function mjq_setBackground(a,b){void 0===b&&(b=1);var c=null;null!==a&&(c=new Image,c.src=a.src);var d=mjq_GetBackgroundArea1(),e=mjq_GetBackgroundArea2();"none"===d.style.display?(d.style.backgroundImage=null!==c?"url("+c.src+")":null,d.style.display="none",mjq_fadeInBackground(d,b),mjq_fadeOutBackground(e,b)):(e.style.backgroundImage=null!==c?"url("+c.src+")":null,e.style.display="none",mjq_fadeInBackground(e,b),mjq_fadeOutBackground(d,b))}function mjq_gameLogin(){}function mjq_gameLogout(){}function MJQ_Resources(a,b,c){this.finished=!1,this.numImageResourcesLoaded=0,this.numImageResourcesToCreate=0,this.resourcesList=[],this.imageHolderData=[],this.spriteSheetNames=[],this.path=c,this.artAssets=[],this.assetsManifestLoaded=!1,this.assetsManifestConfig=new MJQ_Config,this.assetsManifestConfig.init(b,this)}function MJQ_MahjongGame(a,b,c,d){this.mjq_callSuper(MJQ_Config),this.name="MJQ_MahjongGame",this.preventInput=!1,this.numAnchoredWallTiles=0,this.numAnchoredYinTangTiles=0,this.numAnchoredTimeTiles=0,this.numAnchoredMultiplierTiles=0,this.numAnchoredFirecrackerTiles=0,this.numAnchoredWildTiles=0,this.endWhenTimesUp=!0,this.forceAutoPlay=!1,this.allowUnlimitedHints=!1,this.NO_KEY=-999,this.NUM_HINTS=10,this.POINTS_PER_TILE=10,this.rulesTextshub=[],this.rulesImageshub=[],this.rulesTextsnorth=[],this.rulesImagesnorth=[],this.rulesTextssouth=[],this.rulesImagessouth=[],this.rulesTextseast=[],this.rulesImageseast=[],this.rulesTextswest=[],this.rulesImageswest=[],this.mouseOverObj=null,this.scoreAmount=null,this.score=0,this.coins=0,this.coins3=15e4,this.coins2=1e5,this.pointsFromMultiplier=0,this.pointsFromTimer=0,this.pointsFromBonusTimer=0,this.autoPlay=!1,this.prevHint=-1,this.prevHint2=-1,this.countDown=!0,this.currentLayout=1,this.layoutLoaded=!1,this.timerBonusValue=0,this.scoreFont="18pt SansSerif",this.hintFont="italic 16pt SansSerif",this.layout=new Array(MJQ_LAYOUT_LAYERS);for(var e=1;MJQ_LAYOUT_LAYERS>e;e++){this.layout[e]=new Array(MJQ_LAYOUT_COLUMNS);for(var f=0;MJQ_LAYOUT_COLUMNS>f;f++){this.layout[e][f]=new Array(MJQ_LAYOUT_ROWS);for(var g=0;MJQ_LAYOUT_ROWS>g;g++)this.layout[e][f][g]=null}}this.deck=null,this.selectedTile=null,this.firecrackerTile=null,this.wallTile=null,this.wildTileAnimation=null,this.wildTile=null,this.yinyangTileAnimation=null,this.yinyangTile=null,this.firecrackerLitObj=null,this.firecrackerSoundID=0,this.firecrackerExplodeObj=null,this.timerBonusPointsList=[],this.previousMatchedTile=null,this.timesUp=!1,this.numOpenTiles=999,this.preMatchedTiles=[],this.restarting=!1,this.gameInProgress=!1,this.okToCreateObjects=!1,this.backgroundImageName,this.seconds=0,this.finalScoreChecked,this.finalBonusPoints=-1,this.prevScore,this.tilesNotWon=0,this.numPlayableTiles=0,this.layoutConfig=null,this.levelsConfig=null,this.hintsLeft=this.NUM_HINTS,this.multiplier=1,this.tile1X=0,this.tile1Y=0,this.tile2X=0,this.tile2Y=0,this.undoFlag=!1,this.total=0,this.gameNumStr=d,this.layoutName=" ",this.loadingComplete=!1,this.previewLayout=null,this.init(a,b,c)}function mjq_sortNumber(a,b){return a.pri-b.pri}function MJQ_ScoreSummaryDialog(a,b,c,d,e,f,g){this.mjq_callSuper(MJQ_CastMemberDialog,b,c,d),this.name="MJQ_ScoreSummaryDialog",this.type="MJQ_CastMemberDialog",this.script=null,this.game=a.game,this.mapDirection=e,this.usedTimer="east"===e||"west"===e,this.levelNum=f,this.newBest=g,this.coinObj1=null,this.coinObj2=null,this.coinObj3=null,this.dialogFontSize=mjq_scaledValue(42),this.dialogFontSizePlus=mjq_scaledValue(72),this.dialogFontSizePlus2=mjq_scaledValue(56),this.setup()}function ScoreSummaryDialogScript(a,b,c){this.coinObj1=a,this.coinObj2=b,this.coinObj3=c,this.coinObj=a,this.moveTime=20,this.percentAdd=.05,this.percentDone=0,this.mjq_callSuper(MJQ_Script),this.type="ScoreSummaryDialogScript"}function MJQ_GameScript(a,b,c){this.mjq_callSuper(MJQ_Script),this.type="MJQ_GameScript",this.mustReset=!1,this.mustResetLoggingIn=!1,this.pausedByVisibility=!1,this.crossFadeTime=600,this.mapDirection="hub",this.directionButton=null,this.backToHubButton=null,this.locationHeader=null,this.locationCoinsIcon=null,this.locationCoinsValue=null,this.locationCoinsSlashValue=null,this.returningFromDirectionButton=null,this.directionGameObject="",this.levelNum=1,this.locationScript=null,this.useSameSeed=!1,this.setSoundOption(),this.setMusicOption(),this.setDimTilesOption(),this.allowAutoPlay=!0,this.RULES_BUTTON_ID=18,this.UNDO_BUTTON_ID=19,this.GETHINT_BUTTON_ID=20,this.TAPTOSTART_BUTTON_ID=21,this.NORTH_BUTTON_ID=22,this.SOUTH_BUTTON_ID=23,this.EAST_BUTTON_ID=24,this.WEST_BUTTON_ID=25,this.OPTIONS_BUTTON_ID=26,this.EXIT_BUTTON_ID=27,this.RETURNTOHUB_BUTTON_ID=28,this.LEVEL_MARKERS_NORTH_BUTTON_ID=100,this.LEVEL_MARKERS_SOUTH_BUTTON_ID=200,this.LEVEL_MARKERS_EAST_BUTTON_ID=300,this.LEVEL_MARKERS_WEST_BUTTON_ID=400,this.RULES_MESSAGE_BOX_ID=30,this.SOUND_MESSAGE_BOX_ID=31,this.SCORE_SUMMARY_DIALOG_ID=32,this.CHOOSE_LAYOUT_DIALOG_ID=33,this.EXIT_DIALOG_ID=4,this.LEVEL_PREVIEW_DIALOG_ID=5,this.OPTIONS_DIALOG_ID=6,this.RULES_DIALOG_ID=7,this.LOG_IN_OUT_DIALOG_ID=8,this.HUD_ELEMENTS_FADETIME=500,this.responseText="",this.specialMessage="",this.currentBackgroundImage=null,this.backgroundMainHubImage=null,this.backgroundLocationImage=null,this.artAssetsFileNameLocation="",this.windsDots=[],this.windsDotsData=null,this.windsDotsOrigin={x:0,y:0},this.castBackground=a,this.castGameLayer=b,this.castForeground=c,this.castForeground.setInputCatcher(this),this.scoreSummaryDialog=null,this.levelPreviewDialog=null,this.optionsDialog=null,this.exitDialog=null,this.rulesDialog=null,this.mustShowRulesDialog=!1,this.gameReady=!1,this.cmButton=null,this.copyrightText=null,this.splashLogo=null,this.iWinLogo=null,this.titleLabel=null,this.tapToStart=null,this.undoButton=null,this.undoUsed=!1,this.optionsButton=null,this.optionsButtonGame=null,this.exitButton=null,this.hudBackground=null,this.statusTimer=null,this.statusTimerGoing=!1,this.game=null,this.resources=null,this.resourcesLocations=null,this.dealing=!1,this.gameRecorded=!1,this.timer=null,this.timerBar=null,this.timerBarOverlay=null,this.timerUntimed=null,this.multiplierBar=null,this.multiplierBarOverlay=null,this.scoreLabel=null,this.replay=!1,this.numMoves=0,this.counter=1,this.preventUndo=!1,this.autoPlayMode=0,this.autoPlayCount=0,this.wonGameSet=!1,this.yinyangAutoPlaySpeed=180,this.endGameTime=0,this.endGameScore=0,this.tilesFlewAway=!1,this.getHintsLeft=null,this.loadingText=null,this.northButton=null,this.southButton=null,this.eastButton=null,this.westButton=null,this.totalScoreLable=null,this.totalScoreValue=null,this.totalCoinsLable=null,this.totalCoinsIcon=null,this.totalCoinsValue=null,this.totalCoinsSlashValue=null,this.NUMLEVELS=12,this.lanterns=[],this.lanternNums=[],this.lanternHangers=[],this.lightBulbs=[],this.lanternObject=null,this.buttonPos=null,this.headerPos=null,this.numCoinsToAward=0,this.numScoreToAward=0,this.newTotalScore=0,this.nextLevelNum=0,this.mustCheckForUnlock=!1,this.coinsWereEarned=!1,this.mainMenuMusic=null,this.levelSelectMusic=null,this.gamePlayMusic=null,this.gameWinMusic=null,this.gameLoseMusic=null,this.lastUsedEndGameMusic=null,this.musicObjects=[],this.musicObjects[0]=this.mainMenuMusic,this.musicObjects[1]=this.levelSelectMusic,this.musicObjects[2]=this.gamePlayMusic,this.musicObjects[3]=this.gameWinMusic,this.musicObjects[4]=this.gameLoseMusic,this.audioSpriteLoaded=!1,this.mainMenuMusicLoaded=!1,this.levelPreviewCancelClicked=!1,this.allowSignedInDirective=!1}function MJQ_LanternScript(a){this.mjq_callSuper(MJQ_Script),this.type="MJQ_LanternScript",this.lanternObj=a
}function MJQ_Lantern(a,b,c){this.mjq_callSuper(MJQ_CastMemberButton,b,c),this.type="MJQ_CastMemberButton",this.name="MJQ_Lantern",this.obj=b,this.levelNumMem=null}function MJQ_LightBulbScript(a){this.mjq_callSuper(MJQ_Script),this.type="MJQ_LightBulbScript",this.lightBulbObj=a}function MJQ_LevelPreviewDialog(a,b,c,d,e,f){this.mjq_callSuper(MJQ_CastMemberDialog,b,c,d),this.name="MJQ_LevelPreviewDialog",this.type="MJQ_CastMemberDialog",this.script=a,this.game=a.game,this.mapDirection=e,this.levelNum=f,this.dialogFontSize=mjq_scaledValue(50),this.dialogFontSizePlus=mjq_scaledValue(60),this.setup()}function MJQ_OptionsDialog(a,b,c,d){this.mjq_callSuper(MJQ_CastMemberDialog,b,c,d),this.name="MJQ_OptionsDialog",this.type="MJQ_CastMemberDialog",this.script=a,this.game=a.game,this.dialogFontSize=mjq_scaledValue(60),this.setup()}function MJQ_ExitDialog(a,b,c,d){this.mjq_callSuper(MJQ_CastMemberDialog,b,c,d),this.name="MJQ_ExitDialog",this.type="MJQ_CastMemberDialog",this.script=a,this.game=a.game,this.dialogFontSize=mjq_scaledValue(48),this.setup()}function MJQ_LogInOutDialog(a,b,c,d,e){this.mjq_callSuper(MJQ_CastMemberDialog,b,c,d),this.name="MJQ_LogInOutDialog",this.type="MJQ_CastMemberDialog",this.script=a,this.game=a.game,this.dialogFontSize=mjq_scaledValue(48),this.dialogFontSizePlus=mjq_scaledValue(72),this.loggingIn=e,this.setup()}function MJQ_RulesDialog(a,b,c,d,e){this.mjq_callSuper(MJQ_CastMemberDialog,b,c,d),this.name="MJQ_RulesDialog",this.type="MJQ_CastMemberDialog",this.script=a,this.game=a.game,this.mapDirection=e,this.dialogFontSize=mjq_scaledValue(48),this.page=0,this.numPages=mjq_game["rulesTexts"+this.mapDirection].length,this.textItems=[],this.imgItems=[],this.setup()}var mjq_usingiPhone=null!==(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)),mjq_scaledPixelRatio=1;Object.prototype.mjq_receiverContains=function(){return!1},Object.prototype.mjq_receiverAccepts=function(){return!1},Object.prototype.mjq_receiverMoveEnded=function(){},Object.prototype.mjq_inputCatcherMouseDown=function(){},Object.prototype.mjq_mouseMoved=function(){},Object.prototype.mjq_buttonClicked=function(){},Object.prototype.mjq_dialogButtonClicked=function(){},Object.prototype.mjq_dialogItemSet=function(){},Object.prototype.mjq_dialogDetached=function(){},Object.prototype.mjq_cue=function(){},Object.prototype.mjq_callSuper=function(a){arguments.length>1?a.apply(this,Array.prototype.slice.call(arguments,1)):a.call(this)},Function.prototype.mjq_isSubclassOf=function(a){this.prototype=new a,this.prototype.constructor=this},Date.now||(Date.now=function(){return(new Date).getTime()}),window.Object.defineProperty(Element.prototype,"elementOffsetTop",{get:function(){var a=this.offsetParent;return this.offsetTop+(a?a.elementOffsetTop:0)}}),window.Object.defineProperty(Element.prototype,"elementOffsetLeft",{get:function(){var a=this.offsetParent;return this.offsetLeft+(a?a.elementOffsetLeft:0)}}),mjq_debugOut=function(a){window.console&&window.console.log(a)};var mjq_visProp=mjq_getVisibilityHiddenProp();if(null!==mjq_visProp){var evtName=mjq_visProp.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(evtName,mjq_visibilityChanged)}var MersenneTwister=function(a){void 0===a&&(a=(new Date).getTime()),this.seed=a,this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(a)};MersenneTwister.prototype.init_genrand=function(a){for(this.mt[0]=a>>>0,this.mti=1;this.mti<this.N;this.mti++){var a=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&a)>>>16)<<16)+1812433253*(65535&a)+this.mti,this.mt[this.mti]>>>=0}},MersenneTwister.prototype.getSeed=function(){return this.seed},MersenneTwister.prototype.init_by_array=function(a,b){var c,d,e;for(this.init_genrand(19650218),c=1,d=0,e=this.N>b?this.N:b;e;e--){var f=this.mt[c-1]^this.mt[c-1]>>>30;this.mt[c]=(this.mt[c]^(1664525*((4294901760&f)>>>16)<<16)+1664525*(65535&f))+a[d]+d,this.mt[c]>>>=0,c++,d++,c>=this.N&&(this.mt[0]=this.mt[this.N-1],c=1),d>=b&&(d=0)}for(e=this.N-1;e;e--){var f=this.mt[c-1]^this.mt[c-1]>>>30;this.mt[c]=(this.mt[c]^(1566083941*((4294901760&f)>>>16)<<16)+1566083941*(65535&f))-c,this.mt[c]>>>=0,c++,c>=this.N&&(this.mt[0]=this.mt[this.N-1],c=1)}this.mt[0]=2147483648},MersenneTwister.prototype.genrand_int32=function(){var a,b=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var c;for(this.mti===this.N+1&&this.init_genrand(5489),c=0;c<this.N-this.M;c++)a=this.mt[c]&this.UPPER_MASK|this.mt[c+1]&this.LOWER_MASK,this.mt[c]=this.mt[c+this.M]^a>>>1^b[1&a];for(;c<this.N-1;c++)a=this.mt[c]&this.UPPER_MASK|this.mt[c+1]&this.LOWER_MASK,this.mt[c]=this.mt[c+(this.M-this.N)]^a>>>1^b[1&a];a=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^a>>>1^b[1&a],this.mti=0}return a=this.mt[this.mti++],a^=a>>>11,a^=a<<7&2636928640,a^=a<<15&4022730752,a^=a>>>18,a>>>0},MersenneTwister.prototype.genrand_int31=function(){return this.genrand_int32()>>>1},MersenneTwister.prototype.genrand_real1=function(){return this.genrand_int32()*(1/4294967295)},MersenneTwister.prototype.random=function(){return this.genrand_int32()*(1/4294967296)},MersenneTwister.prototype.genrand_real3=function(){return(this.genrand_int32()+.5)*(1/4294967296)},MersenneTwister.prototype.genrand_res53=function(){var a=this.genrand_int32()>>>5,b=this.genrand_int32()>>>6;return(67108864*a+b)*(1/9007199254740992)},TweenDelegate.create=function(a,b){for(var c=new Array,d=arguments.length,e=2;d>e;e++)c[e-2]=arguments[e];return function(){var d=[].concat(arguments,c);b.apply(a,d)}},Tween=function(a,b,c,d,e,f,g,h){this.init(a,b,c,d,e,f,g,h)};var t=Tween.prototype;t.obj=new Object,t.prop="",t.func=function(a,b,c,d){return c*a/d+b},t.begin=0,t.change=0,t.prevTime=0,t.prevPos=0,t.looping=!1,t.roundResult=!0,t._duration=0,t._time=0,t._pos=0,t._position=0,t._startTime=0,t._finish=0,t.name="",t.suffixe="",t._listeners=new Array,t.setTime=function(a){this.prevTime=this._time,a>this.getDuration()?this.looping?(this.rewind(a-this._duration),this.update(),this.broadcastMessage("onMotionLooped",{target:this,type:"onMotionLooped"})):(this._time=this._duration,this.update(),this.stop(),this.broadcastMessage("onMotionFinished",{target:this,type:"onMotionFinished"})):0>a?(this.rewind(),this.update()):(this._time=a,this.update())},t.getTime=function(){return this._time},t.setDuration=function(a){this._duration=null===a||0>=a?1e5:a},t.getDuration=function(){return this._duration},t.setPosition=function(a){this.prevPos=this._pos,this.obj[this.prop]=this.roundResult?""!==this.suffixe?Math.round(a)+this.suffixe:Math.round(a):""!==this.suffixe?a+this.suffixe:a,this._pos=a,this.broadcastMessage("onMotionChanged",{target:this,type:"onMotionChanged"})},t.getPosition=function(a){return void 0===a&&(a=this._time),this.func(a,this.begin,this.change,this._duration)},t.setFinish=function(a){this.change=a-this.begin},t.getFinish=function(){return this.begin+this.change},t.init=function(a,b,c,d,e,f,g,h){arguments.length&&(this._listeners=new Array,this.addListener(this),g&&(this.suffixe=g),this.roundResult=void 0===h?!0:h,this.obj=a,this.prop=b,this.begin=d,this._pos=d,this.setDuration(f),null!=c&&""!=c&&(this.func=c),this.setFinish(e))},t.start=function(){this.rewind(),this.startEnterFrame(),this.broadcastMessage("onMotionStarted",{target:this,type:"onMotionStarted"})},t.rewind=function(a){this.stop(),this._time=void 0===a?0:a,this.fixTime(),this.update()},t.fforward=function(){this._time=this._duration,this.fixTime(),this.update()},t.update=function(){this.setPosition(this.getPosition(this._time))},t.startEnterFrame=function(){this.stopEnterFrame(),this.isPlaying=!0,this.onEnterFrame()},t.onEnterFrame=function(){this.isPlaying&&(this.nextFrame(),setTimeout(TweenDelegate.create(this,this.onEnterFrame),0))},t.nextFrame=function(){this.setTime((this.getTimer()-this._startTime)/1e3)},t.stop=function(){this.stopEnterFrame(),this.broadcastMessage("onMotionStopped",{target:this,type:"onMotionStopped"})},t.stopEnterFrame=function(){this.isPlaying=!1},t.continueTo=function(a,b){this.begin=this._pos,this.setFinish(a),void 0!==this._duration&&this.setDuration(b),this.start()},t.resume=function(){this.fixTime(),this.startEnterFrame(),this.broadcastMessage("onMotionResumed",{target:this,type:"onMotionResumed"})},t.yoyo=function(){this.continueTo(this.begin,this._time)},t.addListener=function(a){return this.removeListener(a),this._listeners.push(a)},t.removeListener=function(a){for(var b=this._listeners,c=b.length;c--;)if(b[c]===a)return b.splice(c,1),!0;return!1},t.broadcastMessage=function(){for(var a=new Array,b=0;b<arguments.length;b++)a.push(arguments[b]);for(var c=a.shift(),d=this._listeners,e=d.length,b=0;e>b;b++)d[b][c]&&d[b][c].apply(d[b],a)},t.fixTime=function(){this._startTime=this.getTimer()-1e3*this._time},t.getTimer=function(){return(new Date).getTime()-this._time},Tween.backEaseIn=function(a,b,c,d){if(void 0===e)var e=1.70158;return c*(a/=d)*a*((e+1)*a-e)+b},Tween.backEaseOut=function(a,b,c,d){if(void 0===e)var e=1.70158;return c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},Tween.backEaseInOut=function(a,b,c,d){if(void 0===e)var e=1.70158;return(a/=d/2)<1?c/2*a*a*(((e*=1.525)+1)*a-e)+b:c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b},Tween.elasticEaseIn=function(a,b,c,d,e,f){if(0==a)return b;if(1==(a/=d))return b+c;if(f||(f=.3*d),!e||e<Math.abs(c)){e=c;var g=f/4}else var g=f/(2*Math.PI)*Math.asin(c/e);return-(e*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f))+b},Tween.elasticEaseOut=function(a,b,c,d,e,f){if(0==a)return b;if(1==(a/=d))return b+c;if(f||(f=.3*d),!e||e<Math.abs(c)){e=c;var g=f/4}else var g=f/(2*Math.PI)*Math.asin(c/e);return e*Math.pow(2,-10*a)*Math.sin(2*(a*d-g)*Math.PI/f)+c+b},Tween.elasticEaseInOut=function(a,b,c,d,e,f){if(0==a)return b;if(2==(a/=d/2))return b+c;if(!f)var f=.3*d*1.5;if(!e||e<Math.abs(c))var e=c,g=f/4;else var g=f/(2*Math.PI)*Math.asin(c/e);return 1>a?-.5*e*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f)+b:e*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f)*.5+c+b},Tween.bounceEaseOut=function(a,b,c,d){return(a/=d)<1/2.75?7.5625*c*a*a+b:2/2.75>a?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:2.5/2.75>a?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b},Tween.bounceEaseIn=function(a,b,c,d){return c-Tween.bounceEaseOut(d-a,0,c,d)+b},Tween.bounceEaseInOut=function(a,b,c,d){return d/2>a?.5*Tween.bounceEaseIn(2*a,0,c,d)+b:.5*Tween.bounceEaseOut(2*a-d,0,c,d)+.5*c+b},Tween.strongEaseInOut=function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},Tween.regularEaseIn=function(a,b,c,d){return c*(a/=d)*a+b},Tween.regularEaseOut=function(a,b,c,d){return-c*(a/=d)*(a-2)+b},Tween.regularEaseInOut=function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},Tween.strongEaseIn=function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},Tween.strongEaseOut=function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},Tween.strongEaseInOut=function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a*a+b:c/2*((a-=2)*a*a*a*a+2)+b};var mjq_elementOffsetLeft=0,mjq_elementOffsetTop=0,mjq_scaledWidth=0,mjq_scaledHeight=0,mjq_scaledPixel=1,mjq_animateCount=0,mjq_showFPS=!1,mjq_touchable="ontouchstart"in window||window.navigator.msPointerEnabled,mjq_ipadtouchable="createTouch"in document,mjq_useragent=navigator.userAgent.toLowerCase(),mjq_usingAndroid=mjq_useragent.indexOf("android")>-1,mjq_isMobile=mjq_useragent.indexOf("mobi")>-1,mjq_devicePixelRatio=window.devicePixelRatio;void 0===mjq_devicePixelRatio&&(mjq_devicePixelRatio=1);var mjq_isHiRes=mjq_devicePixelRatio>1;mjq_isMobile||(mjq_isHiRes=!0);var mjq_backgroundWidths=[568,1136,1366,1920,2726],mjq_resolutionWidths=[426,854,1024,1440,2048],mjq_resolutionHeights=[320,640,768,1080,1536],mjq_resolutionSet=0,mjq_resolutionJSONName="",mjq_resolutionIndex=0,mjq_artAssetsName="",mjq_artAssetsNameLocations="",mjq_artAssetsNameNorth="",mjq_artAssetsNameSouth="",mjq_artAssetsNameEast="",mjq_artAssetsNameWest="",mjq_objectsName="";mjq_calcResolutionSet();var mjq_inputCatcherHandled=!1,mjq_preventDoubleTouchZoom=!0;mjq_isMobile&&window.addEventListener("load",function(){setTimeout(function(){window.scrollTo(0,1)},1)},!1),window.mjq_requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,16.667)}}(),MJQ_AnimationManager.prototype.setAdditionalAnimManager=function(a){this.anims.push(a)},MJQ_AnimationManager.prototype.doit=function(){this.lastTime=this.time,this.time=(new Date).getTime(),this.canvasOffsetLeft=mjq_elementOffsetLeft,this.canvasOffsetTop=mjq_elementOffsetTop,this.primary&&(mjq_inputCatcherHandled=!1,mjq_showFPS&&this.calcFPS());var a=this.cast;(this.repaintAllSetting||this.numCycles<this.forceRepaintCycles)&&this.repaintAll(!0),null!==this.script&&this.script.doScript(this.time),this.handleHovering(),this.processMouseEvents(),null!==a&&a.animate(this.time),this.processDirtyRects(),this.paintDirtyRects(),null!==a&&(a.clearDirtyRects(),this.dirtyRects.length=0),this.numCycles++},MJQ_AnimationManager.prototype.calcFPS=function(){this.timeArray.push(this.time-this.lastTime),this.timeArray.length>100&&this.timeArray.shift();for(var a=0,b=this.timeArray.length,c=0;b>c;c++)a+=this.timeArray[c];a/this.timeArray.length,1e3/(this.time-this.lastTime);this.timeCounter++,60===this.timeCounter&&(this.timeCounter=0)},MJQ_AnimationManager.prototype.repaintAll=function(){if(!this.repaintAllFlag){this.clearDirtyRects();var a={x:0,y:0,width:this.width,height:this.height};this.addDirtyRect(a),this.repaintAllFlag=!0}},MJQ_AnimationManager.prototype.addDirtyRect=function(a){!this.repaintAllFlag&&null!==a&&a.width>0&&a.height>0&&this.dirtyRects.push(a)},MJQ_AnimationManager.prototype.clearDirtyRects=function(){this.dirtyRects.length=0},MJQ_AnimationManager.prototype.getDirtyRects=function(){return this.dirtyRects},MJQ_AnimationManager.prototype.setScript=function(a){this.script=a},MJQ_AnimationManager.prototype.getScript=function(){return this.script},MJQ_AnimationManager.prototype.setCast=function(a){this.cast=a},MJQ_AnimationManager.prototype.getCast=function(){return this.cast},MJQ_AnimationManager.prototype.handleHovering=function(){var a=this.time;0===this.lastMouseTime&&(this.lastMouseTime=a);var b=a-this.lastMouseTime;null!==this.cast&&(this.hovering?this.hovering=this.cast.testMouseHoverObj(this.lastMouseX,this.lastMouseY):null!==this.cast.draggedObj||null!==this.cast.trackedObj?this.lastMouseTime=a:b>=this.HOVER_DELAY&&(this.hovering=this.cast.mouseHover(this.lastMouseX,this.lastMouseY)))},MJQ_AnimationManager.prototype.processDirtyRects=function(){if(null!==this.cast&&!this.repaintAllFlag){this.dirtyRects.length=0;for(var a,b=this.cast.dirtyRects,c=b.length,d=0;c>d;d++)a=b[d],a.width>0&&a.height>0&&this.addDirtyRect(a);for(var e,f=this.cast.members.length,d=0;f>d;d++)if(e=this.cast.members[d],e.dirty){var g=e.getDirtyRect();g.width>0&&g.height>0&&this.addDirtyRect(g)}for(var h=!0,i=0;h;){var j=this.dirtyRects.length;if(i+1>=j)return;h=!1;for(var d=i;j-1>d;d++){i=d;for(var k=d+1;j>k;k++)if(this.cast.intersects(this.dirtyRects[d],this.dirtyRects[k])){this.rectUnion(this.dirtyRects[d],this.dirtyRects[k]),this.dirtyRects.splice(k,1),h=!0;break}if(h)break}}}},MJQ_AnimationManager.prototype.paintDirtyRects=function(){if(null!==this.cast)for(var a=null,b=this.dirtyRects.length,c=0;b>c;c++)a=this.dirtyRects[c],this.context.clearRect(a.x,a.y,a.width,a.height),this.cast.paint(this.context,this.repaintAllFlag,a);this.repaintAllFlag=!1},MJQ_AnimationManager.prototype.initListeners=function(){var a=this;mjq_touchable?window.navigator.msPointerEnabled?(this.canvas.addEventListener("MSPointerDown",function(b){a.onMouseDown(b)},!1),window.addEventListener("MSPointerMove",function(b){a.onMouseMove(b)},!1),window.addEventListener("MSPointerUp",function(b){a.onMouseUp(b)},!1),"undefined"!=typeof this.canvas.style.msContentZooming&&(this.canvas.style.msContentZooming="none"),"undefined"!=typeof this.canvas.style.msTouchAction&&(this.canvas.style.msTouchAction="none")):(this.canvas.addEventListener("touchstart",function(b){a.onTouchStart(b)},!1),window.addEventListener("touchmove",function(b){a.onTouchMove(b)},!1),window.addEventListener("touchend",function(b){a.onTouchEnd(b)},!1)):(this.canvas.addEventListener("mousedown",function(b){a.onMouseDown(b)},!1),window.addEventListener("mousemove",function(b){a.onMouseMove(b)},!1),window.addEventListener("mouseup",function(b){a.onMouseUp(b)},!1))},MJQ_AnimationManager.prototype.onTouchStart=function(a){this.touches=a.touches;var b=0,c=0;mjq_usingAndroid?(b=a.touches[0].pageX,c=a.touches[0].pageY):(b=a.pageX,c=a.pageY);var d=this.anims,e=d.length,f=null;if(mjq_preventDoubleTouchZoom&&this.touches.length<2&&null!==this.cast){var g=b-this.canvasOffsetLeft,h=c-this.canvasOffsetTop,i=!1;if(this.cast.contains(g,h))a.preventDefault(),i=!0;else for(var j=0;e>j;j++)if(d[j].cast.contains(g,h)){i=!0;break}i&&a.preventDefault()}if(this.touches.length<=3){if(!this.mousePressed&&-1===this.touchID&&(this.touchID=this.touches[0].identifier,this.mousePressed=!0,this.addMouseEvent(this.MOUSEDOWN,b,c),this.primary))for(var k=0;e>k;k++)f=d[k],f.inputHandler||f.addMouseEvent(this.MOUSEDOWN,b,c)}else this.mousePressed=!1,this.addMouseEvent(this.MOUSEUP,0,0),this.touchID=-1},MJQ_AnimationManager.prototype.onTouchMove=function(a){this.touches=a.touches;var b=this.touches.length,c=0,d=0;mjq_usingAndroid?(c=a.touches[0].pageX,d=a.touches[0].pageY):(c=a.pageX,d=a.pageY);var e=this.anims,f=e.length,g=null;if(3>=b){for(var h=0;b>h;h++)if(this.touches[h].identifier===this.touchID){if(this.addMouseEvent(this.MOUSEMOVE,c,d),this.primary)for(var i=0;f>i;i++)g=e[i],g.inputHandler||g.addMouseEvent(this.MOUSEMOVE,c,d);break}}else this.mousePressed=!1,this.addMouseEvent(this.MOUSEUP,0,0),this.touchID=-1},MJQ_AnimationManager.prototype.onTouchEnd=function(a){this.touches=a.touches;var b=a.changedTouches,c=b.length,d=null,e=0,f=0,g=this.anims,h=g.length,i=null;if(this.mousePressed)for(var j=0;c>j;j++)if(d=b[j],d.identifier===this.touchID){if(this.mousePressed=!1,e=d.pageX,f=d.pageY,this.addMouseEvent(this.MOUSEUP,e,f),this.primary)for(var k=0;h>k;k++)i=g[k],i.inputHandler||i.addMouseEvent(this.MOUSEUP,e,f);this.touchID=-1;break}0===this.touches.length&&(this.mousePressed=!1,this.touchID=-1)},MJQ_AnimationManager.prototype.onMouseDown=function(a){if(this.addMouseEvent(this.MOUSEDOWN,a.pageX,a.pageY),this.primary)for(var b=this.anims,c=b.length,d=null,e=0;c>e;e++)d=b[e],d.inputHandler||d.addMouseEvent(this.MOUSEDOWN,a.pageX,a.pageY)},MJQ_AnimationManager.prototype.onMouseUp=function(a){if(this.addMouseEvent(this.MOUSEUP,a.pageX,a.pageY),this.primary)for(var b=this.anims,c=b.length,d=null,e=0;c>e;e++)d=b[e],d.inputHandler||d.addMouseEvent(this.MOUSEUP,a.pageX,a.pageY)},MJQ_AnimationManager.prototype.onMouseMove=function(a){if(this.addMouseEvent(this.MOUSEMOVE,a.pageX,a.pageY),this.primary)for(var b=this.anims,c=b.length,d=null,e=0;c>e;e++)d=b[e],d.inputHandler||d.addMouseEvent(this.MOUSEMOVE,a.pageX,a.pageY)},MJQ_AnimationManager.prototype.addMouseEvent=function(a,b,c){this.masterInput&&(b-=this.canvasOffsetLeft,c-=this.canvasOffsetTop,a===this.MOUSEDOWN?this.lastMouseDownEvent={mouseX:b,mouseY:c}:a===this.MOUSEUP?this.lastMouseUpEvent={mouseX:b,mouseY:c}:a===this.MOUSEMOVE&&(this.lastMouseMoveEvent={mouseX:b,mouseY:c}))},MJQ_AnimationManager.prototype.processMouseEvents=function(){var a=MJQ_ACTIVITY_WIDTH/mjq_scaledWidth,b=MJQ_ACTIVITY_HEIGHT/mjq_scaledHeight,c=this.lastMouseDownEvent;this.lastMouseDownEvent=null;var d=this.lastMouseMoveEvent;this.lastMouseMoveEvent=null;var e=this.lastMouseUpEvent;this.lastMouseUpEvent=null;var f=-1,g=-1;if(null!==c&&(f=Math.floor(a*c.mouseX),g=Math.floor(b*c.mouseY),this.mousePressed=!0,null!==this.cast&&this.cast.mouseDown(f,g)),null!==d&&null!==this.cast){if(f=Math.floor(a*d.mouseX),g=Math.floor(b*d.mouseY),this.mousePressed)this.cast.mouseDrag(f,g);else{var h=!1;null!==this.mouseMoveListener&&(h=this.mouseMoveListener.mjq_mouseMoved(f,g)),h||this.cast.mouseMove(f,g)}this.lastMouseX=f,this.lastMouseY=g,this.lastMouseTime=this.time}null!==e&&(this.mousePressed=!1,null!==this.cast&&(f=Math.floor(a*e.mouseX),g=Math.floor(b*e.mouseY),this.cast.mouseUp(f,g)))},MJQ_AnimationManager.prototype.setMasterInput=function(a){this.masterInput=a},MJQ_AnimationManager.prototype.getMasterInput=function(){return this.masterInput},MJQ_AnimationManager.prototype.setMouseMoveListener=function(a){this.mouseMoveListener=a},MJQ_AnimationManager.prototype.rectUnion=function(a,b){var c=a.x,d=a.y,e=b.x,f=b.y,g=a.width,h=a.height,i=b.width,j=b.height,k=c+g,l=d+h,m=e+i,n=f+j,o=e>c?c:e,p=k>m?k:m,q=f>d?d:f,r=l>n?l:n;a.x=o,a.y=q,a.width=p-o,a.height=r-q},MJQ_AnimationManager.prototype.getLastMouseX=function(){return this.lastMouseX},MJQ_AnimationManager.prototype.getLastMouseY=function(){return this.lastMouseY},MJQ_AnimationManager.prototype.lastMousePosOutside=function(){this.lastMouseX=-100,this.lastMouseY=-100},MJQ_Cast.prototype.addDirtyRect=function(a){if(null!==a&&a.width>0&&a.height>0){var b={x:a.x-1,y:a.y-1,width:a.width+2,height:a.height+2};this.dirtyRects.push(b)}},MJQ_Cast.prototype.clearDirtyRects=function(){this.dirtyRects.length=0;for(var a=this.members,b=a.length,c=b-1;c>=0;c--)a[c].clearDirtyRect()},MJQ_Cast.prototype.getDirtyRects=function(){return this.dirtyRects},MJQ_Cast.prototype.getAnimationManager=function(){return this.anim},MJQ_Cast.prototype.startCast=function(){this.prevMouseOverObj=null},MJQ_Cast.prototype.stopCast=function(){null!==this.mouseHoverObj&&this.mouseHoverObj.onMouseHoverEnded(),this.mouseHoverObj=null},MJQ_Cast.prototype.attachDialog=function(a,b){if(null!==a&&null!==this.dialog&&!b)return!1;var c=this.dialog;return this.dialog=null,null!==c&&c.detach(),this.dialog=a,null!==this.dialog?(this.modeless=b,!0):!1},MJQ_Cast.prototype.forceDialogsDispose=function(){for(var a=!1,b=this.members,c=b.length,d=0;c>d;d++)b[d].detach()&&(a=!0);return this.dialog=null,a},MJQ_Cast.prototype.getDialog=function(){return this.dialog},MJQ_Cast.prototype.setInputCatcher=function(a){this.inputCatcher=a},MJQ_Cast.prototype.intersects=function(a,b){var c=a.x,d=a.y,e=b.x,f=b.y;return!(e>c+a.width||e+b.width<c||f>d+a.height||f+b.height<d)},MJQ_Cast.prototype.intersection=function(a,b){var c=this.intersects(a,b),d=a.x,e=a.y,f=b.x,g=b.y,h=[d,f,d+a.width,f+b.width],i=[e,g,e+a.height,g+b.height];h.sort(function(a,b){return a-b}),i.sort(function(a,b){return a-b});var j={x:h[1],y:i[1],width:c?h[2]-h[1]:0,height:c?i[2]-i[1]:0};return j},MJQ_Cast.prototype.animate=function(a){for(var b=this.members.slice(),c=b.length-1;c>=0;c--)b[c].animate(a)},MJQ_Cast.prototype.paint=function(a,b,c){for(var d=this.members,e=null,f=d.length-1;f>=0;f--)e=d[f],e.visible&&(e.dirty||b||this.intersects(e.getRect(),c))&&e.paint(a,c)},MJQ_Cast.prototype.add=function(a){if(-1===this.members.indexOf(a)){var b=this.members.length,c=a.priority,d=0,e=b,f=0,g=0,h=!1;if(1===b)g=this.members[0].priority,c>g&&(f=1);else if(b>1)for(;e>d;)if(f=Math.floor((e+d)/2),g=this.members[f].priority,g>c)e=f-1,0>e&&(e=0),f=e,h=!0;else{if(!(c>g))break;d=f+1,f=d}b>=1&&h&&this.members[f].priority<c&&f++;for(var i=b-1;i>=f&&this.members[f].priority===c;i--)f++;this.members.splice(f,0,a),a.repaint()}},MJQ_Cast.prototype.remove=function(a,b){var c=this.members.indexOf(a);c>=0&&this.members.splice(c,1),(void 0===b||b===!1)&&this.addDirtyRect(a.getRect()),this.anim.primary&&this.anim.repaintAll()},MJQ_Cast.prototype.removeAll=function(){for(var a=this.members.length-1;a>=0;a--)this.members[a].reinit(),this.addDirtyRect(this.members[a].getRect());this.members.length=0},MJQ_Cast.prototype.addReceiver=function(a){var b=this.receivers.indexOf(a);-1===b&&this.receivers.push(a)},MJQ_Cast.prototype.removeReceiver=function(a){var b=this.receivers.indexOf(a);b>=0&&this.receivers.splice(b,1)},MJQ_Cast.prototype.removeAllReceivers=function(){this.receivers.length=0},MJQ_Cast.prototype.setRestrictionOn=function(a){var b=this.restricted.indexOf(a);-1===b&&this.restricted.push(a)},MJQ_Cast.prototype.liftRestrictionOn=function(a){var b=this.restricted.indexOf(a);b>=0&&this.restricted.splice(b,1)},MJQ_Cast.prototype.removeAllRestricted=function(){this.restricted.length=0},MJQ_Cast.prototype.determineReceiverOnDrag=function(a){if(null!==this.draggedObj&&this.receivers.length>=1){for(var b,c=a.getX(),d=a.getY(),e=a.getWidth(),f=a.getHeight(),g=Math.floor(c+e/2),h=Math.floor(d+f/2),i=this.receivers.length,j=0;i>j;j++)if(b=this.receivers[j],-1===this.restricted.indexOf(b)&&b.mjq_receiverContains(g,h)&&b.mjq_receiverAccepts(a,!0))return b;for(var k=Math.floor(c+e/4),l=Math.floor(c+e/4*3),m=Math.floor(d+f/4),n=Math.floor(d+f/4*3),j=0;i>j;j++)if(b=this.receivers[j],-1===this.restricted.indexOf(b)&&(b.mjq_receiverContains(k,m)||b.mjq_receiverContains(k,n)||b.mjq_receiverContains(l,m)||b.mjq_receiverContains(l,n))&&b.mjq_receiverAccepts(a,!0))return b}return null},MJQ_Cast.prototype.determineReceiverOnClick=function(a){for(var b=null,c=this.receivers.length,d=0;c>d;d++)if(b=this.receivers[d],-1===this.restricted.indexOf(b)&&b.mjq_receiverAccepts(a,!1,!0))return b;for(var d=0;c>d;d++)if(b=this.receivers[d],-1===this.restricted.indexOf(b)&&("Foundation"===b.type||b.size()>0)&&b.mjq_receiverAccepts(a,!1))return b;for(var d=0;c>d;d++)if(b=this.receivers[d],-1===this.restricted.indexOf(b)&&"Foundation"!==b.type&&0===b.size()&&b.mjq_receiverAccepts(a,!1))return b;return null},MJQ_Cast.prototype.dragging=function(a){this.draggedObj=a},MJQ_Cast.prototype.cancelDragging=function(){null!==this.draggedObj&&(this.doPrevPriAfterMoveTo=!0,this.draggedObj.cancelDragging())},MJQ_Cast.prototype.getDragObj=function(){return this.draggedObj},MJQ_Cast.prototype.tracking=function(a){this.trackedObj=a},MJQ_Cast.prototype.cancelTracking=function(){null!==this.trackedObj&&this.trackedObj.cancelTracking()},MJQ_Cast.prototype.getTrackObj=function(){return this.trackedObj},MJQ_Cast.prototype.mouseDown=function(a,b){if(null===this.draggedObj&&null===this.trackedObj)if(this.mouseDownTime=this.anim.time,null===this.dialog||this.modeless){for(var c,d=this.members.length,e=0;d>e;e++)if(c=this.members[e],c.visible&&c.checkRect()&&c.contains(a,b)&&(c.allowInputWhileMoving()||!c.moving)&&c.allowInput()&&c.mouseDown(a,b))return}else{if(this.dialog.contains(a,b))return void this.dialog.mouseDown(a,b);this.dialog.mouseDownOutsideOfDialog()}},MJQ_Cast.prototype.mouseUp=function(a,b){var c=this.anim.time,d=c-this.mouseDownTime<=this.CLICK_TIME,e=!1;null!==this.draggedObj?e=this.draggedObj.mouseUp(a,b):null!==this.trackedObj?e=this.trackedObj.mouseUp(a,b):null!==this.dialog&&(e=this.dialog.contains(a,b),this.dialog.mouseUp(a,b)),e&&(mjq_inputCatcherHandled=!0),this.draggedObj=null,this.trackedObj=null,mjq_inputCatcherHandled||!d||e||null===this.inputCatcher||this.inputCatcher.mjq_inputCatcherMouseDown(a,b)},MJQ_Cast.prototype.mouseDrag=function(a,b){null!==this.draggedObj?this.draggedObj.mouseDrag(a,b):null!==this.trackedObj?this.trackedObj.mouseDrag(a,b):null!==this.dialog&&this.dialog.mouseDrag(a,b)},MJQ_Cast.prototype.mouseMove=function(a,b){if(null===this.dialog||this.modeless){for(var c=null,d=this.members.length,e=this.prevMouseOverObj,f=0;d>f;f++)if(c=this.members[f],c.visible&&c.checkRect()&&(c.allowInputWhileMoving()||!c.moving)&&c.contains(a,b)&&c.allowInput())return null!==e&&this.members.indexOf(e)>=0&&e!==c&&(e.mouseMove(a,b,!1),e=null),void(c.allowMouseMoves()&&c!==e&&c.mouseMove(a,b,!0)&&(this.prevMouseOverObj=c));null!==e&&this.members.indexOf(e)>=0&&e.mouseMove(a,b,!1)}else this.dialog.mouseMove(a,b,this.dialog.contains(a,b));this.prevMouseOverObj=null},MJQ_Cast.prototype.testMouseHoverObj=function(a,b){if(null!==this.mouseHoverObj){if(null!==this.draggedObj||null!==this.trackedObj)return this.mouseHoverObj.onMouseHoverEnded(),this.mouseHoverObj=null,!1;for(var c=this.members,d=c.length,e=0;d>e;e++)if(mem=c[e],mem.visible&&mem.contains(a,b))return mem===this.mouseHoverObj}return!1},MJQ_Cast.prototype.mouseHover=function(a,b){null!==this.mouseHoverObj&&this.mouseHoverObj.onMouseHoverEnded();for(var c,d=this.members,e=d.length,f=0;e>f;f++)if(c=d[f],c.visible&&c.contains(a,b))return this.mouseHoverObj=c,this.mouseHoverObj.onMouseHover(a,b),!0;return!1},MJQ_Cast.prototype.mouseHoverEnded=function(a,b,c){if(null!==this.mouseHoverObj){if(c)for(var d,e=this.members,f=e.length,g=0;f>g;g++)return d=e[g],this.mouseHoverObj.contains(a,b)?!0:(this.mouseHoverObj.onMouseHoverEnded(),this.mouseHoverObj=null,!1);this.mouseHoverObj.onMouseHoverEnded()}return this.mouseHoverObj=null,!1},MJQ_Cast.prototype.resetMouseOverObj=function(){this.prevMouseOverObj=null},MJQ_Cast.prototype.isMoving=function(){for(var a=this.members,b=a.length,c=0;b>c;c++)if(a[c].isMoving())return!0;return!1},MJQ_Cast.prototype.removeAllElements=function(){this.members.length=0,this.anim.repaintAll()},MJQ_Cast.prototype.testMembersInteractions=function(a){for(var b=null,c=this.members,d=c.length,e=0;d>e;e++)if(b=c[e],b.type===a&&(b.moving||b.dragging||b.tracking))return!0;return!1},MJQ_Cast.prototype.contains=function(a,b){for(var c,d=this.members.length,e=0;d>e;e++)if(c=this.members[e],c.doCheckRect&&(c.inputAllowedWhileMoving||!c.moving)&&c.contains(a,b))return!0;return!1};var mjq_numCastMembersCreated=0;MJQ_CastMember.CYCLE_FORWARD=1,MJQ_CastMember.CYCLE_REVERSE=-1,MJQ_CastMember.prototype.setImage=function(){},MJQ_CastMember.prototype.paint=function(){},MJQ_CastMember.prototype.repaint=function(){this.visible&&(this.dirty=!0,this.addDirtyRect())},MJQ_CastMember.prototype.clearDirtyRect=function(){this.dirty=!1,this.dirtyRect.width=0,this.dirtyRect.height=0},MJQ_CastMember.prototype.setDirtyRect=function(){var a=this.shadowBlur+6;this.dirtyRect.x=this.rect.x-a,this.dirtyRect.y=this.rect.y-a,this.dirtyRect.width=(this.rect.width+a+a)*this.scale.x,this.dirtyRect.height=(this.rect.height+a+a)*this.scale.y},MJQ_CastMember.prototype.addDirtyRect=function(){this.visible&&(0===this.dirtyRect.width?this.setDirtyRect():this.union(this.dirtyRect))},MJQ_CastMember.prototype.getDirtyRect=function(){return this.dirty?this.dirtyRect:null},MJQ_CastMember.prototype.union=function(a){var b=Math.min(this.rect.x,a.x),c=Math.max(this.rect.x+this.rect.width,a.x+a.width),d=Math.min(this.rect.y,a.y),e=Math.max(this.rect.y+this.rect.height,a.y+a.height);a.x=b,a.y=d,a.width=c-b,a.height=e-d},MJQ_CastMember.prototype.init=function(){},MJQ_CastMember.prototype.reinit=function(){},MJQ_CastMember.prototype.setID=function(a){this.id=a},MJQ_CastMember.prototype.getID=function(){return this.id},MJQ_CastMember.prototype.getCast=function(){return this.cast},MJQ_CastMember.prototype.setCast=function(a){null!==this.cast&&this.cast.remove(this),this.cast=a,null!==this.cast&&(this.cast.add(this),this.curTime=this.cast.anim.time,"MJQ_CastMemberDialog"!==this.getType()&&this.show())},MJQ_CastMember.prototype.setName=function(a){this.name=a},MJQ_CastMember.prototype.getName=function(){return this.name},MJQ_CastMember.prototype.cancelDragging=function(){this.mouseUp(this.CANCEL_MOUSE_OPERATIONS,0,0)},MJQ_CastMember.prototype.cancelTracking=function(){this.mouseUp(this.CANCEL_MOUSE_OPERATIONS,0,0)},MJQ_CastMember.prototype.preventInput=function(){var a=!this.visible||!this.allowInput()||this.isMoving()&&!this.allowInputWhileMoving()||this.checkInputOverride();return a},MJQ_CastMember.prototype.mouseDown=function(a,b){return this.preventInput()?!1:(this.mouseDownTime=this.cast.anim.time,this.mouseDownX=a,this.mouseDownY=b,this.allowDragging()?(this.setPrevPosition(this.rect.x,this.rect.y),(0!==this.mouseDownAdjustmentX||0!==this.mouseDownAdjustmentY)&&this.move(this.rect.x+this.mouseDownAdjustmentX,this.rect.y+this.mouseDownAdjustmentY,!0),this.mouseDownOffsetX=a-this.rect.x,this.mouseDownOffsetY=b-this.rect.y,this.setDragPriority(0),null!==this.cast&&this.cast.dragging(this),this.startDragging()):(this.setPrevPosition(this.rect.x,this.rect.y),this.move(this.rect.x+this.mouseDownAdjustmentX,this.rect.y+this.mouseDownAdjustmentY,!0),this.tracking=!0,this.highestPriorityOnDrag=!1,null!==this.cast&&this.cast.tracking(this),this.lastTrackingState=1),this.onMouseDown(a,b),!0)
},MJQ_CastMember.prototype.mouseUp=function(a,b){if(this.preventInput())return!1;var c=Math.abs(a-this.mouseDownX),d=Math.abs(b-this.mouseDownY);if(this.allowClicks()&&c<=this.CLICK_DISTANCE&&d<=this.CLICK_DISTANCE){var e=this.cast.anim.time,f=e-this.mouseDownTime<=this.CLICK_TIME;if(f){this.moveToPrev(!1);var g=!1;if(null!==this.cast){var h=this.cast.determineReceiverOnClick(this);g=this.clicked(h)}return!this.allowDragging()||g!==!1||this.rect.x===this.prevX&&this.rect.y===this.prevY||this.moveBack(a,b),this.onMouseUp(a,b),this.dragging=!1,this.tracking=!1,null!==this.cast&&this.cast.dragging(null),this.mouseDownTime=0,!0}}return this.allowDragging()&&null!==this.cast&&(a===this.CANCEL_MOUSE_OPERATIONS||this.dragged(this.cast.determineReceiverOnDrag(this))===!1)&&(this.doPrevPriAfterMoveTo=!0,this.moveBack(a,b)),this.tracking&&(this.moveToPrev(!1),a!==this.CANCEL_MOUSE_OPERATIONS&&1===this.lastTrackingState&&null!==this.cast&&this.clicked(this.cast.determineReceiverOnClick(this))),this.onMouseUp(a,b),this.dragging=!1,null!==this.cast&&this.cast.dragging(null),this.tracking=!1,this.mouseDownTime=0,!0},MJQ_CastMember.prototype.moveBack=function(a,b){Math.abs(a-(this.prevX+this.mouseDownOffsetX))<this.SNAP_DISTANCE&&Math.abs(b-(this.prevY+this.mouseDownOffsetY))<this.SNAP_DISTANCE?(this.highestPriorityOnDrag&&this.setPriority(this.getPrevPri()),this.move(this.prevX,this.prevY)):this.moveTo(this.prevX,this.prevY,100,Tween.regularEaseInOut)},MJQ_CastMember.prototype.mouseDrag=function(a,b){if(this.dragging){var c=a-this.mouseDownOffsetX,d=b-this.mouseDownOffsetY;this.move(c,d,!0),this.onMouseDrag(a,b)}else 1===this.lastTrackingState?this.contains(a,b)||(this.lastTrackingState=2,this.onMouseDragExit(a,b)):this.contains(a,b)&&(this.lastTrackingState=1,this.onMouseDragEnter(a,b));return!0},MJQ_CastMember.prototype.mouseMove=function(a,b,c){return this.onMouseOver(a,b,c),!0},MJQ_CastMember.prototype.onMouseDown=function(){},MJQ_CastMember.prototype.onMouseUp=function(){},MJQ_CastMember.prototype.onMouseDrag=function(){},MJQ_CastMember.prototype.onMouseOver=function(){},MJQ_CastMember.prototype.onMouseHover=function(){},MJQ_CastMember.prototype.onMouseEnter=function(){},MJQ_CastMember.prototype.onMouseHoverEnded=function(){},MJQ_CastMember.prototype.onMouseDragEnter=function(){},MJQ_CastMember.prototype.onMouseDragExit=function(){},MJQ_CastMember.prototype.startDragging=function(){},MJQ_CastMember.prototype.startMoving=function(){},MJQ_CastMember.prototype.startCycling=function(){},MJQ_CastMember.prototype.startScaling=function(){},MJQ_CastMember.prototype.startRotating=function(){},MJQ_CastMember.prototype.dragged=function(a){return this.setReceiver(a),!1},MJQ_CastMember.prototype.clicked=function(a){return this.setReceiver(a),!1},MJQ_CastMember.prototype.getReceiver=function(){return this.receiver},MJQ_CastMember.prototype.setReceiver=function(a,b){this.receiverLocked||(void 0!==b&&b&&(this.receiverLocked=!0),null===a&&null!==this.receiver&&this.getCast().removeReceiver(this.receiver),this.receiver=a,null!==this.receiver&&this.getCast().addReceiver(this.receiver))},MJQ_CastMember.prototype.setPrevPosition=function(a,b){this.prevX=a,this.prevY=b},MJQ_CastMember.prototype.show=function(){this.rect.width<=0||this.rect.height<=0||this.visible||null===this.cast||(this.visible=!0,this.repaint(),this.setDirtyRect(this.rect))},MJQ_CastMember.prototype.hide=function(){this.visible&&(this.repaint(),this.visible=!1)},MJQ_CastMember.prototype.isVisible=function(){return this.visible},MJQ_CastMember.prototype.getRect=function(){var a={x:this.rect.x,y:this.rect.y,width:this.rect.width*this.scale.x,height:this.rect.height*this.scale.y};return a},MJQ_CastMember.prototype.getX=function(){return this.rect.x},MJQ_CastMember.prototype.getY=function(){return this.rect.y},MJQ_CastMember.prototype.getWidth=function(){return this.rect.width*this.scale.x},MJQ_CastMember.prototype.getHeight=function(){return this.rect.height*this.scale.y},MJQ_CastMember.prototype.move=function(a,b,c){this.addDirtyRect(),this.rect.x=a,this.rect.y=b,this.repaint(),void 0!==c&&c&&this.onMove(a,b,!1)},MJQ_CastMember.prototype.setPos=function(a){this.addDirtyRect();var b=void 0!==a.offsetFromRight?mjq_scaledValue(a.offsetFromRight):0,c=void 0!==a.offsetFromBottom?mjq_scaledValue(a.offsetFromBottom):0;this.rect.x=void 0!==a.centerX&&a.centerX?Math.floor(MJQ_ACTIVITY_WIDTH/2-this.getWidth()/2)+b:void 0!==a.offsetFromRight?MJQ_ACTIVITY_WIDTH+b:mjq_scaledValue(a.x),this.rect.y=void 0!==a.centerY&&a.centerY?Math.floor(MJQ_ACTIVITY_HEIGHT/2-this.getHeight()/2)+c:void 0!==a.offsetFromBottom?MJQ_ACTIVITY_HEIGHT+c:mjq_scaledValue(a.y),this.repaint()},MJQ_CastMember.prototype.getPriority=function(){return this.priority},MJQ_CastMember.prototype.setPriority=function(a){void 0!==a&&(this.setPrevPri(this.priority),this.priority=a,null!==this.cast&&(this.cast.remove(this,!0),this.cast.add(this)),this.repaint())},MJQ_CastMember.prototype.setDragPriority=function(a){null!==this.cast&&(this.setPriority(a),this.dragging=!0)},MJQ_CastMember.prototype.setPrevPri=function(a){this.prevPri=a},MJQ_CastMember.prototype.getPrevPri=function(){return this.prevPri},MJQ_CastMember.prototype.setHighestPriorityOnDrag=function(a){this.highestPriorityOnDrag=a},MJQ_CastMember.prototype.allowMouseMoves=function(a){return void 0===a?this.mouseMovesAllowed:void(this.mouseMovesAllowed=a)},MJQ_CastMember.prototype.allowInput=function(a){return void 0===a?this.inputAllowed:void(this.inputAllowed=a)},MJQ_CastMember.prototype.allowInputWhileMoving=function(a){return void 0===a?this.inputAllowedWhileMoving:void(this.inputAllowedWhileMoving=a)},MJQ_CastMember.prototype.allowDragging=function(a){return void 0===a?this.draggingAllowed:void(this.draggingAllowed=a)},MJQ_CastMember.prototype.allowClicks=function(a){return void 0===a?this.clicksAllowed:void(this.clicksAllowed=a)},MJQ_CastMember.prototype.moveTo=function(a,b,c,d,e){if(this.moveToBezierPts.length=0,this.moveToBezierPts.push(this.rect.x),this.moveToBezierPts.push(this.rect.y),this.usingBezierPts=!1,void 0!==e&&null!==e)for(var f=0;f<e.length;f++)this.usingBezierPts=!0,this.moveToBezierPts.push(e[f]);if(this.moveToBezierPts.push(a),this.moveToBezierPts.push(b),this.movingToX=a,this.movingToY=b,this.moveToStartTime=this.cast.anim.time,this.moveToOrigX=this.rect.x,this.moveToOrigY=this.rect.y,this.moveToTime=c,this.arrived=!1,this.exactX=this.moveToOrigX,this.exactY=this.moveToOrigY,this.moving=!0,this.tween=d,this.usingTween=void 0!==d&&null!==d,this.usingTween){var g=this,h=function(){g.arrived=!0},i=new Tween(this,"tweenValue",this.tween,0,1,c/1e3,"",!1);i.onMotionFinished=h,i.start()}this.startMoving()},MJQ_CastMember.prototype.stopMoving=function(){this.moving=!1,this.arrived=!0},MJQ_CastMember.prototype.handleMove=function(a){if(this.moving)if(this.arrived)this.moving=!1,this.doPrevPriAfterMoveTo&&(this.doPrevPriAfterMoveTo=!1,this.setPriority(this.getPrevPri())),this.move(this.movingToX,this.movingToY),this.moveEnded(),null!==this.receiver&&this.receiver.mjq_receiverMoveEnded(this);else{var b=0;if(a>=this.moveToStartTime&&(b=(a-this.moveToStartTime)/this.moveToTime),this.usingTween||(this.tweenValue=b,this.arrived=b>=1||0>b),this.usingBezierPts&&this.usingTween&&(this.tweenValue>1&&(this.tweenValue=1),this.tweenValue<0&&(this.tweenValue=0)),this.arrived)b=1,this.exactX=this.movingToX,this.exactY=this.movingToY;else{for(var c=this.moveToBezierPts.slice(),d=0,e=0,f=0,g=0;c.length>2;){for(var h=0;h<c.length-2;h+=2)d=c[h],e=c[h+1],f=c[h+2],g=c[h+3],c[h]+=(f-d)*this.tweenValue,c[h+1]+=(g-e)*this.tweenValue;c.pop(),c.pop()}this.exactX=c[0],this.exactY=c[1]}(this.exactX<-5e3||this.exactY<-5e3||this.exactX>5e3||this.exactY>5e3)&&(this.arrived=!0,this.exactX=this.movingToX,this.exactY=this.movingToY);var i=Math.floor(this.exactX),j=Math.floor(this.exactY);if(i===this.rect.x&&j===this.rect.y)return;this.move(i,j,!1),this.onMove(i,j,!0)}},MJQ_CastMember.prototype.onMove=function(){},MJQ_CastMember.prototype.isMoving=function(){return this.moving},MJQ_CastMember.prototype.moveEnded=function(){if(null!==this.cueListener&&this.moveCue)this.moveCue=!1,this.cueListener.mjq_cue(this,this.MOVE_CUE);else if(null!==this.cueListener&&this.specialCue>0){var a=this.specialCue;this.specialCue=0,this.cueListener.mjq_cue(this,a)}this.hideAfterMove&&(this.hideAfterMove=!1,this.hide())},MJQ_CastMember.prototype.handleCycle=function(){return 0},MJQ_CastMember.prototype.setScale=function(a,b,c){this.addDirtyRect(),this.scale.x=a,this.scale.y=void 0===b?a:b,this.repaint(),void 0!==c&&c&&this.onScale(x,y,!1)},MJQ_CastMember.prototype.getScale=function(){return this.scale},MJQ_CastMember.prototype.scaleTo=function(a,b,c,d){if(this.scalingToX=a,this.scalingToY=b,this.scaleToStartTime=this.cast.anim.time,this.scaleToOrigX=this.scale.x,this.scaleToOrigY=this.scale.y,this.scaleToTime=c,this.scaled=!1,this.scaling=!0,this.scaleTween=d,this.usingScaleTween=void 0!==d&&null!==d,this.usingScaleTween){var e=this,f=function(){e.scaled=!0},g=new Tween(this,"scaleTweenValue",this.scaleTween,0,1,c/1e3,"",!1);g.onMotionFinished=f,g.start()}this.startScaling()},MJQ_CastMember.prototype.handleScale=function(a){if(this.scaling)if(this.scaled)this.scaling=!1,this.setScale(this.scalingToX,this.scalingToY),this.scaleEnded();else{var b=0;a>=this.scaleToStartTime&&(b=(a-this.scaleToStartTime)/this.scaleToTime),this.usingScaleTween||(this.scaleTweenValue=b,(b>=1||0>b)&&(this.scaled=!0)),this.scaled&&(this.scaleTweenValue=1,b=1),(this.scale.x<0||this.scale.y<0||this.scale.x>10||this.scale.y>10)&&(this.scaled=!0);var c=this.scalingToX-this.scaleToOrigX,d=this.scalingToY-this.scaleToOrigY,e=this.scaleToOrigX+c*this.scaleTweenValue,f=this.scaleToOrigY+d*this.scaleTweenValue;if(e===this.scale.x&&f===this.scale.y)return;this.setScale(e,f,!1),this.onScale(e,f,!0)}},MJQ_CastMember.prototype.onScale=function(){},MJQ_CastMember.prototype.isScaling=function(){return this.scaling},MJQ_CastMember.prototype.scaleEnded=function(){if(null!==this.cueListener&&this.scaleCue)this.scaleCue=!1,this.cueListener.mjq_cue(this,this.SCALE_CUE);else if(null!==this.cueListener&&this.specialCue>0){var a=this.specialCue;this.specialCue=0,this.cueListener.mjq_cue(this,a)}},MJQ_CastMember.prototype.setRotation=function(a,b){this.addDirtyRect(),this.rotation=a,this.repaint(),void 0!==b&&b&&this.onRotate(a,!1)},MJQ_CastMember.prototype.getRotation=function(){return this.rotation},MJQ_CastMember.prototype.rotateTo=function(a,b,c){if(this.rotatingTo=a,this.rotateToStartTime=this.cast.anim.time,this.rotateToOrig=this.rotation,this.rotateToTime=b,this.rotated=!1,this.rotating=!0,this.rotateTween=c,this.usingRotateTween=void 0!==c&&null!==c,this.usingRotateTween){var d=this,e=function(){d.rotated=!0},f=new Tween(this,"rotateTweenValue",this.rotateTween,0,1,b/1e3,"",!1);f.onMotionFinished=e,f.start()}this.startRotating()},MJQ_CastMember.prototype.handleRotate=function(a){if(this.rotating)if(this.rotated)this.rotating=!1,this.setRotation(this.rotatingTo,!0),this.rotateEnded();else{var b=0;a>=this.rotateToStartTime&&(b=(a-this.rotateToStartTime)/this.rotateToTime),this.usingRotateTween||(this.rotateTweenValue=b,(b>=1||0>b)&&(this.rotated=!0)),this.rotated&&(this.rotateTweenValue=1,b=1);var c=this.rotatingTo-this.rotateToOrig,d=this.rotateToOrig+c*this.rotateTweenValue;if(d===this.rotation)return;this.setRotation(d,!0),this.onRotate(d,!0)}},MJQ_CastMember.prototype.onRotate=function(){},MJQ_CastMember.prototype.isRotating=function(){return this.rotating},MJQ_CastMember.prototype.rotateEnded=function(){if(null!==this.cueListener&&this.rotateCue)this.rotateCue=!1,this.cueListener.mjq_cue(this,this.ROTATE_CUE);else if(null!==this.cueListener&&this.specialCue>0){var a=this.specialCue;this.specialCue=0,this.cueListener.mjq_cue(this,a)}},MJQ_CastMember.prototype.checkRect=function(a){return void 0===a?this.doCheckRect:void(this.doCheckRect=a)},MJQ_CastMember.prototype.contains=function(a,b){var c=this.rect,d=this.hotRect,e=c.x+d.x,f=c.y+d.y,g=!(e>a||f>b||a>=e+c.width+d.width||b>=f+c.height+d.height);return g&&this.usePerPixelAccuracy?this.onPixel(a,b,!1):g},MJQ_CastMember.prototype.onPixel=function(){return!1},MJQ_CastMember.prototype.detach=function(){return!1},MJQ_CastMember.prototype.setMouseDownAdjustment=function(a,b){this.mouseDownAdjustmentX=a,this.mouseDownAdjustmentY=b},MJQ_CastMember.prototype.moveToPrev=function(){var a=this.rect.x-this.prevX,b=this.rect.y-this.prevY,c=Math.abs(a);return Math.abs(b)>c&&(c=Math.abs(b)),c<=this.SNAP_DISTANCE&&(this.move(this.prevX,this.prevY),this.highestPriorityOnDrag&&this.setPriority(this.getPrevPri())),c},MJQ_CastMember.prototype.getPrevX=function(){return this.prevX},MJQ_CastMember.prototype.getPrevY=function(){return this.prevY},MJQ_CastMember.prototype.setCueListener=function(a){this.cueListener=a},MJQ_CastMember.prototype.setMoveCue=function(){this.moveCue=!0},MJQ_CastMember.prototype.setCycleCue=function(){this.cycleCue=!0},MJQ_CastMember.prototype.setScaleCue=function(){this.scaleCue=!0},MJQ_CastMember.prototype.setRotateCue=function(){this.rotateCue=!0},MJQ_CastMember.prototype.setTimeCue=function(a){this.cueTime=this.cast.anim.time,this.cueDuration=a},MJQ_CastMember.prototype.doTimeCue=function(a){null!==this.cueListener&&this.cueDuration>0&&a-this.cueTime>=this.cueDuration&&(this.cueDuration=0,this.cueListener.mjq_cue(this,this.TIME_CUE))},MJQ_CastMember.prototype.setBlinkCue=function(){this.blinkCue=!0},MJQ_CastMember.prototype.cancelAllCues=function(){this.moveCue=!1,this.cycleCue=!1,this.scaleCue=!1,this.rotateCue=!1,this.cueDuration=0,this.blinkCue=!1},MJQ_CastMember.prototype.animate=function(a){this.curTime=a,this.moving&&this.handleMove(a),this.cycling&&this.handleCycle(a),this.scaling&&this.handleScale(a),this.rotating&&this.handleRotate(a),this.cueDuration>0&&null!==this.cueListener&&this.doTimeCue(a),null!==this.blinkScript&&this.blinkScript.doScript(a),(this.fadingIn||this.fadingOut)&&this.doAlpha(),null!==this.script&&this.script.doScript(a)},MJQ_CastMember.prototype.setScript=function(a){this.script=a,null!==a&&(this.script.parent=this)},MJQ_CastMember.prototype.doBlink=function(a,b,c,d){this.blinkScript=new MJQ_BlinkScript(this,a,b,c,d)},MJQ_CastMember.prototype.doBlinkHide=function(){this.hide()},MJQ_CastMember.prototype.doBlinkShow=function(){this.show()},MJQ_CastMember.prototype.blinkDone=function(){null!==this.cueListener&&this.blinkCue&&(this.blinkCue=!1,this.cueListener.mjq_cue(this,this.BLINK_CUE)),this.blinkScript=null},MJQ_CastMember.prototype.checkInputOverride=function(){return!1},MJQ_CastMember.prototype.getType=function(){return this.type},MJQ_CastMember.prototype.fadeIn=function(a,b,c){this.visible&&(this.fadeStartAlpha=this.alpha,this.fadeStartTime=this.curTime,this.fadeTime=b,this.fadeTime<1&&(this.fadeTime=1),this.fadeTo=this.limitAlpha(a),this.fadeListener=void 0===c?null:c,this.fadingIn=!0,this.fadingOut=!1),this.hideAfterFade=!1,this.removeAfterFade=!1},MJQ_CastMember.prototype.fadeOut=function(a,b,c){this.visible&&(this.fadeStartAlpha=this.alpha,this.fadeStartTime=this.curTime,this.fadeTime=b,this.fadeTime<1&&(this.fadeTime=1),this.fadeTo=this.limitAlpha(a),this.fadeListener=void 0===c?null:c,this.fadingOut=!0,this.fadingIn=!1)},MJQ_CastMember.prototype.fadeStop=function(){this.fadingIn=!1,this.fadingOut=!1},MJQ_CastMember.prototype.fadeShow=function(a,b,c){this.visible||(this.setAlpha(0),this.show()),this.fadeIn(a,b,c)},MJQ_CastMember.prototype.fadeHide=function(a,b){this.visible&&(this.fadeOut(0,a,b),this.hideAfterFade=!0,this.fadingOut=!0,this.fadingIn=!1)},MJQ_CastMember.prototype.fadeRemove=function(a,b){this.visible&&(this.fadeOut(0,a,b),this.removeAfterFade=!0,this.fadingOut=!0,this.fadingIn=!1)},MJQ_CastMember.prototype.fading=function(){return this.fadingIn||this.fadingOut},MJQ_CastMember.prototype.fadingIn=function(){return this.fadingIn},MJQ_CastMember.prototype.fadingOut=function(){return this.fadingOut},MJQ_CastMember.prototype.limitAlpha=function(a){var b=a;return 0>b?b=0:b>1&&(b=1),b},MJQ_CastMember.prototype.setAlpha=function(a){a>=0&&(this.alpha=this.limitAlpha(a))},MJQ_CastMember.prototype.getAlpha=function(){return this.alpha},MJQ_CastMember.prototype.doAlpha=function(){var a=this.alpha;if(this.fadingIn||this.fadingOut){var b=0;this.curTime>=this.fadeStartTime&&(b=this.curTime-this.fadeStartTime);var c=b/this.fadeTime;c>=1&&(c=1);var d=Math.abs(this.fadeStartAlpha-this.fadeTo);this.fadingIn?this.alpha=this.fadeStartAlpha+d*c:this.fadingOut&&(this.alpha=this.fadeStartAlpha-d*c)}this.alpha=this.limitAlpha(this.alpha),a!==this.alpha&&this.setAlpha(this.alpha),this.alpha===this.fadeTo&&(this.fadingIn=!1,this.fadingOut=!1,this.removeAfterFade?(this.setCast(null),this.removeAfterFade=!1):this.hideAfterFade&&(this.hide(),this.hideAfterFade=!1),null!==this.fadeListener&&this.fadeListener.mjq_cue(this,this.FADE_CUE)),this.repaint()},MJQ_CastMember.prototype.shadowsOK=function(){return this.allowShadows&&this.shadowVisible},MJQ_CastMember.prototype.setSpecialCue=function(a){this.specialCue=a},MJQ_CastMember.prototype.setDimensions=function(a,b){this.addDirtyRect(),this.rect.width=a,this.rect.height=b,this.addDirtyRect()},MJQ_CastMemberImage.mjq_isSubclassOf(MJQ_CastMember),MJQ_CastMemberImage.prototype.setImage=function(a,b){this.imgHolder=a,null!==this.imgHolder?(this.numFrames=this.getNumFrames(),this.numRows=this.getNumRows(),this.img=this.imgHolder.rows[0][0],this.rect.width=this.img.width,this.rect.height=this.img.height,void 0!==b&&b||this.repaint()):this.hide()},MJQ_CastMemberImage.prototype.getImage=function(){return this.img},MJQ_CastMemberImage.prototype.getNumFrames=function(){return null!==this.imgHolder?this.imgHolder.rows[0].length:-1},MJQ_CastMemberImage.prototype.getNumRows=function(){return null!==this.imgHolder?this.imgHolder.rows.length:-1},MJQ_CastMemberImage.prototype.getFrame=function(){return this.frame},MJQ_CastMemberImage.prototype.setFrame=function(a,b){if(null!==this.imgHolder){if(0>a||a>this.getNumFrames()-1)return;this.frame=a,this.img=this.imgHolder.rows[this.row][this.frame],void 0!==b&&b||this.repaint()}},MJQ_CastMemberImage.prototype.getRow=function(){return this.row},MJQ_CastMemberImage.prototype.setRow=function(a,b){if(null!==this.imgHolder){if(0>a||a>this.getNumRows()-1)return;this.row=a,this.img=this.imgHolder.rows[this.row][this.frame],void 0!==b&&b||this.repaint()}},MJQ_CastMemberImage.prototype.paint=function(a,b){if(this.visible&&null!==this.img.src&&null!==a){var c=this.cast.anim,d=this.rect,e=d.x,f=d.y,g=d.width,h=d.height,i=Math.floor(g*this.rotationOriginX),j=Math.floor(h*this.rotationOriginY);if(e<c.width&&f<c.height&&e+g>=0&&f+h>=0){a.save(),a.beginPath(),a.rect(b.x,b.y,b.width,b.height),a.clip(),a.globalAlpha=this.alpha,!mjq_touchable&&this.shadowsOK()&&(a.shadowColor=this.shadowColor,a.shadowBlur=this.shadowBlur);var k=e+i,l=f+j;a.translate(k,l),0!==this.rotation&&a.rotate(this.rotation*(Math.PI/180)),1===this.scale.x&&1===this.scale.y?a.drawImage(this.img,-i,-j):a.drawImage(this.img,-i,-j,g*this.scale.x,h*this.scale.y),a.restore()}}},MJQ_CastMemberImage.prototype.cycleStart=function(a,b,c,d){this.cycleDirection=void 0===c?MJQ_CastMember.CYCLE_FORWARD:c,this.cycleStartTime=this.cast.anim.time,this.cycleFrameDuration=a,this.cycles=void 0===b||1>b?9999999:b,this.cycleStopFrame=void 0==d||0>d?0:d,this.cycleStopFrame>this.getNumFrames()&&(this.cycleStopFrame=this.getNumFrames()-1),this.cycling=!0,this.startCycling()},MJQ_CastMemberImage.prototype.handleCycle=function(a){if(this.cycling&&a>=this.cycleStartTime+this.cycleFrameDuration){this.cycleStartTime=a;var b=this.getNumFrames(),c=this.getFrame(),d=c;this.cycleDirection===MJQ_CastMember.CYCLE_FORWARD?(d++,d>=b&&(d=0,this.cycles--)):(d--,0>d&&(d=b-1,this.cycles--)),this.setFrame(d,this.getRow()),this.cycles<=1&&d===this.cycleStopFrame&&(this.cycling=!1,this.cyclingEnded())}},MJQ_CastMemberImage.prototype.onCycle=function(){},MJQ_CastMemberImage.prototype.isCycling=function(){return this.cycing},MJQ_CastMemberImage.prototype.cyclingEnded=function(){null!==this.cueListener&&this.cycleCue&&(this.cycleCue=!1,this.cueListener.mjq_cue(this,this.CYCLE_CUE))},MJQ_CastMemberImage.prototype.onPixel=function(a,b,c){if(null===this.img||void 0===this.img)return!1;if(c&&!this.contains(a,b))return!1;var d=this.getRect(),e=a-d.x,f=b-d.y,g=this.img.getContext("2d"),h=g.getImageData(e,f,1,1).data,i=h[3];return i>=this.ALPHA_THRESHOLD},MJQ_CastMemberImage.prototype.centerX=function(){return this.rect.x+Math.floor(this.rect.width/2)},MJQ_CastMemberImage.prototype.centerY=function(){return this.rect.y+Math.floor(this.rect.height/2)};var MJQ_BUTTON_UP=0,MJQ_BUTTON_DOWN=1,MJQ_BUTTON_OVER=2,MJQ_BUTTON_DISABLED=3,MJQ_NUM_BUTTON_STATES=4;MJQ_CastMemberButton.mjq_isSubclassOf(MJQ_CastMemberImage),MJQ_CastMemberButton.prototype.init=function(){this.allowInput(!0),this.allowClicks(!0),this.highestPriorityOnDrag=!1,this.draggingAllowed=!1},MJQ_CastMemberButton.prototype.setButtonListener=function(a){this.buttonListener=void 0===a?null:a},MJQ_CastMemberButton.prototype.getEnabled=function(){return this.enabled},MJQ_CastMemberButton.prototype.setEnabled=function(a){this.enabled=a,this.setFrame(this.enabled?MJQ_BUTTON_UP:MJQ_BUTTON_DISABLED)},MJQ_CastMemberButton.prototype.clicked=function(){return this.enabled&&null!==this.buttonListener&&this.buttonListener.mjq_buttonClicked(this.id,0),!1},MJQ_CastMemberButton.prototype.onMouseDown=function(){this.enabled&&this.setFrame(MJQ_BUTTON_DOWN)},MJQ_CastMemberButton.prototype.onMouseUp=function(){this.enabled&&this.setFrame(MJQ_BUTTON_UP)},MJQ_CastMemberButton.prototype.onMouseOver=function(a,b,c){this.enabled&&(this.over=c,this.setFrame(this.over?MJQ_BUTTON_OVER:MJQ_BUTTON_UP))},MJQ_CastMemberButton.prototype.onMouseDragEnter=function(){this.enabled&&this.setFrame(MJQ_BUTTON_DOWN)},MJQ_CastMemberButton.prototype.onMouseDragExit=function(){this.enabled&&this.setFrame(MJQ_BUTTON_UP)},MJQ_CastMemberButton.prototype.animate=function(a){if(null!==this.img&&this.over&&null!==this.cast){this.over=!1;var b=this.cast.anim.getLastMouseX(),c=this.cast.anim.getLastMouseY(),d=this.hotRect,e=this.rect,f=e.x+d.x,g=e.y+d.y;(f>b||g>c||b>=f+e.width+d.width||c>=g+e.height+d.height)&&(this.cast.resetMouseOverObj(),this.setFrame(MJQ_BUTTON_UP))}MJQ_CastMemberImage.prototype.animate.call(this,a)},MJQ_CastMemberButton.prototype.setFrame=function(a,b){MJQ_CastMemberImage.prototype.setFrame.call(this,1===this.numButtonStates?0:a,b)};var MJQ_TEXT_LEFT=1,MJQ_TEXT_CENTER=2,MJQ_TEXT_RIGHT=3;MJQ_CastMemberText.mjq_isSubclassOf(MJQ_CastMember),MJQ_CastMemberText.prototype.setExtraShadow=function(a){this.mustRefactor=!0,this.extraShadow=a},MJQ_CastMemberText.prototype.setNoShadow=function(a){this.mustRefactor=!0,this.noShadow=a},MJQ_CastMemberText.prototype.setColor=function(a){this.mustRefactor=!0,this.color=a,this.useColor=a,this.repaint()},MJQ_CastMemberText.prototype.setColor2=function(a){this.mustRefactor=!0,this.color2=a,this.repaint()},MJQ_CastMemberText.prototype.setUseColor=function(a){this.useColor=a,this.mustRefactor=!0,this.repaint()},MJQ_CastMemberText.prototype.setShadowColor=function(a){this.mustRefactor=!0,this.shadowColor=a,this.repaint()},MJQ_CastMemberText.prototype.justify=function(a){this.mustRefactor=!0,this.justification=a},MJQ_CastMemberText.prototype.setShadowDist=function(a){this.mustRefactor=!0,this.shadowDist=a},MJQ_CastMemberText.prototype.setFont=function(a,b,c){this.mustRefactor=!0,this.fontName=a,this.fontSize=void 0===b?10:b,this.fontStyle=void 0===c?"":c,this.font=this.fontStyle+" "+this.fontSize+"pt "+this.fontName,this.repaint()},MJQ_CastMemberText.prototype.setText=function(a){this.mustRefactor=!0,this.text=a,this.repaint()},MJQ_CastMemberText.prototype.getText=function(){return this.text},MJQ_CastMemberText.prototype.getFont=function(){return this.font},MJQ_CastMemberText.prototype.setButtonListener=function(a){this.buttonListener=void 0===a?null:a},MJQ_CastMemberText.prototype.clicked=function(){return null!==this.buttonListener&&this.buttonListener.mjq_buttonClicked(this.id,0),!1},MJQ_CastMemberText.prototype.onMouseDown=function(){""!==this.color2&&this.setUseColor(this.color2)},MJQ_CastMemberText.prototype.onMouseUp=function(){""!==this.color2&&this.setUseColor(this.color)},MJQ_CastMemberText.prototype.onMouseOver=function(a,b,c){""!==this.color2&&this.setUseColor(c?this.color2:this.color)},MJQ_CastMemberText.prototype.onMouseDragEnter=function(){""!==this.color2&&this.setUseColor(this.color2)},MJQ_CastMemberText.prototype.onMouseDragExit=function(){""!==this.color2&&this.setUseColor(this.color)},MJQ_CastMemberText.prototype.paint=function(a,b){if(null!==this.buffer&&(this.mustRefactor&&this.prepareBuffer(),this.visible)){var c=this.cast.anim,d=this.rect,e=this.renderX,f=this.renderY,g=d.width,h=d.height,i=~~(g>>1),j=~~(h>>1);e<c.width&&f<c.height&&e+g>=0&&f+h>=0&&(a.save(),a.beginPath(),a.rect(b.x,b.y,b.width,b.height),a.clip(),a.globalAlpha=this.alpha,0!==this.rotation&&a.rotate(this.rotation*Math.PI/180),a.translate(e+i,f+j),1===this.scale.x&&1===this.scale.y?a.drawImage(this.buffer,-i,-j):a.drawImage(this.buffer,-i,-j,g*this.scale.x,h*this.scale.y),a.restore())}},MJQ_CastMemberText.prototype.prepareBuffer=function(){this.repaint(),null===this.buffer&&(this.buffer=document.createElement("canvas"));var a=this.buffer.getContext("2d");a.font=this.font,this.rect.width=Math.round(a.measureText(this.text).width),this.ascent=Math.round(this.fontSize*this.heightMultiplier),this.fontHeight=this.fontSize+this.ascent+Math.round(this.fontSize*this.heightMultiplier)+this.shadowDist,this.rect.xOffset=0,this.justification===MJQ_TEXT_CENTER?this.rect.xOffset=Math.floor((this.rect.width+this.shadowDist+(this.extraShadow?1:0))/2):this.justification===MJQ_TEXT_RIGHT&&(this.rect.xOffset=this.rect.width+this.shadowDist+(this.extraShadow?1:0)),this.buffer.width=this.rect.width+this.shadowDist+(this.extraShadow?1:0),this.buffer.height=this.fontHeight,a=this.buffer.getContext("2d"),a.font=this.font;var b=Math.floor(this.fontHeight/2)+this.ascent;a.globalAlpha=this.alpha,this.shadowBlur>0&&this.allowShadows&&this.shadowVisible?(a.shadowColor=this.shadowColor,a.shadowBlur=this.shadowBlur):this.noShadow||""===this.shadowColor||null===this.shadowColor||(a.fillStyle=this.shadowColor,a.fillText(this.text,this.shadowDist,b+this.shadowDist),this.extraShadow&&a.fillText(this.text,this.shadowDist+1,b+this.shadowDist+1)),a.fillStyle=this.useColor,a.fillText(this.text,0,b),this.renderX=this.rect.x-this.rect.xOffset,this.renderY=this.rect.y,this.rect.width=this.buffer.width,this.rect.height=this.buffer.height,this.mustRefactor=!1,this.repaint()},MJQ_CastMemberText.prototype.move=function(a,b,c){this.addDirtyRect(),this.rect.x=a,this.rect.y=b,this.renderX=this.rect.x-this.rect.xOffset,this.renderY=this.rect.y,this.repaint(),void 0!==c&&c&&this.onMove(this.renderX,this.renderY,!1)},MJQ_CastMemberText.prototype.setDirtyRect=function(){if(null!==this.rect&&this.rect.width>0){var a=this.shadowBlur+5;this.dirtyRect.x=this.renderX-(a+1),this.dirtyRect.y=this.renderY-(a+1),this.dirtyRect.width=(this.rect.width+a+a+2)*this.scale.x,this.dirtyRect.height=(this.rect.height+a+a+2)*this.scale.y}},MJQ_CastMemberText.prototype.union=function(a){if(null!==this.rect&&this.rect.width>0){var b=Math.min(this.renderX,a.x),c=Math.max(this.renderX+this.rect.width,a.x+a.width),d=Math.min(this.renderY,a.y),e=Math.max(this.renderY+this.rect.height,a.y+a.height);a.x=b,a.y=d,a.width=c-b,a.height=e-d}},MJQ_CastMemberText.prototype.setCast=function(a){null!==this.cast&&void 0!==this.cast&&this.cast.remove(this),this.cast=a,null===this.buffer&&this.prepareBuffer(),null!==this.cast&&void 0!==this.cast&&(this.cast.add(this),this.curTime=this.cast.anim.time)},MJQ_CastMemberText.prototype.getRect=function(){var a={x:this.renderX,y:this.renderY,width:this.rect.width*this.scale.x,height:this.rect.height*this.scale.y};return a},MJQ_CastMemberText.prototype.doAlpha=function(){this.mustRefactor=!0,MJQ_CastMember.prototype.doAlpha.call(this)},MJQ_CastMemberText.prototype.contains=function(a,b){var c=this.hotRect,d=this.rect,e=this.renderX+c.x,f=this.renderY+c.y,g=!(e>a||f>b||a>=e+d.width+c.width||b>=f+d.height+c.height);return g&&this.usePerPixelAccuracy?this.onPixel(a,b,!1):g},MJQ_Script.prototype.resetScript=function(){this.state=0,this.nextState=0,this.prevState=0,this.interval=1,this.changeStateStartTime=0,this.curTime=0,this.lockChangeState=!1,this.changeStateLocked=!1},MJQ_Script.prototype.doScript=function(a){this.curTime=a,this.interval>0&&this.curTime-this.changeStateStartTime>=this.interval&&(this.prevState=this.state,this.state=this.nextState,this.nextState=-1,this.interval=0,this.lockChangeState=!1,this.changeStateLocked=!1,this.doState(this.state)),null!==this.subScript&&this.subScript.doScript(a)},MJQ_Script.prototype.lockChangeState=function(){this.lockChangeState=!0},MJQ_Script.prototype.doState=function(){},MJQ_Script.prototype.getState=function(){return this.state},MJQ_Script.prototype.setState=function(a){this.state=a},MJQ_Script.prototype.getPrevState=function(){return this.nextState},MJQ_Script.prototype.getNextState=function(){return this.state},MJQ_Script.prototype.changeState=function(a,b){if(!this.changeStateLocked){this.lockChangeState&&(this.changeStateLocked=!0);var c=void 0===b?1:b,d=void 0===a?this.state+1:a;this.nextState=d,this.state=d,this.interval=c,this.changeStateStartTime=this.curTime}},MJQ_Script.prototype.changeStateNext=function(a){this.changeState(this.state+1,a)},MJQ_Script.prototype.sameState=function(a){this.changeState(this.state,void 0===a?1:a)},MJQ_Script.prototype.setSubScript=function(a){this.subScript=a,null!==this.subScript&&(this.subScript.parent=this,this.subScript.changeState(0))},MJQ_BlinkScript.mjq_isSubclassOf(MJQ_Script),MJQ_BlinkScript.prototype.doState=function(a){switch(a){case 0:break;case 1:this.blinkCounter=0,this.changeState(2);break;case 2:this.parent.doBlinkHide(),this.changeState(3,this.blinkRateOff);break;case 3:this.parent.doBlinkShow(),this.blinkCounter++,this.blinkCounter<this.blinkTimes?this.changeState(2,this.blinkRate):(this.hideAfterBlink&&this.parent.doBlinkHide(),this.parent.blinkDone(),this.changeState(0))}},MJQ_BlinkScript.prototype.hideAfterBlink=function(a){this.hideAfterBlink=a},MJQ_BlinkScript.prototype.stopBlinking=function(){this.blinkTimes=0,this.blinkCounter=0},MJQ_Config.prototype.init=function(a,b,c){var d=this;this.fileName=a,this.cueListener=void 0===b?null:b,this.nextState=c,this.json={},this.success=!1,this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){var a=4;this.readyState===a&&(d.json=JSON.parse(this.responseText),d.success=!0,d.request=null,d.parseJSON(),void 0!==d.cueListener&&(-1===d.nextState?d.cueListener(d):void 0===d.nextState?d.cueListener.mjq_cue(d,"JSON"):d.cueListener.changeState(d.nextState)))},this.request.open("GET",this.fileName,!0),this.request.send()},MJQ_Config.prototype.parseJSON=function(){},MJQ_Config.prototype.getString=function(a,b){if(void 0===b){var c=this.json[a];return void 0===c?"":c}var c=this.json[a][b];return void 0===c?"":c},MJQ_Config.prototype.getInt=function(a,b){if(void 0===b){var c=this.json[a];return void 0===c?0:c}var c=this.json[a][b];return void 0===c?0:c},MJQ_Config.prototype.getInt2=function(a,b){if(void 0===b){var c=this.json[a];return void 0===c?-999:c}var c=this.json[a][b];return void 0===c?-999:c},MJQ_Config.prototype.getIntFromArray=function(a,b,c){if(void 0===c){var d=this.json[a][b];return void 0===d?0:d}var d=this.json[a][b][c];return void 0===d?0:d},MJQ_Config.prototype.getInt2FromArray=function(a,b,c){if(void 0===c){var d=this.json[a][b];return void 0===d?-999:d}var d=this.json[a][b][c];return void 0===d?-999:d},MJQ_Config.prototype.getBool=function(a,b){if(void 0===b){var c=this.json[a];return void 0===c?!1:c}var c=this.json[a][b];return void 0===c?!1:c};var MJQ_TEXT_LEFT=1,MJQ_TEXT_CENTER=2,MJQ_TEXT_RIGHT=3,MJQ_TEXT_PLAIN=0,MJQ_TEXT_BOLD=1,MJQ_TEXT_ITALIC=2,MJQ_MAX_DIALOG_WIDTH=1800,MJQ_MAX_DIALOG_HEIGHT=1400,MJQ_DIALOG_TEXT=1,MJQ_DIALOG_LINE=2,MJQ_DIALOG_BUTTON=3,MJQ_DIALOG_CHECKBOX=4,MJQ_DIALOG_RADIO=5,MJQ_DIALOG_IMAGE=6,MJQ_DIALOG_CUSTBUTTON=7,MJQ_DIALOG_ICON=8,MJQ_DIALOG_BUTTON_FRAMES=4,MJQ_DIALOG_CHECKBOX_FRAMES=2,MJQ_DIALOG_RADIO_FRAMES=2,MJQ_DIALOG_ICON_FRAMES=3,MJQ_DIALOG_IMAGE_FRAMES=1,MJQ_DIALOG_ICONINDENTX=10,MJQ_DIALOG_ICONINDENTY=10,MJQ_DIALOG_INDENT=5,MJQ_DIALOG_BUTTONINDENT=15,MJQ_DIALOG_TEXTSPACING=10,MJQ_DIALOG_BUTTONSPACING=7,MJQ_DIALOG_MAXLINES=5,MJQ_DIALOG_CHECKBOXOFFSET=35,MJQ_DIALOG_CHECKBOX_ID=50,MJQ_DIALOG_RADIO_ID=51,MJQ_DIALOG_BUTTONSET_NONE=0,MJQ_DIALOG_BUTTONSET_YESNO=1,MJQ_DIALOG_BUTTONSET_OK=2,MJQ_DIALOG_BUTTONSET_OKCANCEL=3,MJQ_DIALOG_BUTTONSET_NEXTGAME_CANCEL=4,MJQ_DIALOG_BUTTONSET_OK_NEXTPREV=5,MJQ_DIALOG_BUTTON_OK=1,MJQ_DIALOG_BUTTON_CANCEL=2,MJQ_DIALOG_BUTTON_YES=1,MJQ_DIALOG_BUTTON_NO=2,MJQ_DIALOG_BUTTON_NEXT=3,MJQ_DIALOG_BUTTON_PREV=4,MJQ_DIALOG_BUTTON_SOUND_EFFECTS=5,MJQ_DIALOG_BUTTON_MUSIC=6,MJQ_DIALOG_BUTTON_PLAYABLE_TILES=7,MJQ_DIALOG_BUTTON_EXIT=8,MJQ_DIALOG_BUTTON_TILE_MARKER=9,MJQ_DIALOG_BUTTON_INFO=10,MJQ_DIALOG_BUTTON_LEFT=11,MJQ_DIALOG_BUTTON_RIGHT=12,MJQ_DIALOG_BUTTON_CHEAT=13,MJQ_DIALOG_ICON_NONE=0,MJQ_DIALOG_ICON_ALERT=1,MJQ_DIALOG_ICON_QUESTION=2,MJQ_DIALOG_ICON_INFO=3,MJQ_DIALOG_MAX_WIDTH=1500,MJQ_DIALOG_MAX_WIDTH_WIDE=2e3,MJQ_DIALOG_MAX_HEIGHT=1500;
MJQ_CastMemberDialog.mjq_isSubclassOf(MJQ_CastMember),MJQ_CastMemberDialog.prototype.mouseDownOutsideOfDialog=function(){if(this.disposeOnMouseDownOutside&&!this.moving&&null!==this.listener)for(var a=0;a<this.buttonItems.length;a++)if(this.buttonItems[a].id===MJQ_DIALOG_BUTTON_CANCEL)return this.listener.mjq_dialogButtonClicked(this.id,this.buttonItems[a].id),this.detachDialog(),this.trackingItem=null,void this.repaint()},MJQ_CastMemberDialog.prototype.setTextJustify=function(a){this.textJustify=a},MJQ_CastMemberDialog.prototype.getItems=function(){return this.items},MJQ_CastMemberDialog.prototype.setName=function(a){this.name=a},MJQ_CastMemberDialog.prototype.getName=function(){return this.name},MJQ_CastMemberDialog.prototype.setColors=function(a,b,c,d){this.foreColor=a,void 0!==b&&(this.shadowColor=b),void 0!==c&&(this.borderColor=c),void 0!==d&&(this.borderColor2=d)},MJQ_CastMemberDialog.prototype.setBorderThickness=function(a){this.borderThickness=a,this.borderThickness<0&&(this.borderThickness=0),this.repaint()},MJQ_CastMemberDialog.prototype.setFontAttributes=function(a,b,c,d){this.fontName=a,this.fontSize=b,this.fontStyle=c,this.textShadowDepth=d,this.repaint()},MJQ_CastMemberDialog.prototype.setBackImage=function(a){this.backImgHolder=a,this.repaint()},MJQ_CastMemberDialog.prototype.setButtonImages=function(a,b,c){this.b1ImgHolder=a,this.b1Frame=0,this.b2ImgHolder=b,this.b2Frame=0,void 0===c&&(c=null),this.b3ImgHolder=c,this.b3Frame=0,null!==this.button1Item&&this.button1Item.setImage(this.b1ImgHolder),null!==this.button2Item&&this.button2Item.setImage(this.b2ImgHolder),null!==this.button3Item&&this.button3Item.setImage(this.b3ImgHolder),this.repaint()},MJQ_CastMemberDialog.prototype.setCheckboxImages=function(a){this.checkImgHolder=a,this.checkFrame=0},MJQ_CastMemberDialog.prototype.setRadioImages=function(a){this.radioImgHolder=a,this.radioFrame=0},MJQ_CastMemberDialog.prototype.setIconImage=function(a){this.iconImgHolder=a,this.iconFrame=0},MJQ_CastMemberDialog.prototype.getForeColor=function(){return this.foreColor},MJQ_CastMemberDialog.prototype.getFontSize=function(){return this.fontSize},MJQ_CastMemberDialog.prototype.getFontStyle=function(){return this.fontStyle},MJQ_CastMemberDialog.prototype.getFontName=function(){return this.fontName},MJQ_CastMemberDialog.prototype.setMinSize=function(a,b){this.rect.width=a,this.rect.height=b,this.sizeSet=!0},MJQ_CastMemberDialog.prototype.show=function(a,b,c,d){var e=-1,f=-1;if(void 0===b?b=-1:e=b,void 0===c?c=-1:f=c,!this.shown){if(this.time=d,this.buttonSet=a,this.buttonSet!==MJQ_DIALOG_BUTTONSET_NONE&&(this.buttonSet===MJQ_DIALOG_BUTTONSET_OK?(this.button2Item=this.addButton(this.b1ImgHolder,-1,-1,MJQ_DIALOG_BUTTON_OK),this.buttonAdded=!0):this.buttonSet===MJQ_DIALOG_BUTTONSET_OK_NEXTPREV?(this.button1Item=this.addButton(this.b1ImgHolder,-1,-1,MJQ_DIALOG_BUTTON_OK),this.button2Item=this.addButton(this.b2ImgHolder,-1,-1,MJQ_DIALOG_BUTTON_NEXT),this.button2Item.buttonPadding=50,this.button2Item.detachOnClick=!1,this.button3Item=this.addButton(this.b3ImgHolder,-1,-1,MJQ_DIALOG_BUTTON_PREV),this.button3Item.detachOnClick=!1,this.buttonAdded=!0):(this.button2Item=this.addButton(this.b2ImgHolder,-1,-1,MJQ_DIALOG_BUTTON_CANCEL),this.button1Item=this.addButton(this.b1ImgHolder,-1,-1,MJQ_DIALOG_BUTTON_OK),this.buttonAdded=!0)),!this.useAbsolutePositioning){this.sizeSet||(this.rect.width=0,this.rect.height=0);for(var g=!1,h=this.items.length,i=0;h>i;i++){var j=this.items[i];j.height=0,j.width=0,null!==j.text?(j.prepareText(),null!==j.imgHolder&&(j.width+=MJQ_DIALOG_CHECKBOXOFFSET)):j.type===MJQ_DIALOG_LINE?(j.height=j.size,j.width=Math.abs(j.x2-j.x)):(j.width=j.getFrameWidth(),j.height=j.getFrameHeight(),j.type!==MJQ_DIALOG_BUTTON||g||(this.rect.height+=j.height+MJQ_DIALOG_BUTTONSPACING+MJQ_DIALOG_BUTTONSPACING+MJQ_DIALOG_INDENT,j.height=0,j.width=0,this.buttonAdded=!0,g=!0)),j.x+j.width>this.rect.width&&(this.rect.width=j.x+j.width),j.y+j.height>this.rect.height&&(this.rect.height=j.y+j.height)}this.anim.width>=900&&this.rect.width>MJQ_DIALOG_MAX_WIDTH_WIDE?this.rect.width=MJQ_DIALOG_MAX_WIDTH_WIDE:this.anim.width<900&&this.rect.width>MJQ_DIALOG_MAX_WIDTH&&(this.rect.width=MJQ_DIALOG_MAX_WIDTH),this.rect.height>MJQ_DIALOG_MAX_HEIGHT&&(this.rect.height=MJQ_DIALOG_MAX_HEIGHT)}if(this.buttonSet!==MJQ_DIALOG_BUTTONSET_NONE&&(this.rect.width+=MJQ_DIALOG_TEXTSPACING+MJQ_DIALOG_TEXTSPACING),this.buttonAdded){var k=0,l=0,m=this.buttonItems.length;if(m>=1){for(var n=0,i=0;m>i;i++){var j=this.buttonItems[i];n+=j.getFrameWidth()+j.buttonPadding,n+=MJQ_DIALOG_BUTTONINDENT}n+=MJQ_DIALOG_BUTTONINDENT,this.rect.width<n&&(this.rect.width=n);var j=this.buttonItems[0];j.x=this.rect.width-j.getFrameWidth()-MJQ_DIALOG_BUTTONINDENT-j.buttonPadding,j.y=this.rect.height-j.getFrameHeight()-MJQ_DIALOG_BUTTONSPACING,k=j.x,l=j.y,m>=2&&(j=this.buttonItems[1],j.x=k-j.getFrameWidth()-MJQ_DIALOG_BUTTONINDENT-j.buttonPadding,j.y=l,k=j.x,m>=3&&(j=this.buttonItems[2],j.x=k-j.getFrameWidth()-MJQ_DIALOG_BUTTONINDENT-j.buttonPadding,j.y=l))}}this.useAbsolutePositioning||(this.rect.height+=MJQ_DIALOG_INDENT),this.attachDialog()&&(this.setCast(this.anim.getCast()),-1===b&&-1===c?this.center():this.move(b,c),this.shown=!0,MJQ_CastMember.prototype.show.call(this))}},MJQ_CastMemberDialog.prototype.validateText=function(a){return null!==a.color1&&null!==a.text&&null!==a.font},MJQ_CastMemberDialog.prototype.addText=function(a,b,c,d,e,f){void 0===b&&(b=-1),void 0===c&&(c=-1),void 0===d&&(d=this.foreColor,void 0===d&&(d="#ffffff")),void 0===e&&(e=this.fontSize,void 0===e&&(e=14)),void 0===f&&(f=this.fontStyle,void 0===f&&(f=MJQ_TEXT_PLAIN));var g=new MJQ_DialogItem(this,MJQ_DIALOG_TEXT,b,c,-1);return g.setTextProperties(a,d,e,f,this.textShadowDepth),this.validateText(g)&&this.items.push(g),g},MJQ_CastMemberDialog.prototype.addCheckbox=function(a,b,c,d,e,f,g,h){void 0===f&&(f=this.foreColor,void 0===f&&(f="#ffffff")),void 0===g&&(g=this.fontSize,void 0===g&&(g=14)),void 0===h&&(h=this.fontStyle,void 0===h&&(h=MJQ_TEXT_PLAIN));var i=new MJQ_DialogItem(this,MJQ_DIALOG_CHECKBOX,b,c,d,MJQ_DIALOG_CHECKBOX_FRAMES);return i.setTextProperties(a,f,g,h,this.textShadowDepth),i.state=e,i.lastState=e,this.validateText(i)&&null!==this.checkImgHolder&&(i.setImage(this.checkImgHolder),this.items.push(i)),i},MJQ_CastMemberDialog.prototype.addRadioButton=function(a,b,c,d,e,f,g,h,i){void 0===g&&(g="#ffffff"),void 0===h&&(h=14),void 0===i&&(i=MJQ_TEXT_PLAIN);var j=new MJQ_DialogItem(this,MJQ_DIALOG_RADIO,b,c,d,MJQ_DIALOG_RADIO_FRAMES);return j.subID=e,j.setTextProperties(a,g,h,i,this.textShadowDepth),f?j.set(this.items,!0):j.lastState=!1,this.validateText(j)&&null!==this.radioImgHolder&&(j.setImage(this.radioImgHolder),this.items.push(j)),j},MJQ_CastMemberDialog.prototype.updateRadioButton=function(a,b,c){for(var d=this.items.length,e=0;d>e;e++){var f=this.items[e];if(f.id===a&&f.subID===b&&(f.type===MJQ_DIALOG_CHECKBOX||f.type===MJQ_DIALOG_RADIO)){f.state=c,c?f.set(this.items,!0):f.lastState=!1;break}}},MJQ_CastMemberDialog.prototype.updateCheckbox=function(a,b){this.updateRadioButton(a,0,b)},MJQ_CastMemberDialog.prototype.addLine=function(a,b,c,d,e,f){void 0===e&&(e="#ffffff"),void 0===f&&(f=14);var g=new MJQ_DialogItem(this,MJQ_DIALOG_LINE,a,b,-1);return g.setTextProperties(null,e,f,-1,0),g.x2=c,g.y2=d,g.size=f,this.items.push(g),g},MJQ_CastMemberDialog.prototype.addImage=function(a,b,c){if(null!==a){var d=new MJQ_DialogItem(this,MJQ_DIALOG_IMAGE,b,c,-1,MJQ_DIALOG_IMAGE_FRAMES);return d.setImage(a),this.items.push(d),d}return null},MJQ_CastMemberDialog.prototype.addIcon=function(a){if(a>0){var b=new MJQ_DialogItem(this,MJQ_DIALOG_ICON,MJQ_DIALOG_ICONINDENTX,MJQ_DIALOG_ICONINDENTY,-1,MJQ_DIALOG_ICON_FRAMES);return b.setImage(this.iconImgHolder),b.setFrame(a-1),this.items.push(b),b}return null},MJQ_CastMemberDialog.prototype.addButton=function(a,b,c,d){var e=new MJQ_DialogItem(this,MJQ_DIALOG_BUTTON,b,c,d,MJQ_DIALOG_BUTTON_FRAMES);return this.doAddButton(e,a)},MJQ_CastMemberDialog.prototype.addCustomButton=function(a,b,c,d,e){var f=new MJQ_DialogItem(this,MJQ_DIALOG_CUSTBUTTON,b,c,d,e);return this.doAddButton(f,a)},MJQ_CastMemberDialog.prototype.doAddButton=function(a,b){return null!==b&&null!==a?(a.setImage(b),this.items.push(a),this.buttonItems.push(a),a):null},MJQ_CastMemberDialog.prototype.setModeless=function(a){this.modeless=a},MJQ_CastMemberDialog.prototype.setPriority=function(a){this.setPrevPri(this.priority),this.priority=a,this.priority<-1&&(this.priority=-1),this.visible&&null!==this.anim.getCast()&&(this.anim.getCast().remove(this),this.anim.getCast().add(this)),this.repaint()},MJQ_CastMemberDialog.prototype.mouseDown=function(a,b){for(var c=this.items.length,d=0;c>d;d++){var e=this.items[d];if(e.contains(a,b))return e.type===MJQ_DIALOG_BUTTON||e.type===MJQ_DIALOG_CUSTBUTTON?(this.trackingItem=e,e.swapImages(!1),e.state=!0):e.type===MJQ_DIALOG_CHECKBOX?(e.set(this.items,!1),this.listener.mjq_dialogButtonClicked(this.id,e.id)):e.set(this.items,!1),this.repaint(),!0}return MJQ_CastMember.prototype.mouseDown.call(this,a,b)},MJQ_CastMemberDialog.prototype.mouseUp=function(a,b){if(null!==this.trackingItem&&this.trackingItem.contains(a,b)){if(this.trackingItem.state=!1,null!==this.listener){if(this.trackingItem.id===MJQ_DIALOG_BUTTON_OK)for(var c=this.items.length,d=0;c>d;d++){var e=this.items[d];(e.type===MJQ_DIALOG_CHECKBOX||e.type===MJQ_DIALOG_RADIO)&&(e.lastState=e.state,this.mjq_dialogItemSet(this.id,e.id,e.subID,e.state),this.listener.mjq_dialogItemSet(this.id,e.id,e.subID,e.state))}if(this.trackingItem.id===MJQ_DIALOG_BUTTON_CANCEL)for(var c=this.items.length,d=0;c>d;d++){var e=this.items[d];(e.type===MJQ_DIALOG_CHECKBOX||e.type===MJQ_DIALOG_RADIO)&&(e.state=e.lastState)}this.listener.mjq_dialogButtonClicked(this.id,this.trackingItem.id)}return this.trackingItem.detachOnClick&&this.detachDialog(),this.trackingItem=null,!0}return this.trackingItem=null,this.repaint(),MJQ_CastMember.prototype.mouseUp.call(this,a,b)},MJQ_CastMemberDialog.prototype.mouseDrag=function(a,b){return null!==this.trackingItem?(this.trackingItem.state=this.trackingItem.contains(a,b),this.repaint(),!0):MJQ_CastMember.prototype.mouseDrag.call(this,a,b)},MJQ_CastMemberDialog.prototype.dragged=function(a){MJQ_CastMember.prototype.dragged.call(this,a);var b=this.anim.width,c=this.anim.height,d=!1;return this.rect.x<0&&(this.setPrevPosition(0,this.rect.y),this.rect.x=0,d=!0),this.rect.y<0&&(this.setPrevPosition(this.rect.x,0),this.rect.y=0,d=!0),this.rect.x+this.rect.width>=b&&(this.setPrevPosition(b-this.rect.width,this.rect.y),this.rect.x=b-this.rect.width,d=!0),this.rect.y+this.rect.height>=c&&(this.setPrevPosition(this.rect.x,c-this.rect.height),this.rect.y=c-this.rect.height,d=!0),this.repaint(),!d},MJQ_CastMemberDialog.prototype.center=function(){var a=this.anim.width,b=this.anim.height;this.move(Math.floor((a-this.rect.width)/2),Math.floor((b-this.rect.height)/2))},MJQ_CastMemberDialog.prototype.onPixel=function(a,b,c){if(null===this.img||void 0===this.img)return!1;if(c&&!this.contains(a,b))return!1;var d=this.getRect(),e=a-d.x,f=b-d.y,g=this.backImgHolder.rows[0][0],h=g.getContext("2d"),i=h.getImageData(e,f,1,1).data,j=i[3];return j>=this.ALPHA_THRESHOLD},MJQ_CastMemberDialog.prototype.paint=function(a,b){if(this.shown){a.save(),a.beginPath();var c=this.anim.cast.intersection(this.rect,b);if(a.rect(c.x,c.y,c.width,c.height),a.clip(),a.globalAlpha=this.alpha,null!==this.backImgHolder)for(var d=0,e=0,f=this.backImgHolder.rows[0][0];d<this.rect.width;){for(;e<this.rect.height;)a.drawImage(f,this.rect.x+d,this.rect.y+e),e+=f.height;d+=f.width,e=0}a.strokeStyle=this.foreColor;for(var g=this.items,h=g.length,i=0;h>i;i++)g[i].paint(a,this.rect.x,this.rect.y);if(this.borderThickness>0){a.strokeStyle=this.borderColor,a.lineWidth=this.borderThickness;var j=a.lineWidth/2;a.strokeRect(this.rect.x+j,this.rect.y+j,this.rect.width-a.lineWidth-0,this.rect.height-a.lineWidth-0),void 0!==this.borderColor2&&(a.strokeStyle=this.borderColor2,a.strokeRect(this.rect.x+(a.lineWidth+1.5),this.rect.y+(a.lineWidth+1.5),this.rect.width-2*(a.lineWidth+1.5),this.rect.height-2*(a.lineWidth+1.5)))}a.restore()}},MJQ_CastMemberDialog.prototype.attachDialog=function(){return this.anim.getCast().attachDialog(this,this.modeless)},MJQ_CastMemberDialog.prototype.detachDialog=function(){return this.anim.getCast().attachDialog(null,!1)},MJQ_CastMemberDialog.prototype.detach=function(){null!==this.listener?this.listener.mjq_dialogDetached(this.id)||(this.shown=!1,this.setCast(null)):(this.shown=!1,this.setCast(null))},MJQ_CastMemberDialog.prototype.animate=function(a){if(null===this.trackingItem){for(var b=this.anim.getLastMouseX(),c=this.anim.getLastMouseY(),d=!1,e=this.items,f=e.length,g=0;f>g;g++){var h=e[g];h.swapImages(h.contains(b,c))&&(d=!0)}d&&this.repaint()}MJQ_CastMember.prototype.animate.call(this,a)},MJQ_CastMemberDialog.prototype.mjq_dialogItemSet=function(){},MJQ_CastMemberDialog.prototype.changeToOKButton=function(){if(null!==this.button1Item){var a=this.items.indexOf(this.button1Item);this.items.splice(a,1),a=this.buttonItems.indexOf(this.button1Item),this.buttonItems.splice(a,1)}this.repaint()},MJQ_CastMemberDialog.prototype.moveBack=function(){this.highestPriorityOnDrag&&this.setPriority(this.getPrevPri()),this.move(this.prevX,this.prevY)},MJQ_CastMemberDialog.prototype.setDimensions=function(a,b){this.rect.width=a>MJQ_MAX_DIALOG_WIDTH?MJQ_MAX_DIALOG_WIDTH:a,this.rect.height=b>MJQ_MAX_DIALOG_HEIGHT?MJQ_MAX_DIALOG_HEIGHT:b},MJQ_CastMemberDialog.prototype.removeItem=function(a){if(null!==a){var b=this.items.indexOf(a);this.items.splice(b,1)}this.repaint()},MJQ_DialogItem.prototype.setTextJustify=function(a){this.justify=a,this.mustRefactorText=!0,this.owner.repaint()},MJQ_DialogItem.prototype.setFrame=function(a){this.frame=a,this.owner.repaint()},MJQ_DialogItem.prototype.setEnabled=function(a){var b=this.enabled;this.enabled=a===!1?!1:!0,this.enabled!==b&&this.owner.repaint()},MJQ_DialogItem.prototype.setImage=function(a){this.imgHolder=a,aFrame=this.imgHolder.rows[0][0],this.width=aFrame.width*this.numFrames,this.height=aFrame.height,this.frameWidth=aFrame.width,this.frameHeight=aFrame.height},MJQ_DialogItem.prototype.swapImages=function(a){var b=this.over;return this.over=a,b!==this.over},MJQ_DialogItem.prototype.getFrameWidth=function(){return this.frameWidth},MJQ_DialogItem.prototype.getFrameHeight=function(){return this.frameHeight},MJQ_DialogItem.prototype.setTextProperties=function(a,b,c,d,e){this.text=a,this.color1=null!==b?b:this.owner.getForeColor(),this.fontSize=-1!==c?c:this.owner.getFontSize(),this.fontStyle=-1!==d?d:this.owner.getFontStyle(),this.shadowDepth=e,this.font="",this.fontStyle===MJQ_TEXT_BOLD&&(this.font+="bold "),this.fontStyle===MJQ_TEXT_ITALIC&&(this.font+="italics "),this.font+=this.fontSize+"pt "+this.owner.getFontName(),this.mustRefactorText=!0,this.owner.repaint()},MJQ_DialogItem.prototype.setTextColor=function(a){this.color1=void 0!==a?a:this.owner.getForeColor(),this.mustRefactorText=!0,this.owner.repaint()},MJQ_DialogItem.prototype.setText=function(a){this.text=a,this.mustRefactorText=!0,this.owner.repaint()},MJQ_DialogItem.prototype.contains=function(a,b){if(this.type===MJQ_DIALOG_BUTTON||this.type===MJQ_DIALOG_CUSTBUTTON||this.type===MJQ_DIALOG_CHECKBOX||this.type===MJQ_DIALOG_RADIO){var c=0;if(this.type===MJQ_DIALOG_CHECKBOX||this.type===MJQ_DIALOG_RADIO){var d=this.owner.anim.context;d.font=this.font,c=d.measureText(this.text).width+MJQ_DIALOG_INDENT}return a>=this.owner.rect.x+this.x-this.hotRectPadding&&b>=this.owner.rect.y+this.y-this.hotRectPadding&&a<=this.owner.rect.x+this.x+this.frameWidth+c+this.hotRectPadding&&b<=this.owner.rect.y+this.y+this.frameHeight+this.hotRectPadding}return!1},MJQ_DialogItem.prototype.set=function(a,b){if(this.type===MJQ_DIALOG_CHECKBOX)this.state=this.state?!1:!0;else if(this.type===MJQ_DIALOG_RADIO){for(var c=a.length,d=0;c>d;d++){var d=a[d];d.id===this.id&&(d.state=!1,b&&(d.lastState=!1))}b?(this.state=!0,this.lastState=this.state):this.state=this.state?!1:!0}this.owner.repaint()},MJQ_DialogItem.prototype.prepareText=function(){this.textBuffer=document.createElement("canvas");var a=this.textBuffer.getContext("2d");a.font=this.font,this.textWidth=Math.ceil(a.measureText(this.text).width),this.ascent=Math.round(this.fontSize*this.heightMultiplier),this.fontHeight=this.fontSize+this.ascent+Math.round(this.fontSize*this.heightMultiplier)+this.shadowDepth,this.textXOffset=0,this.justify===MJQ_TEXT_CENTER?this.textXOffset=Math.floor((this.textWidth+this.shadowDepth)/2):this.justify===MJQ_TEXT_RIGHT&&(this.textXOffset=this.textWidth+this.shadowDepth),this.textBuffer.width=this.textWidth+this.shadowDepth,this.textBuffer.height=this.fontHeight,a=this.textBuffer.getContext("2d"),a.font=this.font;var b=Math.floor(this.fontHeight/2)+this.ascent;this.shadowDepth>0&&(a.fillStyle=this.color2,a.fillText(this.text,1,b+1),this.shadowDepth>1&&a.fillText(this.text,2,b+2)),a.fillStyle=this.color1,a.fillText(this.text,0,b),this.textRenderX=this.x-this.textXOffset,this.textRenderY=this.y,this.textWidth=this.textBuffer.width,this.textHeight=this.textBuffer.height,this.width=this.textWidth,this.height=this.textHeight,this.mustRefactorText=!1},MJQ_DialogItem.prototype.drawImg=function(a,b,c){null!==this.imgHolder&&a.drawImage(this.imgHolder.rows[this.row][this.frame],b+this.x,c+this.y)},MJQ_DialogItem.prototype.paint=function(a,b,c){switch(a.save(),this.type){case MJQ_DIALOG_TEXT:this.mustRefactorText&&this.prepareText(),a.drawImage(this.textBuffer,b+this.textRenderX,c+this.textRenderY);break;case MJQ_DIALOG_LINE:a.beginPath(),a.moveTo(b+this.x,c+this.y),a.lineWidth=this.lineSize,a.strokeStyle=this.color1,a.lineTo(b+this.x2,c+this.y2),a.stroke();break;case MJQ_DIALOG_BUTTON:this.frame=this.state?1:0,this.enabled?this.over&&(this.frame=2):this.frame=3,this.drawImg(a,b,c+this.offsetY);break;case MJQ_DIALOG_CUSTBUTTON:this.frame=this.state?1:0,this.enabled?this.over&&(this.frame=2):this.frame=999,this.frame>this.numFrames-1&&(this.frame=this.numFrames-1),this.drawImg(a,b,c+this.offsetY);break;case MJQ_DIALOG_ICON:this.drawImg(a,b,c);break;case MJQ_DIALOG_IMAGE:this.drawImg(a,b,c);break;case MJQ_DIALOG_CHECKBOX:this.frame=this.state?1:0,this.drawImg(a,b,c),this.mustRefactorText&&this.prepareText(),a.drawImage(this.textBuffer,b+this.textRenderX+MJQ_DIALOG_CHECKBOXOFFSET+MJQ_DIALOG_INDENT,c+this.textRenderY+this.offsetY);break;case MJQ_DIALOG_RADIO:this.frame=this.state?1:0,drawImg(a,b,c),this.mustRefactorText&&this.prepareText(),a.drawImage(this.textBuffer,b+this.textRenderX+MJQ_DIALOG_CHECKBOXOFFSET+MJQ_DIALOG_INDENT,c+this.textRenderY+this.offsetY)}a.restore()},MJQ_DialogItem.prototype.setOffsetY=function(a){this.offsetY=a},MJQ_CastMemberNumber.mjq_isSubclassOf(MJQ_CastMemberImage),MJQ_CastMemberNumber.prototype.setImage=function(a,b){void 0!==b&&b||(this.mustRefactor=!0),MJQ_CastMemberImage.prototype.setImage.call(this,a,b)},MJQ_CastMemberNumber.prototype.setTimeValue=function(a,b){this.value=a,0>a&&(a=0);var c=Math.floor(a/36e3),d=Math.floor(a%36e3/600),e=Math.floor(a%600/10);this.text="",c>0&&(this.text+=c+":"),this.text+=d+":",10>e&&(this.text+="0"),this.text+=e+"",b&&(this.text+="."+a%10),this.mustRefactor=!0,this.repaint()},MJQ_CastMemberNumber.prototype.setNumber=function(a){this.value=a,this.text=a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),this.mustRefactor=!0,this.repaint()},MJQ_CastMemberNumber.prototype.setPlusValue=function(a){this.value=a,this.text="+"+a,this.mustRefactor=!0,this.repaint()},MJQ_CastMemberNumber.prototype.setSlashValue=function(a){this.value=a,this.text="/"+a,this.mustRefactor=!0,this.repaint()},MJQ_CastMemberNumber.prototype.setXValue=function(a){this.value=a,this.text=a+"x",this.useHatchMark=!0,this.mustRefactor=!0,this.repaint()},MJQ_CastMemberNumber.prototype.paint=function(a,b){if(this.mustRefactor&&this.prepareBuffer(),null!==this.buffer&&this.visible){var c=this.cast.anim,d=this.rect,e=this.renderX,f=this.renderY,g=d.width,h=d.height,i=~~(g>>1),j=~~(h>>1);e<c.width&&f<c.height&&e+g>=0&&f+h>=0&&(a.save(),a.beginPath(),a.rect(b.x,b.y,b.width,b.height),a.clip(),a.globalAlpha=this.alpha,0!==this.rotation&&a.rotate(this.rotation*Math.PI/180),!mjq_touchable&&this.shadowsOK()&&(a.shadowColor=this.shadowColor,a.shadowBlur=this.shadowBlur),a.translate(e+i,f+j),1===this.scale.x&&1===this.scale.y?a.drawImage(this.buffer,-i,-j):a.drawImage(this.buffer,-i,-j,g*this.scale.x,h*this.scale.y),a.restore())}},MJQ_CastMemberNumber.prototype.prepareBuffer=function(){if(""===this.text)return void(this.buffer=null);this.repaint(),null===this.buffer&&(this.buffer=document.createElement("canvas"),this.buffer.name="numberImageBuffer"),this.buffer.width=this.text.length*this.img.width,this.buffer.height=this.img.height,this.useHatchMark&&(this.buffer.height=2*this.img.height);var a=this.buffer.getContext("2d");a.globalAlpha=this.alpha;for(var b=null,c=this.img.width,d=null,e=0,f=0,g=0,h=1;2>=h;h++){for(var i=0,j=0;j<this.text.length;j++){if(f=0,g=c,d=this.text[j],b=Number(d),isNaN(b)&&(","===d?(b=12,f=-Math.floor(.2*c),g=Math.floor(1*c)):":"===d?(b=10,f=-Math.floor(.3*c),g=Math.floor(.7*c)):"."===d?(b=14,f=-Math.floor(.3*c),g=Math.floor(.7*c)):"x"===d?b=11:"/"===d?(b=11,g=Math.floor(1*c)):b="+"===d?11:10),i+=f,by=this.useHatchMark?Math.floor(this.buffer.height/2):0,2===h){var e=this.imgHolder.rows[0][b];a.drawImage(e,0,0,e.width,e.height,i,by,e.width,e.height)}i+=g+this.digitPadding,this.useHatchMark&&1===b&&(i-=Math.floor(.2*c))}if(1===h)this.buffer.width=i+10;else if(this.useHatchMark){var e=this.imgHolder.rows[0][13];a.drawImage(e,0,0,e.width,e.height,Math.floor(this.buffer.width/2-e.width/2),Math.floor(e.height/4),e.width,e.height)}}this.rect.xOffset=0,this.justification===MJQ_TEXT_CENTER?this.rect.xOffset=Math.floor(this.buffer.width/2):this.justification===MJQ_TEXT_RIGHT&&(this.rect.xOffset=this.buffer.width),this.renderX=this.rect.x-this.rect.xOffset,this.renderY=this.rect.y,this.rect.width=this.buffer.width,this.rect.height=this.buffer.height,this.mustRefactor=!1,this.repaint()},MJQ_CastMemberNumber.prototype.getRect=function(){var a={x:this.renderX,y:this.renderY,width:this.rect.width*this.scale.x,height:this.rect.height*this.scale.y};return a},MJQ_CastMemberNumber.prototype.move=function(a,b,c){this.addDirtyRect(),this.rect.x=a,this.rect.y=b,this.renderX=this.rect.x-this.rect.xOffset,this.renderY=this.rect.y,this.repaint(),void 0!==c&&c&&this.onMove(this.renderX,this.renderY,!1)},MJQ_CastMemberNumber.prototype.setDirtyRect=function(){null!==this.rect&&this.rect.width>0&&(this.dirtyRect.x=void 0!==this.renderX?this.renderX:0,this.dirtyRect.y=void 0!==this.renderY?this.renderY:0,this.dirtyRect.width=this.rect.width*this.scale.x,this.dirtyRect.height=this.rect.height*this.scale.y)},MJQ_CastMemberNumber.prototype.union=function(a){if(null!==this.rect&&this.rect.width>0){var b=Math.min(this.renderX,a.x),c=Math.max(this.renderX+this.rect.width,a.x+a.width),d=Math.min(this.renderY,a.y),e=Math.max(this.renderY+this.rect.height,a.y+a.height);a.x=b,a.y=d,a.width=c-b,a.height=e-d}},MJQ_Resource.prototype.imgLoaded=function(){this.onloadObj.resourceLoaded(this.currentSrc)},MJQ_Resource.prototype.getImage=function(){return this.image},MJQ_Resource.prototype.createImage=function(a,b,c,d,e,f,g){var h=new Object;void 0===d&&(d=0),void 0===e&&(e=0),(void 0===f||0===f)&&(f=Math.floor(this.image.width/b)),(void 0===g||0===g)&&(g=Math.floor(this.image.height/c)),h.rows=new Array;for(var i=0;c>i;i++){for(var j=new Array,k=0;b>k;k++){var l=document.createElement("canvas");l.width=f,l.height=g;var m=l.getContext("2d");m.drawImage(this.image,d+k*f,e+i*g,f,g,0,0,f,g),j.push(l)}h.rows.push(j)}return h};var mjq_audioSprite=null,mjq_usingWebAudio="undefined"!=typeof AudioContext||"undefined"!=typeof webkitAudioContext;MJQ_Timer.mjq_isSubclassOf(MJQ_CastMemberNumber),MJQ_Timer.prototype.setTimer=function(a,b){null!==mjq_levels&&void 0!==mjq_levels&&mjq_levels.timed&&(this.startSeconds=a,this.addedSeconds=0,this.tenths=10*this.startSeconds,this.countDown=b,this.setValue(this.tenths),this.lastTock=this.TIMER_TOCK_START_TIME)},MJQ_Timer.prototype.addTime=function(a){this.setValue(this.tenths+10*a),this.addedSeconds+=a},MJQ_Timer.prototype.showFraction=function(a){this.showFractn=a,this.setValue(this.tenths),this.repaint()},MJQ_Timer.prototype.start=function(){this.startTime=(new Date).getTime(),this.started=!0,this.runTimer()},MJQ_Timer.prototype.stopTimer=function(){this.started&&(clearInterval(this.loop),this.started=!1)},MJQ_Timer.prototype.pauseTimer=function(){this.started&&(this.paused||(this.paused=!0,this.pauseStartTime=(new Date).getTime()))},MJQ_Timer.prototype.unpauseTimer=function(){if(this.started&&this.paused){this.paused=!1;var a=(new Date).getTime(),b=a-this.pauseStartTime;this.startTime+=b}},MJQ_Timer.prototype.getValue=function(){return this.tenths},MJQ_Timer.prototype.setValue=function(a){this.tenths=a,this.setTimeValue(this.tenths,this.showFractn),this.countDown&&this.tenths<=this.lastTock-10&&(this.lastTock=this.tenths,mjq_playSound("timertock")),this.tenths>=this.TIMER_TOCK_START_TIME&&(this.lastTock=this.TIMER_TOCK_START_TIME),this.mustRefactor=!0,this.repaint(),null!==this.gameScript.timerBar&&this.gameScript.timerBar.handleTimerBar(a,this.startSeconds)},MJQ_Timer.prototype.runTimer=function(){var a=this;this.loop=setInterval(function(){if(!a.paused){var b=(new Date).getTime(),c=b-a.startTime,d=Math.floor(c/100);a.setValue(a.countDown?Math.floor(10*(a.startSeconds+a.addedSeconds))-d:d),a.countDown&&a.tenths<=0?(a.stopTimer(),a.gameScript.game.endWhenTimesUp&&a.gameScript.game.handleTimesUp()):!a.countDown&&a.tenths>=36e3&&a.stopTimer()}},100)},MJQ_Timer.prototype.getMinutes=function(){var a=Math.floor(this.tenths/600);return a},MJQ_Timer.prototype.getSeconds=function(){var a=Math.floor((this.tenths-600*this.getMinutes())/10);return a},MJQ_Timer.prototype.getTenths=function(){var a=this.tenths%10;return a},MJQ_BigTextScript.mjq_isSubclassOf(MJQ_Script),MJQ_BigTextScript.prototype.doState=function(a){var b=this.bigtextObj;switch(a){case 10:b.setCueListener(this),b.setScaleCue(),b.fadeShow(1,200),b.setScale(.3,.3),b.scaleTo(1.5,1.5,1e3,Tween.elasticEaseOut);break;case 11:this.changeStateNext(100);break;case 12:b.setMoveCue(),b.scaleTo(1,1,300),b.moveTo(MJQ_ACTIVITY_WIDTH+mjq_scaledValue(300),b.getY(),500,Tween.backEaseIn,null);break;case 13:this.changeState(100);break;case 20:b.setCueListener(this),b.setScaleCue(),b.fadeShow(1,500),b.setScale(.5,.5),b.scaleTo(1.5,1.5,1200,Tween.elasticEaseOut);break;case 21:this.changeStateNext(600);case 22:b.setScaleCue(),b.scaleTo(1.55,1.55,250,Tween.regularEaseOut);break;case 23:this.changeStateNext(30);case 24:b.setScaleCue(),b.fadeOut(0,250),b.scaleTo(.7,.7,300,Tween.regularEaseIn);break;case 25:this.changeState(100);break;case 100:b.scriptEnded()}},MJQ_BigTextScript.prototype.mjq_cue=function(){this.changeStateNext()},MJQ_BigText.mjq_isSubclassOf(MJQ_CastMemberImage),MJQ_BigText.prototype.paint=function(a,b){if(this.visible&&null!==this.img.src&&null!==a){var c=this.cast.anim,d=this.rect,e=d.x,f=d.y,g=d.width*this.scale.x,h=d.height*this.scale.y,i=d.width-g,j=d.height-h,k=~~(g>>1),l=~~(h>>1);e<c.width&&f<c.height&&e+g>=0&&f+h>=0&&(a.save(),a.beginPath(),a.rect(b.x,b.y,b.width,b.height),a.clip(),a.globalAlpha=this.alpha,a.translate(e+k,f+l),1===this.scale.x&&1===this.scale.y?a.drawImage(this.img,-k,-l):a.drawImage(this.img,-k+Math.floor(i/2),-l+Math.floor(j/2),g,h),a.restore())}},MJQ_BigText.prototype.setDirtyRect=function(){var a=this.rect.width*this.scale.x,b=this.rect.height*this.scale.y,c=this.rect.width-a,d=this.rect.height-b;this.dirtyRect.x=this.rect.x+Math.floor(c/2),this.dirtyRect.y=this.rect.y+Math.floor(d/2),this.dirtyRect.width=Math.ceil(this.rect.width*this.scale.x),this.dirtyRect.height=Math.ceil(this.rect.height*this.scale.y)},MJQ_BigText.prototype.scriptEnded=function(){void 0!==this.nextGameState&&this.gameScript.changeState(this.nextGameState,this.nextStateTime),"bigtextgo"===this.name&&mjq_game.seconds>0&&mjq_levels.timed&&this.gameScript.timer.start(),this.setScript(null),this.setCast(null)},MJQ_TimerBar.mjq_isSubclassOf(MJQ_CastMemberImage),MJQ_TimerBar.prototype.handleTimerBar=function(a,b){var c=Math.floor(a/10),d=c/b;d>1&&(d=1),0>d&&(d=0);var e=Math.floor(this.timerBarWidth-this.timerBarWidth*d);0===e?this.moveTo(this.clipX-e,this.rect.y,1200,Tween.regularEaseOut):this.moveTo(this.clipX-e,this.rect.y,1e3)},MJQ_TimerBar.prototype.paint=function(a,b){if(this.visible&&null!==this.img.src&&null!==a){var c=this.cast.anim,d=this.rect,e=d.x,f=d.y,g=d.width,h=d.height;if(e<c.width&&f<c.height&&e+g>=0&&f+h>=0){a.save(),a.beginPath(),a.rect(b.x,b.y,b.width,b.height),a.clip(),a.globalAlpha=this.alpha;var i=this.clipX-this.rect.x;a.drawImage(this.img,i,0,g-i,h,this.clipX,f,g-i,h),a.restore()}}},MJQ_MultiplierBar.mjq_isSubclassOf(MJQ_CastMemberImage),MJQ_MultiplierBar.prototype.init=function(){if(this.timed=mjq_levels.timed,this.barValue=0,this.started=!1,this.loop=-1,this.paused=!1,this.move(this.clipX-this.multiplierBarWidth,this.rect.y),this.timed||this.addToMultiplierBar(this.multiplierBarWidth,!0,!0),this.initMultiplierValues(),this.timed)for(var a=1;4>=a;a++)this.multiplierValues[a].fadeShow(1,mjq_game.script.HUD_ELEMENTS_FADETIME);else this.multiplierValues[1].fadeShow(1,mjq_game.script.HUD_ELEMENTS_FADETIME),this.multiplierValues[1].setXValue(1),this.multiplierValues[1].value=1},MJQ_MultiplierBar.prototype.getRateOfIncrease=function(){return mjq_gameObjects.multiplierValues.rateOfIncrease},MJQ_MultiplierBar.prototype.getRateOfDecrease=function(){var a=MJQ_MAX_ACTIVITY_HEIGHT/MJQ_ACTIVITY_HEIGHT;return Math.round(mjq_gameObjects.multiplierValues.rateOfDecrease*a)},MJQ_MultiplierBar.prototype.getExtraValue=function(){if(!this.timed)return 0;var a=this.barValue,b=mjq_gameObjects.multiplierValues.posspacing,c=0;return c=b>a?0:2*b>a?1:3*b>a?2:4*b>a?3:4},MJQ_MultiplierBar.prototype.addToMultiplierBar=function(a,b,c){if(this.timed||c!==!1&&void 0!==c){{this.barValue}this.barValue+=a,this.barValue<0&&(this.barValue=0),this.barValue>this.multiplierBarWidth&&(this.barValue=this.multiplierBarWidth);var d=this.multiplierBarWidth-this.barValue;b?this.moveTo(this.clipX-d,this.rect.y,this.timed?400:1e3):this.move(this.clipX-d,this.rect.y)}},MJQ_MultiplierBar.prototype.paint=function(a,b){if(this.visible&&null!==this.img.src&&null!==a){var c=this.cast.anim,d=this.rect,e=d.x,f=d.y,g=d.width,h=d.height;if(e<c.width&&f<c.height&&e+g>=0&&f+h>=0){a.save(),a.beginPath(),a.rect(b.x,b.y,b.width,b.height),a.clip(),a.globalAlpha=this.alpha;var i=this.clipX-this.rect.x;a.drawImage(this.img,i,0,g-i,h,this.clipX,f,g-i,h),a.restore()}}},MJQ_MultiplierBar.prototype.runTimer=function(){var a=this;this.loop=setInterval(function(){a.paused||a.moving||a.addToMultiplierBar(-1,!1)},a.getRateOfDecrease())},MJQ_MultiplierBar.prototype.start=function(){this.timed&&(this.started=!0,this.runTimer())},MJQ_MultiplierBar.prototype.stopTimer=function(){this.started&&(clearInterval(this.loop),this.started=!1)},MJQ_MultiplierBar.prototype.pauseTimer=function(){this.started&&(this.paused||(this.paused=!0))},MJQ_MultiplierBar.prototype.unpauseTimer=function(){this.started&&this.paused&&(this.paused=!1)},MJQ_MultiplierBar.prototype.setMultiplierValues=function(a){var b=400,c=mjq_gameObjects.multiplierValues.pos.x,d=this.multiplierValues[1].rect.y,e=mjq_gameObjects.multiplierValues.posspacing;if(this.timed){if(a>this.multiplierValues[1].value-1){for(var f=1;5>=f;f++)1===f&&this.multiplierValues[f].fadeRemove(b-100),5===f&&(this.multiplierValues[f]=new MJQ_CastMemberNumber(mjq_gameObjects.multiplierValues),this.multiplierValues[f].move(mjq_scaledValue(c+f*e-20),d),this.multiplierValues[f].setXValue(a+4),this.multiplierValues[f].fadeShow(1,b),this.multiplierValues[f].name="multiplierValues"),this.multiplierValues[f].moveTo(mjq_scaledValue(c+(f-1)*e),d,b);for(var f=1;5>=f;f++)this.multiplierValues[f-1]=this.multiplierValues[f];
for(var f=0;5>=f;f++)this.multiplierValues[f].value=a+f}else if(a<this.multiplierValues[1].value-1){for(var f=0;4>=f;f++)4===f&&this.multiplierValues[f].fadeRemove(b-100),0===f&&(this.multiplierValues[f]=new MJQ_CastMemberNumber(mjq_gameObjects.multiplierValues),this.multiplierValues[f].move(mjq_scaledValue(c),d),this.multiplierValues[f].setXValue(a+1),this.multiplierValues[f].fadeShow(1,b),this.multiplierValues[f].name="multiplierValues"),this.multiplierValues[f].moveTo(mjq_scaledValue(c+(f+1)*e),d,b);for(var f=4;f>=0;f--)this.multiplierValues[f+1]=this.multiplierValues[f];for(var f=0;5>=f;f++)this.multiplierValues[f].value=a+f}}else a>this.multiplierValues[1].value?(this.multiplierValues[0]=this.multiplierValues[1],this.multiplierValues[0].fadeRemove(b-100),this.multiplierValues[0].moveTo(mjq_scaledValue(c),d,b),this.multiplierValues[1]=new MJQ_CastMemberNumber(mjq_gameObjects.multiplierValues),this.multiplierValues[1].move(mjq_scaledValue(c+5*e-20),d),this.multiplierValues[1].setXValue(a),this.multiplierValues[1].value=a,this.multiplierValues[1].fadeShow(1,b),this.multiplierValues[1].moveTo(mjq_scaledValue(c+2.5*e),d,b),this.multiplierValues[1].name="multiplierValues"):a<this.multiplierValues[1].value&&(this.multiplierValues[2]=this.multiplierValues[1],this.multiplierValues[2].fadeRemove(b-100),this.multiplierValues[2].moveTo(mjq_scaledValue(c+5*e),d,b),this.multiplierValues[1]=new MJQ_CastMemberNumber(mjq_gameObjects.multiplierValues),this.multiplierValues[1].move(mjq_scaledValue(c),d),this.multiplierValues[1].setXValue(a),this.multiplierValues[1].value=a,this.multiplierValues[1].fadeShow(1,b),this.multiplierValues[1].moveTo(mjq_scaledValue(c+2.5*e),d,b),this.multiplierValues[1].name="multiplierValues")},MJQ_MultiplierBar.prototype.createMultiplierValues=function(){if(void 0===this.multiplierValues[1]||null===this.multiplierValues[1]){for(var a=1;4>=a;a++)this.multiplierValues[a]=new MJQ_CastMemberNumber(mjq_gameObjects.multiplierValues),this.multiplierValues[a].name="multiplierValues";this.initMultiplierValues()}},MJQ_MultiplierBar.prototype.initMultiplierValues=function(){for(var a=0;4>=a;a++)if(null!==this.multiplierValues[a]&&void 0!==this.multiplierValues[a]){var b=this.timed?a:2.5;this.multiplierValues[a].move(mjq_scaledValue(mjq_gameObjects.multiplierValues.pos.x+b*mjq_gameObjects.multiplierValues.posspacing),this.multiplierValues[a].rect.y),this.multiplierValues[a].setXValue(a+mjq_game.multiplier),this.multiplierValues[a].value=a+mjq_game.multiplier}this.multiplierValues[5]=null},MJQ_MultiplierBar.prototype.unloadMultiplierObjects=function(){for(var a=0;6>a;a++)null!==this.multiplierValues[a]&&void 0!==this.multiplierValues[a]&&(this.multiplierValues[a].setCast(null),this.multiplierValues[a]=null)},MJQ_Progress.prototype.init=function(){var a=localStorage.mjq_data;if(void 0===a){var b={data:""};a=JSON.stringify(b),localStorage.setItem("mjq_data",JSON.stringify(b))}for(var c=JSON.parse(a),d=c.data.split(","),e=0,f=1;f<=mjq_gameScript.NUMLEVELS;f++)this.setLevelProgressData(this.northLevels[f],d[e],d[e+1]),e+=2,this.setLevelProgressData(this.southLevels[f],d[e],d[e+1]),e+=2,this.setLevelProgressData(this.eastLevels[f],d[e],d[e+1]),e+=2,this.setLevelProgressData(this.westLevels[f],d[e],d[e+1]),e+=2},MJQ_Progress.prototype.setLevelProgressData=function(a,b,c){b=void 0===b||""===b?0:parseInt(b),c=void 0===c||""===c?0:parseInt(c),a.score=b,a.coins=c},MJQ_Progress.prototype.calcNextLocation=function(a){for(var b=mjq_gameScript.NUMLEVELS+1,c=1;c<=mjq_gameScript.NUMLEVELS;c++)if(0===this.getLevelCoins(a,c)){b=c;break}return b},MJQ_Progress.prototype.getGameDataString=function(){for(var a="",b=this.northLevels,c=this.southLevels,d=this.eastLevels,e=this.westLevels,f=1;f<=mjq_gameScript.NUMLEVELS;f++)a+=b[f].score+",",a+=b[f].coins+",",a+=c[f].score+",",a+=c[f].coins+",",a+=d[f].score+",",a+=d[f].coins+",",a+=e[f].score+",",a+=e[f].coins+",",b[f].score===c[f].score&&b[f].score===d[f].score&&b[f].score===e[f].score&&0!==b[f].score&&void 0!==b[f].score&&mjq_debugOut("PROBLEM with Scoring in MJQ_Progress: getGameDataString");return a+="0"},MJQ_Progress.prototype.setGameData=function(){var a=this.getGameDataString(),b={data:a};localStorage.setItem("mjq_data",JSON.stringify(b))},MJQ_Progress.prototype.processGameResult=function(a,b,c,d){var e=null,f=!1;return b>=1&&b<=mjq_gameScript.NUMLEVELS&&("north"===a?e=this.northLevels[b]:"south"===a?e=this.southLevels[b]:"east"===a?e=this.eastLevels[b]:"west"===a&&(e=this.westLevels[b])),d>=e.coins&&(e.coins=d),c>e.score&&(e.score=c,f=!0),mjq_console.loggedIn()?mjq_console.setGameData():this.setGameData(),f},MJQ_Progress.prototype.getLevelScore=function(a,b){var c=0;return b>=1&&b<=mjq_gameScript.NUMLEVELS&&("north"===a?c=this.northLevels[b].score:"south"===a?c=this.southLevels[b].score:"east"===a?c=this.eastLevels[b].score:"west"===a&&(c=this.westLevels[b].score)),c},MJQ_Progress.prototype.getLevelCoins=function(a,b){var c=0;return b>=1&&b<=mjq_gameScript.NUMLEVELS&&("north"===a?c=this.northLevels[b].coins:"south"===a?c=this.southLevels[b].coins:"east"===a?c=this.eastLevels[b].coins:"west"===a&&(c=this.westLevels[b].coins)),c},MJQ_Progress.prototype.calcLocationScore=function(a){for(var b=0,c=1;c<=mjq_gameScript.NUMLEVELS;c++)b+=this.getLevelScore(a,c);return b},MJQ_Progress.prototype.calcLocationCoins=function(a){for(var b=0,c=1;c<=mjq_gameScript.NUMLEVELS;c++)b+=this.getLevelCoins(a,c);return b},MJQ_Progress.prototype.calcTotalScore=function(){var a=this.calcLocationScore("north")+this.calcLocationScore("south")+this.calcLocationScore("east")+this.calcLocationScore("west");return a},MJQ_Progress.prototype.calcTotalCoins=function(){var a=this.calcLocationCoins("north")+this.calcLocationCoins("south")+this.calcLocationCoins("east")+this.calcLocationCoins("west");return a},MJQ_Console.prototype.loggedIn=function(){return window.iConsole&&null!==this.user},MJQ_Console.prototype.init=function(){window.iConsole&&iConsole.game.ready().result(this.startGame,this)},MJQ_Console.prototype.advanceLoadingBar=function(a){if(!this.initialLoadingComplete){var b=Date.now();0===this.loadingNum&&(this.startTime=b),window.iConsole&&iConsole.game.loadProgress({progress:this.loadingPercentages[this.loadingNum],file:a}),this.loadingNum++}},MJQ_Console.prototype.loadingComplete=function(a,b,c){this.initialLoadingComplete||(this.initialLoadingComplete=!0,this.scriptToCall=a,this.scriptStateNext=b,this.scriptStateTime=c,window.iConsole?iConsole.game.loaded({success:!0}):this.startGame(null))},MJQ_Console.prototype.startGame=function(a){if(window.iConsole){var b=this;iConsole.game.onEvent("signedIn",function(a){(null===b.user||b.user.name!==a.user.name)&&(b.user=a.user,b.gameDataArrived=!1,b.getGameData(),b.scriptToCall.resetOnLogInOut(!0))}),iConsole.game.onEvent("signedOut",function(){b.user=null,b.scriptToCall.resetOnLogInOut(!1)}),this.user=a.user,this.getGameData()}this.scriptToCall.changeState(this.scriptStateNext,this.scriptStateTime)},MJQ_Console.prototype.getGameData=function(){window.iConsole&&iConsole.game.getGameData().result(this.processGameData,this)},MJQ_Console.prototype.processGameData=function(a){var b;if(null===a||void 0===a||"string"!=typeof a&&"object"!=typeof a){var c={data:""};a=JSON.stringify(c)}else"object"==typeof a&&(b=a);"string"==typeof a&&(b=JSON.parse(a));for(var d=b.data.split(","),e=0,f=1;f<=mjq_gameScript.NUMLEVELS;f++){var g=d[e];this.setLevelProgressData(this.progress.northLevels[f],d[e],d[e+1]),e+=2;var h=d[e];this.setLevelProgressData(this.progress.southLevels[f],d[e],d[e+1]),e+=2;var i=d[e];this.setLevelProgressData(this.progress.eastLevels[f],d[e],d[e+1]),e+=2;var j=d[e];this.setLevelProgressData(this.progress.westLevels[f],d[e],d[e+1]),e+=2,g===h&&g===i&&g===j&&0!==parseInt(g)&&void 0!==g&&mjq_debugOut("PROBLEM with Scoring in MJQ_Console: processGameData: a: "+g+", b: "+h+", c: "+i+", d: "+j)}this.gameDataArrived=!0},MJQ_Console.prototype.setLevelProgressData=function(a,b,c){b=void 0===b||""===b?0:parseInt(b),c=void 0===c||""===c?0:parseInt(c),a.score=b,a.coins=c},MJQ_Console.prototype.setGameData=function(){if(window.iConsole){var a=this.progress.getGameDataString();iConsole.game.setGameData({data:a})}},MJQ_Console.prototype.postHighScore=function(a,b,c,d){window.iConsole?iConsole.game.postHighScore({score:a}).result(function(){b.changeState(c,d)}):b.changeState(c,d)},MJQ_Console.prototype.showAd=function(a,b,c,d){window.iConsole?iConsole.ads.show({type:"levelStarted",level:a}).result(function(){b.changeState(c,d)}):b.changeState(c,d)},mjq_outputTileInfoToDebug=!1,MJQ_Tile.mjq_isSubclassOf(MJQ_CastMemberImage),MJQ_Tile.prototype.setImageFrame=function(){this.imageFrame=this.rank-1,this.imageRow=this.suit-1,5===this.suit?(this.imageRow=3,this.imageFrame+=4):6===this.suit?this.imageRow=4:7===this.suit?(this.imageRow=4,this.imageFrame+=4):8==this.suit&&(this.imageRow=5),this.value=9*this.imageRow+this.imageFrame},MJQ_Tile.prototype.getRank=function(){return this.rank},MJQ_Tile.prototype.getSuit=function(){return this.suit},MJQ_Tile.prototype.getValue=function(){return this.value},MJQ_Tile.prototype.setValue=function(a){this.value=a},MJQ_Tile.prototype.is=function(a,b){return a===this.rank&&b===this.suit},MJQ_Tile.prototype.doHideFace=function(a){return void 0===a?this.hideFace:void(this.hideFace!==a&&(this.hideFace=a,this.repaint()))},MJQ_Tile.prototype.setDark=function(a){return void 0===a?this.dark:void(this.dark!==a&&(this.dark=a,this.repaint()))},MJQ_Tile.prototype.setHilite=function(a,b){if(void 0===a)return this.hilite;void 0===b&&(b=!1);var c=this.hilite;this.hilite=a,this.hilite?(!c||b)&&this.repaint():(c||b)&&this.repaint()},MJQ_Tile.prototype.paint=function(a,b){if(this.hideFace)this.setImage(this.tileBlank,!1);else{var c=(this.imgHolder===this.tileBlank,!1);mjq_dimTilesOn&&this.dark?this.imgHolder!==this.tileFacesDark&&(this.setImage(this.tileFacesDark,!1),c=!0):this.hilite?this.imgHolder!==this.tileFacesSelected&&(this.setImage(this.tileFacesSelected,!1),c=!0):this.imgHolder!==this.tileFaces&&(this.setImage(this.tileFaces,!1),c=!0),c&&(this.setFrame(this.imageFrame,!1),this.setRow(this.imageRow,!1))}MJQ_CastMemberImage.prototype.paint.call(this,a,b)},MJQ_Tile.prototype.dragged=function(){return!0},MJQ_Tile.prototype.onMouseOver=function(a,b,c){if(!mjq_touchable){if(this.game.restarting)return void(null!==this.mouseOverObj&&void 0!==this.mouseOverObj&&this.mouseOverObj.hide());this.mouseOver=c,this.mouseOver?(mjq_outputTileInfoToDebug&&mjq_debugOut("MJQ_Tile Layer: "+this.layoutLayer+", Column: "+this.layoutPosX+", Row: "+this.layoutPosY+", Index: "+this.layoutIndex),this.playable&&null!==this.mouseOverObj&&mjq_tileMarkerOn&&(this.mouseOverObj.show(),this.mouseOverObj.move(this.rect.x+mjq_scaledValue(26),this.rect.y),this.mouseOverObj.setPriority(this.priority-1))):null!=this.mouseOverObj&&this.mouseOverObj.rect.x===this.rect.x+mjq_scaledValue(28)&&this.mouseOverObj.rect.y===this.rect.y&&this.mouseOverObj.hide(),null!=this.mouseOverObj&&this.mouseOverObj.repaint()}},MJQ_Tile.prototype.onMove=function(a,b,c){c&&this.onMouseDrag(a,b)},MJQ_Tile.prototype.onMouseDrag=function(){},MJQ_Tile.prototype.clicked=function(){return this.game.autoPlay&&!this.game.forceAutoPlay?!1:(this.clickSucceeded=!1,this.isPlayable()?(mjq_playSound("tileclick"),this.game.tileSelected(this),this.clickSucceeded=!0):mjq_playSound("badclick"),this.clickSucceeded)},MJQ_Tile.prototype.checkInputOverride=function(){return!1},MJQ_Tile.prototype.reset=function(){this.setReceiver(null),this.cueListener=null},MJQ_Tile.prototype.isPlayable=function(){return this.game.preventInput?!1:this.is(MJQ_WALL_RANK,MJQ_SPECIALS_SUIT)?this.checkLayerAbove():this.layoutPosX<=1||this.layoutPosX>=MJQ_LAYOUT_COLUMNS-2?this.checkLayerAbove():null===this.layout[this.layoutLayer][this.layoutPosX-1][this.layoutPosY]&&null===this.layout[this.layoutLayer][this.layoutPosX-1][this.layoutPosY+1]?this.checkLayerAbove():null===this.layout[this.layoutLayer][this.layoutPosX+2][this.layoutPosY]&&null===this.layout[this.layoutLayer][this.layoutPosX+2][this.layoutPosY+1]?this.checkLayerAbove():!1},MJQ_Tile.prototype.checkLayerAbove=function(){return this.layoutLayer===MJQ_LAYOUT_LAYERS-1?!0:null===this.layout[this.layoutLayer+1][this.layoutPosX][this.layoutPosY]&&null===this.layout[this.layoutLayer+1][this.layoutPosX+1][this.layoutPosY]&&null===this.layout[this.layoutLayer+1][this.layoutPosX][this.layoutPosY+1]&&null===this.layout[this.layoutLayer+1][this.layoutPosX+1][this.layoutPosY+1]},MJQ_Tile.prototype.removeFromLayout=function(){this.layout[this.layoutLayer][this.layoutPosX][this.layoutPosY]=null,this.layout[this.layoutLayer][this.layoutPosX+1][this.layoutPosY]=null,this.layout[this.layoutLayer][this.layoutPosX][this.layoutPosY+1]=null,this.layout[this.layoutLayer][this.layoutPosX+1][this.layoutPosY+1]=null},MJQ_Tile.prototype.undo=function(){this.layout[this.layoutLayer][this.layoutPosX][this.layoutPosY]=this,this.layout[this.layoutLayer][this.layoutPosX+1][this.layoutPosY]=this,this.layout[this.layoutLayer][this.layoutPosX][this.layoutPosY+1]=this,this.layout[this.layoutLayer][this.layoutPosX+1][this.layoutPosY+1]=this,this.game.multiplier=this.multiplierBeforePlayed,this.game.setScore(this.pointsBeforePlayed,!0),this.game.pointsFromMultiplier=this.pointsFromMultiplier,this.game.pointsFromTimer=this.pointsFromTimer,this.game.pointsFromBonusTimer=this.pointsFromBonusTimer,this.game.setScoreAmount(this.pointsBeforePlayed),this.game.setMultiplierValues(this.multiplierBeforePlayed),this.setPriority(1),this.setCueListener(this),this.setMoveCue(),this.moveTo(this.origX,this.origY,500,Tween.regularEaseOut)},MJQ_Tile.prototype.mjq_cue=function(){this.setPriority(this.origPriority),this.allowInput(!0)},MJQ_Tile.prototype.doBlinkHide=function(){this.doHideFace(!0)},MJQ_Tile.prototype.doBlinkShow=function(){this.doHideFace(!1)};var mjq_lastShuffledDeck=[],MJQ_BAMS_SUIT=1,MJQ_CRAKS_SUIT=2,MJQ_DOTS_SUIT=3,MJQ_DRAGONS_SUIT=4,MJQ_WINDS_SUIT=5,MJQ_SEASONS_SUIT=6,MJQ_FLOWERS_SUIT=7,MJQ_SPECIALS_SUIT=8,MJQ_BAMS_ROW=0,MJQ_CRAKS_ROW=1,MJQ_DOTS_ROW=2,MJQ_DRAGONS_ROW=3,MJQ_WINDS_ROW=3,MJQ_SEASONS_ROW=4,MJQ_FLOWERS_ROW=4,MJQ_SPECIALS_ROW=5,MJQ_BAMS_FRAME=0,MJQ_CRAKS_FRAME=0,MJQ_DOTS_FRAME=0,MJQ_DRAGONS_FRAME=0,MJQ_WINDS_FRAME=4,MJQ_SEASONS_FRAME=0,MJQ_FLOWERS_FRAME=4,MJQ_SPECIALS_FRAME=0,MJQ_YIN_RANK=1,MJQ_YANG_RANK=2,MJQ_WALL_RANK=3,MJQ_FIRECRACKER_RANK=4,MJQ_TIME_RANK=5,MJQ_WILD_RANK=6,MJQ_MULTIPLIER_RANK=7;MJQ_Deck.prototype.getSetting=function(a,b,c){var d=a[c];return void 0!==b[c]&&(d=b[c]),d},MJQ_Deck.prototype.createDeck=function(a,b){var c=(this.game.json,mjq_levels.level[0]),d=mjq_levels.level[b];mjq_game.seconds=this.getSetting(c,d,"time"),mjq_game.coins3=this.getSetting(c,d,"coins3"),mjq_game.coins2=this.getSetting(c,d,"coins2");var e=this.getSetting(c,d,"highestbamsrank"),f=this.getSetting(c,d,"highestcraksrank"),g=this.getSetting(c,d,"highestdotsrank"),h=this.getSetting(c,d,"bamcopies"),i=this.getSetting(c,d,"crakcopies"),j=(this.getSetting(c,d,"dotcopies"),this.getSetting(c,d,"dragoncopies")),k=this.getSetting(c,d,"windcopies"),l=this.getSetting(c,d,"seasoncopies"),m=this.getSetting(c,d,"flowercopies"),n=this.getSetting(c,d,"firecrackercopies"),o=this.getSetting(c,d,"timecopies"),p=this.getSetting(c,d,"wildcopies"),q=this.getSetting(c,d,"multipliercopies"),r=this.getSetting(c,d,"replaceseasonswith"),s=this.getSetting(c,d,"replaceflowerswith"),t=this.getSetting(c,d,"replacewindswith"),u=this.getSetting(c,d,"replacedragonswith"),v=this.getSetting(c,d,"timetoadd");o>0&&(o=this.calcMaxReplacements("time",o,r,s,t,u)),p>0&&(p=this.calcMaxReplacements("wild",p,r,s,t,u)),q>0&&(q=this.calcMaxReplacements("multiplier",q,r,s,t,u)),n>0&&(n=this.calcMaxReplacements("firecracker",n,r,s,t,u));var w=0,x=0;for(w=1;e>=w;w++)for(x=1;h>=x;x++)this.createTile(w,MJQ_BAMS_SUIT,x);for(w=1;f>=w;w++)for(x=1;i>=x;x++)this.createTile(w,MJQ_CRAKS_SUIT,x);for(w=1;g>=w;w++)for(x=1;h>=x;x++)this.createTile(w,MJQ_DOTS_SUIT,x);var y=!1,z=0;for(this.game.countAnchoredSpecialTiles(),w=1;3>=w;w++)for(x=1;j>=x;x++)y=!1,"time"===u?o>0&&(this.createTile(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT,z,v),y=!0,o--,z++):"wild"===u?p>0&&(this.createTile(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT,z),y=!0,p--,z++):"multiplier"===u?q>0&&(this.createTile(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT,z),y=!0,q--,z++):"firecracker"===u&&n>0&&(this.createTile(MJQ_FIRECRACKER_RANK,MJQ_SPECIALS_SUIT,z),y=!0,n--,z++),y||this.createTile(w,MJQ_DRAGONS_SUIT,x);for(z=0,w=1;4>=w;w++)for(x=1;k>=x;x++)y=!1,"time"===t?o>0&&(this.createTile(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT,z,v),y=!0,o--,z++):"wild"===t?p>0&&(this.createTile(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT,z),y=!0,p--,z++):"multiplier"===t?q>0&&(this.createTile(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT,z),y=!0,q--,z++):"firecracker"===t&&n>0&&(this.createTile(MJQ_FIRECRACKER_RANK,MJQ_SPECIALS_SUIT,z),y=!0,n--,z++),y||this.createTile(w,MJQ_WINDS_SUIT,x);for(z=0,w=1;4>=w;w++)for(x=1;l>=x;x++)y=!1,"time"===r?o>0&&(this.createTile(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT,z,v),y=!0,o--,z++):"wild"===r?p>0&&(this.createTile(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT,z),y=!0,p--,z++):"multiplier"===r?q>0&&(this.createTile(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT,z),y=!0,q--,z++):"firecracker"===r&&n>0&&(this.createTile(MJQ_FIRECRACKER_RANK,MJQ_SPECIALS_SUIT,z),y=!0,n--,z++),y||this.createTile(w,MJQ_SEASONS_SUIT,x);for(z=0,w=1;4>=w;w++)for(x=1;m>=x;x++)y=!1,"time"===s?o>0&&(this.createTile(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT,z,v),y=!0,o--,z++):"wild"===s?p>0&&(this.createTile(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT,z),y=!0,p--,z++):"multiplier"===s?q>0&&(this.createTile(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT,z),y=!0,q--,z++):"firecracker"===s&&n>0&&(this.createTile(MJQ_FIRECRACKER_RANK,MJQ_SPECIALS_SUIT,z),y=!0,n--,z++),y||this.createTile(w,MJQ_FLOWERS_SUIT,x);var A=this.game.numAnchoredYinTangTiles;for(x=1;A>=x;x++){var B=x%2===0?MJQ_YANG_RANK:MJQ_YIN_RANK;this.createTile(B,MJQ_SPECIALS_SUIT,x)}var C=this.game.numAnchoredWallTiles;for(x=1;C>=x;x++)this.createTile(MJQ_WALL_RANK,MJQ_SPECIALS_SUIT,x)},MJQ_Deck.prototype.createTile=function(a,b,c,d){var e=new MJQ_Tile(mjq_gameObjects.aTile,this.game,a,b,c,this.game.mouseOverObj,this.tileBlank,this.tileFaces,this.tileFacesSelected,this.tileFacesDark);e.doHideFace(!0),b===MJQ_SPECIALS_SUIT?a===MJQ_TIME_RANK?(void 0!==d&&(e.extraTime=d),this.anchoredTimeTiles.length<mjq_game.numAnchoredTimeTiles?this.anchoredTimeTiles.push(e):this.tiles.push(e)):a===MJQ_WILD_RANK?this.anchoredWildTiles.length<mjq_game.numAnchoredWildTiles?this.anchoredWildTiles.push(e):this.tiles.push(e):a===MJQ_MULTIPLIER_RANK?this.anchoredMultiplierTiles.length<mjq_game.numAnchoredMultiplierTiles?this.anchoredMultiplierTiles.push(e):this.tiles.push(e):a===MJQ_FIRECRACKER_RANK?this.anchoredFirecrackerTiles.length<mjq_game.numAnchoredFirecrackerTiles?this.anchoredFirecrackerTiles.push(e):this.tiles.push(e):a===MJQ_WALL_RANK?(e.doHideFace(!1),e.allowInput(!1),this.anchoredWallTiles.push(e)):(a===MJQ_YIN_RANK||a===MJQ_YANG_RANK)&&this.anchoredYinYangTiles.push(e):this.tiles.push(e)},MJQ_Deck.prototype.reset=function(){this.tiles.length=0,this.playedTiles.length=0,this.anchoredTimeTiles.length=0,this.anchoredWildTiles.length=0,this.anchoredMultiplierTiles.length=0,this.anchoredFirecrackerTiles.length=0,this.anchoredWallTiles.length=0,this.anchoredYinYangTiles.length=0;for(var a=null,b=0;b<mjq_lastShuffledDeck.length;b++)a=mjq_lastShuffledDeck[b],a.setCast(null);mjq_lastShuffledDeck.length=0},MJQ_Deck.prototype.shuffle=function(){var a=this.tiles.slice(),b=a.length;for(this.tiles.length=0;b>0;){var c=mjq_getRandomInt(0,b-1);c===b&&(c=b-1),this.tiles.push(a[c]),a.splice(c,1),b--}mjq_lastShuffledDeck=this.tiles.slice();for(var d=0;d<this.anchoredYinYangTiles.length;d++)mjq_lastShuffledDeck.push(this.anchoredYinYangTiles[d]);for(var d=0;d<this.anchoredWallTiles.length;d++)mjq_lastShuffledDeck.push(this.anchoredWallTiles[d]);for(var d=0;d<this.anchoredWildTiles.length;d++)mjq_lastShuffledDeck.push(this.anchoredWildTiles[d]);for(var d=0;d<this.anchoredMultiplierTiles.length;d++)mjq_lastShuffledDeck.push(this.anchoredMultiplierTiles[d]);for(var d=0;d<this.anchoredTimeTiles.length;d++)mjq_lastShuffledDeck.push(this.anchoredTimeTiles[d]);for(var d=0;d<this.anchoredFirecrackerTiles.length;d++)mjq_lastShuffledDeck.push(this.anchoredFirecrackerTiles[d])},MJQ_Deck.prototype.revealTileFaces=function(a){if(null!==mjq_lastShuffledDeck)for(var b=null,c=0;c<mjq_lastShuffledDeck.length;c++)b=mjq_lastShuffledDeck[c],"wall"!==b.sValue&&b.doHideFace(a)},MJQ_Deck.prototype.putTile=function(a,b){var c=500-this.playedTiles.length;null!==a&&(a.setPriority(c),this.playedTiles.push(a)),b.setPriority(c),this.playedTiles.push(b)},MJQ_Deck.prototype.getLastPlayedTile=function(a){var b=null;return this.playedTiles.length>0&&(b=this.playedTiles[this.playedTiles.length-1],a&&(this.playedTiles.length=this.playedTiles.length-1)),b},MJQ_Deck.prototype.hideAllPlayedTiles=function(){for(var a=0;a<this.playedTiles.length;a++)aTile=this.playedTiles[a].hide()},MJQ_Deck.prototype.getTileByValue=function(a){for(var b=null,c=0;c<this.tiles.length;c++)if(b=this.tiles[c],b.getSetting()===a)return b;return null},MJQ_Deck.prototype.getFirstTile=function(){var a=null;return this.tiles.length>=1&&(a=this.tiles[0],this.tiles.splice(0,1)),a},MJQ_Deck.prototype.getFirstYinYangTile=function(){var a=null;return this.anchoredYinYangTiles.length>=1&&(a=this.anchoredYinYangTiles[0],this.anchoredYinYangTiles.splice(0,1)),a},MJQ_Deck.prototype.getFirstWallTile=function(){var a=null;return this.anchoredWallTiles.length>=1&&(a=this.anchoredWallTiles[0],this.anchoredWallTiles.splice(0,1)),a},MJQ_Deck.prototype.getFirstWildTile=function(){var a=null;return this.anchoredWildTiles.length>=1&&(a=this.anchoredWildTiles[0],this.anchoredWildTiles.splice(0,1)),a},MJQ_Deck.prototype.getFirstMultiplierTile=function(){var a=null;return this.anchoredMultiplierTiles.length>=1&&(a=this.anchoredMultiplierTiles[0],this.anchoredMultiplierTiles.splice(0,1)),a},MJQ_Deck.prototype.getFirstTimeTile=function(){var a=null;return this.anchoredTimeTiles.length>=1&&(a=this.anchoredTimeTiles[0],this.anchoredTimeTiles.splice(0,1)),a},MJQ_Deck.prototype.getFirstFirecrackerTile=function(){var a=null;return this.anchoredFirecrackerTiles.length>=1&&(a=this.anchoredFirecrackerTiles[0],this.anchoredFirecrackerTiles.splice(0,1)),a},MJQ_Deck.prototype.undo=function(){var a=!1,b=!1,c=this.getLastPlayedTile(!0);if(null!==c){for(var d=0;d<this.game.timerBonusPointsList.length;){var e=this.game.timerBonusPointsList[d];if(e.specialCue>e.SPECIAL_CUE){e.setSpecialCue(e.SPECIAL_CUE);break}d++}b=c.is(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT),a=!0,c.undo(),c.extraTime>0&&c.extraTime>0&&mjq_gameScript.timer.addTime(0-c.extraTime)}var f=c.is(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT)||c.is(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT);if(!f&&(c=this.getLastPlayedTile(!0),null!==c&&(a=!0,c.undo(),b))){var g=c.rank,h=c.suit,i=null,j=c.moveNumID;if(g!==MJQ_WILD_RANK||h!==MJQ_SPECIALS_SUIT)for(;;){if(i=this.getLastPlayedTile(!1),null===i||i.moveNumID!==j)break;if(!(h===MJQ_FLOWERS_SUIT&&i.suit===MJQ_FLOWERS_SUIT||h===MJQ_SEASONS_SUIT&&i.suit===MJQ_SEASONS_SUIT||i.is(g,h)))break;i=this.getLastPlayedTile(!0),i.undo()}}return this.game.script.undoUsed=!0,this.game.previousMatchedTile=this.playedTiles.length>0?this.playedTiles[this.playedTiles.length-1]:null,a},MJQ_Deck.prototype.setEnabled=function(a){for(var b=null,c=0;c<mjq_lastShuffledDeck.length;c++)b=mjq_lastShuffledDeck[c],b.allowInput(a)},MJQ_Deck.prototype.calcMaxReplacements=function(a,b,c,d,e,f){return c===a?this.limitCopiesValue(b,"seasons"):d===a?this.limitCopiesValue(b,"flowers"):e===a?this.limitCopiesValue(b,"winds"):f===a?this.limitCopiesValue(b,"dragons"):0},MJQ_Deck.prototype.limitCopiesValue=function(a,b){return"seasons"===b||"flowers"===b?4:"winds"===b?4>=a?4:6>=a?6:8>=a?8:10>=a?10:12>=a?12:14>=a?14:16:"dragons"===b?4>=a?4:6>=a?6:8>=a?8:10>=a?10:12:0},document.ontouchmove=function(a){a.preventDefault()};var mjq_castForeground=null,mjq_castGameLayer=null,mjq_castBackground=null,mjq_fadeInStartTime=0,mjq_fadeOutStartTime=0,mjq_loadingLoop=null,mjq_randomGen=new MersenneTwister,mjq_seedAssigned=0,mjq_gameSeed=mjq_randomGen.getSeed(),mjq_iOS=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1,mjq_iOSVersion=0;mjq_iOS&&(mjq_iOSVersion=mjq_testiOSVersion());var mjq_browserName="",mjq_browserNumber=0;navigator.sayswho=function(){var a,b=navigator.userAgent,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(c[1])?(a=/\brv[ :]+(\d+)/g.exec(b)||[],mjq_browserName="IE",mjq_browserNumber=a[1],"IE "+(a[1]||"")):"Chrome"===c[1]&&(a=b.match(/\bOPR\/(\d+)/),null!=a)?(mjq_browserName="Opera",mjq_browserNumber=a[1],"Opera "+a[1]):(c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(a=b.match(/version\/(\d+)/i))&&c.splice(1,1,a[1]),mjq_browserName=c[0],mjq_browserNumber=c[1],c.join(" "))}();var mjq_browser=navigator.sayswho,mjq_ua=navigator.userAgent.toLowerCase(),mjq_usingChrome=mjq_ua.search("chrome")>=0,mjq_usingWindows=mjq_ua.search("windows")>=0,mjq_usingIE="IE"===mjq_browserName,mjq_usingIE12=mjq_usingIE&&mjq_browserNumber>=12,mjq_usingSafari=!mjq_usingChrome&&mjq_ua.search("safari")>=0,mjq_usingOpera=mjq_ua.search("opera")>=0,mjq_android=mjq_ua.search(/Android/i)>=0,mjq_forceMusicOff=mjq_iOS&&mjq_iOSVersion[0]<6||mjq_usingOpera&&22>mjq_browserNumber||mjq_usingSafari&&6>mjq_browserNumber,mjq_forceSoundOff=mjq_iOS&&mjq_iOSVersion[0]<6||mjq_usingIE&&!mjq_usingIE12||mjq_usingOpera&&22>mjq_browserNumber||mjq_usingSafari&&6>mjq_browserNumber,mjq_sessionID=0,mjq_loggedOut=!1,mjq_consecHeartbeats=0,mjq_gameLoaded=!1,mjq_gameNum=1,mjq_gameNumStr="1",MJQ_MAX_ACTIVITY_WIDTH=2048,MJQ_MAX_ACTIVITY_HEIGHT=1536,MJQ_ACTIVITY_WIDTH=0,MJQ_ACTIVITY_HEIGHT=0,MJQ_VENDOR=999,mjq_gameScript=null,mjq_game=null,mjq_pathsConfig=null,mjq_audioPath="",mjq_imagesPath="",mjq_layoutsPath="",mjq_levelsPath="",mjq_gameDefinitionsPath="",mjq_musicQualityModifier="",mjq_imageHolders=[];MJQ_Resources.prototype.processArtAssets=function(){mjq_console.advanceLoadingBar("Loading Images");var a=this;for(this.numImageResourcesToCreate=0,i=0;i<this.artAssets.length;i++){var b=this.artAssets[i];if(b.hasOwnProperty("spritesheet")){var c=new MJQ_Resource(this.path+b.assetname,this);for(this.resourcesList[b.keyname]=c,ss=0;ss<b.spritesheet.length;ss++)this.spriteSheetNames.push(b.keyname),this.imageHolderData.push(JSON.stringify(b.spritesheet[ss]));this.numImageResourcesToCreate++}else{var c=new MJQ_Resource(this.path+b.assetname,this);this.resourcesList[b.keyname]=c,this.numImageResourcesToCreate++}}this.loop=setInterval(function(){if(!isNaN(a.numImageResourcesLoaded)&&!isNaN(a.numImageResourcesToCreate)&&void 0!==a.numImageResourcesLoaded&&void 0!==a.numImageResourcesToCreate&&0!==a.numImageResourcesToCreate&&a.numImageResourcesLoaded===a.numImageResourcesToCreate&&!a.finished){a.finished=!0,a.createImages();for(var b=0;b<a.spriteSheetNames.length;b++)a.deleteResource(a.spriteSheetNames[b])}},50)},MJQ_Resources.prototype.resourceLoaded=function(){this.numImageResourcesLoaded++,mjq_console.advanceLoadingBar("Image #"+this.numImageResourcesLoaded+" Loaded")},MJQ_Resources.prototype.createImages=function(){for(var a=0;a<this.imageHolderData.length;a++){var b=this.imageHolderData[a],c=JSON&&JSON.parse(b),d=this.resourcesList[c.resourcename],e=c.width/c.frames,f=c.height/c.rows;void 0===mjq_imageHolders[c.imgname]&&(mjq_imageHolders[c.imgname]=d.createImage(c.imgname,c.frames,c.rows,c.x,c.y,e,f)),e%1!==0&&mjq_debugOut("WARNING: "+c.imgname+" has a width that is not evenly divisible by the number of frames"),f%1!==0&&mjq_debugOut("WARNING: "+c.imgname+" has a height that is not evenly divisible by the number of rows")}},MJQ_Resources.prototype.stopInterval=function(){clearInterval(this.loop)},MJQ_Resources.prototype.getImage=function(a){var b=null;return b=this.resourcesList[a].getImage(),void 0===b&&(b=null),b},MJQ_Resources.prototype.deleteResource=function(a){this.resourcesList[a]=null},MJQ_Resources.prototype.mjq_cue=function(a,b){"JSON"===b&&(this.assetsManifestLoaded=!0,this.artAssets=this.assetsManifestConfig.json.artassets,this.processArtAssets())};var MJQ_MAX_TILES=300,MJQ_MAX_WALL_TILES=100,MJQ_LAYOUT_LAYERS=8,MJQ_LAYOUT_COLUMNS=37,MJQ_LAYOUT_ROWS=18,MJQ_TILE_FACE_WIDTH=0,MJQ_TILE_FACE_HEIGHT=0,MJQ_TILE_SPACING=0,MJQ_LAYER_OFFSETX=0,MJQ_LAYER_OFFSETY=0,MJQ_MINITILE_FACE_WIDTH=0,MJQ_MINITILE_FACE_HEIGHT=0,MJQ_MINITILE_SPACING=0,MJQ_MINILAYER_OFFSETX=0,MJQ_MINILAYER_OFFSETY=0,MJQ_MULTIPLIER_BONUS_MULTIPLE=500;MJQ_MahjongGame.mjq_isSubclassOf(MJQ_Config),MJQ_MahjongGame.prototype.setScript=function(a){this.script=a},MJQ_MahjongGame.prototype.parseJSON=function(){this.rulesTextshub=this.json.rulestextshub,this.rulesImageshub=this.json.rulesimageshub,this.rulesTextsnorth=this.json.rulestextsnorth,this.rulesImagesnorth=this.json.rulesimagesnorth,this.rulesTextssouth=this.json.rulestextssouth,this.rulesImagessouth=this.json.rulesimagessouth,this.rulesTextseast=this.json.rulestextseast,this.rulesImageseast=this.json.rulesimageseast,this.rulesTextswest=this.json.rulestextswest,this.rulesImageswest=this.json.rulesimageswest,this.setPositions()},MJQ_MahjongGame.prototype.createMahjongObjects=function(a,b){this.loadedOK=!0,this.loadMahjongObjects(a,b)},MJQ_MahjongGame.prototype.reset=function(){this.finalBonusPoints=-1,this.prevHint=-1,this.prevHint2=-1,this.score=0,this.coins=0,this.coins3=15e4,this.coins2=1e5,this.tilesNotWon=0,this.selectedTile=null,this.previousMatchedTile=null,this.multiplier=1,this.setMultiplierValues(this.multiplier),this.setScore(0,!0),this.hintsLeft=this.NUM_HINTS,this.setGetHintsLeft(this.hintsLeft),this.numOpenTiles=999,this.preMatchedTiles.length=0,this.restarting=!1,this.timesUp=!1,this.timerBonusValue=0,this.autoPlay=!1,this.setNumMatchesOnTitleBar(-1),this.pointsFromMultiplier=0,this.pointsFromTimer=0,this.pointsFromBonusTimer=0,this.firecrackerTile=null,this.wallTile=null,this.wildTile=null,this.yinyangTile=null,this.preventInput=!1,this.wallTile=null,this.firecrackerSoundID=0},MJQ_MahjongGame.prototype.clearLayout=function(){for(var a=1;MJQ_LAYOUT_LAYERS>a;a++)for(var b=0;MJQ_LAYOUT_COLUMNS>b;b++)for(var c=0;MJQ_LAYOUT_ROWS>c;c++)this.layout[a][b][c]=null},MJQ_MahjongGame.prototype.setMiniLayout=function(){for(var a=0,b=0,c=0,d=0,e=0,f=0,g=0,h=1e4,i=1e4,j=99,k=99,l=(MJQ_MINITILE_FACE_WIDTH+MJQ_MINITILE_SPACING)/2,m=(MJQ_MINITILE_FACE_HEIGHT+MJQ_MINITILE_SPACING)/2,n=[],o=1;MJQ_MAX_TILES>o&&(a=this.layoutConfig.getInt2("v"+o),a!=this.NO_KEY);o++){a>=MJQ_LAYOUT_LAYERS&&mjq_debugOut("Layout entry "+o+" is set to LAYER "+a+". Layer numbers can be no larger than "+(MJQ_LAYOUT_LAYERS-1)),b=this.layoutConfig.getInt2("s"+o),c=this.layoutConfig.getIntFromArray("p"+o,0),d=this.layoutConfig.getIntFromArray("p"+o,1),c>=MJQ_LAYOUT_COLUMNS-1&&mjq_debugOut("Layout entry "+o+" is set to POSITION X "+c+". Position X numbers can be no larger than "+(MJQ_LAYOUT_COLUMNS-2)),d>=MJQ_LAYOUT_ROWS-1&&mjq_debugOut("Layout entry "+o+" is set to POSITION Y "+d+". Position Y numbers can be no larger than "+(MJQ_LAYOUT_ROWS-2)),j>c&&(j=c),k>d&&(k=d),e=1e3*(MJQ_LAYOUT_LAYERS-a+1),e+=10*(MJQ_LAYOUT_ROWS-d),e+=10*c;var p=c*l+(a-1)*MJQ_MINILAYER_OFFSETX,q=d*m+(a-1)*MJQ_MINILAYER_OFFSETY;n[o-1]={layer:a,posx:c,posy:d,pri:e,x:p,y:q,sValue:b},p>f&&(f=p),q>g&&(g=q),h>p&&(h=p),i>q&&(i=q)}n.sort(mjq_sortNumber);for(var o=n.length-1;o>=0;o--)n[o].posx-=j,n[o].posy-=k,n[o].x=(n[o].posx-1)*l+(n[o].layer-1)*MJQ_MINILAYER_OFFSETX,n[o].y=(n[o].posy-1)*m+(n[o].layer-1)*MJQ_MINILAYER_OFFSETY;var r=mjq_imageHolders.minitileblank.rows[0][0],s=mjq_imageHolders.minitilewall.rows[0][0],t=mjq_imageHolders.minitileyinyang.rows[0][0],u=(MJQ_LAYOUT_COLUMNS+2)/2*r.width,v=(MJQ_LAYOUT_ROWS+2)/2*r.height,w=(u-(f-h))/2,x=(v-(g-i))/2;this.previewLayout=document.createElement("canvas"),this.previewLayout.name="previewLayout",this.previewLayout.width=u,this.previewLayout.height=v;
var y=this.previewLayout.getContext("2d");y.strokeStyle="#FFFFFF";for(var z=null,o=n.length-1;o>=0;o--)z="wall"===n[o].sValue?s:"yinyang"===n[o].sValue?t:r,y.drawImage(z,n[o].x+w,n[o].y+x)},MJQ_MahjongGame.prototype.countAnchoredSpecialTiles=function(){this.numAnchoredWallTiles=0,this.numAnchoredYinTangTiles=0,this.numAnchoredTimeTiles=0,this.numAnchoredMultiplierTiles=0,this.numAnchoredFirecrackerTiles=0,this.numAnchoredWildTiles=0;for(var a="",b=1;MJQ_MAX_TILES>b&&!(b>144&&this.layoutConfig.getInt2("v"+b)===this.NO_KEY);b++)a=this.layoutConfig.getInt2("s"+b),"wall"===a?this.numAnchoredWallTiles++:"yinyang"===a?this.numAnchoredYinTangTiles++:"time"===a?this.numAnchoredTimeTiles++:"multiplier"===a?this.numAnchoredMultiplierTiles++:"firecracker"===a?this.numAnchoredFirecrackerTiles++:"wild"===a&&this.numAnchoredWildTiles++},MJQ_MahjongGame.prototype.setLayout=function(a){this.clearLayout();var b=0,c=0,d=1e4,e=1e4,f=99,g=99,h=0,i={x:0,y:0},j="",k=null,l=Math.floor((MJQ_TILE_FACE_WIDTH+MJQ_TILE_SPACING)/2),m=Math.floor((MJQ_TILE_FACE_HEIGHT+MJQ_TILE_SPACING)/2);l=Math.floor(l),m=Math.floor(m);for(var n=1;MJQ_MAX_TILES>n&&(h=this.layoutConfig.getInt2("v"+n),h!==this.NO_KEY);n++){i.x=this.layoutConfig.getIntFromArray("p"+n,0),i.y=this.layoutConfig.getIntFromArray("p"+n,1),j=this.layoutConfig.getInt2("s"+n),f>i.x&&(f=i.x),g>i.y&&(g=i.y),"yinyang"===j?k=this.deck.getFirstYinYangTile():"wall"===j?k=this.deck.getFirstWallTile():"multiplier"===j?k=this.deck.getFirstMultiplierTile():"wild"===j?k=this.deck.getFirstWildTile():"time"===j?k=this.deck.getFirstTimeTile():"firecracker"===j?k=this.deck.getFirstFirecrackerTile():(j="",k=this.deck.getFirstTile()),null===k&&(j="",k=this.deck.getFirstTile(),mjq_debugOut("NOTICE: The layout json file specified a tile that cannot be placed because the layout does not contain that type of tile. sValue is: "+j)),k.layoutLayer=h,k.layoutPosX=i.x,k.layoutPosY=i.y,k.layoutIndex=n,k.sValue=j,this.layout[h][k.layoutPosX][k.layoutPosY]=k,this.layout[h][k.layoutPosX+1][k.layoutPosY]=k,this.layout[h][k.layoutPosX][k.layoutPosY+1]=k,this.layout[h][k.layoutPosX+1][k.layoutPosY+1]=k;var o=1e3*(MJQ_LAYOUT_LAYERS-h+1);o+=10*(MJQ_LAYOUT_ROWS-k.layoutPosY),o+=10*k.layoutPosX,k.setPriority(o),k.origPriority=o,k.origX=k.layoutPosX*l+(h-1)*MJQ_LAYER_OFFSETX,k.origY=k.layoutPosY*m+(h-1)*MJQ_LAYER_OFFSETY,k.origX>b&&(b=k.origX),k.origY>c&&(c=k.origY),k.origX<d&&(d=k.origX),k.origY<e&&(e=k.origY)}this.centerLayout(b,c,d,e,f,g,l,m),this.animateLayout(a)},MJQ_MahjongGame.prototype.centerLayout=function(a,b,c,d,e,f,g,h){for(var i=!1,j=-(h/2),k=-(g/2),l=0,m=0,n=null,o=1;MJQ_LAYOUT_LAYERS>o;o++)for(var p=0;MJQ_LAYOUT_COLUMNS>p;p++)for(var q=0;MJQ_LAYOUT_ROWS>q;q++)n=this.layout[o][p][q],null!==n&&(i||(a=a-c+n.rect.width,b=b-d+n.rect.height,l=Math.floor((MJQ_ACTIVITY_WIDTH-a)/2),l-=e*g,l+=k,l=Math.floor(l),m=(MJQ_ACTIVITY_HEIGHT-b)/2,m-=f*h,m+=j,m=Math.floor(m),i=!0),n.positionAdjusted||(n.origX+=l,n.origY+=m,n.move(n.origX,n.origY),n.positionAdjusted=!0))},MJQ_MahjongGame.prototype.animateLayout=function(a){for(var b=null,c=1;MJQ_LAYOUT_LAYERS>c;c++)for(var d=0;MJQ_LAYOUT_COLUMNS>d;d++)for(var e=0;MJQ_LAYOUT_ROWS>e;e++)if(b=this.layout[c][d][e],null!==b&&!b.animatedIn){if(b.fadeShow(1,300),a){var f=mjq_getRandomInt(-60,60),g=mjq_getRandomInt(-60,60);b.move(b.origX+f,b.origY+g),b.moveTo(b.origX,b.origY,800,Tween.regularEaseInOut)}else b.move(b.origX,b.origY);b.allowInput(!0),b.animatedIn=!0}},MJQ_MahjongGame.prototype.addScore=function(a,b){return this.score+=a,this.setScoreAmount(this.score),!this.undoFlag&&this.score>this.prevScore&&0!==this.score&&!b&&mjq_playSound("tilesmatched"),this.prevScore=this.score,this.score},MJQ_MahjongGame.prototype.setScore=function(a,b){return this.score=a,this.setScoreAmount(this.score),!this.undoFlag&&this.score>this.prevScore&&0!==this.score&&!b&&mjq_playSound("point"),this.prevScore=this.score,this.score},MJQ_MahjongGame.prototype.setScoreAmount=function(a){this.scoreAmount.setNumber(a)},MJQ_MahjongGame.prototype.setMultiplierValues=function(a){this.script.multiplierBar.setMultiplierValues(a)},MJQ_MahjongGame.prototype.setGetHintsLeft=function(a){this.script.getHintsLeft.setText(""+a)},MJQ_MahjongGame.prototype.setPositions=function(){var a=this.json;MJQ_TILE_FACE_WIDTH=a.tilefacewidth[mjq_resolutionIndex],MJQ_TILE_FACE_HEIGHT=a.tilefaceheight[mjq_resolutionIndex],this.tile1X=Math.floor(MJQ_ACTIVITY_WIDTH/2-1.75*MJQ_TILE_FACE_WIDTH),this.tile1Y=MJQ_ACTIVITY_HEIGHT+MJQ_TILE_FACE_HEIGHT,this.tile2X=Math.floor(MJQ_ACTIVITY_WIDTH/2+.25*MJQ_TILE_FACE_WIDTH),this.tile2Y=this.tile1Y,MJQ_TILE_SPACING=a.tilespacing[mjq_resolutionIndex],MJQ_LAYER_OFFSETX=a.layeroffsetx[mjq_resolutionIndex],MJQ_LAYER_OFFSETY=a.layeroffsety[mjq_resolutionIndex],MJQ_MINITILE_FACE_WIDTH=a.minitilefacewidth[mjq_resolutionIndex],MJQ_MINITILE_FACE_HEIGHT=a.minitilefaceheight[mjq_resolutionIndex],MJQ_MINITILE_SPACING=a.minitilespacing[mjq_resolutionIndex],MJQ_MINILAYER_OFFSETX=a.minilayeroffsetx[mjq_resolutionIndex],MJQ_MINILAYER_OFFSETY=a.minilayeroffsety[mjq_resolutionIndex]},MJQ_MahjongGame.prototype.loadMahjongObjects=function(a,b){this.currentLayout=1;this.script.castBackground;null===this.mouseOverObj&&(this.mouseOverObj=new MJQ_CastMemberImage(mjq_gameObjects.mouseOverObj)),this.script.multiplierBar.createMultiplierValues(),this.hintsLeft=this.NUM_HINTS,this.setGetHintsLeft(this.hintsLeft),null===this.scoreAmount&&(this.scoreAmount=new MJQ_CastMemberNumber(mjq_gameObjects.scoreAmount),this.scoreAmount.name="scoreAmount"),this.deck=new MJQ_Deck(this,this.script.castGameLayer,a,b),this.loadingComplete=!0},MJQ_MahjongGame.prototype.unloadMahjongObjects=function(){this.mouseOverObj.setCast(null),this.script.multiplierBar.unloadMultiplierObjects(),this.scoreAmount.setCast(null),this.mouseOverObj=null,this.scoreAmount=null},MJQ_MahjongGame.prototype.loadLayoutConfig=function(){this.doCommonLoadLayoutCode()},MJQ_MahjongGame.prototype.loadPreviewLayoutConfig=function(a){this.currentLayout=a,this.doCommonLoadLayoutCode()},MJQ_MahjongGame.prototype.doCommonLoadLayoutCode=function(){this.layoutLoaded=!1;var a=mjq_layoutsPath+mjq_levels.level[this.currentLayout].layout+".json?v="+MJQ_VERSION_TEXT;this.layoutConfig=new MJQ_Config,this.layoutConfig.init(a,this)},MJQ_MahjongGame.prototype.getScore=function(){return this.score},MJQ_MahjongGame.prototype.moveMatchedTileDown=function(a,b,c,d,e,f){void 0===d&&(d=0);var g=0;this.autoPlay||(void 0!==e&&e?g=0-mjq_scaledValue(350):void 0!==f&&f&&(g=mjq_scaledValue(570))),a.setCueListener(this),a.setMoveCue(),a.allowInput(!1);var h=[b+g,a.rect.y-200];a.moveTo(b+g,c,800+d,Tween.regularEaseInOut,h),a.pointsBeforePlayed=this.score,a.pointsFromMultiplier=this.pointsFromMultiplier,a.pointsFromTimer=this.pointsFromTimer,a.pointsFromBonusTimer=this.pointsFromBonusTimer,a.multiplierBeforePlayed=this.multiplier,a.playable=!1,a.onMouseOver(0,0,!1),a.moveNumID=this.script.numMoves,this.deck.putTile(null,a)},MJQ_MahjongGame.prototype.tileSelected=function(a,b,c){void 0===b&&(b=!1),void 0===c&&(c=!1);var d=c===!0||a.is(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT)||a.is(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT),e=a.is(MJQ_FIRECRACKER_RANK,MJQ_SPECIALS_SUIT),f=a.is(MJQ_WALL_RANK,MJQ_SPECIALS_SUIT),g=a.is(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT),h=(a.is(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT),a.is(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT));if(d){null!==this.selectedTile&&(this.selectedTile.setHilite(!1),this.handleFirecrackerLit(!1,this.selectedTile),this.handleWildTileAnimation(!1,this.selectedTile),this.handleYinyangTileAnimation(!1,this.selectedTile),this.selectedTile=null),a.removeFromLayout(),this.autoPlay||(h?mjq_playSound("multiplierincrease"):g&&mjq_playSound("timerincrease"));var i=this.tile1X,j=this.tile1Y;this.moveMatchedTileDown(a,i,j,0,h,g);var k=2*this.POINTS_PER_TILE,l=(this.multiplier+this.script.multiplierBar.getExtraValue())*k;this.pointsFromMultiplier+=l,this.addScore(l,!1),this.autoPlay||(a.extraTime>0&&mjq_gameScript.timer.addTime(a.extraTime),a.is(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT)&&this.multiplier++),this.setMultiplierValues(this.multiplier),this.awardTimerBonus(!1),this.popupPoints(a),this.tilesWerePlayed(),this.checkForAutoPlay(!1),this.autoPlay||this.script.undoButton.show(),this.previousMatchedTile=a,this.selectedTile=null}else if(null===this.selectedTile)this.selectedTile=a,this.selectedTile.setHilite(!0),this.handleFirecrackerLit(!0,a),this.handleWildTileAnimation(!0,a),this.handleYinyangTileAnimation(!0,a);else if(this.selectedTile===a)this.selectedTile.setHilite(!1),this.selectedTile=null,this.handleFirecrackerLit(!1),this.handleWildTileAnimation(!1),this.handleYinyangTileAnimation(!1);else if(!this.autoPlay&&f&&null!==this.firecrackerLitObj)this.preventInput=!0,this.wallTile=a,this.firecrackerLitObj.setPriority(10),this.firecrackerLitObj.setCueListener(this),this.firecrackerLitObj.setMoveCue(),this.firecrackerLitObj.moveTo(a.rect.x,a.rect.y,500,Tween.regularEaseInOut,null),mjq_stopSound(this.firecrackerSoundID),this.firecrackerSoundID=0,mjq_playSound("firecrackerflyover"),this.firecrackerTile.setPriority(11),this.firecrackerTile.moveTo(a.rect.x,a.rect.y,500,Tween.regularEaseInOut,null);else if(e&&!this.autoPlay||!b&&!this.tilesMatch(this.selectedTile,a))this.selectedTile.setHilite(!1),this.selectedTile=a,this.selectedTile.setHilite(!0),this.handleFirecrackerLit(!0,this.selectedTile),this.handleWildTileAnimation(!0,this.selectedTile),this.handleYinyangTileAnimation(!0,this.selectedTile);else{var m=this.selectedTile.is(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT),n=a.is(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT),o=m&&!n||n&&!m;this.selectedTile.setHilite(!1),this.handleFirecrackerLit(!1),this.handleWildTileAnimation(!1),this.handleYinyangTileAnimation(!1);var p=this.selectedTile.getX()<a.getX();this.selectedTile.getX()===a.getX()&&(p=this.selectedTile.getY()<a.getY());var i=p?this.tile1X:this.tile2X,q=p?this.tile2X:this.tile1X,j=p?this.tile1Y:this.tile2Y,r=p?this.tile2Y:this.tile1Y,s=[],t=0;if(o&&!this.autoPlay){mjq_playSound("wildtilematched");var u=0,v=0;m?(u=a.rank,v=a.suit):(u=this.selectedTile.rank,v=this.selectedTile.suit);for(var w=-200,x=null;;){if(x=this.findRankAndSuit(u,v),null===x)break;x.removeFromLayout(),this.moveMatchedTileDown(x,q,r,w),t++,w+=130,s.push(x)}m?(this.selectedTile.removeFromLayout(),this.moveMatchedTileDown(this.selectedTile,i,j,w),s.push(this.selectedTile)):(a.removeFromLayout(),this.moveMatchedTileDown(a,i,j,w),s.push(a)),t++}else this.selectedTile.removeFromLayout(),a.removeFromLayout(),this.moveMatchedTileDown(this.selectedTile,i,j),this.moveMatchedTileDown(a,q,r),s.push(this.selectedTile),s.push(a),m&&n&&mjq_playSound("wildtilematched"),t=2;var k=this.POINTS_PER_TILE*t,l=(this.multiplier+this.script.multiplierBar.getExtraValue())*k;for(this.pointsFromMultiplier+=l,this.addScore(l,!1),this.setMultiplierValues(this.multiplier);s.length>0;){var y=s.pop();this.popupPoints(y)}this.awardTimerBonus(!1),this.tilesWerePlayed();var z=a.is(MJQ_YIN_RANK,MJQ_SPECIALS_SUIT)||a.is(MJQ_YANG_RANK,MJQ_SPECIALS_SUIT);z&&mjq_playSound("yinyangmatched"),this.checkForAutoPlay(z),this.autoPlay||this.script.undoButton.show(),this.previousMatchedTile=this.selectedTile,this.selectedTile=null}},MJQ_MahjongGame.prototype.handleYinyangTileAnimation=function(a,b){return a&&(b.is(MJQ_YIN_RANK,MJQ_SPECIALS_SUIT)||b.is(MJQ_YANG_RANK,MJQ_SPECIALS_SUIT))?(null===this.yinyangTileAnimation&&(this.yinyangTileAnimation=new MJQ_CastMemberImage(mjq_gameObjects.yinyangHilite),mjq_playSound("yinyangmatched")),this.yinyangTileAnimation.setPriority(b.priority-100),this.yinyangTileAnimation.move(b.rect.x,b.rect.y-mjq_scaledValue(15)),this.yinyangTileAnimation.cycleStart(25),void(this.yinyangTile=b)):void(null!==this.yinyangTileAnimation&&(this.yinyangTileAnimation.setCast(null),this.yinyangTileAnimation=null))},MJQ_MahjongGame.prototype.handleWildTileAnimation=function(a,b){return a&&b.is(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT)?(null===this.wildTileAnimation&&(this.wildTileAnimation=new MJQ_CastMemberImage(mjq_gameObjects.wildHilite),this.autoPlay||mjq_playSound("wildTileSelected")),this.wildTileAnimation.setPriority(b.priority-100),this.wildTileAnimation.move(b.rect.x,b.rect.y-mjq_scaledValue(15)),this.wildTileAnimation.cycleStart(25),void(this.wildTile=b)):void(null!==this.wildTileAnimation&&(this.wildTileAnimation.setCast(null),this.wildTileAnimation=null))},MJQ_MahjongGame.prototype.handleFirecrackerLit=function(a,b){return a&&b.is(MJQ_FIRECRACKER_RANK,MJQ_SPECIALS_SUIT)?(null===this.firecrackerLitObj&&(this.firecrackerLitObj=new MJQ_CastMemberImage(mjq_gameObjects.firecrackerLit),this.firecrackerSoundID=mjq_playSound("firecrackerlit",!0)),this.firecrackerLitObj.setPriority(b.priority-100),this.firecrackerLitObj.move(b.rect.x,b.rect.y),this.firecrackerLitObj.cycleStart(100),void(this.firecrackerTile=b)):void(null!==this.firecrackerLitObj&&(this.firecrackerLitObj.setCast(null),this.firecrackerLitObj=null,mjq_stopSound(this.firecrackerSoundID),this.firecrackerSoundID=0))},MJQ_MahjongGame.prototype.tilesMatch=function(a,b){var c=!1;if(null!==a&&null!==b){var d=a.is(MJQ_FIRECRACKER_RANK,MJQ_SPECIALS_SUIT)||b.is(MJQ_FIRECRACKER_RANK,MJQ_SPECIALS_SUIT),e=a.is(MJQ_WALL_RANK,MJQ_SPECIALS_SUIT)||b.is(MJQ_WALL_RANK,MJQ_SPECIALS_SUIT),f=a.is(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT),g=b.is(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT);f&&g?c=!0:f&&b.suit!==MJQ_SPECIALS_SUIT||g&&a.suit!==MJQ_SPECIALS_SUIT?c=!0:d&&e?c=!0:d&&!e||!d&&e?c=!1:a.suit===b.suit&&(c="yinyang"===a.sValue&&"yinyang"===b.sValue||a.suit===MJQ_SEASONS_SUIT||b.suit===MJQ_FLOWERS_SUIT||a.rank===b.rank)}return c},MJQ_MahjongGame.prototype.getHint=function(){for(var a=this.preMatchedTiles,b=this.countNumSingularTiles(this.preMatchedTiles),c=this.preMatchedTiles.length-b,d=c/2+b,e=[],f=[],g=[],h=!1,i=null,j=0;j<this.preMatchedTiles.length;j++)i=this.preMatchedTiles[j],h=i.is(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT)||i.is(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT),h?e.push(i):(i.is(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT)||(e.push(i),e.push(this.preMatchedTiles[j+1])),j++);if(d>=1){var k=-1;if(null!==this.selectedTile)for(var j=0;j<e.length;j++)if(this.selectedTile===e[j]){var l=e[j-1];if(void 0!==l&&this.tilesMatch(this.selectedTile,l))k=j,this.prevHint2=j-1,a=e;else{var m=e[j+1];void 0!==m&&this.tilesMatch(this.selectedTile,m)&&(k=j,this.prevHint2=j+1,a=e)}break}if(-1===k){for(var n=null,o=null,j=0;j<this.preMatchedTiles.length;j++)if(n=this.preMatchedTiles[j],n.is(MJQ_YIN_RANK,MJQ_SPECIALS_SUIT)||n.is(MJQ_YANG_RANK,MJQ_SPECIALS_SUIT)){if(this.prevHint!==j&&this.prevHint!==j+1){k=j;break}j++}if(-1===k&&(mjq_gameScript.timer.getMinutes()<1||1===mjq_getRandomInt(1,7))){for(var j=0;j<this.preMatchedTiles.length;j++)i=this.preMatchedTiles[j],i.is(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT)&&f.push(i);if(f.length>0)for(var p=10;p>0;){if(k=mjq_getRandomInt(0,f.length-1),this.prevHint!==k){a=f;break}p--,0===p&&(k=-1)}}if(-1===k&&1===mjq_getRandomInt(1,5)){for(var j=0;j<this.preMatchedTiles.length;j++)i=this.preMatchedTiles[j],i.is(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT)&&g.push(i);if(g.length>0)for(var p=10;p>0;){if(k=mjq_getRandomInt(0,g.length-1),this.prevHint!==k){a=g;break}p--,0===p&&(k=-1)}}if(-1===k){if(e.length>0)for(var p=10;p>0;){if(k=mjq_getRandomInt(0,e.length-1),k!==this.prevHint&&k!==this.prevHint2){a=e;break}p--,0===p&&(k=-1)}if(-1===k)for(var j=0;j<this.preMatchedTiles.length;j++)if(this.selectedTile===this.preMatchedTiles[j]){var l=this.preMatchedTiles[j-1];if(void 0!==l&&this.tilesMatch(this.selectedTile,l))k=j,this.prevHint2=j-1;else{var m=this.preMatchedTiles[j+1];void 0!==m&&this.tilesMatch(this.selectedTile,m)&&(k=j,this.prevHint2=j+1)}break}if(-1===k){a=this.preMatchedTiles;for(var p=10;p>0&&(k=mjq_getRandomInt(0,this.preMatchedTiles.length-1),k===this.prevHint||k===this.prevHint2);)p--}}}if(this.prevHint=k,n=a[k],!n.is(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT)&&!n.is(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT)){o=a[k+1],this.prevHint2=k+1,(void 0===o||o.is(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT)||o.is(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT)||!this.tilesMatch(n,o))&&(o=a[k-1],this.prevHint2=k-1);{this.tilesMatch(n,o)}}n.doBlink(130,130,6,!1),null!==o&&o.doBlink(130,130,6,!1)}},MJQ_MahjongGame.prototype.showOnlyPlayableTiles=function(a){this.setPlayable(!0),this.gameInProgress&&(0===this.numPlayableTiles||!a&&0===this.preMatchedTiles.length)&&(this.script.changeState(MJQ_STATE_END_LAYOUT,1600),this.gameInProgress=!1)},MJQ_MahjongGame.prototype.setPlayable=function(a){void 0===a&&(a=!1);for(var b=0,c=null,d=1;MJQ_LAYOUT_LAYERS>d;d++)for(var e=0;MJQ_LAYOUT_COLUMNS>e;e++)for(var f=0;MJQ_LAYOUT_ROWS>f;f++)c=this.layout[d][e][f],null!==c&&(f++,c.playable=!1,c.isPlayable()?(c.playable=!0,b++,a&&c.setDark(!1)):mjq_dimTilesOn?a&&c.setDark(!0):c.setDark(!1),c.isPlayable()||(this.wildTile===c&&null!==this.wildTileAnimation&&(this.wildTileAnimation.setCast(null),this.wildTileAnimation=null,this.wildTile=null),this.yinyangTile===c&&null!==this.yinyangTileAnimation&&(this.yinyangTileAnimation.setCast(null),this.yinyangTileAnimation=null,this.yinyangTile=null),this.firecrackerTile===c&&null!==this.firecrackerLitObj&&(this.firecrackerLitObj.setCast(null),this.firecrackerLitObj=null,this.firecrackerTile=null)));this.getNumMatches(),this.numPlayableTiles=b},MJQ_MahjongGame.prototype.getNumMatches=function(){this.preMatchedTiles.length=0;for(var a=[],b=0,c=null,d=0;d<mjq_lastShuffledDeck.length;d++)c=mjq_lastShuffledDeck[d],c.playable&&a.push(c);this.numOpenTiles=a.length;for(var e=null,f=!1,d=0;d<a.length;d++){c=a[d];var g=c.is(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT);if(f=c.is(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT)||c.is(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT)||1===a.length&&g)this.preMatchedTiles.push(c),c.numInMatch=1,b++;else for(var h=d+1;h<a.length;h++)if(e=a[h],this.tilesMatch(c,e)){var i=e.is(MJQ_WILD_RANK,MJQ_SPECIALS_SUIT);i?(this.preMatchedTiles.push(e),this.preMatchedTiles.push(c)):(this.preMatchedTiles.push(c),this.preMatchedTiles.push(e)),c.numInMatch=2,e.numInMatch=2,b++}}return this.setNumMatchesOnTitleBar(b),b},MJQ_MahjongGame.prototype.noBlockedTiles=function(){for(var a=0,b=null,c=0;c<mjq_lastShuffledDeck.length;c++)b=mjq_lastShuffledDeck[c],b.playable&&a++;if(a>0){var d=a===mjq_lastShuffledDeck.length-this.deck.playedTiles.length-this.numAnchoredWallTiles;return d}return!1},MJQ_MahjongGame.prototype.findRankAndSuit=function(a,b){for(var c=null,d=1;MJQ_LAYOUT_LAYERS>d;d++)for(var e=0;MJQ_LAYOUT_COLUMNS>e;e++)for(var f=0;MJQ_LAYOUT_ROWS>f;f++)if(c=this.layout[d][e][f],null!==c&&(b===MJQ_FLOWERS_SUIT&&c.suit===MJQ_FLOWERS_SUIT||b===MJQ_SEASONS_SUIT&&c.suit===MJQ_SEASONS_SUIT||c.is(a,b)))return c;return null},MJQ_MahjongGame.prototype.flyAway=function(){null!==this.wildTileAnimation&&(this.wildTileAnimation.setCast(null),this.wildTileAnimation=null),null!==this.yinyangTileAnimation&&(this.yinyangTileAnimation.setCast(null),this.yinyangTileAnimation=null),null!==this.firecrackerLitObj&&(this.firecrackerLitObj.setCast(null),this.firecrackerLitObj=null);for(var a=!1,b=null,c=1;MJQ_LAYOUT_LAYERS>c;c++)for(var d=0;MJQ_LAYOUT_COLUMNS>d;d++)for(var e=0;MJQ_LAYOUT_ROWS>e;e++)if(b=this.layout[c][d][e],null!==b&&!b.moving)if(this.script.mustReset)b.setCast(null);else{a=!0,b.cueListener=this,b.moveCue=!0;var f=b.rect.x,g=b.rect.y;b.moveTo(mjq_getRandomInt(f-60,f+60),mjq_getRandomInt(g-60,g+60),mjq_getRandomInt(500,1e3),Tween.regularEaseInOut)}return a&&mjq_playSound("layoutflyaway"),a},MJQ_MahjongGame.prototype.handleTimesUp=function(){this.timesUp=!0,this.script.changeState(MJQ_STATE_END_LAYOUT,1),this.gameInProgress=!1},MJQ_MahjongGame.prototype.awardTimerBonus=function(a){if(mjq_levels.timed){if(0===this.seconds)return;var b=this.script.timer;this.timerBonusValue=1e3*b.getMinutes()+10*b.getSeconds()+b.getTenths();var c=0;if(a?(this.finalBonusPoints=10*this.timerBonusValue,c=this.finalBonusPoints,this.pointsFromBonusTimer=c):(this.timerBonusValue=Math.floor(this.timerBonusValue/10),c=this.timerBonusValue,this.pointsFromTimer+=c),c>0){var d=new MJQ_CastMemberText(mjq_gameObjects.timerBonusPoints);this.timerBonusPointsList.push(d),d.setText("+"+c),d.setCueListener(this),d.setSpecialCue(d.SPECIAL_CUE+c);var e=this.scoreAmount.rect.x,f=this.scoreAmount.rect.y,g=this.script.timer.rect.x-Math.floor(this.script.timer.rect.width/2),h=this.script.timer.rect.y-Math.floor(this.script.timer.rect.height/4),i=[g+mjq_scaledValue(50),h-mjq_scaledValue(60),e+mjq_scaledValue(30),f-mjq_scaledValue(60)],j=a?1600:1200;d.move(g+mjq_scaledValue(50),h-mjq_scaledValue(30)),d.moveTo(e+mjq_scaledValue(20),f-mjq_scaledValue(40),j,Tween.regularEaseInOut,i),a&&mjq_playSound("bonusscore")}}},MJQ_MahjongGame.prototype.awardMultiplierBonus=function(){var a=this.multiplier*MJQ_MULTIPLIER_BONUS_MULTIPLE;this.pointsFromBonusTimer=a;var b=new MJQ_CastMemberText(mjq_gameObjects.timerBonusPoints);b.name="multiplierBonusPoints",b.setText("+"+a),b.setCueListener(this),b.setSpecialCue(b.SPECIAL_CUE+a);var c=this.scoreAmount.rect.x,d=this.scoreAmount.rect.y,e=this.script.multiplierBarOverlay.rect.x+Math.floor(this.script.multiplierBarOverlay.rect.width/4),f=this.script.multiplierBarOverlay.rect.y-Math.floor(this.script.multiplierBarOverlay.rect.height/4),g=[e+mjq_scaledValue(50),f-mjq_scaledValue(60),c+mjq_scaledValue(30),d-mjq_scaledValue(60)],h=1600;b.move(e+mjq_scaledValue(50),f-mjq_scaledValue(30)),b.moveTo(c+mjq_scaledValue(20),d-mjq_scaledValue(40),h,Tween.regularEaseInOut,g),mjq_playSound("bonusscore")},MJQ_MahjongGame.prototype.setNumMatchesOnTitleBar=function(a){this.script.titleLabel.setText(-1===a?this.layoutName:this.layoutName+" - "+a+(1===a?" Match":" Matches"))},MJQ_MahjongGame.prototype.popupPoints=function(a,b){void 0===b&&(b=1);var c=new MJQ_CastMemberText(mjq_gameObjects.timerBonusPoints);c.setText("+"+(this.multiplier+this.script.multiplierBar.getExtraValue())*this.POINTS_PER_TILE*b),c.move(a.getX()+mjq_scaledValue(25),a.getY()),c.setCueListener(this),c.setMoveCue(),c.moveTo(a.getX()+mjq_scaledValue(25),a.getY()-mjq_scaledValue(30),900)},MJQ_MahjongGame.prototype.mjq_cue=function(a,b){if("JSON"===b)this.layoutLoaded=!0,this.layoutName=this.layoutConfig.getString("layoutname");else if(b===a.MOVE_CUE)"MJQ_Tile"===a.name?this.restarting?a.setCast(null):a.moveTo(a.getX()-2,a.getY()+2,300):"timerBonusPoints"===a.name?a.setCast(null):a===this.firecrackerLitObj?(this.firecrackerTile.setPriority(this.wallTile.priority-1),this.firecrackerLitObj.setCast(null),this.firecrackerLitObj=null,this.firecrackerExplodeObj=new MJQ_CastMemberImage(mjq_gameObjects.firecrackerExplode),this.firecrackerExplodeObj.setPriority(this.wallTile.priority-2),this.firecrackerExplodeObj.move(this.wallTile.rect.x,this.wallTile.rect.y),this.firecrackerExplodeObj.setCueListener(this),this.firecrackerExplodeObj.setCycleCue(),this.firecrackerExplodeObj.cycleStart(100,1,MJQ_CastMember.CYCLE_FORWARD,99),mjq_playSound("wallexplode")):a.hide();else if(b===a.CYCLE_CUE){if(a===this.firecrackerExplodeObj){null!==this.selectedTile&&this.selectedTile.setHilite(!1);var c=this.tile1X,d=this.tile2X,e=this.tile1Y,f=this.tile2Y;this.firecrackerTile.removeFromLayout(),this.firecrackerTile.playable=!1,this.firecrackerTile.moveNumID=this.script.numMoves,this.firecrackerTile.pointsBeforePlayed=this.score,this.wallTile.removeFromLayout(),this.wallTile.playable=!1,this.wallTile.moveNumID=this.script.numMoves,this.wallTile.pointsBeforePlayed=this.score,this.deck.putTile(this.firecrackerTile,this.wallTile),this.firecrackerExplodeObj.setCast(null),this.firecrackerExplodeObj=null,this.preventInput=!1;var g=2*this.POINTS_PER_TILE,h=(this.multiplier+this.script.multiplierBar.getExtraValue())*g;this.pointsFromMultiplier+=h,this.addScore(h,!1),this.setMultiplierValues(this.multiplier),this.awardTimerBonus(!1),this.popupPoints(this.firecrackerTile,2),this.tilesWerePlayed(),this.firecrackerTile.move(c,e),this.wallTile.move(d,f),this.checkForAutoPlay(!1),this.autoPlay||this.script.undoButton.show(),this.previousMatchedTile=this.selectedTile,this.selectedTile=null}}else if(b>=a.SPECIAL_CUE){var i=b-a.SPECIAL_CUE;this.addScore(i,!0),a.setCast(null),"timerBonusPoints"===a.name&&this.timerBonusPointsList.shift()}},MJQ_MahjongGame.prototype.countNumSingularTiles=function(a){for(var b=0,c=null,d=0;d<a.length;d++)c=a[d],(c.is(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT)||c.is(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT))&&b++;return b},MJQ_MahjongGame.prototype.autoPlayAnyOpenTiles=function(){for(var a=[],b=null,c=null,d=0;d<mjq_lastShuffledDeck.length;d++)b=mjq_lastShuffledDeck[d],b.playable&&a.push(b);this.numOpenTiles=a.length,b=a[0],this.tileSelected(b,!0,1===this.numOpenTiles),this.numOpenTiles>1&&(c=a[1],this.tileSelected(c,!0,!1)),this.multiplier++,this.setMultiplierValues(this.multiplier)},MJQ_MahjongGame.prototype.autoPlayAMatch=function(){var a=this.countNumSingularTiles(this.preMatchedTiles),b=this.preMatchedTiles.length-a,c=b/2+a;if(c>=1){var d=-1,e=null,f=null;d=0,e=this.preMatchedTiles[d],e.is(MJQ_TIME_RANK,MJQ_SPECIALS_SUIT)||e.is(MJQ_MULTIPLIER_RANK,MJQ_SPECIALS_SUIT)?this.tileSelected(e):(f=this.preMatchedTiles[d+1],this.tileSelected(e),this.tileSelected(f)),this.multiplier++,this.setMultiplierValues(this.multiplier)}},MJQ_MahjongGame.prototype.checkForAutoPlay=function(a){var b="north"===this.script.mapDirection||"east"===this.script.mapDirection;this.forceAutoPlay&&(b=!1),(!b||a)&&(a||this.noBlockedTiles()||this.forceAutoPlay)&&(this.autoPlay=!0,this.autoPlay&&(this.script.undoButton.hide(),this.script.getHintButton.setEnabled(!1),this.script.optionsButtonGame.setEnabled(!1),this.script.exitButton.setEnabled(!1),this.deck.setEnabled(!1),a&&(this.script.yinyangAutoPlaySpeed=150),mjq_levels.timed&&this.seconds>0&&(this.script.timer.stopTimer(),this.script.timer.showFraction(!0)),this.script.multiplierBar.stopTimer(),this.script.changeState(a?MJQ_STATE_AUTOPLAY_YINYANG:MJQ_STATE_AUTOPLAY,300)))},MJQ_MahjongGame.prototype.tilesWerePlayed=function(){this.script.multiplierBar.addToMultiplierBar(mjq_scaledValue(this.script.multiplierBar.getRateOfIncrease()),!0),this.showOnlyPlayableTiles(!1),this.script.numMoves++},MJQ_MahjongGame.prototype.calcCoins=function(a,b,c){this.coins=c?1:0,c&&(this.score>=this.coins2&&(this.coins=2),this.score>=this.coins3&&(this.coins=3))},MJQ_ScoreSummaryDialog.mjq_isSubclassOf(MJQ_CastMemberDialog),MJQ_ScoreSummaryDialog.prototype.setup=function(){this.useAbsolutePositioning=!0,this.setDimensions(mjq_scaledValue(1030),mjq_scaledValue(1090)),this.setColors("#fdd57a","#280000","#ffffff","#ff4848"),this.setBorderThickness(0),this.setFontAttributes("Samurai",this.dialogFontSize,MJQ_TEXT_PLAIN,2),this.setBackImage(mjq_imageHolders.dialogmedium);var a=null,b="";"north"===this.mapDirection?b="lableuntimedquest":"south"===this.mapDirection?b="lableclassicuntimed":"east"===this.mapDirection?b="labletimedquest":"west"===this.mapDirection&&(b="lableuntimedquest");var c=mjq_imageHolders[b].rows[0][0].width;this.addImage(mjq_imageHolders[b],Math.floor((mjq_scaledValue(1030)-c)/2),mjq_scaledValue(134)),this.newBest&&(c=mjq_imageHolders.newbest.rows[0][0].width,this.addImage(mjq_imageHolders.newbest,Math.floor((mjq_scaledValue(1030)-c)/2),mjq_scaledValue(312))),this.addImage(mjq_imageHolders.dialogcoins,mjq_scaledValue(324),mjq_scaledValue(0)),this.addImage(mjq_imageHolders.dialogcoins,mjq_scaledValue(464),mjq_scaledValue(10)),this.addImage(mjq_imageHolders.dialogcoins,mjq_scaledValue(604),mjq_scaledValue(0)),this.game.coins>=1&&(this.coinObj1=this.addImage(mjq_imageHolders.dialogcoins,mjq_scaledValue(324),mjq_scaledValue(-150)),this.coinObj1.startY=mjq_scaledValue(-150),this.coinObj1.destY=mjq_scaledValue(0),this.coinObj1.setFrame(1),this.game.coins>=2&&(this.coinObj2=this.addImage(mjq_imageHolders.dialogcoins,mjq_scaledValue(464),mjq_scaledValue(-140)),this.coinObj2.startY=mjq_scaledValue(-140),this.coinObj2.destY=mjq_scaledValue(10),this.coinObj2.setFrame(1),this.game.coins>=3&&(this.coinObj3=this.addImage(mjq_imageHolders.dialogcoins,mjq_scaledValue(604),mjq_scaledValue(-150)),this.coinObj3.startY=mjq_scaledValue(-150),this.coinObj3.destY=mjq_scaledValue(0),this.coinObj3.setFrame(1)))),a=this.addText("Level "+this.levelNum+" - "+this.game.layoutName,mjq_scaledValue(511),mjq_scaledValue(234)),a.setTextJustify(MJQ_TEXT_CENTER),a=this.addText("Score: "+mjq_formatIntNumber(this.game.score),mjq_scaledValue(515),mjq_scaledValue(380),"#fdd57a",this.dialogFontSizePlus,MJQ_TEXT_PLAIN),a.setTextJustify(MJQ_TEXT_CENTER),this.addLine(mjq_scaledValue(156),mjq_scaledValue(520),mjq_scaledValue(876),mjq_scaledValue(520),"#fdd57a",1);var d=this.usedTimer?576:620,e=90;a=this.addText("Multiplier Points:",mjq_scaledValue(630),mjq_scaledValue(d),"#fdd57a",this.dialogFontSizePlus2,MJQ_TEXT_PLAIN),a.setTextJustify(MJQ_TEXT_RIGHT),d+=e,this.usedTimer&&(a=this.addText("Timer Points:",mjq_scaledValue(630),mjq_scaledValue(d),"#fdd57a",this.dialogFontSizePlus2,MJQ_TEXT_PLAIN),a.setTextJustify(MJQ_TEXT_RIGHT),d+=e),a=this.addText("Win Bonus:",mjq_scaledValue(630),mjq_scaledValue(d),"#fdd57a",this.dialogFontSizePlus2,MJQ_TEXT_PLAIN),a.setTextJustify(MJQ_TEXT_RIGHT),d=this.usedTimer?576:620,a=this.addText(mjq_formatIntNumber(this.game.pointsFromMultiplier),mjq_scaledValue(870),mjq_scaledValue(d),"#fdd57a",this.dialogFontSizePlus2,MJQ_TEXT_PLAIN),a.setTextJustify(MJQ_TEXT_RIGHT),d+=e,this.usedTimer&&(a=this.addText(mjq_formatIntNumber(this.game.pointsFromTimer),mjq_scaledValue(870),mjq_scaledValue(d),"#fdd57a",this.dialogFontSizePlus2,MJQ_TEXT_PLAIN),a.setTextJustify(MJQ_TEXT_RIGHT),d+=e),a=this.addText(mjq_formatIntNumber(this.game.pointsFromBonusTimer),mjq_scaledValue(870),mjq_scaledValue(d),"#fdd57a",this.dialogFontSizePlus2,MJQ_TEXT_PLAIN),a.setTextJustify(MJQ_TEXT_RIGHT),d+=Math.floor(2*e);var f="";this.game.coins<=2&&(f=0===this.game.coins?"Complete the level for 1 Coin":this.game.coins<=1?"Score "+mjq_formatIntNumber(mjq_game.coins2)+" points for 2 Coins":"Score "+mjq_formatIntNumber(mjq_game.coins3)+" points for 3 Coins",a=this.addText(f,mjq_scaledValue(511),mjq_scaledValue(d)),a.setTextJustify(MJQ_TEXT_CENTER)),this.button2Item=this.addButton(mjq_imageHolders.dialogxbutton,mjq_scaledValue(870),mjq_scaledValue(92),MJQ_DIALOG_BUTTON_CANCEL),this.button2Item.hotRectPadding=40,this.setPriority(-1)},MJQ_ScoreSummaryDialog.prototype.show=function(a,b,c,d){this.repaint(),null!==this.coinObj1?(this.setScript(new ScoreSummaryDialogScript(this.coinObj1,this.coinObj2,this.coinObj3)),this.game.script.lastUsedEndGameMusic=this.game.script.gameWinMusic,this.game.script.mustReset||mjq_playMusic(this.game.script.gameWinMusic)):(this.game.script.lastUsedEndGameMusic=this.game.script.gameLoseMusic,this.game.script.mustReset||mjq_playMusic(this.game.script.gameLoseMusic)),MJQ_CastMemberDialog.prototype.show.call(this,a,b,c,d)},ScoreSummaryDialogScript.mjq_isSubclassOf(MJQ_Script),ScoreSummaryDialogScript.prototype.doState=function(a){switch(a){case 0:this.percentDone=0,this.changeState(1,500);break;case 1:0===this.percentDone&&mjq_playSound("dialogcoinearned"),this.coinObj.setFrame(1),this.percentDone+=this.percentAdd,this.percentDone>=1&&(this.percentDone=1);var b=this.coinObj.destY-this.coinObj.startY;this.coinObj.y=this.coinObj.startY+Math.floor(this.percentDone*b),this.parent.repaint(),this.counter++,this.changeState(this.percentDone<1?1:2,this.moveTime);break;case 2:this.coinObj===this.coinObj1?this.coinObj=this.coinObj2:this.coinObj===this.coinObj2?this.coinObj=this.coinObj3:this.coinObj===this.coinObj3&&(this.coinObj=null),null!==this.coinObj?(this.percentDone=0,this.changeState(1)):this.parent.setScript(null)}};var MJQ_VERSION_TEXT="2",mjq_soundOn=!1,mjq_musicOn=!1,mjq_dimTilesOn=!1,mjq_tileMarkerOn=!1,mjq_gameObjects=null,mjq_levels=null,mjq_console=null,MJQ_STATE_LOAD_OBJECTS_CONFIG=0,MJQ_STATE_HANDLE_LOADING=MJQ_STATE_LOAD_OBJECTS_CONFIG+1,MJQ_STATE_INITIALIZATION_FINISHED=MJQ_STATE_HANDLE_LOADING+1,MJQ_STATE_LOAD_IMAGES=MJQ_STATE_INITIALIZATION_FINISHED+1,MJQ_STATE_LOAD_AUDIO=MJQ_STATE_LOAD_IMAGES+1,MJQ_STATE_CREATE_EARLY_OBJECTS=MJQ_STATE_LOAD_AUDIO+1,MJQ_STATE_GAME_READY=MJQ_STATE_CREATE_EARLY_OBJECTS+1,MJQ_STATE_SHOW_LOGO=MJQ_STATE_GAME_READY+1,MJQ_STATE_SHOW_LOGO_2=MJQ_STATE_SHOW_LOGO+1,MJQ_STATE_SHOW_LOGO_IOS=MJQ_STATE_SHOW_LOGO_2+1,MJQ_STATE_SHOW_LOGO2=MJQ_STATE_SHOW_LOGO_IOS+1,MJQ_STATE_LOGO_COMPLETE=MJQ_STATE_SHOW_LOGO2+1,MJQ_STATE_LOAD_GAMEPATH=MJQ_STATE_LOGO_COMPLETE+1,MJQ_STATE_AWARD_HUB_COIN=MJQ_STATE_LOAD_GAMEPATH+1,MJQ_STATE_AWARD_HUB_COIN_BUMP=MJQ_STATE_AWARD_HUB_COIN+1,MJQ_STATE_AWARD_HUB_SCORE=MJQ_STATE_AWARD_HUB_COIN_BUMP+1,MJQ_STATE_WAIT_FOR_DIRECTION=MJQ_STATE_AWARD_HUB_SCORE+1,MJQ_STATE_RESET_HUB=MJQ_STATE_WAIT_FOR_DIRECTION+1,MJQ_STATE_GO_NORTH=MJQ_STATE_RESET_HUB+1,MJQ_STATE_GO_SOUTH=MJQ_STATE_GO_NORTH+1,MJQ_STATE_GO_EAST=MJQ_STATE_GO_SOUTH+1,MJQ_STATE_GO_WEST=MJQ_STATE_GO_EAST+1,MJQ_STATE_GO_LOCATION=MJQ_STATE_GO_WEST+1,MJQ_STATE_DO_TRAIL_DOTS=MJQ_STATE_GO_LOCATION+1,MJQ_STATE_LOAD_GAME_IMAGES=MJQ_STATE_DO_TRAIL_DOTS+1,MJQ_STATE_LOAD_GAME_IMAGES_2=MJQ_STATE_LOAD_GAME_IMAGES+1,MJQ_STATE_GAME_IMAGES_LOADED=MJQ_STATE_LOAD_GAME_IMAGES_2+1,MJQ_STATE_LOCATION_INIT=MJQ_STATE_GAME_IMAGES_LOADED+1,MJQ_STATE_LOAD_LEVELS_CFG=MJQ_STATE_LOCATION_INIT+1,MJQ_STATE_WAIT_FOR_LEVEL_SELECTION=MJQ_STATE_LOAD_LEVELS_CFG+1,MJQ_STATE_PREVIEW_LEVEL_SELECTION=MJQ_STATE_WAIT_FOR_LEVEL_SELECTION+1,MJQ_STATE_PREVIEW_LEVEL_SELECTION_WAIT=MJQ_STATE_PREVIEW_LEVEL_SELECTION+1,MJQ_STATE_PREVIEW_LEVEL_SELECTION_LOADED=MJQ_STATE_PREVIEW_LEVEL_SELECTION_WAIT+1,MJQ_STATE_VIEWING_LEVEL_SELECT_DIALOG=MJQ_STATE_PREVIEW_LEVEL_SELECTION_LOADED+1,MJQ_STATE_FADEOUT_BEFORE_LAYOUT=MJQ_STATE_VIEWING_LEVEL_SELECT_DIALOG+1,MJQ_STATE_INIT_LAYOUT=MJQ_STATE_FADEOUT_BEFORE_LAYOUT+1,MJQ_STATE_AD_START=MJQ_STATE_INIT_LAYOUT+1,MJQ_STATE_AD_END=MJQ_STATE_AD_START+1,MJQ_STATE_WAIT_FOR_LAYOUT=MJQ_STATE_AD_END+1,MJQ_STATE_START_LAYOUT=MJQ_STATE_WAIT_FOR_LAYOUT+1,MJQ_STATE_START_LAYOUT2=MJQ_STATE_START_LAYOUT+1,MJQ_STATE_START_LAYOUT_GAME_SPECIFIC=MJQ_STATE_START_LAYOUT2+1,MJQ_STATE_PRE_READY=MJQ_STATE_START_LAYOUT_GAME_SPECIFIC+1,MJQ_STATE_READY=MJQ_STATE_PRE_READY+1,MJQ_STATE_PLAY=MJQ_STATE_READY+1,MJQ_STATE_RESET_DURING_PLAY=MJQ_STATE_PLAY+1,MJQ_STATE_AUTOPLAY=MJQ_STATE_RESET_DURING_PLAY+1,MJQ_STATE_AUTOPLAY_YINYANG=MJQ_STATE_AUTOPLAY+1,MJQ_STATE_END_LAYOUT=MJQ_STATE_AUTOPLAY_YINYANG+1,MJQ_STATE_END_LAYOUT2=MJQ_STATE_END_LAYOUT+1,MJQ_STATE_WON_LAYOUT=MJQ_STATE_END_LAYOUT2+1,MJQ_STATE_LOST_LAYOUT=MJQ_STATE_WON_LAYOUT+1,MJQ_STATE_END_GAME=MJQ_STATE_LOST_LAYOUT+1,MJQ_STATE_SHOW_SCORE_SUMMARY=MJQ_STATE_END_GAME+1,MJQ_STATE_VIEWING_SCORE_SUMMARY_DIALOG=MJQ_STATE_SHOW_SCORE_SUMMARY+1,MJQ_STATE_TILES_FLY_AWAY=MJQ_STATE_VIEWING_SCORE_SUMMARY_DIALOG+1,MJQ_STATE_RESET_GAME=MJQ_STATE_TILES_FLY_AWAY+1,MJQ_STATE_RESET_GAME2=MJQ_STATE_RESET_GAME+1,MJQ_STATE_EXIT_GAME=MJQ_STATE_RESET_GAME2+1,MJQ_STATE_RETURN_TO_LOCATION=MJQ_STATE_EXIT_GAME+1,MJQ_STATE_RETURN_TO_LOCATION2=MJQ_STATE_RETURN_TO_LOCATION+1,MJQ_STATE_AWARD_LOCATION_COIN=MJQ_STATE_RETURN_TO_LOCATION2+1,MJQ_STATE_AWARD_LOCATION_COIN_BUMP=MJQ_STATE_AWARD_LOCATION_COIN+1,MJQ_STATE_UNLOCK_NEXT_LEVEL=MJQ_STATE_AWARD_LOCATION_COIN_BUMP+1,MJQ_STATE_UNLOCK_NEXT_LEVEL2=MJQ_STATE_UNLOCK_NEXT_LEVEL+1,MJQ_STATE_GO_HUB=MJQ_STATE_UNLOCK_NEXT_LEVEL2+1,MJQ_STATE_GO_HUB2=MJQ_STATE_GO_HUB+1,MJQ_STATE_GO_HUB3=MJQ_STATE_GO_HUB2+1,mjq_audioSpriteNames={badclick:[34,236],buttonclick:[297,177],coinawardarrived:[489,310],coinawardflying:[863,1522],complete:[2438,811],logoappear:[3296,8051],dialogappear:[11848,1840],dialogdisappear:[13755,1684],optionstoggleclick:[15646,300],dialogcoinearned:[16048,987],firecrackerflyover:[17241,1255],firecrackerlit:[18831,3500],go:[22758,4550],hint:[27419,1700],lanternclick:[29226,316],lanternlightsup:[29655,2337],layoutflyaway:[32165,1696],lightbulbon:[33939,435],locationlableflyin:[34653,1389],multiplierincrease:[36327,720],nsewbuttonclick:[37146,4646],nsewflyout:[41927,1802],tileclick:[44295,206],tileshuffle:[44831,1021],tilesmatched:[46304,831],timerincrease:[47352,2331],timertock:[50303,569],timesup:[51349,1729],wildtilematched:[53356,1545],totalscorecountnup:[55838,781],undo:[56796,619],wallexplode:[58300,1892],wildTileSelected:[60801,764],windgust:[62346,2633],yinyangmatched:[65811,1021],hudappear:[67824,2287],huddisappear:[71310,2515],bonusscore:[74324,2120]};
MJQ_GameScript.mjq_isSubclassOf(MJQ_Script),MJQ_GameScript.prototype.doScript=function(a){MJQ_Script.prototype.doScript.call(this,a),this.mustShowRulesDialog&&null===this.castForeground.dialog&&(this.mustShowRulesDialog=!1,this.showRulesDialog())},MJQ_GameScript.prototype.doState=function(a){switch(a){case MJQ_STATE_LOAD_OBJECTS_CONFIG:this.progress=new MJQ_Progress,mjq_console=new MJQ_Console(this.progress),mjq_console.init(),mjq_console.advanceLoadingBar("Loading Mahjong Quest");var b=this;mjq_forceMusicOff?(this.mainMenuMusicLoaded=!0,mjq_console.advanceLoadingBar("Skipping Music: Not Supported for this Browser")):(this.mainMenuMusic=mjq_loadMusic("mjq_mainmenu",function(){b.mainMenuMusicLoaded=!0,mjq_console.advanceLoadingBar("Music Loaded")}),this.mainMenuMusic.musicID=0,this.musicObjects[0]=this.mainMenuMusic),mjq_forceSoundOff?(this.audioSpriteLoaded=!0,mjq_console.advanceLoadingBar("Skipping Sounds: Not Supported for this Browser")):mjq_audioSprite=mjq_createAudioSprite(mjq_audioPath+"mjq_audiosprite.ogg",mjq_audioPath+"mjq_audiosprite.mp3",mjq_audioSpriteNames,function(){b.audioSpriteLoaded=!0,mjq_console.advanceLoadingBar("Sounds Loaded")}),mjq_gameObjects=new MJQ_Config,mjq_gameObjects.init(mjq_gameDefinitionsPath+mjq_objectsName,this);break;case MJQ_STATE_HANDLE_LOADING:mjq_console.advanceLoadingBar("Loading Data"),mjq_gameObjects=mjq_gameObjects.json,this.loadingText=new MJQ_CastMemberText(mjq_gameObjects.loadingText);var b=this,c=0;mjq_loadingLoop=setInterval(function(){c++,6===c&&(c=1);for(var a="Loading.",d=2;5>=d;d++)a+=c>=d?".":"";b.loadingText.setText(a)},250),this.changeState(MJQ_STATE_INITIALIZATION_FINISHED);break;case MJQ_STATE_INITIALIZATION_FINISHED:this.game=mjq_game;var d=mjq_imagesPath+mjq_artAssetsName;this.resources=new MJQ_Resources(this.game,d,mjq_imagesPath),this.changeState(MJQ_STATE_LOAD_IMAGES,1);break;case MJQ_STATE_LOAD_IMAGES:this.resources.finished?(this.resources.stopInterval(),mjq_console.advanceLoadingBar("Images Loaded"),this.backgroundMainHubImage=this.resources.getImage("background"),this.resources=null,this.changeState(MJQ_STATE_LOAD_AUDIO,1)):this.sameState(20);break;case MJQ_STATE_LOAD_AUDIO:this.audioSpriteLoaded&&this.mainMenuMusicLoaded?this.changeState(MJQ_STATE_CREATE_EARLY_OBJECTS):this.changeState(MJQ_STATE_LOAD_AUDIO,50);break;case MJQ_STATE_CREATE_EARLY_OBJECTS:if(void 0===mjq_loadingLoop)return void changeState(MJQ_STATE_CREATE_EARLY_OBJECTS,100);clearInterval(mjq_loadingLoop),mjq_loadingLoop=null,this.loadingText.setCast(null),this.loadingText=null,this.titleLabel=new MJQ_CastMemberText(mjq_gameObjects.titleLabel),this.copyrightText=new MJQ_CastMemberText(mjq_gameObjects.copyrightText),this.splashLogo=new MJQ_CastMemberImage(mjq_gameObjects.splashLogo),this.iWinLogo=new MJQ_CastMemberImage(mjq_gameObjects.iWinLogo),this.optionsButton=new MJQ_CastMemberButton(mjq_gameObjects.optionsButton,this),this.changeState(MJQ_STATE_GAME_READY,1);break;case MJQ_STATE_GAME_READY:mjq_console.advanceLoadingBar("Loading Complete"),mjq_console.loadingComplete(this,MJQ_STATE_SHOW_LOGO,500);break;case MJQ_STATE_SHOW_LOGO:mjq_playSound("logoappear"),mjq_playMusic(this.mainMenuMusic),this.splashLogo.fadeShow(1,700),this.splashLogo.scaleTo(1.1,1.1,2e3,Tween.backEaseOut),this.splashLogo.moveTo(this.splashLogo.rect.x-mjq_scaledValue(40),this.splashLogo.rect.y,2e3,Tween.backEaseOut),this.changeState(MJQ_STATE_SHOW_LOGO_2,1e3);break;case MJQ_STATE_SHOW_LOGO_2:this.gameWinMusic=mjq_loadMusic("mjq_win"),this.gameWinMusic.musicID=0,this.musicObjects[3]=this.gameWinMusic,this.gameLoseMusic=mjq_loadMusic("mjq_lose"),this.gameLoseMusic.musicID=0,this.musicObjects[4]=this.gameLoseMusic,this.iWinLogo.fadeShow(1,1e3),this.copyrightText.fadeShow(1,1e3),this.changeState(MJQ_STATE_SHOW_LOGO_IOS,1e3);break;case MJQ_STATE_SHOW_LOGO_IOS:mjq_iOS&&mjq_browserNumber>=6?this.tapToStart=new MJQ_CastMemberButton(mjq_gameObjects.tapToStart,this):this.changeState(MJQ_STATE_SHOW_LOGO2,500);break;case MJQ_STATE_SHOW_LOGO2:this.splashLogo.scaleTo(1,1,1500,Tween.backEaseInOut),this.splashLogo.moveTo(this.splashLogo.rect.x+mjq_scaledValue(40),this.splashLogo.rect.y,1500,Tween.backEaseInOut),this.copyrightText.fadeRemove(1200),this.copyrightText=null,this.iWinLogo.fadeRemove(1200),this.iWinLogo=null,this.changeState(MJQ_STATE_LOGO_COMPLETE,1720);break;case MJQ_STATE_LOGO_COMPLETE:mjq_setBackground(this.backgroundMainHubImage,this.crossFadeTime),this.changeState(MJQ_STATE_LOAD_GAMEPATH,this.crossFadeTime);break;case MJQ_STATE_LOAD_GAMEPATH:this.currentBackgroundImage=this.backgroundMainHubImage,this.mapDirection="hub",this.levelNum=1;var e=!1;if(null===this.northButton){e=!0,this.northButton=new MJQ_CastMemberButton(mjq_gameObjects.northButton,this),this.southButton=new MJQ_CastMemberButton(mjq_gameObjects.southButton,this),this.eastButton=new MJQ_CastMemberButton(mjq_gameObjects.eastButton,this),this.westButton=new MJQ_CastMemberButton(mjq_gameObjects.westButton,this),this.northButton.origX=this.northButton.rect.x,this.northButton.origY=this.northButton.rect.y,this.southButton.origX=this.southButton.rect.x,this.southButton.origY=this.southButton.rect.y,this.eastButton.origX=this.eastButton.rect.x,this.eastButton.origY=this.eastButton.rect.y,this.westButton.origX=this.westButton.rect.x,this.westButton.origY=this.westButton.rect.y,this.northButton.move(this.northButton.rect.x+mjq_scaledValue(mjq_gameObjects.northButton.posstart.x),this.northButton.rect.y+mjq_scaledValue(mjq_gameObjects.northButton.posstart.y)),this.southButton.move(this.southButton.rect.x+mjq_scaledValue(mjq_gameObjects.southButton.posstart.x),this.southButton.rect.y+mjq_scaledValue(mjq_gameObjects.southButton.posstart.y)),this.eastButton.move(this.eastButton.rect.x+mjq_scaledValue(mjq_gameObjects.eastButton.posstart.x),this.eastButton.rect.y+mjq_scaledValue(mjq_gameObjects.eastButton.posstart.y)),this.westButton.move(this.westButton.rect.x+mjq_scaledValue(mjq_gameObjects.westButton.posstart.x),this.westButton.rect.y+mjq_scaledValue(mjq_gameObjects.westButton.posstart.y)),this.totalScoreLable=new MJQ_CastMemberImage(mjq_gameObjects.totalScoreLable);var f=this.totalScoreLable.rect.width;this.totalScoreValue=new MJQ_CastMemberNumber(mjq_gameObjects.totalScoreValue),this.totalScoreValue.move(this.totalScoreLable.rect.x+Math.floor(f/2)+mjq_scaledValue(0),this.totalScoreLable.rect.y+this.totalScoreLable.rect.height+mjq_scaledValue(10)),this.totalScoreValue.setNumber(this.progress.calcTotalScore()),this.totalScoreValue.name="Total Score Value",this.totalCoinsLable=new MJQ_CastMemberImage(mjq_gameObjects.totalCoinsLable),f=this.totalCoinsLable.rect.width,this.totalCoinsIcon=new MJQ_CastMemberImage(mjq_gameObjects.totalCoinsIcon),this.totalCoinsIcon.move(this.totalCoinsLable.rect.x+Math.floor(f/3)-mjq_scaledValue(90),this.totalCoinsLable.rect.y+this.totalCoinsLable.rect.height+mjq_scaledValue(10)),this.totalCoinsIcon.setScale(.7);var g=this.progress.calcTotalCoins();this.totalCoinsValue=new MJQ_CastMemberNumber(mjq_gameObjects.totalCoinsValue),this.totalCoinsValue.move(this.totalCoinsIcon.rect.x+mjq_scaledValue(130),this.totalCoinsIcon.rect.y-mjq_scaledValue(6)),this.totalCoinsValue.setNumber(g),this.totalCoinsValue.name="Total Coins Value";var h=mjq_scaledValue(110);g>=100?h=mjq_scaledValue(144):g>=10&&(h=mjq_scaledValue(130)),this.totalCoinsSlashValue=new MJQ_CastMemberNumber(mjq_gameObjects.totalCoinsSlashValue),this.totalCoinsSlashValue.move(this.totalCoinsValue.rect.x+h,this.totalCoinsValue.rect.y),this.totalCoinsSlashValue.setSlashValue(4*this.NUMLEVELS*3),this.totalCoinsSlashValue.name="Total Coins Slash Value"}var i=300,j=1500;this.northButton.fadeShow(1,i),e&&(mjq_playSound("nsewflyout"),this.northButton.moveTo(this.northButton.origX,this.northButton.origY,j,Tween.regularEaseInOut)),this.southButton.fadeShow(1,i),e&&this.southButton.moveTo(this.southButton.origX,this.southButton.origY,j,Tween.regularEaseInOut),this.eastButton.fadeShow(1,i),e&&this.eastButton.moveTo(this.eastButton.origX,this.eastButton.origY,j,Tween.regularEaseInOut),this.westButton.fadeShow(1,i),e&&this.westButton.moveTo(this.westButton.origX,this.westButton.origY,j,Tween.regularEaseInOut),this.optionsButton.fadeShow(1,i),this.totalScoreLable.fadeShow(1,i),this.totalScoreValue.fadeShow(1,i),this.totalCoinsLable.fadeShow(1,i),this.totalCoinsIcon.fadeShow(1,i),this.totalCoinsValue.fadeShow(1,i),this.totalCoinsSlashValue.fadeShow(1,i),this.newTotalScore=this.progress.calcTotalScore(),this.numCoinsToAward=this.progress.calcTotalCoins()-this.totalCoinsValue.value,this.numScoreToAward=this.newTotalScore-this.totalScoreValue.value,this.numCoinsToAward>0?this.changeState(MJQ_STATE_AWARD_HUB_COIN,i):this.numScoreToAward>0?this.changeState(MJQ_STATE_AWARD_HUB_SCORE,i):this.changeState(MJQ_STATE_WAIT_FOR_DIRECTION);break;case MJQ_STATE_AWARD_HUB_COIN:if(this.mustReset){this.changeState(MJQ_STATE_WAIT_FOR_DIRECTION);break}var k=(this.lanterns[this.levelNum-1],this.returningFromDirectionButton),l=new MJQ_CastMemberImage(mjq_gameObjects.hubCoinAward);l.move(k.centerX()-Math.floor(l.rect.width/2),k.centerY()-Math.floor(l.rect.height/2)),l.setCueListener(this),l.setMoveCue(),l.moveTo(this.totalCoinsIcon.rect.x-Math.floor((l.rect.width-this.totalCoinsIcon.rect.width)/2),this.totalCoinsIcon.rect.y-Math.floor((l.rect.height-this.totalCoinsIcon.rect.height)/2),200,Tween.regularEaseOut),mjq_playSound("coinawardflying");break;case MJQ_STATE_AWARD_HUB_COIN_BUMP:this.numCoinsToAward--;var g=this.totalCoinsValue.value+1;this.totalCoinsValue.setNumber(g);var h=mjq_scaledValue(110);g>=100?h=mjq_scaledValue(144):g>=10&&(h=mjq_scaledValue(130)),this.totalCoinsSlashValue.move(this.totalCoinsValue.rect.x+mjq_scaledValue(10>g?110:130),this.totalCoinsValue.rect.y),mjq_playSound("coinawardarrived"),this.numCoinsToAward>0?this.changeState(MJQ_STATE_AWARD_HUB_COIN):this.numScoreToAward>0?this.changeState(MJQ_STATE_AWARD_HUB_SCORE,100):this.changeState(MJQ_STATE_WAIT_FOR_DIRECTION);break;case MJQ_STATE_AWARD_HUB_SCORE:if(this.mustReset){this.totalScoreValue.setNumber(this.newTotalScore),this.changeState(MJQ_STATE_WAIT_FOR_DIRECTION);break}var m=Math.ceil(this.numScoreToAward/17);m+this.totalScoreValue.value>=this.newTotalScore?(this.totalScoreValue.setNumber(this.newTotalScore),mjq_playSound("totalscorecountnup"),this.changeState(MJQ_STATE_WAIT_FOR_DIRECTION)):(this.totalScoreValue.setNumber(this.totalScoreValue.value+m),mjq_playSound("totalscorecountnup"),this.changeState(MJQ_STATE_AWARD_HUB_SCORE,50));break;case MJQ_STATE_WAIT_FOR_DIRECTION:this.allowSignedInDirective||(this.totalScoreValue.setNumber(this.progress.calcTotalScore()),this.totalCoinsValue.setNumber(this.progress.calcTotalCoins()),this.allowSignedInDirective=!0),this.mustReset?!this.mustResetLoggingIn||mjq_console.gameDataArrived?this.changeState(MJQ_STATE_RESET_HUB,1e3):this.changeState(MJQ_STATE_WAIT_FOR_DIRECTION,100):(null===this.castForeground.dialog&&(this.castGameLayer.anim.setMasterInput(!0),this.castBackground.anim.setMasterInput(!0)),this.changeState(MJQ_STATE_WAIT_FOR_DIRECTION,100));break;case MJQ_STATE_RESET_HUB:this.mustReset=!1;var n=this.progress.calcTotalScore(),o=this.progress.calcTotalCoins();this.totalScoreValue.setNumber(n),this.totalCoinsValue.setNumber(o),this.castForeground.forceDialogsDispose(),this.changeState(MJQ_STATE_WAIT_FOR_DIRECTION);break;case MJQ_STATE_GO_NORTH:mjq_fadeOutMusic(this.mainMenuMusic,3e3),mjq_playSound("nsewbuttonclick"),this.optionsButton.setEnabled(!1),(null===this.musicObjects[1]||"north"!==this.musicObjects[1].mapDir)&&(mjq_unloadMusic(this.musicObjects[1]),mjq_unloadMusic(this.musicObjects[2]),this.musicObjects[2]=null,this.levelSelectMusic=mjq_loadMusic("mjq_northselect"),this.levelSelectMusic.mapDir="north",this.levelSelectMusic.musicID=0,this.musicObjects[1]=this.levelSelectMusic),this.artAssetsFileNameLocation=mjq_imagesPath+mjq_artAssetsNameNorth,this.windsDotsData=mjq_gameObjects.northTrailDot,this.windsDotsOrigin.x=Math.floor(this.northButton.rect.x+this.northButton.rect.width/2),this.windsDotsOrigin.y=this.northButton.rect.y+this.northButton.rect.width,this.directionButton=this.northButton,this.mapDirection="north",this.directionGameObject=mjq_gameObjects.northButton,this.changeState(MJQ_STATE_GO_LOCATION);break;case MJQ_STATE_GO_SOUTH:mjq_fadeOutMusic(this.mainMenuMusic,3e3),mjq_playSound("nsewbuttonclick"),this.optionsButton.setEnabled(!1),(null===this.musicObjects[1]||"south"!==this.musicObjects[1].mapDir)&&(mjq_unloadMusic(this.musicObjects[1]),mjq_unloadMusic(this.musicObjects[2]),this.musicObjects[2]=null,this.levelSelectMusic=mjq_loadMusic("mjq_southselect"),this.levelSelectMusic.mapDir="south",this.levelSelectMusic.musicID=0,this.musicObjects[1]=this.levelSelectMusic),this.artAssetsFileNameLocation=mjq_imagesPath+mjq_artAssetsNameSouth,this.windsDotsData=mjq_gameObjects.southTrailDot,this.windsDotsOrigin.x=Math.floor(this.southButton.rect.x+this.southButton.rect.width/2),this.windsDotsOrigin.y=this.southButton.rect.y,this.directionButton=this.southButton,this.mapDirection="south",this.directionGameObject=mjq_gameObjects.southButton,this.changeState(MJQ_STATE_GO_LOCATION);break;case MJQ_STATE_GO_EAST:mjq_fadeOutMusic(this.mainMenuMusic,3e3),mjq_playSound("nsewbuttonclick"),this.optionsButton.setEnabled(!1),(null===this.musicObjects[1]||"east"!==this.musicObjects[1].mapDir)&&(mjq_unloadMusic(this.musicObjects[1]),mjq_unloadMusic(this.musicObjects[2]),this.musicObjects[2]=null,this.levelSelectMusic=mjq_loadMusic("mjq_eastselect"),this.levelSelectMusic.mapDir="east",this.levelSelectMusic.musicID=0,this.musicObjects[1]=this.levelSelectMusic),this.artAssetsFileNameLocation=mjq_imagesPath+mjq_artAssetsNameEast,this.windsDotsData=mjq_gameObjects.eastTrailDot,this.windsDotsOrigin.x=this.eastButton.rect.x,this.windsDotsOrigin.y=Math.floor(this.eastButton.rect.y+this.eastButton.rect.height/2),this.directionButton=this.eastButton,this.mapDirection="east",this.directionGameObject=mjq_gameObjects.eastButton,this.changeState(MJQ_STATE_GO_LOCATION);break;case MJQ_STATE_GO_WEST:mjq_fadeOutMusic(this.mainMenuMusic,3e3),mjq_playSound("nsewbuttonclick"),this.optionsButton.setEnabled(!1),(null===this.musicObjects[1]||"west"!==this.musicObjects[1].mapDir)&&(mjq_unloadMusic(this.musicObjects[1]),mjq_unloadMusic(this.musicObjects[2]),this.musicObjects[2]=null,this.levelSelectMusic=mjq_loadMusic("mjq_westselect"),this.levelSelectMusic.mapDir="west",this.levelSelectMusic.musicID=0,this.musicObjects[1]=this.levelSelectMusic),this.artAssetsFileNameLocation=mjq_imagesPath+mjq_artAssetsNameWest,this.windsDotsData=mjq_gameObjects.westTrailDot,this.windsDotsOrigin.x=this.westButton.rect.x+this.westButton.rect.width,this.windsDotsOrigin.y=Math.floor(this.westButton.rect.y+this.westButton.rect.height/2),this.directionButton=this.westButton,this.mapDirection="west",this.directionGameObject=mjq_gameObjects.westButton,this.changeState(MJQ_STATE_GO_LOCATION);break;case MJQ_STATE_GO_LOCATION:this.castGameLayer.anim.setMasterInput(!1),this.castBackground.anim.setMasterInput(!1),this.resourcesLocations=new MJQ_Resources(this.game,mjq_imagesPath+mjq_artAssetsNameLocations,mjq_imagesPath),this.resources=new MJQ_Resources(this.game,this.artAssetsFileNameLocation,mjq_imagesPath),this.changeState(MJQ_STATE_DO_TRAIL_DOTS);break;case MJQ_STATE_DO_TRAIL_DOTS:var p=this.windsDots.length;if(p<this.windsDotsData.path.length/2){var q=new MJQ_CastMemberImage(this.windsDotsData);q.move(this.windsDotsOrigin.x+mjq_scaledValue(this.windsDotsData.path[2*p]),this.windsDotsOrigin.y+mjq_scaledValue(this.windsDotsData.path[2*p+1])),q.setFrame(p),q.cycleStart(250),this.windsDots.push(q),mjq_playSound("windgust")}p++,p<this.windsDotsData.path.length/2?this.changeState(MJQ_STATE_DO_TRAIL_DOTS,750):this.changeState(MJQ_STATE_LOAD_GAME_IMAGES,this.resources.finished?100:500);break;case MJQ_STATE_LOAD_GAME_IMAGES:if(this.resources.finished&&this.resourcesLocations.finished){this.resourcesLocations.stopInterval(),this.resources.stopInterval(),this.backgroundLocationImage=this.resources.getImage("background"),this.resourcesLocations=null,this.resources=null;var i=250;this.northButton.fadeHide(i),this.southButton.fadeHide(i),this.eastButton.fadeHide(i),this.westButton.fadeHide(i),this.splashLogo.fadeHide(i),this.totalScoreLable.fadeHide(i),this.totalScoreValue.fadeHide(i),this.totalCoinsLable.fadeHide(i),this.totalCoinsIcon.fadeHide(i),this.totalCoinsValue.fadeHide(i),this.totalCoinsSlashValue.fadeHide(i);for(var r;this.windsDots.length>0;)r=this.windsDots.pop(),r.fadeRemove(i);this.changeState(MJQ_STATE_LOAD_GAME_IMAGES_2,i)}else this.sameState(20);break;case MJQ_STATE_LOAD_GAME_IMAGES_2:var i=this.crossFadeTime;mjq_setBackground(this.backgroundLocationImage,i);var s=0,t=0;640===MJQ_ACTIVITY_HEIGHT?(s=-2,t=-2):320===MJQ_ACTIVITY_HEIGHT&&(s=-1,t=-1),this.getHintButton=new MJQ_CastMemberButton(mjq_gameObjects.getHintButton,this),this.getHintButton.move(this.getHintButton.rect.x+s,this.getHintButton.rect.y),this.getHintsLeft=new MJQ_CastMemberText(mjq_gameObjects.getHintsLeft),this.getHintsLeft.move(this.getHintButton.rect.x+mjq_scaledValue(140)+s,this.getHintButton.rect.y+mjq_scaledValue(2)+t),this.getHintsLeft.setPriority(this.getHintButton.priority-1),this.undoButton=new MJQ_CastMemberButton(mjq_gameObjects.undoButton,this),this.undoButton.move(this.undoButton.rect.x+s,this.undoButton.rect.y),this.exitButton=new MJQ_CastMemberButton(mjq_gameObjects.exitButton,this),this.hudBackground=new MJQ_CastMemberImage(mjq_gameObjects.hudBackground),this.optionsButtonGame=new MJQ_CastMemberButton(mjq_gameObjects.optionsButtonGame,this),null===this.timer&&(this.timer=new MJQ_Timer(this,mjq_gameObjects.timer),this.timer.showFraction(!1),this.timerUntimed=new MJQ_CastMemberText(mjq_gameObjects.timerUntimed),this.timerBar=new MJQ_TimerBar(mjq_gameObjects.timerBar),this.timerBar.move(this.timerBar.rect.x+s,this.timerBar.rect.y),this.timerBar.clipX=this.timerBar.rect.x,this.timerBarOverlay=new MJQ_CastMemberImage(mjq_gameObjects.timerBarOverlay),this.timerBarOverlay.move(this.timerBarOverlay.rect.x+s,this.timerBarOverlay.rect.y),this.multiplierBar=new MJQ_MultiplierBar(mjq_gameObjects.multiplierBar),this.multiplierBar.clipX=this.multiplierBar.rect.x,this.multiplierBarOverlay=new MJQ_CastMemberImage(mjq_gameObjects.multiplierBarOverlay)),this.changeState(MJQ_STATE_GAME_IMAGES_LOADED,i);break;case MJQ_STATE_GAME_IMAGES_LOADED:this.currentBackgroundImage=this.backgroundLocationImage,this.counter=0,this.changeState(MJQ_STATE_LOCATION_INIT);break;case MJQ_STATE_LOCATION_INIT:var u=this.mapDirection;if(null===this.backToHubButton){this.buttonPos=mjq_gameObjects.backToHubButton.pos,"north"===u?(mjq_gameObjects.locationHeader.imgName="headeruntimedquest",this.headerPos=mjq_gameObjects.locationHeader.northPos):"south"===u?(mjq_gameObjects.locationHeader.imgName="headerclassicuntimed",this.headerPos=mjq_gameObjects.locationHeader.southPos):"east"===u?(mjq_gameObjects.locationHeader.imgName="headertimedquest",this.headerPos=mjq_gameObjects.locationHeader.eastPos):"west"===u&&(mjq_gameObjects.locationHeader.imgName="headerclassictimed",this.headerPos=mjq_gameObjects.locationHeader.westPos);var b=this;this.backToHubButton=new MJQ_CastMemberButton(mjq_gameObjects.backToHubButton,this),this.backToHubButton.showBackToHubButton=function(){b.backToHubButton.setPos(b.buttonPos);var a=b.backToHubButton.rect.x,c=b.backToHubButton.rect.y;b.backToHubButton.move(a-mjq_scaledValue(200),c),b.backToHubButton.fadeShow(1,800),b.backToHubButton.moveTo(a,c,1300,Tween.elasticEaseOut)},this.backToHubButton.showBackToHubButton(),this.locationHeader=new MJQ_CastMemberImage(mjq_gameObjects.locationHeader);var v=0,w=0;this.locationHeader.showHeader=function(){b.locationHeader.setPos(b.headerPos),v=b.locationHeader.rect.x,w=b.locationHeader.rect.y,b.locationHeader.move(v,-200),b.locationHeader.fadeShow(1,700);var a=[v-50,w+50];b.locationHeader.moveTo(v,w,800,Tween.regularEaseOut,a),mjq_playSound("locationlableflyin")},this.locationHeader.showHeader();var f=this.locationHeader.rect.width;this.locationCoinsIcon=new MJQ_CastMemberImage(mjq_gameObjects.locationCoinsIcon),this.locationCoinsIcon.move(v+Math.floor(f/3)-mjq_scaledValue(20),w+this.locationHeader.rect.height-mjq_scaledValue(10)),this.locationCoinsIcon.setScale(.7),this.locationCoinsIcon.fadeShow(1,1e3);var g=this.progress.calcLocationCoins(u);this.locationCoinsValue=new MJQ_CastMemberNumber(mjq_gameObjects.locationCoinsValue),this.locationCoinsValue.move(this.locationCoinsIcon.rect.x+mjq_scaledValue(140),this.locationCoinsIcon.rect.y-mjq_scaledValue(5)),this.locationCoinsValue.setNumber(g),this.locationCoinsValue.name="Location Coins Value",this.locationCoinsValue.fadeShow(1,1e3);var h=mjq_scaledValue(90);g>=100?h=mjq_scaledValue(124):g>=10&&(h=mjq_scaledValue(110)),this.locationCoinsSlashValue=new MJQ_CastMemberNumber(mjq_gameObjects.locationCoinsSlashValue),this.locationCoinsSlashValue.move(this.locationCoinsValue.rect.x+h,this.locationCoinsValue.rect.y),this.locationCoinsSlashValue.setSlashValue(3*this.NUMLEVELS),this.locationCoinsSlashValue.name="Location Coins Slash Value",this.locationCoinsSlashValue.fadeShow(1,1e3)}"north"===u?this.lanternObject=mjq_gameObjects.lanternsnorth:"south"===u?this.lanternObject=mjq_gameObjects.lanternssouth:"east"===u?this.lanternObject=mjq_gameObjects.lanternseast:"west"===u&&(this.lanternObject=mjq_gameObjects.lanternswest);var x=this.counter,i=400;this.nextLevelNum=this.progress.calcNextLocation(this.mapDirection),this.mustCheckForUnlock=!1;var r=new MJQ_Lantern(this,this.lanternObject,this);this.lanterns[x]=r,r.id=r.id+this.counter,r.move(mjq_scaledValue(this.lanternObject.posx[x]),mjq_scaledValue(this.lanternObject.posy[x]+this.lanternObject.posyoffset)),r.fadeShow(1,i),r.setRow(0),this.nextLevelNum>x?(r.setRotation(mjq_getRandomInt(0,6)-3,!0),r.setScript(new MJQ_LanternScript(r)),this.nextLevelNum===x+1&&r.setRow(1)):r.setEnabled(!1);var y=new MJQ_CastMemberNumber(mjq_gameObjects.lanternnumbers);this.lanternNums[x]=y,y.setNumber(x+1),y.name="LevelNumber",y.move(r.rect.x+mjq_scaledValue(mjq_gameObjects.lanternnumbers.pos.offsetX),r.rect.y+mjq_scaledValue(mjq_gameObjects.lanternnumbers.pos.offsetY-this.lanternObject.posyoffset)),y.fadeShow(1,i),r.levelNumMem=y,this.showLanternHangers(),this.showLightBulbs(),this.counter++,this.counter<this.NUMLEVELS?this.changeState(MJQ_STATE_LOCATION_INIT,50):this.changeState(MJQ_STATE_LOAD_LEVELS_CFG,1);break;case MJQ_STATE_LOAD_LEVELS_CFG:this.mustReset||mjq_playMusic(this.levelSelectMusic);var z=mjq_levelsPath+this.mapDirection+"levels.json";this.levelsConfig=new MJQ_Config,this.levelsConfig.init(z,this);break;case MJQ_STATE_WAIT_FOR_LEVEL_SELECTION:this.mustReset?this.mjq_buttonClicked(this.RETURNTOHUB_BUTTON_ID,1):(mjq_levels=this.levelsConfig.json,null===this.castForeground.dialog&&(this.castGameLayer.anim.setMasterInput(!0),this.castBackground.anim.setMasterInput(!0)),this.optionsButton.setEnabled(!0),this.changeState(MJQ_STATE_WAIT_FOR_LEVEL_SELECTION,100));break;case MJQ_STATE_PREVIEW_LEVEL_SELECTION:this.castGameLayer.anim.setMasterInput(!1),this.castBackground.anim.setMasterInput(!1),mjq_playSound("lanternclick"),this.game.loadPreviewLayoutConfig(this.levelNum),this.changeState(this.mustReset?MJQ_STATE_WAIT_FOR_LEVEL_SELECTION:MJQ_STATE_PREVIEW_LEVEL_SELECTION_WAIT);break;case MJQ_STATE_PREVIEW_LEVEL_SELECTION_WAIT:this.mustReset?this.changeState(MJQ_STATE_WAIT_FOR_LEVEL_SELECTION):this.game.layoutLoaded?this.changeState(MJQ_STATE_PREVIEW_LEVEL_SELECTION_LOADED):this.changeState(MJQ_STATE_PREVIEW_LEVEL_SELECTION_WAIT,50);break;case MJQ_STATE_PREVIEW_LEVEL_SELECTION_LOADED:if(this.mustReset)this.changeState(MJQ_STATE_WAIT_FOR_LEVEL_SELECTION);else{this.game.setMiniLayout(),this.castForeground.forceDialogsDispose(),this.levelPreviewDialog=new MJQ_LevelPreviewDialog(this,this.castForeground.anim,this.LEVEL_PREVIEW_DIALOG_ID,this,this.mapDirection,this.levelNum),this.levelPreviewDialog.show(MJQ_DIALOG_BUTTONSET_NONE),this.levelPreviewDialog.opening=!0,this.levelPreviewDialog.setCueListener(this),this.levelPreviewDialog.setMoveCue(),mjq_playSound("dialogappear");var A=Math.floor((MJQ_ACTIVITY_WIDTH-this.levelPreviewDialog.rect.width)/2),B=Math.floor((MJQ_ACTIVITY_HEIGHT-this.levelPreviewDialog.rect.height)/2);this.levelPreviewDialog.move(this.lanterns[this.levelNum-1].rect.x-Math.floor(this.levelPreviewDialog.rect.width/2),this.lanterns[this.levelNum-1].rect.y-Math.floor(this.levelPreviewDialog.rect.height/2));var C=[A,B-mjq_scaledValue(100)];this.levelPreviewDialog.moveTo(A,B,500,Tween.regularEaseOut,C),this.levelPreviewDialog.setAlpha(0),this.levelPreviewDialog.fadeIn(1,300),this.changeState(MJQ_STATE_VIEWING_LEVEL_SELECT_DIALOG)}break;case MJQ_STATE_VIEWING_LEVEL_SELECT_DIALOG:this.mustReset?this.changeState(MJQ_STATE_WAIT_FOR_LEVEL_SELECTION):this.changeState(MJQ_STATE_VIEWING_LEVEL_SELECT_DIALOG,50);break;case MJQ_STATE_FADEOUT_BEFORE_LAYOUT:this.optionsButton.setEnabled(!1),this.optionsButton.fadeHide(this.HUD_ELEMENTS_FADETIME),this.castGameLayer.anim.setMasterInput(!1),this.castBackground.anim.setMasterInput(!1);var i=this.crossFadeTime;for(this.backToHubButton.fadeHide(i),this.locationHeader.fadeHide(i),this.locationCoinsIcon.fadeHide(i),this.locationCoinsValue.fadeHide(i),this.locationCoinsSlashValue.fadeHide(i),x=0;x<this.NUMLEVELS;x++)this.lanterns[x].fadeHide(i),this.lanternNums[x].fadeHide(i);this.hideLanternHangers(),this.hideLightBulbs(),this.mustCheckForUnlock=this.levelNum===this.nextLevelNum,mjq_fadeOutMusic(this.levelSelectMusic,3500),this.changeState(MJQ_STATE_INIT_LAYOUT,i);break;case MJQ_STATE_INIT_LAYOUT:this.game.createMahjongObjects(this.mapDirection,this.levelNum),this.changeState(MJQ_STATE_AD_START,100);break;case MJQ_STATE_AD_START:mjq_console.showAd(this.levelNum,this,MJQ_STATE_AD_END,100);break;case MJQ_STATE_AD_END:this.changeState(MJQ_STATE_WAIT_FOR_LAYOUT,100);break;case MJQ_STATE_WAIT_FOR_LAYOUT:this.game.loadingComplete?(this.game.setScore(0,!1),this.useSameSeed=!1,this.game.currentLayout=this.levelNum,this.changeState(MJQ_STATE_START_LAYOUT,500)):this.changeState(MJQ_STATE_WAIT_FOR_LAYOUT);break;case MJQ_STATE_START_LAYOUT:this.dealing=!0,this.counter=1,this.numMoves=0,this.undoUsed=!1,null===this.musicObjects[2]&&(this.gamePlayMusic=mjq_loadMusic("mjq_"+this.mapDirection+"play"),this.gamePlayMusic.mapDir=this.mapDir,this.gamePlayMusic.musicID=0,this.musicObjects[2]=this.gamePlayMusic),this.castGameLayer.anim.setMasterInput(!1),this.castBackground.anim.setMasterInput(!1),this.game.seconds>0&&(this.timer.setTimer(this.game.seconds,!0),this.timer.showFraction(!1)),void 0===this.useSameSeed&&(this.useSameSeed=!1),this.setSeed(this.useSameSeed),this.game.deck.shuffle(),this.game.loadLayoutConfig(),this.changeState(MJQ_STATE_START_LAYOUT2,D);break;case MJQ_STATE_START_LAYOUT2:if(this.game.layoutLoaded){this.game.setLayout(!0),this.castGameLayer.anim.repaintAll(),this.castBackground.anim.repaintAll(),this.replay||(this.titleLabel.setText(this.game.layoutName),this.titleLabel.show(),this.titleLabel.move(Math.floor(MJQ_ACTIVITY_WIDTH/2-mjq_scaledValue(5)),-40)),mjq_playSound("tileshuffle");var D=1e3;void 0!==this.game.startSpecificGameDelay&&(D+=this.game.startSpecificGameDelay()),this.changeState(MJQ_STATE_START_LAYOUT_GAME_SPECIFIC,D),this.useSameSeed=!1}else this.changeState(MJQ_STATE_START_LAYOUT2,100);break;case MJQ_STATE_START_LAYOUT_GAME_SPECIFIC:void 0!==this.game.startSpecificGame&&this.game.startSpecificGame();var E=800;mjq_playSound("hudappear"),this.hudBackground.show();var F=mjq_gameObjects.hudBackground;this.hudBackground.moveTo(mjq_scaledValue(F.posend.x),MJQ_ACTIVITY_HEIGHT+mjq_scaledValue(F.posend.offsetFromBottom),E,Tween.regularEaseInOut),this.changeState(MJQ_STATE_PRE_READY,E);break;case MJQ_STATE_PRE_READY:this.getHintButton.fadeShow(1,this.HUD_ELEMENTS_FADETIME),this.getHintsLeft.fadeShow(1,this.HUD_ELEMENTS_FADETIME),this.getHintsLeft.setColor("#304030"),this.getHintButton.setEnabled(!0),this.undoButton.setEnabled(!0),this.optionsButtonGame.fadeShow(1,this.HUD_ELEMENTS_FADETIME),this.optionsButtonGame.setEnabled(!0),this.exitButton.fadeShow(1,this.HUD_ELEMENTS_FADETIME),this.exitButton.setEnabled(!0),this.game.scoreAmount.fadeShow(1,this.HUD_ELEMENTS_FADETIME),mjq_levels.timed?(this.timer.fadeShow(1,this.HUD_ELEMENTS_FADETIME),this.timerBar.move(this.timerBar.rect.x-this.timerBar.timerBarWidth,this.timerBar.rect.y),this.timer.setTimer(this.game.countDown?this.game.seconds:0,this.game.countDown),mjq_playSound("timerincrease")):(this.timerUntimed.fadeShow(1,this.HUD_ELEMENTS_FADETIME),this.timerBar.move(this.timerBar.clipX,this.timerBar.rect.y)),this.timerBar.fadeShow(1,this.HUD_ELEMENTS_FADETIME),this.timerBarOverlay.fadeShow(1,this.HUD_ELEMENTS_FADETIME-300),this.multiplierBar.fadeShow(1,this.HUD_ELEMENTS_FADETIME),this.multiplierBarOverlay.fadeShow(1,this.HUD_ELEMENTS_FADETIME-300),this.multiplierBar.init(),this.multiplierBar.start(),mjq_levels.timed||mjq_playSound("multiplierincrease"),this.changeState(MJQ_STATE_READY,1200);break;case MJQ_STATE_READY:this.replay=!1,this.autoPlayMode=0,this.dealing=!1,new MJQ_BigText(this,mjq_gameObjects.bigtextgo),mjq_playSound("go"),this.game.dealing=!1,this.dealing=!1,this.castGameLayer.anim.setMasterInput(!0),this.castBackground.anim.setMasterInput(!0),this.gameRecorded=!1,this.game.deck.revealTileFaces(!1),this.game.gameInProgress=!0,this.game.setPlayable(!0),this.game.showOnlyPlayableTiles(!1),this.mustReset||mjq_playMusic(this.gamePlayMusic),this.changeState(MJQ_STATE_PLAY);break;case MJQ_STATE_PLAY:this.mustReset?this.changeState(MJQ_STATE_RESET_DURING_PLAY):this.changeState(MJQ_STATE_PLAY,100);break;case MJQ_STATE_RESET_DURING_PLAY:this.mjq_buttonClicked(this.EXIT_BUTTON_ID,1);break;case MJQ_STATE_AUTOPLAY:this.game.showOnlyPlayableTiles(!1),this.game.preMatchedTiles.length>0?(this.game.autoPlayAMatch(),this.changeState(MJQ_STATE_AUTOPLAY,180)):this.changeState(MJQ_STATE_END_LAYOUT,600);break;case MJQ_STATE_AUTOPLAY_YINYANG:this.game.showOnlyPlayableTiles(!0),this.yinyangAutoPlaySpeed-=2,this.yinyangAutoPlaySpeed<50&&(this.yinyangAutoPlaySpeed=50),this.game.preMatchedTiles.length>0?(this.game.autoPlayAMatch(),this.changeState(MJQ_STATE_AUTOPLAY_YINYANG,this.yinyangAutoPlaySpeed)):this.game.numPlayableTiles>0?(this.game.autoPlayAnyOpenTiles(),this.changeState(MJQ_STATE_AUTOPLAY_YINYANG,this.yinyangAutoPlaySpeed)):this.changeState(MJQ_STATE_END_LAYOUT,600);break;case MJQ_STATE_END_LAYOUT:mjq_levels.timed&&this.game.seconds>0&&(this.timer.stopTimer(),this.timer.showFraction(!0)),this.multiplierBar.stopTimer(),this.optionsButtonGame.setEnabled(!1),this.exitButton.setEnabled(!1),this.undoButton.hide(),this.getHintButton.hide(),this.getHintsLeft.hide(),null!==this.game.selectedTile&&(this.game.selectedTile.setHilite(!1),this.game.selectedTile=null),null!==this.game.mouseOverObj&&this.game.mouseOverObj.hide(),this.game.deck.setEnabled(!1),this.game.gameInProgress=!1,this.game.endWhenTimesUp&&this.game.timesUp?(new MJQ_BigText(this,mjq_gameObjects.bigtextoutoftime,MJQ_STATE_END_LAYOUT2),mjq_playSound("complete")):this.changeState(MJQ_STATE_END_LAYOUT2,1);break;case MJQ_STATE_END_LAYOUT2:mjq_game.handleFirecrackerLit(!1);var G=0===this.game.numOpenTiles,i=this.game.endWhenTimesUp&&this.game.timesUp?200:500;this.changeState(G?MJQ_STATE_WON_LAYOUT:MJQ_STATE_LOST_LAYOUT,i);break;case MJQ_STATE_WON_LAYOUT:this.wonGameSet=!0,mjq_fadeOutMusic(this.gamePlayMusic,2e3),new MJQ_BigText(this,mjq_gameObjects.bigtextcomplete,MJQ_STATE_END_GAME,500),mjq_playSound("complete"),this.mustReset||(mjq_levels.timed?this.game.awardTimerBonus(!0):this.game.awardMultiplierBonus());break;case MJQ_STATE_LOST_LAYOUT:this.wonGameSet=!1,mjq_game.handleFirecrackerLit(!1),mjq_game.handleWildTileAnimation(!1),mjq_game.handleYinyangTileAnimation(!1),mjq_fadeOutMusic(this.gamePlayMusic,2e3),this.optionsButtonGame.setEnabled(!1),this.exitButton.setEnabled(!1),this.castForeground.forceDialogsDispose(),this.game.endWhenTimesUp&&this.game.timesUp?this.changeState(MJQ_STATE_END_GAME,200):(new MJQ_BigText(this,mjq_gameObjects.bigtextoutofmoves,MJQ_STATE_END_GAME,200),mjq_playSound("complete"));
break;case MJQ_STATE_END_GAME:if(!this.gameRecorded){this.gameRecorded=!0;var H=-1;this.game.seconds>0&&(H=10*this.game.seconds-this.timer.getValue()),this.recordGame(this.wonGameSet,this.game.getScore(),this.game.coins,H,this.numMoves,this.mapDirection,this.game.layoutNum,this.undoUsed)}this.castGameLayer.anim.repaintAll(),this.castBackground.anim.repaintAll(),mjq_playSound("dialogdisappear"),this.optionsButtonGame.setEnabled(!1),this.exitButton.setEnabled(!1),this.exitButton.hide(),this.mustReset||this.castForeground.forceDialogsDispose(),this.game.calcCoins(this.mapDirection,this.levelNum,this.wonGameSet),this.mustReset?this.changeState(MJQ_STATE_TILES_FLY_AWAY):mjq_console.postHighScore(this.game.score,this,MJQ_STATE_SHOW_SCORE_SUMMARY,100);break;case MJQ_STATE_SHOW_SCORE_SUMMARY:if(this.mustReset)this.changeState(MJQ_STATE_VIEWING_SCORE_SUMMARY_DIALOG);else{var I=this.progress.processGameResult(this.mapDirection,this.levelNum,this.game.score,this.game.coins);this.scoreSummaryDialog=new MJQ_ScoreSummaryDialog(this,this.castForeground.anim,this.SCORE_SUMMARY_DIALOG_ID,this,this.mapDirection,this.levelNum,I),this.scoreSummaryDialog.show(MJQ_DIALOG_BUTTONSET_NONE),this.scoreSummaryDialog.opening=!0,this.scoreSummaryDialog.setCueListener(this),this.scoreSummaryDialog.setMoveCue(),mjq_playSound("dialogappear");var A=Math.floor((MJQ_ACTIVITY_WIDTH-this.scoreSummaryDialog.rect.width)/2),B=Math.floor((MJQ_ACTIVITY_HEIGHT-this.scoreSummaryDialog.rect.height)/2);this.scoreSummaryDialog.move(-400,B);var C=[A+mjq_scaledValue(60),B];this.scoreSummaryDialog.moveTo(A,B,500,Tween.regularEaseOut,C),this.changeState(MJQ_STATE_VIEWING_SCORE_SUMMARY_DIALOG)}break;case MJQ_STATE_VIEWING_SCORE_SUMMARY_DIALOG:this.mustReset?(this.mjq_buttonClicked(this.EXIT_BUTTON_ID,1),mjq_fadeOutMusic(this.lastUsedEndGameMusic,3500),this.lastUsedEndGameMusic=null):this.changeState(MJQ_STATE_VIEWING_SCORE_SUMMARY_DIALOG,50);break;case MJQ_STATE_TILES_FLY_AWAY:this.castGameLayer.anim.setMasterInput(!1),this.castBackground.anim.setMasterInput(!1),this.game.deck.hideAllPlayedTiles(),this.tilesFlewAway=this.game.flyAway(),this.counter=0,this.changeState(MJQ_STATE_RESET_GAME,this.tilesFlewAway?2e3:500);break;case MJQ_STATE_RESET_GAME:this.wonGameSet=!1,this.gameRecorded=!1,this.numMoves=0,mjq_levels.timed&&this.game.seconds>0&&this.timer.stopTimer(),this.multiplierBar.stopTimer(),this.timer.fadeHide(this.HUD_ELEMENTS_FADETIME-300),this.timerBar.fadeHide(this.HUD_ELEMENTS_FADETIME-300),this.timerBarOverlay.fadeHide(this.HUD_ELEMENTS_FADETIME),this.timerUntimed.fadeHide(this.HUD_ELEMENTS_FADETIME-300),this.multiplierBar.fadeHide(this.HUD_ELEMENTS_FADETIME-300),this.multiplierBarOverlay.fadeHide(this.HUD_ELEMENTS_FADETIME);for(var x=1;5>=x;x++){var J=this.multiplierBar.multiplierValues[x];null!==J&&void 0!==J&&J.fadeHide(this.HUD_ELEMENTS_FADETIME-300)}this.game.scoreAmount.fadeHide(this.HUD_ELEMENTS_FADETIME),this.titleLabel.fadeHide(this.HUD_ELEMENTS_FADETIME),this.exitButton.hide(),this.optionsButtonGame.hide(),this.changeState(MJQ_STATE_RESET_GAME2,this.HUD_ELEMENTS_FADETIME);break;case MJQ_STATE_RESET_GAME2:this.game.reset(),this.game.deck.reset(),mjq_levels.timed&&this.game.seconds>0&&this.timer.setTimer(this.game.seconds,!0),mjq_playSound("huddisappear");var E=800;this.hudBackground.hideAfterMove=!0;var F=mjq_gameObjects.hudBackground;this.hudBackground.moveTo(mjq_scaledValue(F.posend.x),MJQ_ACTIVITY_HEIGHT+1,E,Tween.regularEaseInOut),this.game.unloadMahjongObjects(),this.changeState(MJQ_STATE_EXIT_GAME);break;case MJQ_STATE_EXIT_GAME:var u=this.mapDirection,i=400,r=this.lanterns[this.counter];r.fadeShow(1,i),r.setRow(this.counter+1===this.levelNum?1:0);var y=this.lanternNums[this.counter];y.fadeShow(1,i),this.counter++,this.counter<this.NUMLEVELS?this.changeState(MJQ_STATE_EXIT_GAME,this.mustReset?1:50):this.changeState(MJQ_STATE_RETURN_TO_LOCATION);break;case MJQ_STATE_RETURN_TO_LOCATION:this.backToHubButton.showBackToHubButton(),this.locationHeader.showHeader(),this.locationCoinsIcon.fadeShow(1,500),this.locationCoinsValue.fadeShow(1,500),this.locationCoinsSlashValue.fadeShow(1,500),this.optionsButton.fadeShow(1,this.HUD_ELEMENTS_FADETIME),this.showLanternHangers(),this.showLightBulbs(),this.mustReset||mjq_playMusic(this.levelSelectMusic),this.changeState(MJQ_STATE_RETURN_TO_LOCATION2,this.mustReset?1:500);break;case MJQ_STATE_RETURN_TO_LOCATION2:this.numCoinsToAward=this.progress.calcLocationCoins(this.mapDirection)-this.locationCoinsValue.value,this.coinsWereEarned=this.numCoinsToAward>=1,this.mustReset&&(this.numCoinsToAward=0),this.changeState(this.numCoinsToAward>=1?MJQ_STATE_AWARD_LOCATION_COIN:MJQ_STATE_UNLOCK_NEXT_LEVEL);break;case MJQ_STATE_AWARD_LOCATION_COIN:var K=this.lanterns[this.levelNum-1],l=new MJQ_CastMemberImage(mjq_gameObjects.locationCoinAward);l.move(K.centerX()-Math.floor(l.rect.width/2),K.rect.y+Math.floor(K.rect.height/4)),l.setCueListener(this),l.setMoveCue(),l.moveTo(this.locationCoinsIcon.rect.x-Math.floor((l.rect.width-this.locationCoinsIcon.rect.width)/2),this.locationCoinsIcon.rect.y-Math.floor((l.rect.height-this.locationCoinsIcon.rect.height)/2),350,Tween.regularEaseOut),mjq_playSound("coinawardflying");break;case MJQ_STATE_AWARD_LOCATION_COIN_BUMP:this.numCoinsToAward--;var g=this.locationCoinsValue.value+1;this.locationCoinsValue.setNumber(g),mjq_playSound("coinawardarrived");var h=mjq_scaledValue(90);if(g>=100?h=mjq_scaledValue(124):g>=10&&(h=mjq_scaledValue(110)),this.locationCoinsSlashValue.move(this.locationCoinsValue.rect.x+h,this.locationCoinsValue.rect.y),this.numCoinsToAward>0)this.changeState(MJQ_STATE_AWARD_LOCATION_COIN);else if(this.mustCheckForUnlock&&this.coinsWereEarned){var K=this.lanterns[this.levelNum-1];K.setRow(0),this.nextLevelNum++,this.changeState(MJQ_STATE_UNLOCK_NEXT_LEVEL)}else this.changeState(MJQ_STATE_WAIT_FOR_LEVEL_SELECTION);break;case MJQ_STATE_UNLOCK_NEXT_LEVEL:this.mustReset?this.changeState(MJQ_STATE_WAIT_FOR_LEVEL_SELECTION):this.turnOnNextLightBulb()>=0?this.changeState(MJQ_STATE_UNLOCK_NEXT_LEVEL,500):this.changeState(MJQ_STATE_UNLOCK_NEXT_LEVEL2);break;case MJQ_STATE_UNLOCK_NEXT_LEVEL2:this.turnOnNextLantern(),this.changeState(MJQ_STATE_WAIT_FOR_LEVEL_SELECTION);break;case MJQ_STATE_GO_HUB:mjq_playSound("buttonclick"),mjq_fadeOutMusic(this.levelSelectMusic,1500),this.castGameLayer.anim.setMasterInput(!1),this.castBackground.anim.setMasterInput(!1);var i=this.crossFadeTime;for(this.backToHubButton.fadeHide(i),this.locationHeader.fadeHide(i),this.locationCoinsIcon.fadeHide(i),this.locationCoinsValue.fadeHide(i),this.locationCoinsSlashValue.fadeHide(i),this.hideLanternHangers(),this.hideLightBulbs(),x=0;x<this.NUMLEVELS;x++)this.lanterns[x].fadeHide(i),this.lanternNums[x].fadeHide(i);mjq_setBackground(this.backgroundMainHubImage,i),this.changeState(MJQ_STATE_GO_HUB2,i);break;case MJQ_STATE_GO_HUB2:for(this.backToHubButton.setCast(null),this.backToHubButton=null,this.locationHeader.setCast(null),this.locationHeader=null,this.locationCoinsIcon.setCast(null),this.locationCoinsIcon=null,this.locationCoinsValue.setCast(null),this.locationCoinsValue=null,this.locationCoinsSlashValue.setCast(null),this.locationCoinsSlashValue=null,x=0;x<this.NUMLEVELS;x++)null!==this.lanterns[x]&&void 0!==this.lanterns[x]&&(this.lanterns[x].setCast(null),this.lanterns[x]=null,this.lanternNums[x].setCast(null),this.lanternNums[x]=null);var i=500;this.northButton.fadeShow(1,i),this.southButton.fadeShow(1,i),this.eastButton.fadeShow(1,i),this.westButton.fadeShow(1,i),this.splashLogo.fadeShow(1,i),this.totalScoreLable.fadeShow(1,i),this.totalScoreValue.fadeShow(1,i),this.totalCoinsLable.fadeShow(1,i),this.totalCoinsIcon.fadeShow(1,i),this.totalCoinsValue.fadeShow(1,i),this.totalCoinsSlashValue.fadeShow(1,i),this.returningFromDirectionButton=this.directionButton,this.mapDirection="hub",this.directionButton=null,this.directionGameObject=null,this.artAssetsFileNameLocation="",this.backToHubButton=null,this.locationHeader=null,this.changeState(MJQ_STATE_GO_HUB3,i);break;case MJQ_STATE_GO_HUB3:mjq_playMusic(this.mainMenuMusic),this.changeState(MJQ_STATE_LOAD_GAMEPATH)}},MJQ_GameScript.prototype.mjq_dialogButtonClicked=function(a,b){if(a===this.SCORE_SUMMARY_DIALOG_ID)mjq_playSound("buttonclick"),b===MJQ_DIALOG_BUTTON_CANCEL&&(this.mjq_buttonClicked(this.EXIT_BUTTON_ID,1),mjq_fadeOutMusic(this.lastUsedEndGameMusic,3500),this.lastUsedEndGameMusic=null);else if(a===this.LEVEL_PREVIEW_DIALOG_ID)mjq_playSound("lanternclick"),b===MJQ_DIALOG_BUTTON_OK?(this.levelPreviewCancelClicked=!1,this.changeState(MJQ_STATE_FADEOUT_BEFORE_LAYOUT)):(this.levelPreviewCancelClicked=!0,this.changeState(MJQ_STATE_WAIT_FOR_LEVEL_SELECTION));else if(a===this.OPTIONS_DIALOG_ID)b===MJQ_DIALOG_BUTTON_SOUND_EFFECTS?this.optionsDialog.soundEffectsButtonItem.enabled&&(mjq_playSound("optionstoggleclick"),this.changeSounds(),this.optionsDialog.soundEffectsButtonItem.row=mjq_soundOn?0:1,this.optionsDialog.repaint(),mjq_playSound("optionstoggleclick")):b===MJQ_DIALOG_BUTTON_MUSIC?this.optionsDialog.musicButtonItem.enabled&&(mjq_playSound("optionstoggleclick"),this.changeMusic(),this.optionsDialog.musicButtonItem.row=mjq_musicOn?0:1,this.optionsDialog.repaint(),mjq_handleMusicOption(this.musicObjects)):b===MJQ_DIALOG_BUTTON_PLAYABLE_TILES?(mjq_playSound("optionstoggleclick"),this.changeDimTiles(),this.optionsDialog.playableTilesButtonItem.row=mjq_dimTilesOn?0:1,this.optionsDialog.repaint(),this.game.showOnlyPlayableTiles(!1)):b===MJQ_DIALOG_BUTTON_INFO?(this.mustShowRulesDialog=!0,mjq_playSound("buttonclick")):b===MJQ_DIALOG_BUTTON_CANCEL&&mjq_playSound("buttonclick");else if(a===this.EXIT_DIALOG_ID)mjq_playSound("buttonclick"),b===MJQ_DIALOG_BUTTON_YES&&this.forceGameplayExit();else if(a===this.RULES_DIALOG_ID)if(mjq_playSound("buttonclick"),b===MJQ_DIALOG_BUTTON_LEFT){var c=this.rulesDialog.pageBack();c&&this.rulesDialog.leftButtonItem.setEnabled(!1),this.rulesDialog.rightButtonItem.setEnabled(!0)}else if(b===MJQ_DIALOG_BUTTON_RIGHT){var d=this.rulesDialog.pageForward();d&&this.rulesDialog.rightButtonItem.setEnabled(!1),this.rulesDialog.leftButtonItem.setEnabled(!0)}},MJQ_GameScript.prototype.mjq_dialogItemSet=function(){},MJQ_GameScript.prototype.mjq_dialogDetached=function(a){var b=MJQ_ACTIVITY_WIDTH,c=MJQ_ACTIVITY_HEIGHT;if(a===this.SCORE_SUMMARY_DIALOG_ID){var d=b-(this.scoreSummaryDialog.rect.width+mjq_scaledValue(3)),e=[this.scoreSummaryDialog.getX()-mjq_scaledValue(60),this.scoreSummaryDialog.getY()];return this.scoreSummaryDialog.setCueListener(this),this.scoreSummaryDialog.setMoveCue(),this.scoreSummaryDialog.moveTo(b+mjq_scaledValue(200),this.scoreSummaryDialog.getY(),500,Tween.regularEaseIn,e),mjq_playSound("dialogdisappear"),!0}if(a===this.OPTIONS_DIALOG_ID){var d=b-(this.optionsDialog.rect.width+mjq_scaledValue(3)),e=[this.optionsDialog.getX()-mjq_scaledValue(60),this.optionsDialog.getY()];return this.optionsDialog.setCueListener(this),this.optionsDialog.setMoveCue(),this.optionsDialog.moveTo(b+mjq_scaledValue(200),this.optionsDialog.getY(),500,Tween.regularEaseIn,e),mjq_playSound("dialogdisappear"),this.game.gameInProgress&&(this.game.deck.revealTileFaces(!1),this.timer.unpauseTimer(),this.multiplierBar.unpauseTimer()),!0}if(a===this.EXIT_DIALOG_ID){var d=b-(this.exitDialog.rect.width+mjq_scaledValue(3)),e=[this.exitDialog.getX()-mjq_scaledValue(60),this.exitDialog.getY()];return this.exitDialog.setCueListener(this),this.exitDialog.setMoveCue(),this.exitDialog.moveTo(b+mjq_scaledValue(200),this.exitDialog.getY(),500,Tween.regularEaseIn,e),mjq_playSound("dialogdisappear"),this.game.gameInProgress&&(this.game.deck.revealTileFaces(!1),this.timer.unpauseTimer(),this.multiplierBar.unpauseTimer()),!0}if(a===this.LOG_IN_OUT_DIALOG_ID){var d=b-(this.logInOutDialog.rect.width+mjq_scaledValue(3)),e=[this.logInOutDialog.getX()-mjq_scaledValue(60),this.logInOutDialog.getY()];return this.logInOutDialog.setCueListener(this),this.logInOutDialog.setMoveCue(),this.logInOutDialog.moveTo(b+mjq_scaledValue(200),this.logInOutDialog.getY(),500,Tween.regularEaseIn,e),mjq_playSound("dialogdisappear"),this.optionsButton.setEnabled(!0),!0}if(a===this.LEVEL_PREVIEW_DIALOG_ID){if(this.levelPreviewDialog.setCueListener(this),this.levelPreviewDialog.setMoveCue(),this.levelPreviewCancelClicked){var d=Math.floor(b-(this.levelPreviewDialog.rect.width+mjq_scaledValue(3))),e=[this.levelPreviewDialog.getX()-mjq_scaledValue(60),this.levelPreviewDialog.getY()];this.levelPreviewDialog.moveTo(b+mjq_scaledValue(200),this.levelPreviewDialog.getY(),500,Tween.regularEaseIn,e)}else{var d=Math.floor((b-this.levelPreviewDialog.rect.width)/2),e=[d,c-this.levelPreviewDialog.rect.height-60];this.levelPreviewDialog.moveTo(d,c+100,300,Tween.regularEaseIn,e),this.levelPreviewDialog.fadeOut(0,300)}return mjq_playSound("dialogdisappear"),!0}if(a===this.RULES_DIALOG_ID){var d=b-(this.rulesDialog.rect.width+mjq_scaledValue(3)),e=[this.rulesDialog.getX()-mjq_scaledValue(60),this.rulesDialog.getY()];return this.rulesDialog.setCueListener(this),this.rulesDialog.setMoveCue(),this.rulesDialog.moveTo(b+mjq_scaledValue(200),this.rulesDialog.getY(),500,Tween.regularEaseIn,e),mjq_playSound("dialogdisappear"),!0}return!1},MJQ_GameScript.prototype.mjq_buttonClicked=function(a,b){if(a===this.RETURNTOHUB_BUTTON_ID)this.changeState(MJQ_STATE_GO_HUB);else if(a===this.NORTH_BUTTON_ID)this.changeState(MJQ_STATE_GO_NORTH);else if(a===this.SOUTH_BUTTON_ID)this.changeState(MJQ_STATE_GO_SOUTH);else if(a===this.EAST_BUTTON_ID)this.changeState(MJQ_STATE_GO_EAST);else if(a===this.WEST_BUTTON_ID)this.changeState(MJQ_STATE_GO_WEST);else if(a>=this.LEVEL_MARKERS_NORTH_BUTTON_ID&&a<=this.LEVEL_MARKERS_NORTH_BUTTON_ID+99)this.levelNum=a-this.LEVEL_MARKERS_NORTH_BUTTON_ID+1,this.changeState(MJQ_STATE_PREVIEW_LEVEL_SELECTION);else if(a>=this.LEVEL_MARKERS_SOUTH_BUTTON_ID&&a<=this.LEVEL_MARKERS_SOUTH_BUTTON_ID+99)this.levelNum=a-this.LEVEL_MARKERS_SOUTH_BUTTON_ID+1,this.changeState(MJQ_STATE_PREVIEW_LEVEL_SELECTION);else if(a>=this.LEVEL_MARKERS_EAST_BUTTON_ID&&a<=this.LEVEL_MARKERS_EAST_BUTTON_ID+99)this.levelNum=a-this.LEVEL_MARKERS_EAST_BUTTON_ID+1,this.changeState(MJQ_STATE_PREVIEW_LEVEL_SELECTION);else if(a>=this.LEVEL_MARKERS_WEST_BUTTON_ID&&a<=this.LEVEL_MARKERS_WEST_BUTTON_ID+99)this.levelNum=a-this.LEVEL_MARKERS_WEST_BUTTON_ID+1,this.changeState(MJQ_STATE_PREVIEW_LEVEL_SELECTION);else if(a===this.RULES_BUTTON_ID)0===b&&mjq_playSound("buttonclick");else if(a===this.OPTIONS_BUTTON_ID){0===b&&mjq_playSound("buttonclick");if(0===b){this.castGameLayer.anim.setMasterInput(!1),this.castBackground.anim.setMasterInput(!1),this.game.gameInProgress&&(this.game.deck.revealTileFaces(!0),this.timer.pauseTimer(),this.multiplierBar.pauseTimer()),this.optionsDialog=new MJQ_OptionsDialog(this,this.castForeground.anim,this.OPTIONS_DIALOG_ID,this),this.optionsDialog.show(MJQ_DIALOG_BUTTONSET_NONE),this.optionsDialog.opening=!0,this.optionsDialog.setCueListener(this),this.optionsDialog.setMoveCue(),mjq_playSound("dialogappear");var c=Math.floor((MJQ_ACTIVITY_WIDTH-this.optionsDialog.rect.width)/2),d=Math.floor((MJQ_ACTIVITY_HEIGHT-this.optionsDialog.rect.height)/2);this.optionsDialog.move(-400,d);var e=[c+mjq_scaledValue(60),d];this.optionsDialog.moveTo(c,d,500,Tween.regularEaseOut,e),this.optionsDialog.setPriority(1)}}else if(a===this.EXIT_BUTTON_ID){0===b&&mjq_playSound("buttonclick");if(0===b){this.castGameLayer.anim.setMasterInput(!1),this.castBackground.anim.setMasterInput(!1),this.game.gameInProgress&&(this.game.deck.revealTileFaces(!0),this.timer.pauseTimer(),this.multiplierBar.pauseTimer()),this.exitDialog=new MJQ_ExitDialog(this,this.castForeground.anim,this.EXIT_DIALOG_ID,this),this.exitDialog.show(MJQ_DIALOG_BUTTONSET_NONE),this.exitDialog.opening=!0,this.exitDialog.setCueListener(this),this.exitDialog.setMoveCue(),mjq_playSound("dialogappear");var c=Math.floor((MJQ_ACTIVITY_WIDTH-this.exitDialog.rect.width)/2),d=Math.floor((MJQ_ACTIVITY_HEIGHT-this.exitDialog.rect.height)/2);this.exitDialog.move(-400,d);var e=[c+mjq_scaledValue(60),d];this.exitDialog.moveTo(c,d,500,Tween.regularEaseOut,e)}else this.mustReset||this.castForeground.forceDialogsDispose(),this.handleExitButton(a,b)}else a===this.UNDO_BUTTON_ID?(mjq_playSound("undo"),null!==this.game.deck&&void 0!==this.game.deck&&this.game.deck.undo()&&(this.castForeground.forceDialogsDispose(),this.numMoves--,0===this.numMoves&&this.undoButton.hide(),this.game.showOnlyPlayableTiles(!1),this.multiplierBar.addToMultiplierBar(0-mjq_scaledValue(this.multiplierBar.getRateOfIncrease()),!0))):a===this.GETHINT_BUTTON_ID?(mjq_playSound("hint"),this.game.hintsLeft>=1&&(this.castForeground.forceDialogsDispose(),this.game.allowUnlimitedHints||this.game.hintsLeft--,this.getHintsLeft.setText(""+this.game.hintsLeft),this.game.getHint(),0===this.game.hintsLeft&&(this.getHintButton.setEnabled(!1),this.getHintsLeft.setColor("#607060")))):a===this.TAPTOSTART_BUTTON_ID&&(this.tapToStart.hide(),this.tapToStart.setEnabled(!1),this.tapToStart.setButtonListener(null),this.tapToStart.setCast(null),this.changeState(MJQ_STATE_SHOW_LOGO2,1))},MJQ_GameScript.prototype.handleExitButton=function(){mjq_playSound("buttonclick"),this.optionsButton.setEnabled(!1),this.exitButton.setEnabled(!1),this.getHintButton.setEnabled(!1),this.undoButton.setEnabled(!1),this.getHintButton.hide(),this.getHintsLeft.hide(),this.undoButton.hide(),this.game.restarting=!0,this.game.gameInProgress=!1,mjq_fadeOutMusic(this.gamePlayMusic,3500),this.changeState(MJQ_STATE_TILES_FLY_AWAY,800)},MJQ_GameScript.prototype.mjq_inputCatcherMouseDown=function(){},MJQ_GameScript.prototype.mjq_cue=function(a,b){"JSON"===b&&this.changeState(this.getState()+1),"MJQ_CastMemberDialog"===a.type&&(a.opening?a.opening=!1:(a.shown=!1,a.setCast(null),null===this.castForeground.dialog&&(this.castGameLayer.anim.setMasterInput(!0),this.castBackground.anim.setMasterInput(!0)))),"locationCoinAward"===a.name?(a.setCast(null),this.changeState(MJQ_STATE_AWARD_LOCATION_COIN_BUMP)):"hubCoinAward"===a.name&&(a.setCast(null),this.changeState(MJQ_STATE_AWARD_HUB_COIN_BUMP))},MJQ_GameScript.prototype.handleLogOut=function(){if(!this.gameRecorded){this.gameRecorded=!0;var a=-1;this.game.seconds>0&&(a=10*this.game.seconds-this.timer.getValue()),this.recordGame(this.wonGameSet,this.game.getScore(),this.game.coins,a,this.numMoves,this.mapDirection,this.game.layoutNum,this.undoUsed)}},MJQ_GameScript.prototype.recordGame=function(){},MJQ_GameScript.prototype.setSeed=function(a){void 0===a&&(a=!1),a?(mjq_randomGen=new MersenneTwister(mjq_gameSeed),mjq_gameSeed=mjq_randomGen.getSeed()):(mjq_randomGen=new MersenneTwister,mjq_gameSeed=mjq_randomGen.getSeed())},MJQ_GameScript.prototype.showLanternHangers=function(){if(null===this.lanternHangers[0]||void 0===this.lanternHangers[0]){for(var a=0;2>=a;a++)this.lanternHangers[a]=new MJQ_CastMemberImage(mjq_gameObjects.lanternHanger),this.lanternHangers[a].setRotation(this.lanternObject.linerotation[a]),this.lanternHangers[a].move(this.lanternHangers[a].rect.x+mjq_scaledValue(this.lanternObject.linex[a]),mjq_scaledValue(this.lanternObject.liney[a])),this.lanternHangers[a].show();this.castBackground.anim.repaintAll(!0)}},MJQ_GameScript.prototype.showLightBulbs=function(){if(null===this.lightBulbs[0]||void 0===this.lightBulbs[0]){var a="";"north"===this.mapDirection?a="lightBulbNorth":"south"===this.mapDirection?a="lightBulbSouth":"east"===this.mapDirection?a="lightBulbEast":"west"===this.mapDirection&&(a="lightBulbWest");for(var b=mjq_gameObjects[a],c=b.posx.length,d=1,e=0;c>e;e++)0!==b.posx[e]?(this.lightBulbs[e]=new MJQ_CastMemberImage(b),this.lightBulbs[e].move(mjq_scaledValue(b.posx[e]),mjq_scaledValue(b.posy[e])),this.lightBulbs[e].fadeShow(1,500),this.lightBulbs[e].lanternNum=d,this.nextLevelNum>=d&&(this.lightBulbs[e].setFrame(1),this.lightBulbs[e].setScript(new MJQ_LightBulbScript(this.lightBulbs[e])))):(this.lightBulbs[e]=null,d++)}},MJQ_GameScript.prototype.turnOnNextLightBulb=function(){for(var a=this.lightBulbs.length,b=0;a>b;b++)if(null!==this.lightBulbs[b]&&this.lightBulbs[b].lanternNum<=this.nextLevelNum&&0===this.lightBulbs[b].frame){if(this.lightBulbs[b].setFrame(1),null===this.lightBulbs[b].script){var c=new MJQ_LightBulbScript(this.lightBulbs[b]);this.lightBulbs[b].setScript(c),c.changeState(10)}return b}return-1},MJQ_GameScript.prototype.turnOnNextLantern=function(){var a=this.lanterns[this.nextLevelNum-1];null!==a&&void 0!==a&&(a.setEnabled(!0),null===a.script&&(a.setRow(1),a.setScript(new MJQ_LanternScript(a)),mjq_playSound("lanternlightsup")))},MJQ_GameScript.prototype.hideLanternHangers=function(){for(var a=0;2>=a;a++)null!==this.lanternHangers[a]&&void 0!==this.lanternHangers[a]&&(this.lanternHangers[a].setScript(null),this.lanternHangers[a].setCast(null),this.lanternHangers[a]=null);this.castBackground.anim.repaintAll(!0)},MJQ_GameScript.prototype.hideLightBulbs=function(){for(var a=this.lightBulbs.length,b=0;a>b;b++)null!==this.lightBulbs[b]&&void 0!==this.lightBulbs[b]&&(this.lightBulbs[b].setScript(null),this.lightBulbs[b].fadeRemove(500),this.lightBulbs[b]=null)},MJQ_GameScript.prototype.showRulesDialog=function(){this.rulesDialog=new MJQ_RulesDialog(this,this.castForeground.anim,this.RULES_DIALOG_ID,this,this.mapDirection),this.rulesDialog.show(MJQ_DIALOG_BUTTONSET_NONE),this.rulesDialog.opening=!0,this.rulesDialog.setCueListener(this),this.rulesDialog.setMoveCue(),mjq_playSound("dialogappear");var a=Math.floor((MJQ_ACTIVITY_WIDTH-this.rulesDialog.rect.width)/2),b=Math.floor((MJQ_ACTIVITY_HEIGHT-this.rulesDialog.rect.height)/2);this.rulesDialog.move(-400,b);var c=[a+mjq_scaledValue(60),b];this.rulesDialog.moveTo(a,b,500,Tween.regularEaseOut,c),this.rulesDialog.setPriority(-1)},MJQ_GameScript.prototype.changeSounds=function(){mjq_soundOn=mjq_soundOn?!1:!0,window.localStorage.mjq_soundOn=mjq_soundOn},MJQ_GameScript.prototype.changeMusic=function(){mjq_musicOn=mjq_musicOn?!1:!0,window.localStorage.mjq_musicOn=mjq_musicOn},MJQ_GameScript.prototype.changeDimTiles=function(){mjq_dimTilesOn=mjq_dimTilesOn?!1:!0,window.localStorage.mjq_dimTilesOn=mjq_dimTilesOn},MJQ_GameScript.prototype.setSoundOption=function(){var a=window.localStorage.mjq_soundOn;mjq_soundOn=void 0===a||"true"===a},MJQ_GameScript.prototype.setMusicOption=function(){var a=window.localStorage.mjq_musicOn;mjq_musicOn=void 0===a||"true"===a},MJQ_GameScript.prototype.setDimTilesOption=function(){var a=window.localStorage.mjq_dimTilesOn;mjq_dimTilesOn=void 0===a||"true"===a},MJQ_GameScript.prototype.visibilityChanged=function(a){a?(mjq_muteAllAudio(),this.game.gameInProgress&&!this.timer.paused&&(this.timer.pauseTimer(),this.multiplierBar.pauseTimer(),this.pausedByVisibility=!0)):(mjq_unmuteAllAudio(),this.pausedByVisibility&&(this.timer.unpauseTimer(),this.multiplierBar.unpauseTimer()),this.pausedByVisibility=!1)},MJQ_GameScript.prototype.forceGameplayExit=function(){this.mjq_buttonClicked(this.EXIT_BUTTON_ID,1),null!==mjq_levels&&void 0!==mjq_levels&&mjq_levels.timed&&null!==this.timer&&this.timer.stopTimer(),null!==this.multiplierBar&&this.multiplierBar.stopTimer()},MJQ_GameScript.prototype.showLogInOutDialog=function(a){this.castGameLayer.anim.setMasterInput(!1),this.castBackground.anim.setMasterInput(!1),this.castForeground.forceDialogsDispose(),this.logInOutDialog=new MJQ_LogInOutDialog(this,this.castForeground.anim,this.LOG_IN_OUT_DIALOG_ID,this,a),this.logInOutDialog.show(MJQ_DIALOG_BUTTONSET_NONE),this.logInOutDialog.opening=!0,this.logInOutDialog.setCueListener(this),this.logInOutDialog.setMoveCue(),mjq_playSound("dialogappear");var b=Math.floor((MJQ_ACTIVITY_WIDTH-this.logInOutDialog.rect.width)/2),c=Math.floor((MJQ_ACTIVITY_HEIGHT-this.logInOutDialog.rect.height)/2);this.logInOutDialog.move(-400,c);var d=[b+mjq_scaledValue(60),c];this.logInOutDialog.moveTo(b,c,500,Tween.regularEaseOut,d)},MJQ_GameScript.prototype.resetOnLogInOut=function(a){a||this.progress.init(),this.allowSignedInDirective&&(this.showLogInOutDialog(a),this.mustReset=!0,this.mustResetLoggingIn=a)},MJQ_LanternScript.mjq_isSubclassOf(MJQ_Script),MJQ_LanternScript.prototype.doState=function(a){var b=this.lanternObj,c=0,d=0,e=1200,f=2500,g=7;switch(a){case 0:d=b.rotation>=0?0-mjq_getRandomInt(1,g):mjq_getRandomInt(1,g),c=mjq_getRandomInt(e,f),b.setCueListener(this),b.setRotateCue(),b.rotateTo(d,c,Tween.regularEaseInOut);break;case 1:d=b.rotation>=0?0-mjq_getRandomInt(0,g):mjq_getRandomInt(0,g),c=mjq_getRandomInt(e,f),b.setCueListener(this),b.setRotateCue(),b.rotateTo(d,c,Tween.regularEaseInOut)}},MJQ_LanternScript.prototype.mjq_cue=function(){var a=300,b=mjq_getRandomInt(1,a);this.changeState(1-this.state,b)},MJQ_Lantern.mjq_isSubclassOf(MJQ_CastMemberButton),MJQ_Lantern.prototype.onRotate=function(){null!==this.levelNumMem&&void 0!==this.levelNumMem&&this.levelNumMem.repaint()},MJQ_LightBulbScript.mjq_isSubclassOf(MJQ_Script),MJQ_LightBulbScript.prototype.doState=function(a){var b=this.lightBulbObj,c=0,d=0,e=65,f=80,g=0,h=100,i=300,j=200;switch(a){case 0:c=mjq_getRandomInt(h,i),d=mjq_getRandomInt(1,j),1===b.getFrame()&&(g=mjq_getRandomInt(e,f)/100,b.fadeOut(g,c)),this.changeState(1,c+d);break;case 1:c=mjq_getRandomInt(h,i),d=mjq_getRandomInt(1,j+300),1===b.getFrame()&&(g=mjq_getRandomInt(e+20,f+20)/100,b.fadeIn(g,c)),this.changeState(0,c+d);break;case 10:this.counter=3,this.changeState(11),mjq_playSound("lightbulbon");break;case 11:c=mjq_getRandomInt(60-5*this.counter,90-5*this.counter),b.setFrame(0),this.changeState(12,c);break;case 12:c=mjq_getRandomInt(20+5*this.counter,40+5*this.counter),b.setFrame(1),this.counter--,this.counter>0?this.changeState(11,c):this.changeState(0)}},MJQ_LevelPreviewDialog.mjq_isSubclassOf(MJQ_CastMemberDialog),MJQ_LevelPreviewDialog.prototype.setup=function(){this.useAbsolutePositioning=!0,this.setDimensions(mjq_scaledValue(1030),mjq_scaledValue(1090)),this.setColors("#fdd57a","#280000","#ffffff","#ff4848"),this.setBorderThickness(0),this.setFontAttributes("Samurai",this.dialogFontSize,MJQ_TEXT_PLAIN,2),this.setBackImage(mjq_imageHolders.dialogmedium);var a=null,progress=this.script.progress,b=null,c="";"north"===this.mapDirection?(c="lableuntimedquest",b=progress.northLevels[this.levelNum]):"south"===this.mapDirection?(c="lableclassicuntimed",b=progress.southLevels[this.levelNum]):"east"===this.mapDirection?(c="labletimedquest",b=progress.eastLevels[this.levelNum]):"west"===this.mapDirection&&(c="lableclassictimed",b=progress.westLevels[this.levelNum]);var d=mjq_imageHolders[c].rows[0][0].width;this.addImage(mjq_imageHolders[c],Math.floor((mjq_scaledValue(1030)-d)/2),mjq_scaledValue(134)),a=this.addText("Level "+this.levelNum+" - "+this.game.layoutName,mjq_scaledValue(512),mjq_scaledValue(234)),a.setTextJustify(MJQ_TEXT_CENTER),this.setFontAttributes("Samurai",this.dialogFontSizePlus,MJQ_TEXT_PLAIN,2),a=this.addText("Your Best: "+mjq_formatIntNumber(b.score),mjq_scaledValue(512),mjq_scaledValue(310)),a.setTextJustify(MJQ_TEXT_CENTER),a=this.addImage(mjq_imageHolders.dialogcoins,mjq_scaledValue(324),mjq_scaledValue(0)),b.coins>=1&&a.setFrame(1),a=this.addImage(mjq_imageHolders.dialogcoins,mjq_scaledValue(464),mjq_scaledValue(10)),b.coins>=2&&a.setFrame(1),a=this.addImage(mjq_imageHolders.dialogcoins,mjq_scaledValue(604),mjq_scaledValue(0)),3===b.coins&&a.setFrame(1);var e={};e.rows=[[]],e.rows[0][0]=this.game.previewLayout,this.addImage(e,mjq_scaledValue(40),mjq_scaledValue(350)),this.button1Item=this.addButton(mjq_imageHolders.dialogplay,mjq_scaledValue(366),mjq_scaledValue(930),MJQ_DIALOG_BUTTON_OK),this.button2Item=this.addButton(mjq_imageHolders.dialogxbutton,mjq_scaledValue(870),mjq_scaledValue(92),MJQ_DIALOG_BUTTON_CANCEL),this.button2Item.hotRectPadding=40,this.setPriority(-1)},MJQ_LevelPreviewDialog.prototype.show=function(a,b,c,d){this.repaint(),MJQ_CastMemberDialog.prototype.show.call(this,a,b,c,d)},MJQ_OptionsDialog.mjq_isSubclassOf(MJQ_CastMemberDialog),MJQ_OptionsDialog.prototype.setup=function(){this.useAbsolutePositioning=!0,this.setDimensions(mjq_scaledValue(1030),mjq_scaledValue(1090)),this.setBorderThickness(0),this.setFontAttributes("Samurai",this.dialogFontSize,MJQ_TEXT_PLAIN,2),this.setBackImage(mjq_imageHolders.dialogmedium);var a=null,b=mjq_imageHolders.lableoptions.rows[0][0].width;this.addImage(mjq_imageHolders.lableoptions,Math.floor((mjq_scaledValue(1030)-b)/2),mjq_scaledValue(150)),this.setColors(mjq_forceSoundOff?"#c0c0c0":"#fdd57a","#280000","#ffffff","#ff4848"),a=this.addText("Sound Effects",mjq_scaledValue(620),mjq_scaledValue(384)),a.setTextJustify(MJQ_TEXT_RIGHT),this.setColors(mjq_forceMusicOff?"#c0c0c0":"#fdd57a","#280000","#ffffff","#ff4848"),a=this.addText("Music",mjq_scaledValue(620),mjq_scaledValue(504)),a.setTextJustify(MJQ_TEXT_RIGHT),this.setColors("#fdd57a","#280000","#ffffff","#ff4848"),a=this.addText("Dim Tiles",mjq_scaledValue(620),mjq_scaledValue(624)),a.setTextJustify(MJQ_TEXT_RIGHT),this.soundEffectsButtonItem=this.addButton(mjq_imageHolders.dialogonoffbutton,mjq_scaledValue(680),mjq_scaledValue(384),MJQ_DIALOG_BUTTON_SOUND_EFFECTS),this.soundEffectsButtonItem.row=mjq_soundOn?0:1,this.soundEffectsButtonItem.detachOnClick=!1,mjq_forceSoundOff&&(this.soundEffectsButtonItem.row=1,this.soundEffectsButtonItem.setEnabled(!1)),this.musicButtonItem=this.addButton(mjq_imageHolders.dialogonoffbutton,mjq_scaledValue(680),mjq_scaledValue(504),MJQ_DIALOG_BUTTON_MUSIC),this.musicButtonItem.row=mjq_musicOn?0:1,this.musicButtonItem.detachOnClick=!1,mjq_forceMusicOff&&(this.musicButtonItem.row=1,this.musicButtonItem.setEnabled(!1)),this.playableTilesButtonItem=this.addButton(mjq_imageHolders.dialogonoffbutton,mjq_scaledValue(680),mjq_scaledValue(624),MJQ_DIALOG_BUTTON_PLAYABLE_TILES),this.playableTilesButtonItem.row=mjq_dimTilesOn?0:1,this.playableTilesButtonItem.detachOnClick=!1;var c=-50;this.infoButtonItem=this.addButton(mjq_imageHolders.infobutton,mjq_scaledValue(310),mjq_scaledValue(870+c),MJQ_DIALOG_BUTTON_INFO),this.infoButtonItem.detachOnClick=!0,this.infoButtonItem.hotRectPadding=20,a=this.addText("Game Rules",mjq_scaledValue(450),mjq_scaledValue(878+c),"#92D7B7"),a.setTextJustify(MJQ_TEXT_LEFT),this.button2Item=this.addButton(mjq_imageHolders.dialogxbutton,mjq_scaledValue(870),mjq_scaledValue(92),MJQ_DIALOG_BUTTON_CANCEL),this.button2Item.hotRectPadding=40,this.setPriority(-1)},MJQ_OptionsDialog.prototype.show=function(a,b,c,d){this.repaint(),MJQ_CastMemberDialog.prototype.show.call(this,a,b,c,d)},MJQ_ExitDialog.mjq_isSubclassOf(MJQ_CastMemberDialog),MJQ_ExitDialog.prototype.setup=function(){this.useAbsolutePositioning=!0,this.setDimensions(mjq_scaledValue(790),mjq_scaledValue(520)),this.setColors("#fdd57a","#280000","#ffffff","#ff4848"),this.setBorderThickness(0),this.setFontAttributes("Samurai",this.dialogFontSize,MJQ_TEXT_PLAIN,2),this.setBackImage(mjq_imageHolders.dialogsmall);var a=null,b=mjq_imageHolders.lableexitlevel.rows[0][0].width;this.addImage(mjq_imageHolders.lableexitlevel,Math.floor((mjq_scaledValue(790)-b)/2),mjq_scaledValue(80)),a=this.addText("Are you sure you want to",mjq_scaledValue(400),mjq_scaledValue(220)),a.setTextJustify(MJQ_TEXT_CENTER),a=this.addText("exit this level?",mjq_scaledValue(400),mjq_scaledValue(280)),a.setTextJustify(MJQ_TEXT_CENTER),this.exitButtonItem=this.addButton(mjq_imageHolders.dialogyesbutton,mjq_scaledValue(96),mjq_scaledValue(366),MJQ_DIALOG_BUTTON_YES),this.button2Item=this.addButton(mjq_imageHolders.dialognobutton,mjq_scaledValue(400),mjq_scaledValue(366),MJQ_DIALOG_BUTTON_NO),this.setPriority(-1)},MJQ_ExitDialog.prototype.show=function(a,b,c,d){this.repaint(),MJQ_CastMemberDialog.prototype.show.call(this,a,b,c,d)},MJQ_LogInOutDialog.mjq_isSubclassOf(MJQ_CastMemberDialog),MJQ_LogInOutDialog.prototype.setup=function(){this.useAbsolutePositioning=!0,this.setDimensions(mjq_scaledValue(790),mjq_scaledValue(520)),this.setColors("#fdd57a","#280000","#ffffff","#ff4848"),this.setBorderThickness(0),this.setFontAttributes("Samurai",this.dialogFontSize,MJQ_TEXT_PLAIN,2),this.setBackImage(mjq_imageHolders.dialogsmall);var a=null;
a=this.addText(this.loggingIn?"Signed IN":"Signed OUT",mjq_scaledValue(400),mjq_scaledValue(100),"#fdd57a",this.dialogFontSizePlus,MJQ_TEXT_PLAIN),a.setTextJustify(MJQ_TEXT_CENTER),a=this.addText("Please wait",mjq_scaledValue(400),mjq_scaledValue(240)),a.setTextJustify(MJQ_TEXT_CENTER),a=this.addText("while the game resets",mjq_scaledValue(400),mjq_scaledValue(300)),a.setTextJustify(MJQ_TEXT_CENTER),this.setPriority(-1)},MJQ_LogInOutDialog.prototype.show=function(a,b,c,d){this.repaint(),MJQ_CastMemberDialog.prototype.show.call(this,a,b,c,d)},MJQ_RulesDialog.mjq_isSubclassOf(MJQ_CastMemberDialog),MJQ_RulesDialog.prototype.setup=function(){this.useAbsolutePositioning=!0,this.setDimensions(mjq_scaledValue(1030),mjq_scaledValue(1090)),this.setColors("#fdd57a","#280000","#ffffff","#ff4848"),this.setBorderThickness(0),this.setFontAttributes("Samurai",this.dialogFontSize,MJQ_TEXT_PLAIN,2),this.setBackImage(mjq_imageHolders.dialogmedium),this.showPage(this.page),this.leftButtonItem=this.addButton(mjq_imageHolders.dialogleftbutton,mjq_scaledValue(330),mjq_scaledValue(926),MJQ_DIALOG_BUTTON_LEFT),this.leftButtonItem.detachOnClick=!1,this.leftButtonItem.setEnabled(!1),this.rightButtonItem=this.addButton(mjq_imageHolders.dialogrightbutton,mjq_scaledValue(530),mjq_scaledValue(926),MJQ_DIALOG_BUTTON_RIGHT),this.rightButtonItem.detachOnClick=!1,this.button2Item=this.addButton(mjq_imageHolders.dialogxbutton,mjq_scaledValue(870),mjq_scaledValue(92),MJQ_DIALOG_BUTTON_CANCEL),this.button2Item.hotRectPadding=40,this.setPriority(-1)},MJQ_RulesDialog.prototype.show=function(a,b,c,d){this.repaint(),MJQ_CastMemberDialog.prototype.show.call(this,a,b,c,d)},MJQ_RulesDialog.prototype.showPage=function(a){for(var b="",c="",d=0,e=0,f="",g=mjq_game["rulesTexts"+this.mapDirection][a],h=0;10>h&&(b="text"+(h+1),f=g[h],void 0!==f);h++)c=f[b],d=mjq_scaledValue(void 0===f.x?515:f.x),e=mjq_scaledValue(f.y),dItem=this.addText(c,d,e),dItem.setTextJustify(MJQ_TEXT_CENTER),this.textItems.push(dItem);for(var i="",j="",k=mjq_game["rulesImages"+this.mapDirection][a],l=null,m=0,h=0;10>h&&(b="img"+(h+1),j=k[h],void 0!==j);h++)i=j[b],l=mjq_imageHolders[i],m=l.rows[0][0].width,d=void 0===j.x?Math.floor((mjq_scaledValue(1030)-m)/2):mjq_scaledValue(j.x),e=mjq_scaledValue(j.y),dItem=this.addImage(l,d,e),this.imgItems.push(dItem)},MJQ_RulesDialog.prototype.pageBack=function(){return this.page>0&&(this.page--,this.removePageItems(),this.showPage(this.page)),0===this.page},MJQ_RulesDialog.prototype.pageForward=function(){return this.page+1<this.numPages&&(this.page++,this.removePageItems(),this.showPage(this.page)),this.page+1===this.numPages},MJQ_RulesDialog.prototype.removePageItems=function(){for(var a=0;a<this.textItems.length;a++)this.removeItem(this.textItems[a]);this.textItems.length=0;for(var a=0;a<this.imgItems.length;a++)this.removeItem(this.imgItems[a]);this.imgItems.length=0};